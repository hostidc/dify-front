window.sc.getESLInstance().addEslConfig({paths:{"js/cosmic.pc.CiKfZjh1":"//ms.bdstatic.com/se/chat-search/static/js/cosmic.pc.CiKfZjh1","js/cosmic-agent-ui.pc.D3zcnH4y":"//ms.bdstatic.com/se/chat-search/static/js/cosmic-agent-ui.pc.D3zcnH4y","js/search-components.pc.DXXW15mB":"//ms.bdstatic.com/se/chat-search/static/js/search-components.pc.DXXW15mB","js/bootstrap.pc.xdqafqeS":"//ms.bdstatic.com/se/chat-search/static/js/bootstrap.pc.xdqafqeS","js/echarts.pc.KGe0vDLl":"//ms.bdstatic.com/se/chat-search/static/js/echarts.pc.KGe0vDLl","js/baidubce-sdk.bundle.min.pc.Dl2RPL9u":"//ms.bdstatic.com/se/chat-search/static/js/baidubce-sdk.bundle.min.pc.Dl2RPL9u","js/artplayer.pc.Cx1tPsvT":"//ms.bdstatic.com/se/chat-search/static/js/artplayer.pc.Cx1tPsvT","js/jsencrypt.min.pc.C4lM-0We":"//ms.bdstatic.com/se/chat-search/static/js/jsencrypt.min.pc.C4lM-0We","js/index.pc.Cl9AChXm":"//ms.bdstatic.com/se/chat-search/static/js/index.pc.Cl9AChXm","js/qeditor.pc.BpWzuvbh":"//ms.bdstatic.com/se/chat-search/static/js/qeditor.pc.BpWzuvbh","js/client.esm.pc.CbkX8WQ8":"//ms.bdstatic.com/se/chat-search/static/js/client.esm.pc.CbkX8WQ8","js/crypto.pc.DUESVqs9":"//ms.bdstatic.com/se/chat-search/static/js/crypto.pc.DUESVqs9"}}),define("js/bootstrap.pc.xdqafqeS",["require","./cosmic.pc.CiKfZjh1","./search-components.pc.DXXW15mB","san","lottie-web","@baidu/boxx","@baidu/chat-stream","./cosmic-agent-ui.pc.D3zcnH4y","@baidu/marklang","@baidu/video-controller"],(function(t,e,n,a,i,o,r,s,c,l){"use strict";function d(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}function u(t,e){return e.forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(n){if("default"!==n&&!(n in t)){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}}))})),Object.freeze(t)}var p=function(t,e){var n,a;return p=Object.setPrototypeOf||(n={__proto__:[]},(null!=(a=Array)&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?!!a[Symbol.hasInstance](n):n instanceof a)&&function(t,e){t.__proto__=e})||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},p(t,e)};var h=function(){return h=Object.assign||function(t){for(var e,n=1,a=Array.from(arguments).length;n<a;n++)for(var i in e=Array.from(arguments)[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},h.apply(this,Array.from(arguments))};function f(){for(var t=[],e=0;e<Array.from(arguments).length;e++)t[e]=Array.from(arguments)[e];var n=Object.assign||function(t){for(var e=void 0,n=1,a=Array.from(arguments).length;n<a;n++)for(var i in e=Array.from(arguments)[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};return n.apply(this,t)}function g(t){var e=function(t){if(URL&&t)try{var e=new URL(t);if(void 0!==e.host)return{protocol:e.protocol,host:e.host,pathname:e.pathname,ext:""}}catch(t){console.error(t)}}(t);if(!e){var n=document.createElement("a");n.href=t,e={protocol:n.protocol,host:n.host||location.host,pathname:n.pathname,ext:""}}var a=e.pathname.split(".");return e.ext=a[a.length-1],e}function m(t){return+t.toFixed(1)}function v(t){if(!t)return{xpath:""};for(var e=[];t&&1===t.nodeType&&t!==t.parentNode;){var n=t.tagName.toLowerCase();if(t.getAttribute("id")?n+="[#"+t.getAttribute("id")+"]":t.classList&&t.classList.length&&(n+="[."+t.classList[t.classList.length-1]+"]"),e.push(n),t===document.body)break;t=t.parentNode}return{xpath:e.join("<")}}var y=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?)_/):"",b=y&&y[2]&&+y[2]<14;function w(t){console.error("[SpyClient_log]"+t)}function _(t){return Object.keys(t).map((function(e){var n=t[e];return void 0===n?n="":"string"!=typeof n&&(n=JSON.stringify(n)),encodeURIComponent(e)+"="+encodeURIComponent(n)})).join("&")}function k(t){return"[object Array]"===Object.prototype.toString.call(t)}var S=function(){function t(t){if(this.sample={},this.markCache={},!t.pid)throw new Error("pid is required");this.option={pid:t.pid,lid:t.lid,check:!1!==t.check,sample:t.sample,localCache:t.localCache,logServer:t.logServer||"https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/mwb2.gif?"}}return t.prototype.handle=function(t){if(this.check(t)){if(t=f({pid:this.option.pid,lid:this.option.lid,ts:Date.now(),group:"common"},t),this.option.localCache&&this.option.localCache.addLog(t),"number"==typeof t.sample){if(Math.random()>t.sample)return}else if("number"==typeof this.option.sample&&Math.random()>this.option.sample)return;return delete t.sample,t}},t.prototype.send=function(t,e){void 0===e&&(e=!1);for(var n=[],a=0,i=k(t)?t:[t];a<i.length;a++){var o=i[a];if((o=this.handle(o))&&(n.push(o),!e)){var r=this.option.logServer+_(o);this.request(r)}}e&&this.sendPost(n)},t.prototype.check=function(t){if(!this.option.check)return!0;var e=["perf","except","dist","count"];if(-1===e.indexOf(t.type))return w("type only is one of "+e.join(", ")),!1;if(t.group&&t.group.length>30)return w("group length execeeds 30"),!1;var n=/^[a-zA-Z0-9-_]{0,30}$/;if("except"===t.type){if("string"!=typeof t.info.msg||!t.info.msg.length)return w("info.msg field must be not empty and is String"),!1}else for(var a=0,i=Object.keys(t.info);a<i.length;a++){var o=i[a];if(!n.test(o))return w("info."+o+" is unexpected. Length must be not more than 30. Supported chars: a-zA-Z0-9-_"),!1;var r=t.info[o];if("dist"===t.type){if(r.length>30)return w("info."+o+" value length execeeds 30 when type == 'dist'"),!1}else if("number"!=typeof r)return w("info."+o+" value must be number"),!1}if(t.dim)for(var s=0,c=Object.keys(t.dim);s<c.length;s++){var l=c[s];if(!n.test(l))return w("dim key ["+l+"] is unexpected. Length must be not more than 30. Supported chars: a-zA-Z0-9-_"),!1;var d=t.dim[l];if(!/^[a-zA-Z0-9\-_\*\.\s\/#\+@\&\u4e00-\u9fa5]{0,30}$/.test(d))return w("dim."+l+" value ["+d+"] is unexpected. Length must be not more than 30. Supported chars: a-zA-Z0-9-_*. /#+@& and Chinese"),!1}return!0},t.prototype.sendPerf=function(t){this.send(f({type:"perf"},t))},t.prototype.sendExcept=function(t){this.send(f({type:"except"},t))},t.prototype.sendDist=function(t){this.send(f({type:"dist"},t))},t.prototype.sendCount=function(t){this.send(f({type:"count"},t))},t.prototype.sendExceptForError=function(t,e){var n=f({},e);n.info=f({},e.info||{},{msg:t.message,stack:t.stack}),this.sendExcept(n)},t.prototype.startMark=function(t){this.markCache[t]={start:Date.now()}},t.prototype.endMark=function(t){return this.markCache[t]?(this.markCache[t].total=Date.now()-this.markCache[t].start,this.markCache[t].total):0},t.prototype.clearMark=function(t){this.markCache[t]&&delete this.markCache[t]},t.prototype.getAllMark=function(){for(var t={},e=0,n=Object.keys(this.markCache);e<n.length;e++){var a=n[e];t[a]=this.markCache[a].total}return t},t.prototype.clearAllMark=function(){this.markCache={}},t.prototype.sendPost=function(t){var e=(k(t)?t:[t])[0],n={pid:e.pid,type:e.type,group:e.group},a=this.option.logServer+_(n);this.request(a,t)},t.prototype.request=function(t,e){!b&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(t,e?JSON.stringify(e):void 0)||(e?this.fetch(t,e):(new Image).src=t)},t.prototype.fetch=function(t,e){fetch?fetch(t,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}):w("Global fetch method doesn't exist")},t}(),x=window.__spyHead,I="first-input",T=function(){function t(){var t=this;if(this.observer=null,window.PerformanceObserver){x&&x.entryMap&&x.entryMap[I]&&this.handle(x.entryMap[I]);try{this.observer=new PerformanceObserver((function(e){t.handle(e.getEntries())})),this.observer.observe({entryTypes:[I]})}catch(t){}}}return t.prototype.listenFID=function(t){this.cb=t,this.callCB()},t.prototype.callCB=function(){void 0!==this.finalValue&&this.cb&&this.cb({fid:this.finalValue})},t.prototype.destroy=function(){this.observer&&this.observer.disconnect(),this.observer=null},t.prototype.handle=function(t){var e=t.pop();e&&(this.finalValue=e.duration,this.callCB(),this.destroy())},t}(),C=window.__spyHead,L="layout-shift",P=function(){function t(){var t=this;if(this.observer=null,this.onceLeave=!1,window.PerformanceObserver){C&&C.entryMap&&C.entryMap[L]&&this.handle(C.entryMap[L]);try{this.observer=new PerformanceObserver((function(e){t.handle(e.getEntries())})),this.observer.observe({entryTypes:[L]})}catch(t){}}}return t.prototype.listenLayoutShift=function(t){this.cb=t},t.prototype.leave=function(){this.onceLeave||(this.onceLeave=!0,this.observer&&this.observer.takeRecords&&this.observer.takeRecords(),this.finalValue=this.value,this.callCB(),this.destroy())},t.prototype.callCB=function(){void 0!==this.finalValue&&this.cb&&this.cb({layoutShift:this.finalValue})},t.prototype.destroy=function(){this.observer&&this.observer.disconnect(),this.observer=null},t.prototype.handle=function(t){var e=this;t.map((function(t){t.hadRecentInput||(e.value=(e.value||0)+(t.value||0))}))},t}(),D={};function A(t){return D[t]}var E=window.__spyHead,O="largest-contentful-paint",R=function(){function t(){var t=this;if(this.observer=null,window.PerformanceObserver){E&&E.entryMap&&E.entryMap[O]&&this.handle(E.entryMap[O]);try{this.observer=new PerformanceObserver((function(e){t.handle(e.getEntries())})),this.observer.observe({entryTypes:[O]})}catch(t){}}}return t.prototype.listenLCP=function(t){this.cb=t,this.callCB()},t.prototype.callCB=function(){this.finalValue&&this.cb&&this.cb({lcp:this.finalValue})},t.prototype.load=function(){var t,e;this.observer&&this.observer.takeRecords&&this.observer.takeRecords(),this.finalValue=this.value,t="lcp",e=this.value,D[t]=e,this.callCB(),this.destroy()},t.prototype.destroy=function(){this.observer&&this.observer.disconnect(),this.observer=null},t.prototype.handle=function(t){var e=this;t.map((function(t){e.value=t.renderTime||t.loadTime}))},t}();function N(t){return t.name.indexOf(".gif?")<0}var q,M,j=function(){function t(){this.lastLongTask=0,this.observer=null,this.interval=5e3,this.filterRequest=N,this.observerCallback=this.observerCallback.bind(this),this.ttiCheck=this.ttiCheck.bind(this)}return t.prototype.check=function(){return window.PerformanceObserver&&performance&&performance.timing&&performance.timing.navigationStart},t.prototype.listenTTI=function(t,e){this.check()&&(this.observeLongtask(2e4),this.cb=t,(e=e||{}).interval&&(this.interval=e.interval),e.filterRequest&&(this.filterRequest=e.filterRequest))},t.prototype.load=function(){this.check()&&(this.ttiTimer=setInterval(this.ttiCheck,this.interval))},t.prototype.ttiCheck=function(){if(this.cb){var t=performance.now();if(!(t-this.lastLongTask<this.interval)){var e=this.getNetworkSilenceAt();if(!1!==e&&!(t-e<this.interval)){clearTimeout(this.ttiTimer);var n=this.lastLongTask;n||(n=performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart),this.stopObserveLongTask(),this.cb({tti:n})}}}},t.prototype.observerCallback=function(t){var e=t.getEntries(),n=e[e.length-1];this.lastLongTask=n.startTime+n.duration},t.prototype.stopObserveLongTask=function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.stopLongTaskTimeoutId&&clearTimeout(this.stopLongTaskTimeoutId)},t.prototype.getNetworkSilenceAt=function(){for(var t=0,e=0,n=performance.getEntriesByType("resource").filter(this.filterRequest);e<n.length;e++){var a=n[e];if(!a.responseEnd)return!1;a.responseEnd>t&&(t=a.responseEnd)}return t},t.prototype.observeLongtask=function(t){this.stopObserveLongTask();try{this.observer=new PerformanceObserver(this.observerCallback),this.observer.observe({entryTypes:["longtask"]}),this.stopLongTaskTimeoutId=setTimeout(this.stopObserveLongTask,t)}catch(t){}},t}(),B=function(){function t(){}return t.prototype.listenTiming=function(t){window.performance&&window.performance.timing&&(this.cb=t)},t.prototype.load=function(){var t=this;setTimeout((function(){t.cb&&t.cb(t.getMetric())}),500)},t.prototype.getMetric=function(){var t={},e=window.performance.timing,n=e.navigationStart;if(t.dns=e.domainLookupEnd-e.domainLookupStart,t.tcp=e.connectEnd-e.connectStart,t.request=e.responseStart-e.requestStart,t.response=e.responseEnd-e.responseStart,t.parseHtml=e.domInteractive-e.domLoading,t.domReady=e.domContentLoadedEventEnd-n,t.loadEventHandle=e.loadEventEnd-e.loadEventStart,t.load=e.loadEventEnd-n,performance.getEntriesByType){var a=performance.getEntriesByType("paint");a&&a.length&&a.forEach((function(e){var n=e.name,a=e.duration,i=e.startTime,o=Math.ceil(a+i);"first-paint"===n&&(t.fp=o),"first-contentful-paint"===n&&(t.fcp=o)}))}return e.domFirstPaint&&(t.t7FirstPaint=e.domFirstPaint-n),e.domFirstScreenPaint&&(t.t7FirstScreen=e.domFirstScreenPaint-n),t},t}();!function(t){t.JS="js",t.CSS="css",t.IMG="img",t.FONT="font"}(q||(q={})),function(t){t[t.ttf=0]="ttf",t[t.eot=1]="eot",t[t.woff=2]="woff",t[t.woff2=3]="woff2"}(M||(M={}));var H=["/mwb2.gif"];function $(t,e){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t.indexOf(i)>-1)return!0}return!1}function U(t){return+t.toFixed(1)}var F=function(){function t(){this.trigger="load",this.jsList=[],this.cssList=[],this.imgList=[],this.fontList=[],this.hostList={},this.bigImgList={},this.httpResList={},this.slowList={},this.resOption={ignorePaths:[],trigger:"load"},this.bigImgOption={ignorePaths:[],maxSize:153600,trigger:"load"},this.httpResOption={ignorePaths:[],trigger:"load"},this.slowOption={ignorePaths:[],trigger:"load",threshold:1e3}}return t.prototype.check=function(){return performance&&performance.getEntriesByType},t.prototype.listenResource=function(t,e){void 0===e&&(e={}),this.check()&&(this.resOption=f(this.resOption,e),this.trigger=this.resOption.trigger,this.cb=t)},t.prototype.listenBigImg=function(t,e){void 0===e&&(e={}),this.check()&&(this.bigImgOption=f(this.bigImgOption,e),this.trigger=this.bigImgOption.trigger,this.bigImgCB=t)},t.prototype.listenHttpResource=function(t,e){void 0===e&&(e={}),this.check()&&(this.httpResOption=f(this.httpResOption,e),this.trigger=this.httpResOption.trigger,this.httpResCB=t)},t.prototype.listenSlowResource=function(t,e){void 0===e&&(e={}),this.check()&&(this.slowOption=f(this.slowOption,e),this.trigger=this.slowOption.trigger,this.slowResCB=t)},t.prototype.report=function(){var t=this,e=this.getMetric();if(e){var n=e.metric,a=e.hostMetric;this.cb&&this.cb(n,a)}this.bigImgCB&&"function"==typeof window.requestIdleCallback&&Object.keys(this.bigImgList).length&&window.requestIdleCallback((function(){for(var e=0,n=Object.keys(t.bigImgList);e<n.length;e++)for(var a=n[e],i=0,o=t.bigImgList[a];i<o.length;i++){var r=o[i],s=r.timing,c=r.type;try{var l=document.body.querySelector('img[src="'+s.name+'"]');t.bigImgCB({msg:s.name,dur:s.duration,xpath:v(l).xpath,host:a,type:c})}catch(t){console.error(t)}}})),this.httpResCB&&"function"==typeof window.requestIdleCallback&&Object.keys(this.httpResList).length&&window.requestIdleCallback((function(){for(var e=0,n=Object.keys(t.httpResList);e<n.length;e++)for(var a=n[e],i=0,o=t.httpResList[a];i<o.length;i++){var r=o[i],s=r.timing,c=r.type;try{var l=document.body.querySelector('[src="'+s.name+'"]');t.httpResCB({msg:s.name,dur:s.duration,xpath:v(l).xpath,host:a,type:c})}catch(t){console.error(t)}}})),this.slowResCB&&"function"==typeof window.requestIdleCallback&&Object.keys(this.slowList).length&&window.requestIdleCallback((function(){for(var e=0,n=Object.keys(t.slowList);e<n.length;e++)for(var a=n[e],i=0,o=t.slowList[a];i<o.length;i++){var r=o[i],s=r.timing,c=r.type;try{var l=document.body.querySelector('[src="'+s.name+'"]'),d={wait:m((u=s).domainLookupStart-(u.navigationStart||u.fetchStart||u.startTime)),dns:m(u.domainLookupEnd-u.domainLookupStart),connect:m(u.connectEnd-u.connectStart),req:m(u.responseStart-u.requestStart),res:m(u.responseEnd-u.responseStart)};t.slowResCB(h(h({},d),{dur:s.duration,msg:s.name,xpath:v(l).xpath,host:a,type:c}))}catch(t){console.error(t)}}var u}))},t.prototype.load=function(){var t=this;"load"===this.trigger&&this.check()&&setTimeout((function(){t.report()}),500)},t.prototype.leave=function(){"leave"===this.trigger&&this.report()},t.prototype.push=function(t,e,n,a){$(a.pathname,this.resOption.ignorePaths||[])||(e.push(n),this.pushWithHost(t,this.hostList,n,a)),$(a.pathname,this.slowOption.ignorePaths||[])||n.duration>this.slowOption.threshold&&this.pushWithHost(t,this.slowList,n,a)},t.prototype.pushWithHost=function(t,e,n,a){var i=a.host;e[i]||(e[i]=[]),e[i].push({timing:n,type:t})},t.prototype.collectHttpResInHttps=function(t,e,n){"https:"!==location.protocol||0!==e.name.indexOf("http://")||$(n.pathname,this.httpResOption.ignorePaths||[])||this.pushWithHost(t,this.httpResList,e,n)},t.prototype.addScript=function(t,e){"js"===e.ext&&0!==t.decodedBodySize&&this.push("js",this.jsList,t,e)},t.prototype.addResFromCss=function(t,e){e.ext&&M.hasOwnProperty(e.ext)?this.push("font",this.fontList,t,e):this.addImg(t,e)},t.prototype.addLink=function(t,e){"css"===e.ext?this.push("css",this.cssList,t,e):"js"===e.ext&&this.push("js",this.jsList,t,e)},t.prototype.addImg=function(t,e){this.push("img",this.imgList,t,e),t.decodedBodySize>(this.bigImgOption.maxSize||0)&&!$(e.pathname,this.bigImgOption.ignorePaths||[])&&this.pushWithHost("img",this.bigImgList,t,e)},t.prototype.handleTimings=function(t){for(var e=t.length,n=0;n<e;n++){var a=t[n],i=g(a.name);if(!$(i.pathname,H))switch(t[n].initiatorType){case"script":this.addScript(a,i);break;case"css":this.addResFromCss(a,i);break;case"img":this.addImg(a,i);break;case"link":this.addLink(a,i);break;case"audio":this.collectHttpResInHttps("audio",a,i);break;case"video":this.collectHttpResInHttps("video",a,i)}}},t.prototype.getNumAndSize=function(t,e){var n={},a=t+"Num",i=t+"Size",o=t+"TransferSize",r=t+"CacheRate",s=t+"Duration";n[a]=0,n[i]=0,n[o]=0;var c=0;if(e.forEach((function(t){n[a]++,n[i]+=t.decodedBodySize/1024,n[o]+=t.transferSize/1024,c+=t.duration})),n[s]=U(n[a]>0?c/n[a]:0),n[i]){var l=n[i]-n[o];n[r]=U(l>=0?100*l/n[i]:0)}return n[i]=U(n[i]),n[o]=U(n[o]),n},t.prototype.getMetric=function(){var t=performance.getEntriesByType("navigation")[0],e=performance.getEntriesByType("resource");if(t&&e&&e.length){this.handleTimings(e);var n=h(h(h(h({},this.getNumAndSize(q.JS,this.jsList)),this.getNumAndSize(q.CSS,this.cssList)),this.getNumAndSize(q.IMG,this.imgList)),this.getNumAndSize(q.FONT,this.fontList)),a=t;n.docSize=U(a.decodedBodySize/1024),n.docTransferSize=U(a.transferSize/1024),n.headerSize=U((a.transferSize-a.encodedBodySize||0)/1024),n.allSize=U(n.docSize+n.jsSize+n.cssSize+n.imgSize+n.fontSize),n.allTransferSize=U(n.docTransferSize+n.jsTransferSize+n.cssTransferSize+n.imgTransferSize+n.fontTransferSize);for(var i={},o=0,r=Object.keys(this.hostList);o<r.length;o++){var s=r[o],c=this.hostList[s].map((function(t){return t.timing}));i[s]=this.getNumAndSize("host",c)}return{metric:n,hostMetric:i}}},t}(),G=null;window.performance&&window.performance.memory&&(G=window.performance.memory);var W,z=function(){function t(){this.onceLeave=!1}return t.prototype.listenMemory=function(t){this.cb=t},t.prototype.leave=function(){if(!this.onceLeave&&G){this.onceLeave=!0;var t=window.performance.memory;if(t.usedJSHeapSize===G.usedJSHeapSize&&t.totalJSHeapSize===G.totalJSHeapSize)return;var e=window.performance.memory;this.cb&&this.cb({usedJSHeapSize:e.usedJSHeapSize/1024,totalJSHeapSize:e.totalJSHeapSize/1024,jsHeapSizeLimit:e.jsHeapSizeLimit/1024,usedJSHeapRate:100*e.usedJSHeapSize/e.totalJSHeapSize})}},t}(),Q=function(){function t(){}return t.prototype.getNavigatorInfo=function(){var t,n={},a=navigator.connection;return"object"===(void 0===a?"undefined":(t=a)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":e._typeof(t))&&(n={downlink:a.downlink,effectiveType:a.effectiveType,rtt:a.rtt,saveData:!!a.saveData}),navigator.deviceMemory&&(n.deviceMemory=navigator.deviceMemory),navigator.hardwareConcurrency&&(n.hardwareConcurrency=navigator.deviceMemory),n},t.prototype.load=function(){},t}(),J=window.__spyHead,V="longtask",K=function(){function t(){var t=this;this.lts=[],this.observer=null,this.onceLeave=!1,J&&J.entryMap&&J.entryMap[V]&&(this.lts=this.lts.concat(J.entryMap[V]));try{this.observer=new PerformanceObserver((function(e){t.lts=t.lts.concat(e.getEntries())})),this.observer.observe({entryTypes:[V]})}catch(t){}}return t.prototype.check=function(){return window.PerformanceObserver&&performance&&performance.timing&&performance.timing.navigationStart},t.prototype.listenFSPLongTask=function(t){this.check()&&(this.fspCB=t)},t.prototype.listenLCPLongTask=function(t){this.check()&&(this.lcpCB=t)},t.prototype.listenLoadLongTask=function(t){this.check()&&(this.loadCB=t)},t.prototype.listenPageLongTask=function(t){this.check()&&(this.pageCB=t)},t.prototype.load=function(){var t=this;if(this.check()){var e=this.getStatData(Date.now());setTimeout((function(){if(t.loadCB&&t.loadCB({loadLongtaskTime:e.time,loadTBT:e.tbt,loadTotalTime:e.totalTime,loadLongtaskRate:e.rate,loadLongtaskNum:e.num}),performance.timing&&performance.timing.domFirstScreenPaint){var n=t.getStatData(performance.timing.domFirstScreenPaint);t.fspCB&&t.fspCB({fspLongtaskTime:n.time,fspTBT:n.tbt,fspTotalTime:n.totalTime,fspLongtaskRate:n.rate,fspLongtaskNum:n.num})}if(A("lcp")){var a=t.getStatData(performance.timing.navigationStart+A("lcp"));t.lcpCB&&t.lcpCB({lcpLongtaskTime:a.time,lcpTBT:a.tbt,lcpTotalTime:a.totalTime,lcpLongtaskRate:a.rate,lcpLongtaskNum:a.num})}}),200)}},t.prototype.leave=function(){if(!this.onceLeave){this.onceLeave=!0;var t=this.getStatData(Date.now());this.pageCB&&this.pageCB({pageLongtaskTime:t.time,pageTBT:t.tbt,pageTotalTime:t.totalTime,pageLongtaskRate:t.rate,pageLongtaskNum:t.num,pageIframeLongtaskTime:t.iframeTime,pageIframeLongtaskRate:t.iframeRate,pageIframeLongtaskNum:t.iframeNum})}},t.prototype.destroy=function(){this.lts=[],this.observer&&this.observer.disconnect(),this.observer=null},t.prototype.getStatData=function(t){for(var e=performance.timing.navigationStart,n=0,a=0,i=0,o=0,r=0,s={},c=0;c<this.lts.length;c++){var l=this.lts[c],d=l.duration;if(e+l.startTime+d<t&&(n+=d,a+=d-50>0?d-50:0,i++,l.attribution&&l.attribution[0])){var u=l.attribution[0].containerSrc;u&&u!==location.href&&(s[u]||(s[u]=[]),s[u].push(d),o+=d,r++)}}var p=t-e;return{num:i,time:n,tbt:a,totalTime:p,rate:100*n/p,iframeTime:o,iframeNum:r,iframeRate:100*o/p,iframeLongtasks:s}},t}(),X=function(t){function e(e){var n=t.call(this,e)||this;return n.modules=[],n.register(new T),n.register(new R),n.register(new P),n.register(new j),n.register(new B),n.register(new F),n.register(new z),n.register(new Q),n.register(new K),n.visibilitychangeCB=n.visibilitychangeCB.bind(n),n.load=n.load.bind(n),n.leave=n.leave.bind(n),"complete"===document.readyState?n.load():window.addEventListener("load",n.load),document.addEventListener("visibilitychange",n.visibilitychangeCB),window.addEventListener("beforeunload",n.leave,!1),window.addEventListener("unload",n.leave,!1),n.handleHead(),n}return function(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.handleHead=function(){var t=this;if(this.option.localCache){var e=window.__spyHead;if(e&&e.winerrors){for(var n=0;n<e.winerrors.length;n++){var a=e.winerrors[n];this.option.localCache.addLog(a)}e.interceptor=function(e){t.option.localCache.addLog(e)}}}},e.prototype.listenFID=function(t){this.invoke("listenFID",t)},e.prototype.listenLayoutShift=function(t){this.invoke("listenLayoutShift",t)},e.prototype.listenLCP=function(t){this.invoke("listenLCP",t)},e.prototype.listenFSPLongTask=function(t){this.invoke("listenFSPLongTask",t)},e.prototype.listenLCPLongTask=function(t){this.invoke("listenLCPLongTask",t)},e.prototype.listenLoadLongTask=function(t){this.invoke("listenLoadLongTask",t)},e.prototype.listenPageLongTask=function(t){this.invoke("listenPageLongTask",t)},e.prototype.listenMemory=function(t){this.invoke("listenMemory",t)},e.prototype.getNavigatorInfo=function(){return this.invoke("getNavigatorInfo")},e.prototype.listenResource=function(t,e){this.invoke("listenResource",t,e)},e.prototype.listenBigImg=function(t,e){this.invoke("listenBigImg",t,e)},e.prototype.listenHttpResource=function(t,e){this.invoke("listenHttpResource",t,e)},e.prototype.listenSlowResource=function(t,e){this.invoke("listenSlowResource",t,e)},e.prototype.listenTiming=function(t){this.invoke("listenTiming",t)},e.prototype.listenTTI=function(t,e){this.invoke("listenTTI",t,e)},e.prototype.invoke=function(t,e,n){for(var a=0;a<this.modules.length;a++){var i=this.modules[a];if("function"==typeof i[t])return i[t].apply(i,[e,n])}console.error("no method",t)},e.prototype.register=function(t){this.modules.push(t)},e.prototype.load=function(){for(var t=0;t<this.modules.length;t++){var e=this.modules[t];e.load&&e.load()}},e.prototype.leave=function(){for(var t=0;t<this.modules.length;t++){var e=this.modules[t];e.leave&&e.leave()}},e.prototype.destroy=function(){for(var t=0;t<this.modules.length;t++){var e=this.modules[t];e.destroy&&e.destroy()}document.removeEventListener("visibilitychange",this.visibilitychangeCB),window.removeEventListener("load",this.load),window.removeEventListener("beforeunload",this.leave),window.removeEventListener("unload",this.destroy)},e.prototype.visibilitychangeCB=function(){"hidden"===document.visibilityState&&this.leave()},e}(S),Y={exports:{}};W=Y,n.commonjsGlobal,W.exports=function(){function t(t){if(URL&&t)try{var e=new URL(t);if(void 0!==e.host)return{protocol:e.protocol,host:e.host,pathname:e.pathname,ext:""}}catch(t){console.error(t)}}function e(e){var n=t(e);if(!n){var a=document.createElement("a");a.href=e,n={protocol:a.protocol,host:a.host||location.host,pathname:a.pathname,ext:""}}var i=n.pathname.split(".");return n.ext=i[i.length-1],n}function n(t){return+t.toFixed(1)}function a(t){return{wait:n(t.domainLookupStart-(t.navigationStart||t.fetchStart||t.startTime)),dns:n(t.domainLookupEnd-t.domainLookupStart),connect:n(t.connectEnd-t.connectStart),req:n(t.responseStart-t.requestStart),res:n(t.responseEnd-t.responseStart)}}function i(t){if(!t)return{xpath:""};for(var e=[];t&&1===t.nodeType&&t!==t.parentNode;){var n=t.tagName.toLowerCase();if(t.getAttribute("id")?n+="[#"+t.getAttribute("id")+"]":t.classList&&t.classList.length&&(n+="[."+t.classList[t.classList.length-1]+"]"),e.push(n),t===document.body)break;t=t.parentNode}return{xpath:e.join("<")}}var o={conf:{},winerrors:[],errorDestroy:function(){},observerDestroy:function(){},entryMap:{},init:function(t){this.conf=t},addError:function(t){if(this.winerrors.length>0){var e=this.winerrors[this.winerrors.length-1];if(t.info.msg===e.info.msg)return void(e.info.count+=e.info.count||0)}this.winerrors.length<1e3&&this.winerrors.push(t)},send:function(t,e,n){var a=this.conf;if(t.type=t.type||"except",t.pid=a.pid,t.lid=a.lid,t.ts=Date.now(),this.addError(t),this.interceptor&&this.interceptor(t),!1!==e){var i=(n=n||a.logServer)+"?pid="+t.pid+"&lid="+t.lid+"&ts="+t.ts+"&type="+t.type+"&group="+t.group+"&info="+encodeURIComponent(JSON.stringify(t.info));t.dim&&(i+="&dim="+encodeURIComponent(JSON.stringify(t.dim)));var o=new Image;o.src=i,o.onload=o.onerror=function(){o=null}}}};function r(t){var n=t.resourceError||{},a=t.jsError||{},r=Math.random()<(a.sample?a.sample:0),s=Math.random()<(n.sample?n.sample:0),c=o.winerrors,l=0;function d(t){try{var d=t.target,u={info:{},dim:{},group:""},p=u.info,h=t.srcElement,f=navigator.connection||{};if(p.downlink=f.downlink,p.effectiveType=f.effectiveType,p.rtt=f.rtt,p.deviceMemory=navigator.deviceMemory||0,p.hardwareConcurrency=navigator.hardwareConcurrency||0,h===window){u.group=a.group;var g=t.error||{};if(p.msg=t.message,p.file=t.filename,p.ln=t.lineno,p.col=t.colno,p.stack=(g.stack||"").split("\n").slice(0,3).join("\n"),-1!==p.msg.indexOf("MODULE_TIMEOUT")){var m=p.msg.match(/^.*Hang:(.*); Miss:(.*)/);m&&m[2]&&(p.msg="MODULE_TIMEOUT for miss:"+m[2])}for(var v=[],y=0;y<c.length;y++){var b=c[y],w=b.info.count>1?"("+b.info.count+")":"";v.push(w+b.info.msg)}p.hisErrors=v.join("----");var _=!0;a.handler&&(_=a.handler(u)),!1!==_&&o.send(u,r)}else{u.group=n.group,u.dim.type=h.tagName.toLowerCase();var k=h.src||h.href||"";if(k.indexOf("/mwb2.gif?")>-1)return;p.msg=k||"unknown load eror",u.dim.host=e(k).host,d&&"IMG"===d.tagName&&(p.xpath=i(d).xpath),l&&(p.hisErrCount=l),_=!0,n.handler&&(_=n.handler(u)),!1!==_&&o.send(u,s),l++}}catch(t){console.error(t)}}window.addEventListener("error",d,!0),o.errorDestroy=function(){window.removeEventListener("error",d,!0),o.winerrors=[]}}function s(){if(window.PerformanceObserver){var t=new window.PerformanceObserver((function(t){for(var e=o.entryMap,n=t.getEntries(),a=0;a<n.length;a++){var i=n[a];e[i.entryType]||(e[i.entryType]=[]),e[i.entryType].push(i)}}));o.observerDestroy=function(){t.disconnect()};try{t.observe({entryTypes:["longtask","layout-shift","first-input","largest-contentful-paint"]})}catch(t){}}}function c(t){var e=t.whiteScreenError||{},n=e.handler,i=e.selector,r=e.subSelector,s=e.timeout||6e3,c=Math.random()<(e.sample?e.sample:0);function l(){if(!window.performance)return!1;var t=a(window.performance.timing);return"&wait="+t.wait+"&dns="+t.dns+"&connect="+t.connect+"&requestTime="+t.req+"&resoneTime="+t.res}function d(){if(!o.winerrors)return!1;for(var t=o.winerrors,e=[],n=0;n<t.length;n++){var a=(t[n].info.stack||"").split("\n")[0];e.push("("+n+")"+(a||t[n].info.msg))}return e.join(";;")}function u(){var t={},e=navigator.connection||{};return t.downlink=e.downlink,t.effectiveType=e.effectiveType,t.rtt=e.rtt,t.deviceMemory=navigator.deviceMemory||0,t.hardwareConcurrency=navigator.hardwareConcurrency||0,t}function p(){var t=document.querySelector(i);return!t||!t.querySelector(r)||t.clientHeight<2*window.innerHeight/3}i&&setTimeout((function(){if(p()){var t={group:e.group,info:{msg:"",netTime:l(),hisErrors:d(),deviceInfo:u()}};t.info.msg="WhiteScren Error";var a=!0;n&&(a=n(t)),!1!==a&&t.info.msg&&o&&o.send(t,c)}}),s)}return o.init=function(t){t.logServer||(t.logServer="https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/mwb2.gif"),this.conf=t,r(t),s(),c(t)},window.__spyclientConf&&o.init(window.__spyclientConf),o}();var Z=Y.exports,tt=n.getDefaultExportFromCjs(Z),et=new URL(document.URL),nt=et.host.indexOf("debug")>-1||"2"===et.searchParams.get("info"),at=(+et.searchParams.get("bottomBarHeight")||0)/window.devicePixelRatio;function it(){var t="";if(nt)try{t=JSON.parse(et.searchParams.get("dheader"))["User-Agent"]}catch(t){console.error("获取debug环境ua失败",t)}var e=(nt&&t?t:navigator.userAgent).toLowerCase(),n=e.includes("iphone")||e.includes("ipod")||e.includes("ipad"),a=e.includes("android"),i=e.includes("baiduboxapp"),o=e.includes("searchcraft"),r=e.includes("theme/dark"),s=e.includes("bdhonorbrowser"),c=e.includes("arkweb"),l=e.includes("huawei"),d=e.includes("qqbrowser"),u=e.includes("safari")&&!e.includes("chrome"),p=e.includes("firefox"),h=location.href.includes("extension://")&&e.includes("edg/"),f=e.includes("ipad")?"pc":/Mobi|Android|iPhone|ArkWeb/i.test(e||"")?"wise":"pc";return{isIOS:n,isAndroid:a,isBaiduBox:i,isSearchCraft:o,isDarkMode:r,isQQBrowser:d,isSafari:u,platform:f,debugUA:t,isWindows:e.includes("windows"),isFirefox:p,isEdgeExtension:h,scene:"pc",isDeepSeekPage:"/deepseek"===location.pathname&&"pc"!==f,isOnline:"chat.baidu.com"===et.host,isBdhonor:s,isHarmony:c,isHuawei:l}}var ot=it();function rt(){return ot.platform}function st(){return ot.isOnline}function ct(){return ot.isDeepSeekPage}function lt(){return ot.isSearchCraft}function dt(){return ot.isHarmony}function ut(){return ot.isBaiduBox}function pt(){return!("pc"===rt()||ut()||nt||ot.isBdhonor||lt()||dt())}function ht(){return ot.isFirefox}function ft(){return"extension"===ot.scene}function gt(){if(dt())return!0;if(!ot.isIOS)return!1;var t=window.screen,e=t.width,n=t.height;return 375===e&&812===n||414===e&&896===n||390===e&&844===n||428===e&&926===n||430===e&&932===n||393===e&&852===n||430===e&&932===n||375===e&&812===n}function mt(t){return dt()?t+at+11-45:ct()?ot.isAndroid||!gt()?t:t+11:0}function vt(t){var e=!!t;return Array.isArray(t)&&t.forEach((function(t){switch(t.type){case"TEXT":e=!!t.data.text.query;break;case"IMAGE":e=Object.keys(t.data.image).length>0}})),e}function yt(t){var e=t;if(Array.isArray(t)){var n="";t.forEach((function(t){var e=t.data;if("TEXT"===t.type)n+=e.text.query})),e=n}return e||""}function bt(t,e){var n=[];if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length)for(var a=0;a<e.length;a++){var i={};switch(i.type=e[a],e[a]){case"TEXT":i.data={text:t[a]};break;case"IMAGE":i.data={image:t[a]};break;case"FILE":i.data={file:t[a]}}n.push(i)}else if("object"===(void 0===t?"undefined":function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(t))&&null!==t&&!Array.isArray(t)){var o={};switch(o.type=e,e){case"TEXT":o.data={text:t};break;case"IMAGE":o.data={image:t};break;case"FILE":o.data={file:t}}n.push(o)}return n.length>0?n:""}var wt,_t={exports:{}};function kt(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}wt=_t.exports,n.commonjsGlobal,function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){if(!kt(t,e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,n){return e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){return r(t)||s(t)||c(t)||d()}function r(t){if(Array.isArray(t))return l(t)}function s(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t){var e=[],n=[];function a(t){if(t.$change)return t.target=n.slice(0),void e.push(t);for(var i in t)t.hasOwnProperty(i)&&(n.push(i),a(t[i]),n.pop())}return a(t),e}function p(t){if(kt(t,Array))return t;if("string"!=typeof t)return[];for(var e=t.split("."),n=[],a=0,i=e.length;a<i;a++){var o=e[a],r=o.indexOf("[");if(r>=0)for(r>0&&(n.push(o.slice(0,r)),o=o.slice(r));91===o.charCodeAt(0);){var s=o.indexOf("]");if(s<0)throw new Error("name syntax error: "+t);var c=o.slice(1,s);/^[0-9]+$/.test(c)?n.push(+c):/^(['"])([^\1]+)\1$/.test(c)&&n.push(c.slice(1,-1)),o=o.slice(s+1)}else n.push(o)}return n}var h="undefined"!=typeof window;function f(t,e){h&&window.__san_devtool__&&window.__san_devtool__.emit(t,e)}var g,m=0,v=function(){return(++m).toString()},y=function(){function t(){var e=this,a=Array.from(arguments).length>0&&void 0!==Array.from(arguments)[0]?Array.from(arguments)[0]:{},i=a.initData,o=void 0===i?{}:i,r=a.actions,s=void 0===r?{}:r,c=a.log,l=void 0!==c&&c,d=a.name;n(this,t),this.raw=o,this.actions=s,this.log=l,this.name=d,this.id=v(),this.listeners=[],this.stateChangeLogs=[],this.actionInfos=[],this.actionInfoIndex={},this.aiLen=0,this.stateGetter=function(t){return e.getState(t)}}return i(t,[{key:"getState",value:function(t){t=p(t);for(var e=this.raw,n=0,a=t.length;null!=e&&n<a;n++)e=e[t[n]];return e}},{key:"listen",value:function(t){"function"==typeof t&&this.listeners.push(t),this.log&&f("store-listened",{store:this,listener:t})}},{key:"unlisten",value:function(t){for(var e=this.listeners.length;e--;)this.listeners[e]===t&&this.listeners.splice(e,1);this.log&&f("store-unlistened",{store:this,listener:t})}},{key:"_fire",value:function(t){for(var e=0,n=this.listeners.length;e<n;e++)this.listeners[e].call(this,t)}},{key:"addAction",value:function(t,e){if("function"==typeof e){if(this.actions[t])throw new Error("Action "+t+" exists!");this.actions[t]=e,this.log&&f("store-action-added",{store:this,action:e})}}},{key:"dispatch",value:function(t,e){return this._dispatch(t,e)}},{key:"_dispatch",value:function(t,e,n){var a=this,i=this.actions[t],o=v();if("function"==typeof i){var r,s=this._actionStart(o,t,i,e,n);if(s){if("function"==typeof s.then)return s.then((function(t){return a._actionDone(o),t}));var c=this.raw;this.raw=s[0],r=s[1],this.log&&this.stateChangeLogs.push({oldValue:c,newValue:this.raw,diff:r,id:o})}this._actionDone(o),r&&r.length>0&&this._fire(r)}}},{key:"_getActionInfo",value:function(t){var e=this.actionInfoIndex[t];if(null!=e)return this.actionInfos[e]}},{key:"_actionStart",value:function(t,e,n,a,i){var o=this,r={id:t,name:e,parentId:i,childs:[]};if(this.log&&(r.startTime=(new Date).getTime(),r.payload=a),this.actionInfos[this.aiLen]=r,this.actionInfoIndex[t]=this.aiLen++,i){var s=this._getActionInfo(i);s&&s.childs.push(t)}this.log&&f("store-dispatch",{store:this,name:e,payload:a,actionId:t,parentId:i});var c=n.call(this,a,{getState:this.stateGetter,dispatch:function(e,n){return o._dispatch(e,n,r.done?null:t)}});if(null!=c){if("function"==typeof c.buildWithDiff){var l=c.buildWithDiff()(this.raw);return l[1]=u(l[1]),this.log&&(r.updateInfo=l),l}if("function"==typeof c.then)return c}}},{key:"_actionDone",value:function(t){this._getActionInfo(t).selfDone=!0,this._detectActionDone(t)}},{key:"_detectActionDone",value:function(t){if(t){var e=this._getActionInfo(t);if(e){if(!e.selfDone)return!1;for(var n=0;n<e.childs.length;n++)if(!this._getActionInfo(e.childs[n]).done)return!1;if(e.done=!0,this.log&&(e.endTime=(new Date).getTime(),f("store-dispatched",{store:this,diff:e.updateInfo?e.updateInfo[1]:null,name:e.name,payload:e.payload,actionId:e.id,parentId:e.parentId})),e.parentId)this._detectActionDone(e.parentId);else if(!this.log){for(var a=this.actionInfos.length;a--;)if(!this.actionInfos[a].done)return;this.actionInfos=[],this.aiLen=0,this.actionInfoIndex={}}return!0}}}}]),t}(),b=new y({name:"__default__"});function w(t,e,n,a){var i=n.stateName;if(i){for(var r=i.length,s=a,c=0;c<r;){var l=i[c];if(!s[l]){s.__selfDiff__||(s=null);break}c++,s=s[l]}if(0!==c&&s){var d=s.__diffs__;if(d)for(var u=0;u<d.length;u++){var p=d[u],h=p.target,f=n.dataName,g=n.stateName;h.length>r&&(f+="."+h.slice(r).join("."),g=h),h.length>=r&&p.splice?t.data.splice(f,kt(p.splice.insertions,Array)?[p.splice.index,p.splice.deleteCount].concat(o(p.splice.insertions)):[p.splice.index,p.splice.deleteCount]):t.data.set(f,e.getState(g))}}}}function _(t){for(var e={},n=0,a=t.length;n<a;n++){for(var i=t[n].target,o=e,r=[],s=0;s<i.length;s++){var c=i[s],l=o[c];if(!l){l={__diffs__:[]},o[c]=l;for(var d=0;d<s;d++){var u=r[d].__offsprings__;u||(u=r[d].__offsprings__=[]),u.push(l)}}o=l,r[s]=l}o.__selfDiff__=!0}for(var p=0,h=t.length;p<h;p++){for(var f=t[p],g=f.target,m=e,v=0;v<g.length;v++)(m=m[g[v]]).__diffs__.push(f);var y=m.__offsprings__;if(y)for(var b=0;b<y.length;b++)y[b].__diffs__.push(f)}return e}f("store-default-inited",{store:b});try{g=new Function("RawClass","return class extends RawClass {}")}catch(t){}function k(t){var e=function(){};e.prototype=t.prototype;var n=function(e){return t.call(this,e)||this};return n.prototype=new e,n.prototype.constructor=n,e.prototype.hasOwnProperty("aPack")&&(n.prototype.aPack=e.prototype.aPack),n}function S(t){var e;return(e=0===t.toString().indexOf("class")?g(t):k(t)).template=t.template,e.components=t.components,e.trimWhitespace=t.trimWhitespace,e.delimiters=t.delimiters,e.autoFillStyleAndId=t.autoFillStyleAndId,e.filters=t.filters,e.computed=t.computed,e.aPack=t.aPack,e.messages=t.messages,e}function x(t,n,a){var i=[];function o(t,n,a){kt(t,y)||(a=n,n=t,t=b);for(var o=[],r=0,s=Object.keys(n),c=0;c<s.length;c++){var l=s[c],d=n[l],u={dataName:l};switch(e(d)){case"string":u.stateName=p(d);break;case"function":u.getter=d;break;default:u=null}u&&(o.push(u),r++)}i.push({mapStates:n,mapStateInfos:o,mapStateCount:r,mapActions:a,store:t}),t.log&&f("store-connected",{mapStates:n,mapActions:a,store:t})}function r(t){var e,n,o;"function"==typeof t?(n=S(t),e=t.prototype,o=n.prototype):(e=t||{},n=Object.assign({},t),o=n);var r=e.inited,s=e.disposed;if(o.inited=function(){var t=this;this.__storeListeners=this.__storeListeners||[];for(var e=function(e){for(var n=i[e],o=n.mapStates,r=n.mapStateCount,s=n.mapStateInfos,c=n.store,l=0;l<r;l++){var d=s[l];"function"==typeof d.getter?t.data.set(d.dataName,d.getter(c.getState(),t)):t.data.set(d.dataName,c.getState(d.stateName))}var u=function(e){for(var n=_(e),a=0;a<r;a++){var i=s[a];"function"==typeof i.getter?t.data.set(i.dataName,i.getter(c.getState(),t)):w(t,c,i,n)}};c.listen(u),t.__storeListeners.push(u),c.log&&f("store-comp-inited",{mapStates:o,mapActions:a,store:c,component:t})},n=0;n<i.length;n++)e(n);"function"==typeof r&&r.call(this)},o.disposed=function(){for(var t=0;t<i.length;t++){var e=i[t],n=e.mapStates,a=e.mapActions,o=e.store;o.unlisten(this.__storeListeners[t]),o.log&&f("store-comp-disposed",{mapStates:n,mapActions:a,store:o,component:this})}"function"==typeof s&&s.call(this)},!o.actions){o.actions={};for(var c=function(t){var e=i[t],n=e.mapActions,a=e.store;if(!n)return"continue";if(kt(n,Array))for(var r=function(t){var e=n[t];o.actions[e]=function(t){return a.dispatch(e,t)}},s=0;s<n.length;s++)r(s);else for(var c=Object.keys(n),l=function(t){var e=c[t],i=n[e];o.actions[e]=function(t){return a.dispatch(i,t)}},d=0;d<c.length;d++)l(d)},l=0;l<i.length;l++)c(l)}return n}return o(t,n,a),r.connect=function(t,e,n){return o(t,e,n),r},r}x.createConnector=function(t){if(kt(t,y))return function(e,n){return x(t,e,n)};throw new Error(t+" must be an instance of Store!")},x.san=function(t,e,n){return x(t,e,n)};var I="2.2.8";t.Store=y,t.connect=x,t.store=b,t.version=I,Object.defineProperty(t,"__esModule",{value:!0})}(wt);var St=_t.exports,xt={exports:{}};function It(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":e._typeof(t)}!function(t,e){n.commonjsGlobal,function(t){var e=function(t){var e={};for(var n in t)e[n]=t[n];return e},n=function(t,e){for(var n=0;n<t.length;n++){var a=t[n];if(e(a))return a}},a=function(t){if(!t)return!1;for(var e in t)if(t.hasOwnProperty(e))return!0;return!1},i=function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},o=function(t,e,n){return{$change:t,oldValue:e,newValue:n}},r=function(t,e,n,a,i){return{$change:"change",oldValue:t,newValue:e,splice:{index:n,deleteCount:a,insertions:i}}},s="function"==typeof Symbol&&"symbol"==It(Symbol.iterator)?function(t){return void 0===t?"undefined":It(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":It(t)},c=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},l=function(){function t(t,e){var n=[],a=!0,i=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(a=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);a=!0);}catch(t){i=!0,o=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(t){return Array.isArray(t)?t:Array.from(t)},u=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},p={},h={$set:function(t,e,n){var a=t[e];return n===a?[n,null]:[n,o(t.hasOwnProperty(e)?"change":"add",a,n)]},$push:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $push command on non array object is forbidden.");var i=a.concat([n]);return[i,r(a,i,a.length,0,[n])]},$unshift:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $unshift command on non array object is forbidden.");var i=[n].concat(a);return[i,r(a,i,0,0,[n])]},$pop:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $pop command on non array object is forbidden.");if(a.length&&(!0===n||"function"==typeof n&&n(a))){var i=a.slice(0,-1);return[i,r(a,i,a.length,1,[])]}return[a,null]},$shift:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $shift command on non array object is forbidden.");if(a.length&&(!0===n||"function"==typeof n&&n(a))){var i=a.slice(1);return[i,r(a,i,a.length,1,[])]}return[a,null]},$removeAt:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $removeAt command on non array object is forbidden.");if(n>=a.length||n<0)return[a,null];var i=a.slice(0,n).concat(a.slice(n+1));return[i,r(a,i,n,1,[])]},$remove:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $removeAt command on non array object is forbidden.");var o=i(a,n);if(-1===o)return[a,null];var s=a.slice(0,o).concat(a.slice(o+1));return[s,r(a,s,o,1,[])]},$splice:function(t,e,n){var a=d(n),i=a[0],o=a[1],s=a.slice(2),c=t[e];if(!Array.isArray(c))throw new Error("Usage of $splice command on non array object is forbidden.");var l=c.slice(0,i).concat(s).concat(c.slice(i+o));return[l,r(c,l,i,o,s)]},$map:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $map command on non array object is forbidden.");var i=a.map(n);return[i,o("change",a,i)]},$filter:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $filter command on non array object is forbidden.");var i=a.filter(n);return[i,o("change",a,i)]},$reduce:function(t,e,n){var a=t[e];if(!Array.isArray(a))throw new Error("Usage of $reduce command on non array object is forbidden.");var i="function"==typeof n?a.reduce(n):a.reduce.apply(a,u(n));return[i,o("change",a,i)]},$merge:function(t,n,a){var i=t[n]||{},r=e(i),s={};for(var c in a)if(a.hasOwnProperty(c)){var l=a[c],d=i[c];if(l!==d){r[c]=l;var u=i.hasOwnProperty(c)?"change":"add";s[c]=o(u,d,l)}}return[r,s]},$defaults:function(t,n,a){var i=t[n],r=e(i),s={};for(var c in a)a.hasOwnProperty(c)&&void 0===r[c]&&(r[c]=a[c],s[c]=o("add",void 0,a[c]));return[r,s]},$apply:function(t,e,n){var a=n(t[e]);return[a,o(t.hasOwnProperty(e)?"change":"add",t[e],a)]},$omit:function(t,e,n){var a=t[e];return!0===n||"function"==typeof n&&n(a)?[p,o("remove",a,void 0)]:[a,null]},$composeBefore:function(t,e,n){var a=t[e];if("function"!=typeof a)throw new Error("Usage of $composeBefore command on non function object is forbidden.");if("function"!=typeof n)throw new Error("Passing non function object to $composeBefore command is forbidden");var i=function(){return a(n.apply(void 0,Array.from(arguments)))};return[i,o("change",a,i)]},$composeAfter:function(t,e,n){var a=t[e];if("function"!=typeof a)throw new Error("Usage of $composeAfter command on non function object is forbidden.");if("function"!=typeof n)throw new Error("Passing non function object to $composeAfter command is forbidden");var i=function(){return n(a.apply(void 0,Array.from(arguments)))};return[i,o("change",a,i)]}},f=Object.keys(h),g=f.map((function(t){return t.slice(1)})),m=function t(e,i){var o=n(f,(function(t){return i.hasOwnProperty(t)}));if(o){var r={source:e},s=i[o];return h[o](r,"source",s)}var c=function(a){var o=i[a],r=n(f,(function(t){return o.hasOwnProperty(t)}));return r?h[r](e,a,o[r]):t(e[a]||{},o)},d=function(t,e){for(var n in i)if(!t.hasOwnProperty(n)&&i.hasOwnProperty(n)){var a=c(n),o=l(a,2),r=o[0],s=o[1];e[n]=s,r!==p&&(t[n]=r)}return[t,e]};if(Array.isArray(e)){for(var u=[],g={},m=0;m<e.length;m++)if(i.hasOwnProperty(m)){var v=c(m),y=l(v,2),b=y[0],w=y[1];a(w)&&(g[m]=w),b!==p&&u.push(b)}else u.push(e[m]);return d(u,g)}var _={},k={};for(var S in e)if(i.hasOwnProperty(S)){var x=c(S),I=l(x,2);b=I[0],w=I[1],a(w)&&(k[S]=w),b!==p&&(_[S]=b)}else _[S]=e[S];return d(_,k)},v=function(t,e){return m(t,e)[0]},y="[".charCodeAt(0),b=function(t){if(Array.isArray(t))return t;for(var e=(t+"").split("."),n=[],a=0;a<e.length;a++){var i=e[a],o=i.indexOf("[");if(o>=0)for(o>0&&(n.push(i.slice(0,o)),i=i.slice(o));i.charCodeAt(0)===y;){var r=i.indexOf("]");if(r<0)throw new Error("Property path syntax error: "+t);var s=i.slice(1,r);if(/^[0-9]+$/.test(s))n.push(+s);else{if(!/^(['"])([^\1]+)\1$/.test(s))throw new Error("Property path syntax error: "+t);n.push(new Function("return "+s)())}i=i.slice(r+1)}else n.push(i)}return n},w=function(t,e){if(null==t)return e;for(var n=b(t),a={},i=a,o=0;o<n.length-1;o++)i=i[n[o]]={};return i[n[n.length-1]]=e,a},_=function(t,e,n){return v(t,w(e,{$set:n}))},k=function(t,e,n){return v(t,w(e,{$push:n}))},S=function(t,e,n){return v(t,w(e,{$unshift:n}))},x=function(t,e,n){return v(t,w(e,{$pop:n}))},I=function(t,e,n){return v(t,w(e,{$shift:n}))},T=function(t,e,n){return v(t,w(e,{$removeAt:n}))},C=function(t,e,n){return v(t,w(e,{$remove:n}))},L=function(t,e,n,a){for(var i=Array.from(arguments).length,o=Array(i>4?i-4:0),r=4;r<i;r++)o[r-4]=Array.from(arguments)[r];var s=[n,a].concat(o);return v(t,w(e,{$splice:s}))},P=function(t,e,n){return v(t,w(e,{$map:n}))},D=function(t,e,n){return v(t,w(e,{$filter:n}))},A=function(t,e){for(var n=Array.from(arguments).length,a=Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=Array.from(arguments)[i];var o=1===a.length?{$reduce:a[0]}:{$reduce:a};return v(t,w(e,o))},E=function(t,e,n){return v(t,w(e,{$merge:n}))},O=function(t,e,n){return v(t,w(e,{$defaults:n}))},R=function(t,e,n){return v(t,w(e,{$apply:n}))},N=function(t,e){return v(t,w(e,{$omit:!(Array.from(arguments).length>2&&void 0!==Array.from(arguments)[2])||Array.from(arguments)[2]}))},q=function(t,e,n){return v(t,w(e,{$composeBefore:n}))},M=function(t,e,n){return v(t,w(e,{$composeAfter:n}))},j=function(t,e,n,a){if(Array.isArray(n)){var i=function(){var i=n.map((function(e){return e(t)})),o=function(t){return a.apply(void 0,u(i).concat([t]))};return{v:R(t,e,o)}}();if("object"===(void 0===i?"undefined":s(i)))return i.v}var o=n(t),r=function(t){return a(o,t)};return R(t,e,r)},B={},H=function t(e,n){return g.reduce((function(a,i){return a[i]=function(a){for(var o=Array.from(arguments).length,r=Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=Array.from(arguments)[s];var l=c({},"$"+i,1===r.length?r[0]:r),d=E(n,a,l);return t(e,d)},a}),{value:function(){return v(e,n)},withDiff:function(){return m(e,n)}})},$=function(t){return H(t,B)},U=function t(e){return g.reduce((function(n,a){return n[a]=function(n){for(var i=Array.from(arguments).length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=Array.from(arguments)[r];var s=c({},"$"+a,1===o.length?o[0]:o),l=E(e,n,s);return t(l)},n}),{build:function(){var t=function(t){return v(t,e)};return t.withDiff=function(t){return m(t,e)},t},buildWithDiff:function(){return function(t){return m(t,e)}}})},F=U({}),G=function(){return F};t.chain=$,t.immutable=$,t.macro=G,t.builder=G,t.updateBuilder=G,t.update=v,t.withDiff=m,t.set=_,t.push=k,t.unshift=S,t.pop=x,t.shift=I,t.removeAt=T,t.remove=C,t.splice=L,t.map=P,t.filter=D,t.reduce=A,t.merge=E,t.defaults=O,t.apply=R,t.omit=N,t.composeBefore=q,t.composeAfter=M,t.applyWith=j,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,xt.exports);var Tt=xt.exports;function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Lt(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function Pt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Dt(t){switch(t){case"http:":return"80";case"https:":return"443";default:return location.port}}function At(t,e,n){"function"==typeof n&&(n=n()),null===n&&(n=""),t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}function Et(t,e,n){var a=Array.isArray(e),i="[object Object]"===Object.prototype.toString.call(e);for(var o in e)if(e.hasOwnProperty(o)){var r=e[o],s="object"===(void 0===r?"undefined":Lt(r))&&null!==r,c=n?n+"["+(i||s?o:"")+"]":o;!n&&a?At(t,r.name,r.value):s?Et(t,r,c):At(t,c,r)}}function Ot(t){if(void 0===t&&(t={}),!t)return"";var e="";for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];null==a?a="":"object"===(void 0===a?"undefined":Lt(a))&&(a=JSON.stringify(a)),e+="&"+encodeURIComponent(n)+"="+encodeURIComponent(a)}return e.slice(1)}function Rt(t){var e={};return t.forEach((function(t,n){e[n]=t})),e}function Nt(t,e){if(!t||!e)return"";var n=t.includes("?")?"&":"?";return""+t+n+e}function qt(t,e){var n=Object.entries(e).map((function(t){var e=t[0],n=t[1];return encodeURIComponent(e)+"="+encodeURIComponent(n)})).join("&"),a=t.includes("?")?"&":"?";return""+t+a+n}var Mt={params:function(t){var e=[];return Et(e,t),e.join("&").replace(/%20/g,"+")},parse:function(t){var e=document.createElement("a");e.href=t;var n=e.pathname.startsWith("/")?e.pathname:"/"+e.pathname;if(t.startsWith("baiduboxapp")){var a=t.indexOf(":"),i=t.indexOf("?");n=t.slice(a+1,-1===i?t.length:i)}return{href:e.href,host:e.host||location.host,port:"0"===e.port||""===e.port?Dt(e.protocol):e.port,hash:e.hash,hostname:e.hostname||location.hostname,pathname:n,protocol:e.protocol&&":"!==e.protocol?e.protocol:location.protocol,search:e.search,query:Mt.qs(e.search.slice(1))}},qs:function(t){if(!t)return{};var e=decodeURIComponent;return t.split("&").reduce((function(t,n){var a=n.indexOf("="),i=e(n.slice(0,a)),o=e(n.slice(a+1));if(!i)return t;var r=t[i];return Array.isArray(r)?r.push(o):t[i]=r?[r,o]:o,t}),{})}};function jt(t){if(!t)return{};for(var e,n={},a=Pt((t.startsWith("?")?t.substring(1):t).split("&"));!(e=a()).done;){var i=e.value.split("="),o=i[0],r=i[1];o&&(n[o]=void 0!==r?r:"")}return n}var Bt,Ht="https://chat.baidu.com",$t={riskcheck:"/aichat/api/riskcheck",conversation:"/aichat/api/conversation",history:"/csaitab/history/list",delete:"/csaitab/history/delete",uploadSts:"/aichat/api/file/sts",upload:"/aichat/api/file/upload",loginConfirmation:"/aichat/api/loginConfirmation"},Ut={FETCH_TIMEOUT_ERROR:"fetch timeout",FETCH_FAIL:"Failed to fetch"},Ft='[component="askBack"]',Gt="cs-ul-mb-fill",Wt="cs-fit-answer-container",zt="#chat-container-main",Qt=".answer-box",Jt="百度AI助手",Vt=".se-page-bd",Kt=["cs_tab_cache_key","appendQuery","appendSa","extParams","extParamsJson","isLoggedIn","csaitab_slip_prefetch","clickTime","ori_word","ori_lid","agentInfo","headers","do_not_intercept","cs_ext_params"],Xt="让我们换个话题聊聊吧。";!function(t){t.REBUILD="rebuild",t.APPEND="append"}(Bt||(Bt={}));var Yt,Zt,te,ee,ne=["bkb","bks","bvoice","image"],ae=["bkb_funcguide","bkb_functab"],ie=["agent","prob_agent","greet_agent","agent_ala","capsule_agent","contact_agent","funcguide_agent"],oe=8;!function(t){t.CONVERSATION="conversation",t.SHOW_AGENT_GREETING="showAgentGreeting"}(Yt||(Yt={})),function(t){t.WRITE="ai_write",t.PAINT="ai_paint"}(Zt||(Zt={})),function(t){t.GRAPH_SEARCH="graph_search",t.CHAT_SEARCH="chat_search"}(te||(te={})),function(t){t.CHAT="3741000200000000",t.SIDEBAR="3741000110001000"}(ee||(ee={}));var re,se=["sid","uid","cuid"],ce=[".jpeg",".png",".jpg",".bmp",".webp"],le=[".pdf",".doc",".docx",".txt",".xls",".xlsx",".csv",".ppt",".pptx"],de={PDF:"https://psstatic.cdn.bcebos.com/basics/chat/pdf-valid_1734164026000.png",WORD:"https://psstatic.cdn.bcebos.com/basics/chat/word-valid_1734164041000.png",PPT:"https://psstatic.cdn.bcebos.com/basics/chat/ppt-valid_1734164053000.png",TXT:"https://psstatic.cdn.bcebos.com/basics/chat/text-valid_1735528290000.png",EXCEL:"https://psstatic.cdn.bcebos.com/basics/chat/xls-valid_1734164077000.png",unknown:""},ue={PDF:"https://psstatic.cdn.bcebos.com/basics/chat/pdf-invlid_1734164033000.png",WORD:"https://psstatic.cdn.bcebos.com/basics/chat/word-invalid_1734164047000.png",PPT:"https://psstatic.cdn.bcebos.com/basics/chat/ppt-invalid_1734164060000.png",TXT:"https://psstatic.cdn.bcebos.com/basics/chat/text-invalid_1734164071000.png",EXCEL:"https://psstatic.cdn.bcebos.com/basics/chat/xls-invalid_1734164082000.png",unknown:""};!function(t){t.LOGIN="LOGIN",t.LOGIN_SUCCESS="LOGIN_SUCCESS",t.FEEDBACK_CLOSE="FEEDBACK_CLOSE"}(re||(re={}));var pe,he="CHAT_SEARCH_USED_MODEL",fe={CHAT:{path:"/search"},HISTORY:{path:"/aichat/history"},SQUARE:{path:"/aichat/square"},AGENT:{path:"/aichat/lingjing"},DEEPSEEK:{path:"/deepseek"}};!function(t){t.SMART_MODEL_ID="smartMode",t.DEFAULT_MODEL_ID="smartMode",t.DEEP_SEEK_MODEL_ID="DeepSeek-R1"}(pe||(pe={}));var ge=new Map([["1-1","https://psstatic.cdn.bcebos.com/basics/chat/1-1_1741748805000.json"],["2-3","https://psstatic.cdn.bcebos.com/basics/chat/2-3_1741693200000.json"],["3-2","https://psstatic.cdn.bcebos.com/basics/chat/3-2_1741695732000.json"],["16-9","https://psstatic.cdn.bcebos.com/basics/chat/16-9_1741695763000.json"],["9-16","https://psstatic.cdn.bcebos.com/basics/chat/9-16_1741695745000.json"],["3-4","https://psstatic.cdn.bcebos.com/basics/chat/3-4_1741748830000.json"],["4-3","https://psstatic.cdn.bcebos.com/basics/chat/4-3_1741748848000.json"]]),me="名额已满",ve=function(t){return Object.prototype.toString.call(t)};function ye(t){return"[object Object]"===ve(t)}function be(t){return"[object Array]"===ve(t)}function we(t){return"[object String]"===ve(t)}function _e(){return _e=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},_e.apply(this,Array.from(arguments))}var ke,Se,xe,Ie="askBack",Te="questionCloselyShort",Ce=new Set(["sa","apagelid","re_rank","ori_lid","sge_lid","sid","setype","pd","word","fqid","suv","cv","scv","insc","async_flag","pn","foot_ec","mod","cstabpage","chat_token","agent_id","agent_p","aitab_ct","actiontype","agt_rk","agt_sess_cnt","csextdata","a_srcid","a_tplname","a_order","blockCmpt"]),Le=[Ie,Te];function Pe(t){void 0===t&&(t={});var e="";window.page&&window.page.amd&&window.page.amd.version&&(e=window.page.amd.version.searchUi);var n=window.page.comm.lid;Object.assign(t,{fqid:n,suv:e,insc:1,async_flag:1,foot_ec:"0_0",pn:0});var a={};return Object.keys(t).forEach((function(e){var n=t[e];Ce.has(e)&&null!=n&&""!==n&&(a[e]=n)})),a}function De(t){var e={};return Object.keys(t).forEach((function(n){var a=t[n];void 0!==a&&(e[n]=a)})),e}function Ae(t){return t?t.inputCustom&&!be(t.inputCustom)||t.word&&!we(t.word)?null:t:null}function Ee(t){return t&&we(t.type)&&we(t.triggerType)?t:null}function Oe(t){var e=t.searchParams,n=t.eventParams,a=t.user,i=e||n,o=i.extParamsJson||i.extParams||i.cs_ext_params||{},r=i.headers||{},s=i.word,c=i.query,l=i.conversationLogId,d=i.isLoggedIn,u=i.urlParams,p=i.isShowHello,h=i.enterType,f=i.preQuery,g=i.tabName,m=i.pageType,v=i.interactionType,y=i.bottomBarHeight,b=i.topBarHeight,w=localStorage.getItem(he)||"{}",_=c||s;try{o=(o="string"==typeof o?JSON.parse(n?decodeURIComponent(o):o):o).extParams&&"string"==typeof o.extParams?JSON.parse(o.extParams):o,r="string"==typeof r?JSON.parse(n?decodeURIComponent(r):r):r}catch(t){console.error(t),"string"==typeof o&&(o="string"==typeof o&&jt(decodeURIComponent(o)))}var k=i.extParamsJson,S=i.extParams;if(k&&S)try{k="string"==typeof k?JSON.parse(k?decodeURIComponent(k):k):o,S="string"==typeof S?JSON.parse(S?decodeURIComponent(S):S):S,o=Object.assign(k,S)}catch(t){}var x=i.agentInfo||o.agentInfo||{},I=i.triggerType||o.triggerType||Yt.CONVERSATION;try{x="string"==typeof x?JSON.parse(decodeURIComponent(x)):x}catch(t){console.error(t)}var T=o.invokeChatExt;if(T)try{var C="string"==typeof T?JSON.parse(T):T;x.agentParams?x.agentParams=_e({},x.agentParams,C):x.agentParams=C}catch(t){console.error("解析参数发生错误:",t)}x=function(t){var e=null==t?void 0:t.agentId;return(null==t?void 0:t.jumpUrl)||(null==t?void 0:t.jump_url)||!e||(t=_e({},t,{jumpUrl:{zbios:"baiduboxapp://swan/"+e+"?_baiduboxapp=%7B%22lingjing_type%22%3A"}})),t}(x);var L=o.sge_lid,P=o.apagelid,D=o.aPageWord,A=o.sa,E=o.ori_lid,O=o.ori_word,R=o.askType,N=o.aitab_ct,q=o.actiontype,M=o.csextdata,j=o.shareId,B=o.enter_type,H=o.tplname,$=o.srcid,U=o.order,F=o.helloKey,G=o.helloAgentID,W=o.helloQuery,z=o.open_left_agent,Q=o.queryPrefix,J=o.messageReadStyle,V=o.upperSearchbox,K=o.openInputPanel,X=o.localSelectedId,Y=o.localFullFeature,Z=o.landingPageSwitch,tt=o.selectedId,et=o.internetSearch,nt=o.fullFeature,at=o.modelList,it=o.isShowHello,ot=o.subEnterType,st=o.searchBoxPanel,lt={sgeLid:L,query:O||_,agentInfo:x||{},conversationLogId:l,clientHeaders:r,apagelid:P,aPageWord:D,iosSlipPrefetchEnable:i.csaitab_slip_prefetch,setype:i.setype,sid:i.sid,sa:A||i.sa,agentSa:i.agentSa,appUrlParams:u,user:a,askType:R,connectPreQuery:f||Q||(Le.includes(R)&&O&&O!==_?_:""),aitab_ct:N,actiontype:q,triggerType:I,isShowHello:+it||+p||(O||_?0:1),tabName:g,shareId:j,csextdata:M,enterType:h||B,pcEnterType:B,tplname:H,srcid:$,order:U,openLeftAgent:z,pageType:m,messageReadStyle:J,upperSearchbox:Ae(V),openInputPanel:Ee(K),interactionType:v,clickTime:i.clickTime,searchBoxPanel:st,topBarHeight:b,bottomBarHeight:y};if((lt.isShowHello&&"wise"===rt()||"message"===h)&&(lt.isShowHello=1,J&&"0"!==J&&!Number.isNaN(+J)&&(lt.initShowHistory=!0)),lt.query&&i.clickTime&&(lt.naInjectTime=+new Date-i.clickTime),E&&(lt.oriLid=E),ot&&(lt.subEnterType=ot),void 0!==d&&(a.isUserLogin=!!+(d||0),lt.user=a),e&&e.chatsearch_action_id&&(lt.chatSearchAcitonId=e.chatsearch_action_id),g&&(lt.pcEnterType="find_agent"),p&&F&&(lt.helloInfo={helloKey:F,helloAgentID:G,helloQuery:W}),(X||tt)&&(lt.initModelInfo={localSelectedId:X,localFullFeature:Y,landingPageSwitch:Z,fullFeature:"string"==typeof nt?"true"===nt:nt,selectedId:tt,modelList:at,internetSearch:et}),(null==w?void 0:w.length)>0&&"pc"===rt()||ct()){if(ct())try{lt.usedModel=JSON.parse(localStorage.getItem(he))||{modelName:"DeepSeek-R1"}}catch(t){lt.usedModel={modelName:"DeepSeek-R1"}}else lt.usedModel=JSON.parse(w);localStorage.setItem(he,JSON.stringify(lt.usedModel))}return De(lt)}function Re(t){var e=null,n=document.querySelectorAll(t);try{n.forEach((function(t){t.innerHTML&&(e=Object.assign({},e,JSON.parse(t.innerHTML)))}))}catch(t){}return e}function Ne(){return Ne=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ne.apply(this,Array.from(arguments))}!function(t){t.OPEN="1",t.CLOSE="0"}(ke||(ke={})),function(t){t.OPEN="1",t.CLOSE="0"}(Se||(Se={})),function(t){t[t.LOGIN=1]="LOGIN",t[t.LOGOUT=0]="LOGOUT"}(xe||(xe={}));var qe,Me=function(t){return!t||!Object.keys(t).length},je=new function(){var t=this;this.guideTip="百度AI推出全新智能模式，快来试试吧",this.defaultModel={modelName:"smartMode",modelFunction:{internetSearch:ke.CLOSE}},this.isModelAvailable=function(t){var e;return null==(e=t.modelAvailable)||e},this.isLogin=function(){return!!t.userInfo&&t.userInfo.isUserLogin===xe.LOGIN},this.handlePCModel=function(e,n){var a=JSON.parse(localStorage.getItem(he));if(Me(a)||!t.isLogin()){var i=e.find((function(t){return t.modelName===n}));if(i&&t.isModelAvailable(i))return t.setUsedModel(i)}else{var o=e.find((function(t){return t.modelName===a.modelName}));if(o&&t.isModelAvailable(o)){var r;if(!a.modelFunction)a.modelFunction=null!=(r=o.modelFunction)?r:{internetSearch:ke.OPEN};var s={modelName:o.modelName,modelFunction:Ne({},a.modelFunction)};return t.setUsedModel(s)}}return t.setUsedModel(t.transformModel(e[0]))},this.transformModel=function(e){return e?{modelName:e.modelName,modelFunction:e.modelFunction}:t.defaultModel},this.handleUsableModel=function(e){var n=e.usableModel,a=void 0===n?[]:n,i=e.defaultModel,o=void 0===i?"DeepSeek-R1":i,r=e.fusionEnhanceTips,s=e.userInfo;return t.userInfo=s,r&&(t.guideTip=r),{usedModel:t.handlePCModel(a,o),usableModel:a}},this.showToast=function(t){t.forEach((function(t){t.modelToast&&e.Toast.show({message:t.modelToast})}))},this.setUsedModel=function(e){if(Me(e))return t.defaultModel;var n=e;return n=function(t){return void 0===t.modelTitle}(e)?e:t.transformModel(e),"pc"===rt()&&localStorage.setItem(he,JSON.stringify(n)),n},this.setUsableModel=function(t){return t.map((function(t){var e;return Ne({},t,{modelAvailable:null==(e=t.modelAvailable)||e})}))},this.init=function(e){var n=t.handleUsableModel(e),a=n.usableModel,i=void 0===a?[]:a,o=n.usedModel,r=t.setUsableModel(i),s=t.setUsedModel(o);return t.showToast(r),{usableModel:r,usedModel:s}}};function Be(){return Be=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Be.apply(this,Array.from(arguments))}!function(t){t.DeepSeek="DeepSeek",t.DeepSeek_R1="DeepSeek-R1",t.ERINE="ERINE",t.ERINE_4_5="ERINE-4.5",t.ERINE_X1="ERINE-X1",t.SMART_MODE="smartMode"}(qe||(qe={}));var He=new function(){var t=this;this.guideShowData=null,this.newModelTip="",this.ModelTipMap={TIPS_SHOW_TEXT_KEY:"chat-search-model-tip-show",GUIDE_SHOW_KEY:"chat-search-model-guide-show"},this.handleModelUi=function(e,n,a){return void 0===a&&(a=!1),e.map((function(e){var i,o,r=e.id,s=(null==(i=e.modelFunction)?void 0:i.internetSearch)||ke.CLOSE,c=(null==(o=e.modelFunction)?void 0:o.deepThink)||Se.OPEN;return a&&(s=r.includes(qe.DeepSeek)?t.getInternetStatus(s)?ke.OPEN:ke.CLOSE:ke.OPEN,c=r.includes(qe.DeepSeek)&&t.getDeepThinkStatus(c)?Se.OPEN:Se.CLOSE),Be({},e,{checked:r===n,isShowFuncBtn:r.includes(qe.DeepSeek),isShowCapsule:r===qe.SMART_MODE,modelFunction:{internetSearch:s,deepThink:c}})}))},this.handleModelData=function(e,n,a){void 0===n&&(n=[]),void 0===a&&(a=!1);var i={},o=[].concat(n),r=(null==e?void 0:e.landingPageSwitch)||"";if(void 0!==(null==e?void 0:e.internetSearch)&&t.setInternetStatus((null==e?void 0:e.internetSearch)||"0"),Array.isArray(o)&&o.length>0){(null==e?void 0:e.selectedId)===qe.DeepSeek_R1&&o.some((function(t){return t.id!==qe.DeepSeek_R1}))&&o.some((function(t){return t.id===qe.DeepSeek}))&&(e.selectedId="DeepSeek");var s=(null==e?void 0:e.selectedId)||(null==e?void 0:e.localSelectedId);if(!a||s){s="undefined"!==s&&s?s:pe.DEFAULT_MODEL_ID,o.some((function(t){return t.id===s&&(t.enable||t.hasPermission)}))||(s=pe.DEFAULT_MODEL_ID),o.some((function(t){return t.id===s}))||(s=o[0].id);var c=(o=t.handleModelUi(o,s,!0)).find((function(t){return t.id===s}));i={modelName:null==c?void 0:c.id,modelFunction:null==c?void 0:c.modelFunction}}}var l={};return 0!==o.length&&Object.assign(l,{modelList:o}),r&&Object.assign(l,{landingPageSwitch:r}),i.modelName&&Object.assign(l,{usedModel:i}),l},this.getInternetStatus=function(t){var e=localStorage.getItem(he)||"{}",n=!1;try{var a,i=JSON.parse(e);if((null==i?void 0:i.modelName)===qe.DeepSeek)n="1"===(null==i||null==(a=i.modelFunction)?void 0:a.internetSearch);else n="1"===t}catch(t){}return n},this.getDeepThinkStatus=function(t){var e=localStorage.getItem(he)||"{}",n=!0;try{var a,i=JSON.parse(e);if((null==i?void 0:i.modelName)===qe.DeepSeek)n="1"===(null==i||null==(a=i.modelFunction)?void 0:a.deepThink);else n="1"===t}catch(t){}return n},this.setInternetStatus=function(t){var e=localStorage.getItem(he)||"{}",n={modelFunction:{}};try{n=JSON.parse(e)}catch(t){return}n.modelFunction||(n.modelFunction={}),n.modelFunction.internetSearch=t,localStorage.setItem(he,JSON.stringify(n))},this.setLocalModelData=function(t){localStorage.setItem(he,JSON.stringify(t))},this.init=function(e,n,a){return void 0===n&&(n=[]),void 0===a&&(a=!1),t.handleModelData(e,n,a)},this.getModelTip=function(){var e=localStorage.getItem(t.ModelTipMap.TIPS_SHOW_TEXT_KEY);return(t.guideShowData||{}).isShowGuide&&e!==t.newModelTip?(localStorage.setItem(t.ModelTipMap.TIPS_SHOW_TEXT_KEY,t.newModelTip),t.newModelTip):""},this.setGuideShowData=function(e){t.guideShowData=e},this.setNewModelTip=function(e){t.newModelTip=e},this.getNewModelTip=function(){return t.newModelTip},this.getGuideShowData=function(e){var n=t.ModelTipMap.GUIDE_SHOW_KEY+"-"+e,a=localStorage.getItem(n),i=t.guideShowData||{},o=i.isShowGuide,r=i.modelGuideList;if(a||!o)return null;var s=null==r?void 0:r.find((function(t){return t.modelId===e}));return s&&localStorage.setItem(n,"1"),s}};function $e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Ue(){return Ue=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ue.apply(this,Array.from(arguments))}function Fe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ge(t,e){if(t&&e)return t.variables&&t.variables[e]}function We(t,e,n){var a=Ge(t,e);return!!a&&a===n}function ze(){var t,e,n=new URL(location.href).search,a=Re('script[name="aiTabFrameBaseData"]')||{},i=Rt(new URL(location.href).searchParams),o=Oe({searchParams:i,user:Object.assign(a.user||{},a.userInfo||{})}),r="pc"!==rt()&&(window.location.pathname===fe.CHAT.path||ct()||We(a.sample,"WISE_NEW_CSAITAB","1")),s="pc"!==rt()&&Ge(a.sample,"SINGLE_LINE_OVERVIEW");if(ft()){var c="https://chat.baidu.com";Object.assign(a,{user:{},chatParams:{sse_host:c,sse_ws_host:c,setype:"csaitab"},urlInfo:{guideWordsUrl:c+"/aichat/api/aitabserver?ctl=guidewords"}})}return{syncSearchParams:n,guideWord:"",agentList:[],firstRankQuery:o.query,chatSearchAcitonId:o.chatSearchAcitonId||"",oriLid:o.oriLid||"",apagelid:o.apagelid||"",aPageWord:o.aPageWord||"",sgeLid:o.sgeLid||"",askType:o.askType||"",connectPreQuery:o.connectPreQuery||"",searchframeLid:r||"pc"===rt()?a.lid||Date.now():null==a||null==(t=a.searchframeParams)?void 0:t.lid,chatSearch:a.chatSearch,chatParams:a.chatParams||{},preChatParms:{},sa:o.sa||"",oriSa:o.sa||"",pn:0,isShowHello:+o.isShowHello||0,helloInfo:o.helloInfo||{},isHistoryLoading:!1,enterType:o.enterType||"",pcEnterType:o.pcEnterType||"",initShowHistory:o.initShowHistory||!1,triggerType:o.triggerType||Yt.CONVERSATION,appUrlParams:{},shareId:o.shareId||"",lid:"",rank:0,topRank:1,query:o.query||"",qaPairIdDiff:0,agentInfo:o.agentInfo||{},agentRank:0,agentSessionCount:0,agentSa:"bkb_agent",preQuery:"",showScrollToBottomBtn:!1,naInjectTime:o.naInjectTime,iosSlipPrefetchEnable:o.iosSlipPrefetchEnable,startTimeList:o.startTimeList,aitab_ct:o.aitab_ct,actiontype:o.actiontype,imageQuery:{},imageQueryLid:{},token:a.token||(null==(e=a.searchframeParams)?void 0:e.token)||"",pcClickInfo:{},searchParams:i,csextdata:o.csextdata,prefetchUrl:[],tplname:o.tplname||"",srcid:o.srcid||"",order:o.order||"",upperSearchbox:o.upperSearchbox,openInputPanel:o.openInputPanel,hideTopAgentList:!1,chatStatus:"",generateStatus:"",curRankInfo:{rank:0},subEnterType:o.subEnterType||"",subSession:{entrance:o.subEnterType||"",oriLid:"",reRank:0},blockCmptList:{},truncQueryIndexRange:[],phoneParams:a.phoneParams||{},syncTabData:!1,pulldownDisabled:!1,pageType:o.pageType||"",firstRankHideQuery:!1,showMindMap:!1,showWorkspaceType:"",workspaceData:{wenku:{outlineLid:"",outlineQid:"",pptId:""}},pptRanks:[],withoutStopSseRanks:[],messageReadStyle:o.messageReadStyle,urlInfo:a.urlInfo,singleOverviewType:s||"",pluginPromptType:0,chatPageInitialized:!1,searchBoxPanel:o.searchBoxPanel||"",topBarHeight:o.topBarHeight||"",bottomBarHeight:o.bottomBarHeight||""}}function Qe(){var t="";window.page&&window.page.amd&&window.page.amd.version&&(t=window.page.amd.version.searchUi);var e=Re('script[name="aiTabFrameBaseData"]')||{},n=Oe({searchParams:Rt(new URL(location.href).searchParams),user:Object.assign(e.user||{},e.userInfo||{})}),a=function(t,e,n){if("wise"===rt()){var a=He.init;return(0,He.setNewModelTip)(n),a(t,e)}return{}}(n.initModelInfo,e.modelList||[],e.bottomModelGuide),i=function(t){if("pc"===rt()){var e=(0,je.init)(t),n=e.usableModel;return{usedModel:e.usedModel,usableModel:n}}return{usedModel:{},usableModel:[]}}(e),o=i.usedModel,r=i.usableModel,s="pc"!==rt()&&(window.location.pathname===fe.CHAT.path||We(e.sample,"WISE_NEW_CSAITAB","1"));return!s&&function(t){if("pc"!==rt()){var e=new window.URL(window.location.href),n=new URLSearchParams(e.search);t.forEach((function(t){return n.delete(t)}));var a=e.origin+e.pathname+"?"+n.toString();window.history.replaceState({},document.title,a)}}(Kt),{user:n.user||{},sample:e.sample,isWiseNewCsaitab:s,tabData:{lid:e.lid,data:e.tabList,showTabCount:e.showTabCount,showTagCount:e.showTagCount||4,hasSearchTag:e.hasSearchTag||!1,logUrl:"https://m.baidu.com/tc?",logParams:e.logParams||{}},sid:n.sid,tabName:n.tabName||"",tabList:e.tabList,cosmicVersion:e.cosmicVersion,scVersion:e.scVersion,searchUiVersion:t||"",openLeftAgent:n.openLeftAgent||0,queryIndustry:"",queryIntent:"",urlInfo:e.urlInfo,clientHeaders:n.clientHeaders||{},conversationLogId:n.conversationLogId,usedModel:ct()?{modelName:"DeepSeek-R1"}:a.usedModel||o,usableModel:r,modelList:a.modelList||[],landingPageSwitch:a.landingPageSwitch||""}}var Je=new St.Store({initData:Ue({},ze(),Qe()),actions:{update:function(t){for(var e,n=Tt.builder(),a=Fe(Object.keys(t));!(e=a()).done;){var i=e.value;n=n.set(i,t[i])}return n},resetChatPageStore:function(){for(var t,e=ze(),n=Tt.builder(),a=Fe(Object.keys(e));!(t=a()).done;){var i=t.value;n=void 0===e[i]?n.omit(i):n.set(i,e[i])}return n}}});function Ve(){return Ve=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ve.apply(this,Array.from(arguments))}var Ke="19_103",Xe="ai_tab",Ye=ft();function Ze(t){try{var e,n;if(Ye)t.info&&(t.info.is_plugin=1);else if(null==(e=t.info)?void 0:e.file){var a,i;return!(null==(i=t.info)||null==(a=i.file)?void 0:a.startsWith("chrome-extension://"))}return(null==(n=t.info)?void 0:n.msg)&&/talosGlobalFuncName\d{10,}/.test(t.info.msg)&&t.info.msg.replace(/talosGlobalFuncName\d{10,}/,"talosGlobalFuncName${timestamp}"),!0}catch(t){return!0}}var tn=new X({pid:Ke,lid:"",sample:1});function en(t,e){var n=e.group;tn.sendExceptForError(t,{group:n})}function nn(t){!Je.getState("isDev")&&t&&tn.sendPerf({group:"guide",info:{requestTime:t}})}tt.init({pid:Ke,lid:"",resourceError:{group:Xe+"_resource",sample:1,handler:function(t){return Ze(t)}},jsError:{group:Xe+"_js_error",sample:1,handler:function(t){return Ze(t)}},whiteScreenError:{selector:"body",subSelector:"#conversation-flow-container",sample:0,timeout:6e3,group:Xe+"_white_screen",handler:function(t){return Ze(t)}}}),window.addEventListener("unhandledrejection",(function(t){var e=t.reason||{};tn.sendExcept({group:Xe+"_js_error",info:{msg:"string"==typeof e?e:e.message,stack:(e.stack||"").split("\n").slice(0,5).join("\n")}})}));var an={exports:{}};!function(t){n.commonjsGlobal,t.exports=function(){var t=function(e,n){var a,i;return t=Object.setPrototypeOf||(a={__proto__:[]},(null!=(i=Array)&&"undefined"!=typeof Symbol&&i[Symbol.hasInstance]?!!i[Symbol.hasInstance](a):a instanceof i)&&function(t,e){t.__proto__=e})||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};function e(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}var n=function(){function t(t,e){this.data=t,this.weight=e}return t.prototype.preOrder=function(t){t.push(this),this.left&&this.left.preOrder(t),this.right&&this.right.preOrder(t)},t}();function a(t){for(var e=[],a={},i=0,o=t;i<o.length;i++){var r=o[i];null==a[r]?a[r]=1:a[r]++}for(var s=0,c=Object.entries(a);s<c.length;s++){var l=c[s],d=l[0],u=l[1];e.push(new n(d,u))}return e}function i(t){for(var e=function(t,e){return t.weight-e.weight};t.length>1;){t.sort(e);var a=t.shift(),i=t.shift();if(a&&i){var o=new n(null,a.weight+i.weight);o.left=a,o.right=i,t.unshift(o)}}return t.shift()}function o(t){if(null==t)return null;var e={};function n(t,a,i){var o=[].concat(i);o.push(a),null!=t&&(null==t.data?(n(t.left,"0",o),n(t.right,"1",o)):e[t.data]=o.join(""))}return n(t,"",[]),e}function r(t,e){for(var n=[],a=0,i=t;a<i.length;a++){var o=i[a];n.push(e[o])}return n}function s(t){for(var e=t.join(""),n=Math.ceil(e.length/8),a=new Array(n+1),i=0,o="",r=0;r<e.length;r+=8)o=e.substring(r,r+8),a[i]=parseInt(o,2),i++;return a[i]=o.length,a}function c(t){var e=o(i(a(t)));return{result:s(r(t,e)),codes:e}}function l(t,e){t&&(e|=256);var n=Number(e).toString(2);return t?n.substring(n.length-8):n}function d(t,e){for(var n=[],a=0;a<e.length-1;a++){var i=a!==e.length-2;n.push(l(i,e[a]))}var o=n[n.length-1],r=e[e.length-1];o="00000000".substring(8-(r-o.length))+o,n[n.length-1]=o;for(var s={},c=0,d=Object.entries(t);c<d.length;c++){var u=d[c],p=u[0];s[u[1]]=p}var h=n.join(""),f=[],g=h.length;for(a=0;a<g;){for(var m=1,v=(i=!0,null);i&&a+m<=g&&""!==(p=h.substring(a,a+m));)(v=s[p])?i=!1:m++;f.push(parseInt(v,10)),a+=m}return f}function u(t){for(var e=[],n=0;n<t.length;n++)e.push(t.charCodeAt(n));return e}function p(t){for(var e="",n=0,a=t;n<a.length;n++){var i=a[n];e+=String.fromCharCode(i)}return e}function h(t){var e=c(u(t)),n=e.result;return{codes:e.codes,result:p(n)}}function f(t,e){return p(d(t,u(e)))}var g=function(){function t(){}return t.prototype.set=function(t,e){},t.prototype.get=function(t,e){},t.prototype.rm=function(t){},t}(),m=function(t){function n(){return null!==t&&t.apply(this,Array.from(arguments))||this}return e(n,t),n.isSupport=function(){return!!window.localStorage},n.prototype.set=function(t,e){try{localStorage.setItem(t,e)}catch(t){console.error(t)}},n.prototype.get=function(t,e){var n=null;try{n=localStorage.getItem(t)}catch(t){console.error(t)}e&&e(n)},n.prototype.rm=function(t){try{localStorage.removeItem(t)}catch(t){console.error(t)}},n}(g),v=function(t){function n(){var e=t.call(this)||this;e.databaseName="spyLC",e.db=null,e.setQueue=[],e.getQueue=[];var n=window.indexedDB.open(e.databaseName);return n.onupgradeneeded=function(t){e.db=t.target&&t.target.result,e.db&&!e.db.objectStoreNames.contains(e.databaseName)&&e.db.createObjectStore(e.databaseName,{keyPath:"key"}),e.runQueueTask()},n.onsuccess=function(){e.db=n.result,e.runQueueTask()},e}return e(n,t),n.isSupport=function(){return!!window.indexedDB},n.prototype.set=function(t,e){this.db?this.db.transaction([this.databaseName],"readwrite").objectStore(this.databaseName).add({key:t,value:e}):this.setQueue.push({key:t,value:e})},n.prototype.get=function(t,e){if(this.db){var n=this.db.transaction([this.databaseName]).objectStore(this.databaseName).get(t);n.onsuccess=function(){var t=n.result?n.result:{value:""};e(t.value)}}else this.getQueue.push({key:t,cb:e})},n.prototype.runQueueTask=function(){var t=this;this.setQueue.forEach((function(e){t.set(e.key,e.value)})),this.getQueue.forEach((function(e){t.get(e.key,e.cb)}))},n}(g);function y(){for(var t=[],e=0;e<Array.from(arguments).length;e++)t[e]=Array.from(arguments)[e];var n=Object.assign||function(t){for(var e=void 0,n=1,a=Array.from(arguments).length;n<a;n++)for(var i in e=Array.from(arguments)[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};return n.apply(this,t)}function b(t){for(var e="",n=0;n<t.length;n++){var a=t.charCodeAt(n);a<128?e+=String.fromCharCode(a):a>127&&a<2048?(e+=String.fromCharCode(a>>6|192),e+=String.fromCharCode(63&a|128)):(e+=String.fromCharCode(a>>12|224),e+=String.fromCharCode(a>>6&63|128),e+=String.fromCharCode(63&a|128))}return e}function w(t){for(var e="",n=0,a=0,i=0,o=0;n<t.length;)(a=t.charCodeAt(n))<128?(e+=String.fromCharCode(a),n++):a>191&&a<224?(i=t.charCodeAt(n+1),e+=String.fromCharCode((31&a)<<6|63&i),n+=2):(i=t.charCodeAt(n+1),o=t.charCodeAt(n+2),e+=String.fromCharCode((15&a)<<12|(63&i)<<6|63&o),n+=3);return e}function _(t,e){if(void 0===e&&(e=!1),!t)return"";e||(t=b(t));var n,a,i,o={},r=[],s=t.charAt(0),c=s,l=c,d=256,u=function(){r.push(s.length>1?String.fromCharCode(o[s]):s)};for(e&&r.push(s),n=1;n<t.length;n++)a=t.charAt(n),e?(i=t.charCodeAt(n),s=i<256?a:o[i]||s+c,r.push(s),c=s.charAt(0),o[d++]=l+c,l=s):o.hasOwnProperty(s+a)?s+=a:(u(),o[s+a]=d++,s=a);e||u();var p=r.join("");return e&&(p=w(p)),p}var k=function(){function t(t){void 0===t&&(t={}),this.tmpList=[],this.option=y({defaultTrigger:!0,compress:"lzw",key:"SpyLocalCache",interval:500,maxRecordLen:30,onFlush:function(){},onSave:function(){},onAdd:function(){return!0},storage:v.isSupport()?"indexedDB":m.isSupport()?"localstorage":"empty"},t),this.load=this.load.bind(this),this.init()}return t.prototype.init=function(){"indexedDB"===this.option.storage?this.storage=new v:"localstorage"===this.option.storage?this.storage=new m:this.storage=new g,"complete"===document.readyState?this.load():window.addEventListener("load",this.load)},t.prototype.load=function(){location.search.indexOf("_FlushLogLocalCache=1")>-1&&this.option.defaultTrigger&&this.flushLog()},t.prototype.addLog=function(t){var e=this;this.option.onAdd&&!this.option.onAdd(t)||(t=JSON.stringify(t),this.tmpList.push(t),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.save()}),this.option.interval))},t.prototype.getData=function(t){var e=this;try{this.storage.get(this.option.key,(function(n){n?e.storage.get(e.option.key+"Codes",(function(a){var i=[];try{a&&(a=JSON.parse(a)),i=e.unzip(n,a).split("\n")}catch(t){console.error(t)}t(i)})):t([])}))}catch(e){console.error(e),t([])}},t.prototype.save=function(){var t=this,e=Date.now();this.getData((function(n){var a=t.option.maxRecordLen-1,i=(n.length>a?n.slice(n.length-a,n.length):n).concat(t.tmpList),o=i.join("\n"),r=null,s=0;try{var c=t.zip(o),l="";c.codes?(l=JSON.stringify(c.codes),t.storage.set(t.option.key+"Codes",l)):t.storage.rm(t.option.key+"Codes"),t.storage.set(t.option.key,c.result),s=c.result.length}catch(t){r=t,console.error(t)}t.tmpList=[],t.option.onSave&&t.option.onSave({cost:Date.now()-e,length:s/1024,list:i,error:r})}))},t.prototype.flushLog=function(){var t=this;this.getData((function(e){try{for(var n=0;n<e.length;n++)e[n]=JSON.parse(e[n])}catch(n){e=[],t.storage.rm(t.option.key),console.error(n)}for(n=0;n<t.tmpList.length;n++)e.push(JSON.parse(t.tmpList[n]));t.option.onFlush&&t.option.onFlush(e)}))},t.prototype.zip=function(t){return"lzw"===this.option.compress?{codes:null,result:_(t)}:"huffman"===this.option.compress?h(t):{codes:null,result:t}},t.prototype.unzip=function(t,e){return"lzw"===this.option.compress?_(t,!0):"huffman"===this.option.compress?f(e,t):t},t}();return k}()}(an);var on=an.exports,rn=n.getDefaultExportFromCjs(on);function sn(){return sn=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},sn.apply(this,Array.from(arguments))}var cn=function(){function t(){var e=this;this.spyCache=new rn({maxRecordLen:50,onFlush:t.getFlushFun(),storage:"localstorage",key:"csSpyLocalCache",compress:"no"}),window.onbeforeunload=function(){e.spyCache&&e.spyCache.save()},window.addEventListener("error",(function(t){e.sendLog({msg:t.message})}))}return t.prototype.sendLog=function(t){var e=Je.getState("curRankInfo")||{};this.spyCache&&this.spyCache.addLog(sn({},t,{lid:e.lid||""}))},t.getFlushFun=function(){return function(t){t&&t.length&&function(t){for(var e=t.length;e>0&&!(encodeURIComponent(JSON.stringify(t)).length<6e3);e--)t.splice(0,1);tn.sendExcept({group:"chat_local_cache",info:{msg:JSON.stringify(t)}})}(t)}},t}();function ln(t,e){return"string"==typeof t?Array.from(e?e.querySelectorAll(t):document.querySelectorAll(t)):(n=t,(null!=(a=Element)&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?a[Symbol.hasInstance](n):n instanceof a)?[t]:Array.isArray(t)?t:"[object NodeList]"===Object.prototype.toString.call(t)?Array.from(t):[]);var n,a}function dn(t,e){return ln(t,e)}function un(t,e){return e?e.querySelector(t):document.querySelector(t)}function pn(t,e,n){var a=ln(t);if(void 0===n)return a.length>0?a[0].getAttribute(e):null;a.forEach((function(t){null===n?t.removeAttribute(e):t.setAttribute(e,n)}))}function hn(t){ln(t).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))}function fn(t,e,n){if(Element.prototype.closest)return t.closest(e);do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType&&n&&t!==n);return null}function gn(t,e){return t?t.classList&&t.classList.contains(e)?t:gn(t.parentElement,e):null}var mn={exports:{}};function vn(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function yn(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":e._typeof(t)}!function(t){!function(){function e(t){var e={hash:"",queryString:"",params:{},query:{},path:t},n=e.path.indexOf("#");n>=0&&(e.hash=e.path.slice(n+1),e.path=e.path.slice(0,n));var a=e.query,i=e.path.indexOf("?");if(i>=0){e.queryString=e.path.slice(i+1),e.path=e.path.slice(0,i);for(var o=e.queryString.split("&"),r=0;r<o.length;r++){var s=o[r],c=s.indexOf("="),l="";c>0&&(l=s.slice(c+1),s=s.slice(0,c));var d=decodeURIComponent(s);l=decodeURIComponent(l),a.hasOwnProperty(d)?a[d]=[].concat(a[d],l):a[d]=l}}return e}function n(t){if(!t)return"";if("string"==typeof t)return t;var e,n=t.query,a=t.params,i=t.path||"",o=[];if(i)for(var r=i.split("/"),s=0,c=r.length;s<c;s++){var l=r[s];if(/^:[a-z0-9_-]+$/.test(l)){e=!0;var d=l.slice(1);o.push(a&&a[d]||n&&n[d])}else o.push(l)}var u=t.queryString||"";if(0===u.indexOf("?")&&(u=u.slice(1)),!u&&n&&(!e||a)){var p=!0;for(var h in n)n.hasOwnProperty(h)&&(u+=(p?"":"&")+h+"="+encodeURIComponent(n[h]),p=!1)}return o.join("/")+(u&&"?")+u}function a(t,n){var a,i=e(t),o=e(n),r=i.path;if(0===r.indexOf("/"))return t;if(r){var s=r.split("/"),c=o.path.split("/");c.pop();for(var l=0;l<s.length;l++){var d=s[l];switch(d){case"..":c.pop();break;case".":break;default:c.push(d)}}""!==c[0]&&c.unshift(""),a=c.join("/")}else a=o.path;return a+(i.queryString?"?"+i.queryString:"")}function i(){}function o(){var t=location.href.indexOf("#");return t<0?"/":location.href.slice(t+1)||"/"}function r(){this.current=o(),this.referrer="";var t=this;this.hashChangeHandler=function(){t.redirect(o())}}function s(){return location.pathname+location.search}function c(){if(!c.isSupport)throw new Error("[SAN-ROUTER ERROR] Your navigator doesn't supports HTML5!");this.current=s(),this.referrer="";var t=this;this.popstateHandler=function(){t.referrer=t.current,t.current=s(),t.fire("redirect",{url:t.current,referrer:t.referrer})}}i.prototype.on=function(t,e){"function"==typeof e&&(this._eventListeners||(this._eventListeners={}),this._eventListeners[t]||(this._eventListeners[t]=[]),this._eventListeners[t].push(e))},i.prototype.un=function(t,e){if(this._eventListeners&&this._eventListeners[t])if(e)for(var n=this._eventListeners[t],a=n.length;a--;)n[a]===e&&n.splice(a,1);else this._eventListeners[t]=[]},i.prototype.fire=function(t,e){if(!t)throw new Error("No event type specified");var n=this._eventListeners&&this._eventListeners[t];if(n)for(var a=0;a<n.length;a++)n[a](e)},r.prototype=new i,r.prototype.constructor=r,r.prototype.start=function(){window.addEventListener&&window.addEventListener("hashchange",this.hashChangeHandler,!1),window.attachEvent&&window.attachEvent("onhashchange",this.hashChangeHandler)},r.prototype.stop=function(){window.removeEventListener&&window.removeEventListener("hashchange",this.hashChangeHandler,!1),window.detachEvent&&window.detachEvent("onhashchange",this.hashChangeHandler)},r.prototype.redirect=function(t,e){e=e||{},t=a(t,this.current);var n,i,o,r=this.current,s=t!==r;s?(this.referrer=r,this.current=t,e.replace?location.replace((n=t,i=location.href,o=i.indexOf("#"),i.slice(0,o+1)+n)):location.hash=t):r=this.referrer,!s&&!e.force||e.silent||this.fire("redirect",{url:t,referrer:r})},r.prototype.reload=function(){this.redirect(this.current,{force:!0})},c.prototype=new i,c.prototype.constructor=c,c.prototype.start=function(){window.addEventListener("popstate",this.popstateHandler)},c.prototype.stop=function(){window.removeEventListener("popstate",this.popstateHandler)},c.prototype.redirect=function(t,e){e=e||{},t=a(t,this.current);var n=this.current,i=t!==n;i&&(this.referrer=n,this.current=t,history[e.replace?"replaceState":"pushState"]({},"",t)),!i&&!e.force||e.silent||this.fire("redirect",{url:t,referrer:n})},c.prototype.reload=function(){this.fire("redirect",{url:this.current,referrer:this.referrer})},c.isSupport="pushState"in window.history;var l=365611;function d(t){return t.prototype&&(5===t.prototype.nodeType||"san-cmpt"===t.prototype._type)}function u(t){var n=(t=t||{}).mode||"hash";this.routes=[],this.routeAlives=[],this.listeners=[],this.__withRouteListeners=[],this.__redirectListener=function(t){return function(n){var a=e(n.url),i=t.match(a,n.referrer),o=i?i.data:a,r=0,s=1,c={url:n.url,hash:o.hash,queryString:o.queryString,query:o.query,params:o.params,path:o.path,referrer:n.referrer,config:i&&i.route.config,data:i&&i.data,resume:function(){0===s&&(s=1,l())},suspend:function(){s=0},stop:function(){s=-1}};function l(){if(s>0){if(r<t.listeners.length)t.listeners[r++].call(t,c);else u();s>0&&l()}}function u(){if(s=-1,i)!function(t,e){var n=e.route,a=!1,i=t.routeAlives.length,o=t.__withRouteListeners.slice(0);for(;i--;){var r=t.routeAlives[i];r.id===n.id?(r.component.data.set("route",e.data),"function"==typeof r.component.route&&r.component.route(),a=!0):(r.component.dispose(),t.routeAlives.splice(i,1))}a||(n.Component?d(n.Component)?h(t,e):n.Component().then((function(a){d(a)?n.Component=a:a.__esModule&&d(a.default)&&(n.Component=a.default),h(t,e)})):n.handler.call(t,e.data));for(var s=0,c=o.length;s<c;s++)o[s](e)}(t,i);else for(var e=t.routeAlives.length;e--;)t.routeAlives[e].component.dispose(),t.routeAlives.splice(e,1)}l()}}(this),this.setMode(n)}function p(t,e){var n=e.rule,a=[""];if("string"==typeof n){var i=n.replace(/\/:([a-z0-9_-]+)(?=\/|$)/gi,(function(t,e){return a.push(e),"/([^/\\s]+)"}));n=new RegExp("^"+i+"$","i")}if(!vn(n,RegExp))throw new Error("[SAN-ROUTER ERROR] Rule must be string or RegExp!");var o=(++l).toString();t.routes.push({id:o,rule:n,handler:e.handler,keys:a,target:e.target||"#main",Component:e.Component,config:e})}function h(t,e){var n=e.route,a=new n.Component;a.$router=t,a.data.set("route",e.data),"function"==typeof a.route&&a.route();var i=function(t){switch(void 0===t?"undefined":yn(t)){case"object":return t;case"string":return document.querySelector?document.querySelector(t):document.getElementById(t.replace(/#/i,""))}}(n.target);if(!i)throw new Error('[SAN-ROUTER ERROR] Attach failed, target element "'+n.target+'" is not found.');a.attach(i),t.routeAlives.push({component:a,id:n.id}),"function"==typeof n.handler&&setTimeout((function(){n.handler.call(t,e.data)}))}u.prototype.match=function(t,n){"string"==typeof t&&(t=e(t));for(var a=0;a<this.routes.length;a++){var i=this.routes[a],o=i.rule.exec(t.path);if(o){for(var r=i.keys||[],s=1;s<o.length;s++){var c=r[s]||s,l=o[s];t.query[c]=l,t.params[c]=l}return{data:{hash:t.hash,queryString:t.queryString,params:t.params,query:t.query,path:t.path,referrer:n},url:t,route:i}}}return null},u.prototype.listen=function(t){this.listeners.push(t)},u.prototype.unlisten=function(t){for(var e=this.listeners.length;e--;)this.listeners[e]===t&&this.listeners.splice(e,1)},u.prototype.start=function(){return this.isStarted||(this.isStarted=!0,this.locator.on("redirect",this.__redirectListener),this.locator.start(),this.locator.reload()),this},u.prototype.stop=function(){return this.locator.un("redirect",this.__redirectListener),this.locator.stop(),this.isStarted=!1,this},u.prototype.setMode=function(t){if(t=t.toLowerCase(),this.mode!==t){this.mode=t;var e=!1;switch(this.isStarted&&(this.stop(),e=!0),t){case"hash":this.locator=new r;break;case"html5":this.locator=new c}return e&&this.start(),this}},u.prototype.add=function(t){if(vn(t,Array))for(var e=0,n=t.length;e<n;e++)p(this,t[e]);else"object"===(void 0===t?"undefined":yn(t))&&p(this,t);return this},u.prototype.push=function(t,e){this.locator.redirect(n(t),e)},u.prototype.replace=function(t,e){e=Object.assign({replace:!0},e),this.locator.redirect(n(t),e)};var f,g=new u;try{f=new Function("RawClass","return class extends RawClass {}")}catch(t){}function m(t){var e;return(e=0===t.toString().indexOf("class")?f(t):function(t){var e=new Function;e.prototype=t.prototype;var n=function(e){return t.call(this,e)||this};return(n.prototype=new e).constructor=n,e.prototype.hasOwnProperty("aPack")&&(n.prototype.aPack=e.prototype.aPack),n}(t)).template=t.template,e.components=t.components,e.trimWhitespace=t.trimWhitespace,e.delimiters=t.delimiters,e.autoFillStyleAndId=t.autoFillStyleAndId,e.filters=t.filters,e.computed=t.computed,e.aPack=t.aPack,e.messages=t.messages,e}function v(t){return{template:'<a href="{{hrefPrefix}}{{href}}" onclick="return false;" on-click="clicker($event)" target="{{target}}" class="{{isActive ? activeClass : \'\'}}"><slot/></a>',clicker:function(e){var n=this.data.get("href");"string"==typeof n&&t.locator.redirect(n.replace(/^#/,"")),e.preventDefault?e.preventDefault():e.returnValue=!1},inited:function(){var e=this;this.routeListener=function(t){e.data.set("isActive",t.url===e.data.get("href"))},this.routeListener({url:t.locator.current}),t.listen(this.routeListener)},disposed:function(){t.unlisten(this.routeListener),this.routeListener=null},initData:function(){return{isActive:!1,hrefPrefix:"hash"===t.mode?"#":""}},computed:{href:function(){return a(this.data.get("to")||"",t.locator.current)}}}}var y={Link:v(g),createLink:v,withRoute:function(t,e){var n,a,i;e=e||g,"function"==typeof t?(a=m(t),n=t.prototype,i=a.prototype):(n=t||{},i=a=Object.assign({},t));var o=n.inited;i.inited=function(){this.$router=e,this.data.set("route",e.match(e.locator.current,e.locator.referrer).data),"function"==typeof this.route&&this.route();var t=this;this.__routerListener=function(e){t.data.set("route",e.data),"function"==typeof t.route&&t.route()},e.__withRouteListeners.push(this.__routerListener),"function"==typeof o&&o.call(this)};var r=n.disposed;return i.disposed=function(){if(this.$router){for(var t=this.$router.__withRouteListeners,e=t.length;e--;)if(t[e]===this.__routerListener){t.splice(e,1);break}this.__routerListener=null,this.$router=null}"function"==typeof r&&r.call(this)},a},router:g,Router:u,HashLocator:r,HTML5Locator:c,resolveURL:a,parseURL:e,stringifyURL:n,version:"2.0.2"};t.exports=y}()}(mn);var bn=mn.exports;function wn(t,e,n){void 0===n&&(n={});var a,i,o,r,s,c,l=0,d=!1,u=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var n=a,o=i;return a=i=void 0,c=e,r=t.apply(o,n)}function f(t){var n=t-c;return void 0===c||n>=e||n<0||u&&t-l>=o}function g(){var t=Date.now();if(f(t))return m(t);s=setTimeout(g,function(t){var n=t-l,a=e-(t-c);return u?Math.min(a,o-n):a}(t))}function m(t){return s=void 0,p&&a?h(t):(a=i=void 0,r)}function v(){var t=Date.now(),n=f(t);if(a=Array.prototype.slice.call(Array.from(arguments)),i=this,c=t,n){if(void 0===s)return function(t){return l=t,s=setTimeout(g,e),d?h(t):r}(c);if(u)return s=setTimeout(g,e),h(c)}return void 0===s&&(s=setTimeout(g,e)),r}return e=+e||0,ye(n)&&(d=!!n.leading,o=(u="maxWait"in n)?Math.max(void 0===n.maxWait?0:+n.maxWait,e):o,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==s&&clearTimeout(s),l=0,a=i=s=void 0},v.flush=function(){return void 0===s?r:m(Date.now())},v}function _n(t,e,n){void 0===n&&(n={});var a=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return ye(n)&&(a="leading"in n?!!n.leading:a,i="trailing"in n?!!n.trailing:i),wn(t,e,{leading:a,maxWait:e,trailing:i})}function kn(t){var e,n,a,i,o=un('.cs-rank-container[rank="'+t+'"]');if(!o)return"";var r=null==(e=un("[data-share]",o))?void 0:e.getAttribute("data-share"),s=(null==(n=un("[data-agent]",o))?void 0:n.getAttribute("data-agent"))||"{}",c=null==(a=un("[data-query]",o))?void 0:a.getAttribute("data-query"),l=null==(i=un("[data-share-disabled]",o))?void 0:i.getAttribute("data-share-disabled");if(!r||!c||l)return"";var d=JSON.parse(r),u=JSON.parse(s),p=u.agentName?{aggentId:u.agentId,agentName:u.agentName,agentSearchId:u.agentSearchId,startIndex:u.startIndex,endIndex:u.endIndex,span:u.span}:{},h=encodeURIComponent("extParams="+encodeURIComponent(JSON.stringify({shareId:d.shareId,agentInfo:p})));return Nt("https://mbd.baidu.com/ug_share/mbox/4a84ae9866/share",Ot({product:"default",tk:"665167314a3488d45738b9d218daebed",domain:"mbd.baidu.com",share_url:"https://chat.baidu.com/csaitab/history/share?share_id="+encodeURIComponent(d.shareId)+"&word="+encodeURIComponent(c),word:c,extParams:h}))}var Sn={exports:{}};function xn(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":e._typeof(t)}!function(t){n.commonjsGlobal,t.exports=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==xn(Symbol.iterator)?function(t){return void 0===t?"undefined":xn(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":xn(t)})(e)}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function a(t){for(var a=1;a<Array.from(arguments).length;a++){var i=null!=Array.from(arguments)[a]?Array.from(arguments)[a]:{};a%2?n(Object(i),!0).forEach((function(n){e(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function i(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function o(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var s=/^(?:(\w+)\.)?(?:(\w+)\.)?(\w+)$/;function c(t){var e=s.exec(t[0]);if(null==e||4!==e.length)throw"UBC SDK error inputs";if(this.trackerName=e[1]||"t0",this.pluginName=e[2]||"",this.methodName=e[3],this.fields=[].slice.call(t,1),this.isCreateCommand="init"===this.methodName,this.isConfigCommand="config"===this.methodName,this.isEventCommand="event"===this.methodName||"pv"===this.methodName,this.isTimingCommand="timing"===this.methodName,!this.methodName)throw"UBC SDK methodName can not be empty!";if(this.isCreateCommand&&!this.fields[0])throw"UBC SDK serverId can not be empty!"}var l=window.navigator.userAgent,d=/ (lite|info) baiduboxapp\//i.test(l),u=/ mission baiduboxapp\//i.test(l),p=/ baiduboxapp\//i.test(l)&&!d&&!u,h=function(e,n){if(!Array.isArray(e)||!Array.isArray(n))return{};for(var a={},i=Math.min(e.length+1,n.length),o=0;o<i;o++)if("object"===t(n[o]))for(var r in a[e[o]]={},n[o])n[o].hasOwnProperty(r)&&(a[e[o]][r]=n[o][r]);else o<e.length&&(a[e[o]]=n[o]);return a};function f(t){var e=Array.from(arguments).length>1&&void 0!==Array.from(arguments)[1]?Array.from(arguments)[1]:window.location.href,n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i");if(e.split("?")[1]){var a=e.split("?")[1].match(n);return null!=a?decodeURIComponent(a[2]):null}return null}function g(){var e=Array.from(arguments).length>0&&void 0!==Array.from(arguments)[0]?Array.from(arguments)[0]:{};if(!e)return"";var n="";for(var a in e)if(e.hasOwnProperty(a)){var i=e[a];null==i?i="":"object"===t(i)&&(i=JSON.stringify(i)),n+="&"+encodeURIComponent(a)+"="+encodeURIComponent(i)}return n.slice(1)}function m(){var t=Array.from(arguments).length>0&&void 0!==Array.from(arguments)[0]?Array.from(arguments)[0]:"",e=Array.from(arguments).length>1&&void 0!==Array.from(arguments)[1]?Array.from(arguments)[1]:{};return t+(~t.indexOf("?")?"&":"?")+g(e)}function v(e){var n=t(e);return"function"===n||!!e&&"object"===n}function y(t){return!0===t||!1===t}function b(){}function w(t,e){try{if("function"==typeof t.find)return t.find(e);for(var n=0;n<t.length;n++)if(e(t[n],n,t))return t[n]}catch(t){}}var _={cmdQueue:[],init:function(){_.cmdQueue=[]},run:function(t){var e=t.map((function(t){return _.toCommands.apply(_,[t])})),n=_.cmdQueue.concat(e);for(_.cmdQueue=[];n.length>0;)_.runCommand.apply(this,[n[0]])&&_.cmdQueue.push(n[0]),n.shift()},toCommands:function(t){return new c(t)},runCommand:function(t){if(t.isCreateCommand)this.create.apply(this,[t.trackerName].concat(o(t.fields)));else if(t.isConfigCommand){var e=this.getByName(t.trackerName);if(!e)throw"不存在"+t.trackerName+"实例";var n=t.fields[0];for(var a in n)n.hasOwnProperty(a)&&(v(n[a])?e.set(a,Object.assign({},e.get(a),n[a])):e.set(a,n[a]))}else if(t.isEventCommand){var i=this.getByName(t.trackerName);if(!i)throw"不存在"+t.trackerName+"实例";i.send.call(i,{type:"event",fields:t.fields})}else if(t.isTimingCommand){var r=this.getByName(t.trackerName);if(!r)throw"不存在"+t.trackerName+"实例";var s=t.fields[0],c=[].slice.call(t.fields,1);"start"===s?r.regestTimingReportor(c):"end"===s&&r.endTimingReportor(c)}}};_.init();var k={http:"http://mbd.baidu.com/tcbox?action=pblog",https:"https://mbd.baidu.com/tcbox?action=pblog"}["https:"===document.location.protocol?"https":"http"];function S(t,e,n,a){var i=function(t){var e=document.createElement("img");return e.width=1,e.height=1,e.src=t,e}(t=m(t,{data:e})),o=!1;setTimeout((function(){n&&!o&&(n(a),o=!0)}),100),i.onload=i.onerror=function(){i=null,n&&!o&&(n(a),o=!0)}}function x(t,e,n,a){t=m(t,{data:e}),window.navigator.sendBeacon(t),n(a)}function I(t,e){var n=Array.from(arguments).length>2&&void 0!==Array.from(arguments)[2]?Array.from(arguments)[2]:b,a=Array.from(arguments).length>3&&void 0!==Array.from(arguments)[3]?Array.from(arguments)[3]:0,i=Array.from(arguments).length>4?Array.from(arguments)[4]:void 0;return"function"==typeof window.navigator.sendBeacon&&(i.model.useSendBeacon&&0===a||1===a)?x(t,e,n,i):S(t,e,n,i)}var T,C,L=[{appname:"baiduboxmission",reg:/\bmission\sbaiduboxapp\b/i,appid:"10006"},{appname:"baiduboxlite",reg:/\b(?:lite|info) baiduboxapp\b/i,appid:"10001"},{appname:"baiduboxapp",reg:/\bbaiduboxapp\b/i,appid:"1"},{appname:"tieba",reg:/\btieba\b/i,appid:"11001"},{appname:"haokan",reg:/\bhaokan\b/i,appid:"11000"},{appname:"quanmin",reg:/\bbdminivideo\b/i,appid:"12022"},{appname:"bdmap",reg:/\bbaidumap_/i,appid:"11006"},{appname:"wangpan",reg:/\bnetdisk;/i,appid:"12018"},{appname:"askmybaby",reg:/\bmybaby\//i,appid:"12019"},{appname:"xifan",reg:/\bbdxifan\//i,appid:"12006"},{appid:"12031",appname:"sowhat"},{appid:"12010",appname:"lemon",reg:/lemonapp/i},{appid:"12015",appname:"baijiahao"},{appid:"12012",appname:"fanle"},{appid:"12013",appname:"zhaocaimao"},{appid:"12014",appname:"gamenow"},{appid:"12016",appname:"iqiyi"},{appid:"12017",appname:"baike"},{appid:"12023",appname:"flow"},{appid:"12026",appname:"dutaxi"},{appid:"12011",appname:"youjia"},{appid:"12020",appname:"feedsunion"},{appid:"12021",appname:"album"},{appid:"12024",appname:"webgame"},{appid:"12027",appname:"hmi_passenger"},{appid:"12028",appname:"bdwenku"},{appid:"12029",appname:"fanyi"},{appid:"12030",appname:"iknow"},{appid:"12025",appname:"duxiaoxiao"},{appid:"12032",appname:"baiduhanyu"},{appid:"12034",appname:"exp"},{appid:"12036",appname:"demo"},{appid:"12037",appname:"baiduyuedu"},{appid:"12038",appname:"cdm"},{appid:"12040",appname:"weiba"},{appid:"12041",appname:"baiduboxvision"},{appid:"12042",appname:"hiphop"},{appid:"12043",appname:"robobus-panel"},{appid:"12044",appname:"wenkustudent"},{appid:"12045",appname:"pc_live"},{appid:"12049",appname:"yunshangbaidu"},{appid:"12050",appname:"baiduwenku_pc"},{appid:"12051",appname:"yinci"},{appid:"12052",appname:"novel"},{appid:"12054",appname:"yoopu"},{appid:"12057",appname:"yinbo"},{appid:"12062",appname:"aiqicha"},{appid:"12066",appname:"Bamboo_Health"},{appid:"12067",appname:"Bamboo_Health_Dr"},{appid:"12073",appname:"superduer"},{appid:"12074",appname:"baidujiankangapp"},{appid:"12075",appname:"bdcrm_aifanfan"},{appid:"12077",appname:"muzhidoctor"},{appid:"12079",appname:"apollogo"},{appid:"12080",appname:"lvlin"},{appid:"12083",appname:"aipurchase"},{appid:"12088",appname:"BaiDuCarLife"},{appid:"12090",appname:"baidujiankangtt"},{appid:"12092",appname:"infoflow",reg:/\bbaiduhi/i},{appid:"12094",appname:"hmi_driver"},{appid:"12095",appname:"vr_expo"},{appid:"12096",appname:"content_ecommerce"},{appid:"12097",appname:"play_control"},{appid:"12098",appname:"aipurchaser"},{appid:"12101",appname:"ditutaojin"},{appid:"12102",appname:"hp_location"},{appid:"12106",appname:"chatroom"},{appid:"12107",appname:"gaia"},{appid:"12108",appname:"ubi"},{appid:"12109",appname:"yiju"},{appid:"12111",appname:"bml"},{appid:"12112",appname:"aihome"},{appid:"12113",appname:"aihome_children"},{appid:"12114",appname:"mobsecurity"},{appid:"12117",appname:"tomas"},{appid:"12118",appname:"baidu_flutter"},{appid:"12120",appname:"wepod"},{appid:"12121",appname:"yy"},{appid:"12122",appname:"kidedu"},{appid:"12123",appname:"wangpan_faster"},{appid:"12124",appname:"wepod_mobile"},{appid:"12125",appname:"baidu_vr_classroom_launcher"},{appid:"12192",appname:"searchcraft",reg:/\bSearchCraft\b/i}],P=["type","value","ext"];function D(t){this.model={},function(t,e){t.trackerName=e.trackerName,t.trackerId=e.trackerId||"",t.timingId=e.config&&e.config.timingId||"",t.useSendBeacon=e.config&&e.config.useSendBeacon||!1,t.version=e.config&&e.config.version||"1.0",e.config&&y(e.config.ifHeartbeatTime)?t.ifHeartbeatTime=e.config.ifHeartbeatTime:t.ifHeartbeatTime=!0,e.config&&y(e.config.testMode)?t.testMode=e.config.testMode:t.testMode=!1,t.testUrl=e.config&&e.config.testUrl||"",e.config&&y(e.config.autoPvTrack)?t.autoPvTrack=e.config.autoPvTrack:t.autoPvTrack=!1,e.config&&y(e.config.autoTimingTrack)?t.autoTimingTrack=e.config.autoTimingTrack:t.autoTimingTrack=!1,t.queryParams=e.config&&e.config.queryParams||{},t.version&&(t.queryParams.v=t.version,t.queryParams.appname=t.queryParams.appname||"baiduboxapp"),t.appid=e.config&&e.config.appid||"1",t.cateid=e.config&&e.config.cateid||"99",t.actiontype=e.config&&e.config.actiontype||"0",t.from=e.config&&e.config.from||"act",t.duration=e.config&&e.config.duration||3,t.source=e.config&&e.config.source||"",t.inBox=p?"1":"0",t.abtest=e.config&&e.config.abtest||"",t.network=e.config&&e.config.network||"",t.page=e.config&&e.config.page||"",t.baiduTongJiId=e.config&&e.config.baiduTongJiId,t.isBaiduTongJi=!(!e.config||!e.config.baiduTongJiId),t.timingTasks=[],t.apptype=function(){var t=Array.from(arguments).length>0&&void 0!==Array.from(arguments)[0]?Array.from(arguments)[0]:"",e={appname:"other",appid:"12133"};if(t)return w(L,(function(e){return t===e.appname}))||e;var n,a=(null===(n=navigator)||void 0===n?void 0:n.userAgent)||"";return w(L,(function(t){return t.reg?t.reg.test(a):-1!==a.search(t.appname)}))||e}().appid}(this.model,t),this.get("isBaiduTongJi")&&(window._hmt=window._hmt||[],function(t){if(t){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}}("https://hm.baidu.com/hm.js?"+this.get("baiduTongJiId"))),this.get("autoPvTrack")&&this.send({type:"event",fields:["pageAutoPv"]}),this.get("autoTimingTrack")&&this.regestTimingReportor(["pageAutoTiming"])}D.prototype.set=function(t,e){this.model[t]=e},D.prototype.get=function(t){return this.model[t]},D.prototype.send=function(t){var e,n,o,r=t.type,s=t.fields,c=0;if("event"===r){if(s&&v(s[0])?(o=s[0],function(t){return"function"==typeof t}(s[1])&&(e=s[1])):o=h(P,s),n=function(t,e){var n={cateid:t.cateid,actiondata:{id:t.trackerId,type:"0",timestamp:Date.now(),content:a(a({page:t.page||window.location.hostname+window.location.pathname,source:t.source||f("idfrom")||"",from:t.from},e),{},{ext:a({apptype:t.apptype},e.ext)})}};return"1.0"===t.version&&(n.actiondata.abtest=t.abtest,n.actiondata.inBox=t.inBox,n.actiondata.network=t.network,n.appid=t.appid,n.actiontype=t.actiontype),n}(this.model,o),o.useSendBeacon&&(c=o.useSendBeacon),this.get("isBaiduTongJi")){var l=n.actiondata.content||{},d=l.page,u=l.type,p=l.value;window._hmt.push(["_trackEvent",d,u,p])}}else"timing"===r&&(n=function(t,e){var n=e.starttime,o=e.ext,r=i(e,["starttime","ext"]),s={cateid:t.cateid,actiondata:{id:t.timingId,type:"1",timestamp:Date.now(),starttime:n,content:{duration:t.duration,option:a(a({page:t.page||window.location.hostname+window.location.pathname,source:t.source||f("idfrom")||"",from:t.from},r),{},{ext:a({apptype:t.apptype},o)})}}};return t.ifHeartbeatTime||(s.actiondata.endtime=Date.now(),s.actiondata.content.duration=(s.actiondata.endtime-s.actiondata.starttime)/1e3),"1.0"===t.version&&(s.actiondata.abtest=t.abtest,s.actiondata.inBox=t.inBox,s.actiondata.network=t.network,s.appid=t.appid,s.actiontype=t.actiontype),s}(this.model,s));var g=this.get("testMode")?"http://bjyz-mco-searchbox201609-m12xi3-044.bjyz.baidu.com:8080/tcbox?action=pblog":k;"2.0"===this.model.version&&(g=this.get("testMode")?"http://bjyz-mco-searchbox201609-m12xi3-044.bjyz.baidu.com:8080/ztbox?action=zpblog":"https://mbd.baidu.com/ztbox?action=zpblog",g=m(g=this.model.testUrl||g,this.model.queryParams)),I.apply(this,[g,n,e,c,this])},D.prototype.regestTimingReportor=function(){var t=this,e=Array.from(arguments).length>0&&void 0!==Array.from(arguments)[0]?Array.from(arguments)[0]:[];if(!this.get("timingId"))throw"timing ID is required!";var n=this.get("timingTasks"),i=this.get("duration"),o=this.get("ifHeartbeatTime"),r={};r=e&&v(e[1])?a({type:e[0]},e[1]):h(P,e);var s=w(n,(function(t){return t.eventName===e[0]}));if(r.starttime=Date.now(),!s){var c=0;o&&(this.send({type:"timing",fields:r}),c=setInterval((function(){t.send({type:"timing",fields:r})}),1e3*i)),n.push({timingIntevalId:c,isReporting:!0,eventName:e[0],fields:r})}},D.prototype.stopAllTimingReportor=function(){var t=this;this.get("timingTasks").forEach((function(e){t.send({type:"timing",fields:e.fields}),e.isReporting=!1,clearInterval(e.timingIntevalId)}))},D.prototype.startAllTimingReportor=function(){var t=this,e=this.get("timingTasks"),n=this.get("duration"),a=this.get("ifHeartbeatTime");e.forEach((function(e){e.isReporting||(e.isReporting=!0,e.fields.starttime=Date.now(),a&&(t.send({type:"timing",fields:e.fields}),e.timingIntevalId=setInterval((function(){t.send({type:"timing",fields:e.fields})}),1e3*n)))}))},D.prototype.endTimingReportor=function(t){var e=this,n={};t&&v(t[1])&&(n=t[1]);var i=this.get("timingTasks"),o=[];i.forEach((function(i){var r=i.timingIntevalId;i.eventName===t[0]?(e.send({type:"timing",fields:a(a({},i.fields),n)}),clearInterval(r)):o.push(i),e.set("timingTasks",o)}))},D.prototype.removeAllTimingReportor=function(){var t=this,e=this.get("timingTasks");e.forEach((function(e){t.send({type:"timing",fields:e.fields}),clearInterval(e.timingIntevalId)})),e=[]},void 0!==document.hidden?(T="hidden",C="visibilitychange"):void 0!==document.msHidden?(T="msHidden",C="msvisibilitychange"):(void 0!==document.webkitHidden||void 0!==document.baiduboxappvisibilitychange)&&(T="webkitHidden",C="webkitvisibilitychange");var A=[],E={},O=["trackerName","trackerId","config"];function R(){for(var t=Array.from(arguments).length,e=new Array(t),n=0;n<t;n++)e[n]=Array.from(arguments)[n];_.run.call(window.ubc,[e])}return R.create=function(){for(var t=Array.from(arguments).length,e=new Array(t),n=0;n<t;n++)e[n]=Array.from(arguments)[n];var a=h(O,[].slice.call(e)),i=a.trackerName;if(E[i])return E[i];var o=new D(a);return E[i]=o,A.push(o),o},R.remove=function(t){for(var e=A.length,n=0;n<e;n++)if(A[n][t]===t){A.splice(n,1),E[t]=null;break}},R.main=function(){var t=window.ubc,e=t&&t.q;t&&"function"==typeof t.getAll&&(R=window.ubc),Array.isArray(e)&&(_.run.apply(R,[e]),t.q=[]),R.startTime=t&&t.l||1*new Date,R.loaded=!0,window.ubc=R},R.getByName=function(t){return E[t]},R.getAll=function(){return A.slice()},R.main(),function(t){void 0!==document.addEventListener&&void 0!==T&&document.addEventListener(C,(function(){t.getAll().forEach((function(t){var e=t.get("timingTasks");Array.isArray(e)&&(document[T]?t.stopAllTimingReportor():t.startAllTimingReportor())}))}),!1)}(R),R}()}(Sn);var In=Sn.exports,Tn=n.getDefaultExportFromCjs(In);function Cn(){return Cn=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Cn.apply(this,Array.from(arguments))}var Ln={eventType:{type:"sendCommand"}},Pn={eventType:{type:"notifyStateEvent"}},Dn={from:"chatjs",to:"chatjs"},An={container:{halfScreenClosed:Cn({name:"half-screen-closed",from:"na"},Ln),halfScreenOpened:Cn({name:"half-screen-opened",from:"na"},Ln),imageGuidanceShow:Cn({name:"image-guidance-showed",from:"na"},Ln),inputStart:Cn({name:"input-start",from:"na"},Ln),deleteAgent:Cn({name:"delete-agent",from:"na"},Ln),search:Cn({name:"search",from:"na"},Ln),backFirstpage:Cn({name:"back-firstpage",from:"na"},Ln),inputCancel:Cn({name:"input-cancel",from:"na"},Ln),sendAvatar:Cn({name:"send-avatar",from:"na"},Ln),deleteTag:Cn({name:"delete-tag",from:"na"},Ln),submitTag:Cn({name:"submit-tag",from:"na"},Ln),scanImage:Cn({name:"scan-image",from:"na"},Ln),chatRecommendUpdate:Cn({name:"chat-recommend-update",from:"na"},Ln),loginStatus:Cn({name:"login-status",from:"na"},Ln),longPressRespond:Cn({name:"execute-h5-function",from:"na"},Ln),searchPrerenderConfirm:Cn({name:"search-prerender-confirm",from:"na"},Ln),voicePanelStatus:Cn({name:"voice-panel-status",from:"na"},Ln),makeAiCall:Cn({name:"make-ai-call",from:"na"},Ln),stopSyncTabData:Cn({name:"stop-sync-tab-data",from:"na"},Ln),guidewordsReqIntercept:Cn({name:"guidewords-req-intercept",from:"na"},Ln),checkReady:Cn({name:"check-ready",from:"na"},Ln),updateCapsule:Cn({name:"update-capsule",from:"na"},Ln),openNewPageOrHistory:Cn({name:"checkout-chat",from:"na"},Ln),checkoutChatModel:Cn({name:"checkout-chat-model",from:"na"},Ln)},conversation:{openHalfScreen:Cn({name:"open-half-screen",to:"na"},Pn),closeHalfScreen:Cn({name:"close-half-screen",to:"na"},Pn),showImageGuidance:Cn({name:"show-image-guidance",to:"na"},Pn),sendInputConfig:Cn({name:"send-input-config",to:"na"},Pn),ready:Cn({name:"ready",to:"na"},Pn),sidebarUpdate:Cn({name:"sidebar-infoupdate",to:"na"},Pn),complete:Cn({name:"complete",to:"na"},Pn),resultLog:Cn({name:"result-log",to:"na"},Pn),clickLog:Cn({name:"click-log",to:"na"},Pn),launchSearch:Cn({name:"launch-search",to:"na"},Pn),openInput:Cn({name:"open-input",to:"na"},Pn),closeInput:Cn({name:"close-input",to:"na"},Pn),upperSearchbox:Cn({name:"upper-searchbox",to:"na"},Pn),photoQuestion:Cn({name:"open-camera",to:"na"},Pn),updataTag:Cn({name:"updata-tag",to:"na"},Pn),showImageEdit:Cn({name:"show-image-edit",to:"na"},Pn),chatSearchPageReady:Cn({name:"chat-search-page-ready"},Dn),chatSearchRecommendTplUpdate:Cn({name:"chat-search-recommend-tpl-update"},Dn),getGenerateCardSign:Cn({name:"get-generate-card-sign"},Dn),removeFold:Cn({name:"remove-fold"},Dn),exportFile:Cn({name:"export-file",to:"na"},Pn),updateSearchtips:Cn({name:"update-searchtips",to:"na"},Pn),updateGenerateInfo:Cn({name:"update-generate-info",to:"na"},Pn),generateStart:Cn({name:"generate-start",to:"na"},Pn),generateComplete:Cn({name:"generate-complete",to:"na"},Pn),errorOccur:Cn({name:"error-occur",to:"na"},Pn),abortProcess:Cn({name:"abort-process",to:"na"},Pn),loading:Cn({name:"loading",to:"na"},Pn),loadComplete:Cn({name:"load-complete",to:"na"},Pn),clickDownload:Cn({name:"click-download",to:"na"},Pn),multichatPagestatus:Cn({name:"multichat-pagestatus",to:"na"},Pn),goBack:Cn({name:"go-back",to:"na"},Pn),search:Cn({name:"search"},Dn),loadSlideToast:Cn({name:"load-slide-toast"},Dn,{strick:!0}),showGuideCard:Cn({name:"show-guide-card"},Dn,{strick:!0}),cardTypingComplete:Cn({name:"card-typing-complete"},Dn),cardContentFinished:Cn({name:"card-content-finished"},Dn),askDataInterflow:Cn({name:"ask-data-interflow",sticky:!0},Dn),operateCapsulesDataInterflow:Cn({name:"operate-capsule-data-interflow"},Dn),showFeedbackFormCard:Cn({name:"show-feedback-form-card"},Dn),receiveFirstChunk:Cn({name:"receive-first-chunk",to:"na"},Pn),hitDanger:Cn({name:"hit-danger"},Dn),feedbackPop:Cn({name:"feedback-pop"},Dn),stopConversation:Cn({name:"stop-conversation"},Dn),agentChange:Cn({name:"agent-change"},Dn),capsuleShow:Cn({name:"caosule-show"},Dn),openHalfScreenByUijson:Cn({name:"open-half-screen-by-uijson"},Dn),updateImageQuery:Cn({name:"update-image-query"},Dn),retryGenerate:Cn({name:"retry-generate"},Dn),fillerEmptyHeight:Cn({name:"filler-emtpy-height"},Dn),regenerate:Cn({name:"regenerate"},Dn),askDataSend:Cn({name:"ask-data-send"},Dn),agentTelHide:Cn({name:"agent-tel-hide"},Dn),adultCheckHide:Cn({name:"adult-check-hide"},Dn),asyncBubClick:Cn({name:"async-bub-click"},Dn),dialogPop:Cn({name:"dialog-pop"},Dn),dialogClick:Cn({name:"dialog-click"},Dn),h5UpperSearchbox:Cn({name:"upper-searchbox"},Dn),hoverRespond:Cn({name:"execute-h5-function"},Dn),deleteAgent:Cn({name:"delete-agent"},Dn),stopBottomAlign:Cn({name:"stop-bottom-align"},Dn),openCompositionEditor:Cn({name:"open-full-editor",to:"na"},Pn),updateInputBorder:Cn({name:"update-input-border",to:"na"},Pn),readyReply:Cn({name:"ready-reply",to:"na"},Pn),checkoutAiModel:Cn({name:"checkout-ai-model",to:"na"},Pn),updateModelList:Cn({name:"update-model-list",to:"na"},Pn),openExtendPanel:Cn({name:"open-extend-panel",to:"na"},Pn),sendSessionId:Cn({name:"session-info",to:"na"},Pn)},component:{chatToast:{},beforeLaunchConversation:{},beforeCreateNewGreet:{},imageQuerySelectedChange:{},imageQueryTabClicked:{},beforeCreateNewContext:{},ttsPlay:{},getHistoryStateChange:{},showHistoryTips:{},showPauseButton:{},historyRenderfinished:{},sharePopup:{},dialogChannel:{},loading:{},loginCancel:{},login:{},agentHintClick:{},showGoToBottom:{},questionGuide:{sticky:!0},beforeOpenAiCall:{},beforeRenderAiCallHistory:{},showGuide:{},sendTipsData:{sticky:!0},sendLoadingData:{sticky:!0},handleMindMapAction:{},handleWenkuAction:{},checkOutlineTitle:{},handlePptViewerPack:{},hitHintsDanger:{},handlePptDownloadAction:{},sendInputPanelData:{},openInputPanel:{},openInputUpload:{},showGuideBlankBox:{},showFindAgentIframe:{},getUpdatedSa:{},responseRisk:{},stopDsMarkdown:{},wiseInputFocus:{},showBottomTips:{sticky:!0},showLoginToast:{},showModelFunData:{}}},En=new URL(document.URL).searchParams.get("chatsearch_action_id"),On=function(){return(window.sc.eventBus||(window.sc.eventBus=window.sc.initEventBus({type:"chatjs",platform:"na",pageType:"result",channelId:En},An),window.sc.eventBus)).get()};function Rn(){return Rn=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Rn.apply(this,Array.from(arguments))}function Nn(){return On().conversation.cardTypingComplete}function qn(){return On().conversation.cardContentFinished}function Mn(){return On().conversation.hitDanger}function jn(){var t,e=On().conversation;return"pc"===rt()||ct()?e.h5UpperSearchbox:Rn({},e.upperSearchbox,{emit:(t=e.upperSearchbox.emit,function(e){for(var n=Array.from(arguments).length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=Array.from(arguments)[i];var o=["file","image","inputCustom"],r={};return Object.keys(e).forEach((function(t){o.includes(t)||(r[t]=e[t])})),t.apply(void 0,[].concat([r],a))})})}function Bn(){return On().component.chatToast}function Hn(){return On().component.beforeLaunchConversation}function $n(){return On().component.imageQuerySelectedChange}function Un(){return On().component.imageQueryTabClicked}function Fn(){return On().component.beforeCreateNewContext}function Gn(){return On().component.beforeCreateNewGreet}function Wn(){return On().component.getHistoryStateChange}function zn(){return On().component.historyRenderfinished}function Qn(){return On().component.beforeRenderAiCallHistory}function Jn(){return On().component.beforeOpenAiCall}function Vn(){return On().component.ttsPlay}function Kn(){return On().conversation.retryGenerate}function Xn(){return On().conversation.regenerate}function Yn(){return On().conversation.fillerEmptyHeight}function Zn(){return On().conversation.agentTelHide}function ta(){return On().conversation.adultCheckHide}function ea(){return On().conversation.photoQuestion}function na(){return On().component.sharePopup}function aa(){return On().conversation.showFeedbackFormCard}function ia(){return On().component.dialogChannel}function oa(){return On().component.loading}function ra(){return On().component.loginCancel}function sa(){return On().component.showPauseButton}function ca(){return On().component.agentHintClick}function la(){return On().component.showGoToBottom}function da(){return On().conversation.agentChange}function ua(){return On().conversation.capsuleShow}function pa(){return On().conversation.updateImageQuery}function ha(){return On().conversation.stopBottomAlign}function fa(){return On().component.showGuide}function ga(){return On().component.sendTipsData}function ma(){return On().component.showHistoryTips}function va(){return On().conversation.openHalfScreenByUijson}function ya(){return On().component.sendLoadingData}function ba(){return On().component.openInputPanel}function wa(){return On().component.sendInputPanelData}function _a(){return On().component.openInputUpload}function ka(){return On().component.showGuideBlankBox}function Sa(){return On().component.showFindAgentIframe}function xa(){return On().component.getUpdatedSa}function Ia(){return On().component.responseRisk}function Ta(){return On().component.stopDsMarkdown}function Ca(){return On().component.showBottomTips}function La(){return On().component.wiseInputFocus}function Pa(){return Pa=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pa.apply(this,Array.from(arguments))}var Da=ct();function Aa(t,e){var n=t.ubcId||"17132",a={page:t.page||"resultpage",from:"search",version:"2.0",useSendBeacon:!0,queryParams:{appname:Je.getState("isSearchCraft")?"searchcraft":"pc"===rt()?"pcsearch":"baiduboxapp"}},i=t.curLid,o=t.type,r=t.value,s=t.source,c=t.clk_result,l=t.info,d=t.page,u=t.ext,p={};e&&(p={query:e.query,qid:e.lid,tplname:e.tplname,srcid:e.srcid,order:e.order,sessionid:"lid["+(null==e?void 0:e.lid)+"]_si["+(null==e?void 0:e.srcid)+"]"});var h=Pa({},u,{clk_result:c,info:l,browser:"pc"===rt()?"pc":"baiduboxapp"},p,{is_plugin:ft()?1:0},Da&&{deepseek:1});"more"===t.value&&"click"===t.type&&(h.result_num=t.resultNum||0),"fold"===t.value&&(h.fold_result=t.fold),Je.getState("chatParams")&&Je.getState("chatParams").setype&&(h.setype=Je.getState("chatParams").setype,h.lid=i||h.lid),h.query&&(h.query=yt(h.query)),lt()&&(h.setype="ssaitab"),Tn(n+".init",n,a),Tn(n+".config",a),Tn(n+".event",{ext:h,type:o,value:r,source:s,page:d||"resultpage",useSendBeacon:1})}function Ea(t,e){t&&e&&Aa({ubcId:"18663",type:"",value:"page_duration",ext:Pa({enter_type:Je.getState("pcEnterType")||"ai_tab_url",a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),sa:Je.getState("oriSa"),starttime:String(t),endtime:String(e),duration:String(e-t),lid:Je.getState("lid"),re_rank:String(Je.getState("rank")),is_plugin:ft()?1:0},Da&&{deepseek:1})})}function Oa(){return Oa=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Oa.apply(this,Array.from(arguments))}var Ra="",Na=null;function qa(t){void 0===t&&(t={});var n=Je.getState("rank"),a=Je.getState("oriLid"),i=location.pathname,o={};try{o=JSON.parse(t.extParams||"{}")}catch(t){}if(i!==fe.CHAT.path||a||(null==o?void 0:o.ori_lid)!==a)if(0!==n||i!==fe.CHAT.path||a||(null==o?void 0:o.ori_lid)&&"his_middle"===(null==o?void 0:o.subEnterType)){Na&&(Na.dispose(),Na=null);var r=De(t);bn.router.push({path:fe.CHAT.path,query:Oa({},r)},{force:!0})}else e.Toast.show({message:"已经是最新对话了"});else e.Toast.show({message:"已在当前对话"})}bn.router.listen((function(t){var e=t.referrer;if(e){var n,a=Mt.parse(e);if(a.pathname===fe.CHAT.path&&t.path!==fe.CHAT.path)Ra=e,Na&&(null==(n=Na.el)||n.classList.add("chat-page-hide"));if(a.pathname===fe.CHAT.path&&t.path===fe.CHAT.path||a.pathname===fe.AGENT.path&&t.path===fe.AGENT.path){var i=bn.router.routeAlives[0];null==i||i.component.dispose(),i&&bn.router.routeAlives.splice(0,1)}}}));function Ma(){return Ma=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ma.apply(this,Array.from(arguments))}function ja(t,e,n,a){return void 0===e&&(e={}),void 0===n&&(n=500),void 0===a&&(a=!1),Promise.race([fetch(t,e).then((function(t){if(t.ok){var e=t.headers.get("Content-Type");return a&&e&&e.includes("text/html")?t.text():t.json()}return Promise.reject({status:-2})})),new Promise((function(t){return setTimeout((function(){return t({status:-9999})}),n)}))])}function Ba(t,e,n,a){void 0===e&&(e={}),void 0===n&&(n={}),void 0===a&&(a=500);var i=new URLSearchParams(e).toString();return ja(i?t+"?"+i:t,Ma({method:"GET"},n),a)}function Ha(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function $a(t){if(null===t)return t;var e,n=null;if(Array.isArray(t)){n=[];for(var a=0;a<t.length;a++)n[a]=$a(t[a]);return n}if("object"==(void 0===t?"undefined":(e=t)&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)){for(var i in n={},t)t.hasOwnProperty(i)&&(n[i]=$a(t[i]));return n}return Ha(t,Date)?((n=new Date).setTime(t.getTime()),n):Ha(t,RegExp)?n=new RegExp(t):t}function Ua(t,e){if(ye(t)||(t={}),!ye(e))throw new Error("obj must be object");var n=JSON.parse(JSON.stringify(t));return Object.keys(e).forEach((function(t){ye(e[t])?n[t]=Ua(n[t],e[t]):n[t]=e[t]})),n}window.addEventListener("new_chat",(function(t){var e=t.data||{},n=e.sessionId,a=e.enterType;qa({word:"百度AI助手",isShowHello:"1",pd:"csaitab",setype:"csaitab",extParams:JSON.stringify(Oa({},n?Oa({ori_lid:n,subEnterType:"his_middle"},a?{enter_type:a}:{}):{}))})}));var Fa=navigator.userAgent.toLowerCase(),Ga=Fa.includes("android"),Wa=/(iPhone|iPod|iPad)/gi.test(Fa),za=Fa.includes("baiduboxapp");function Qa(){return document.body.className.includes("darkmode")}function Ja(){return Ja=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ja.apply(this,Array.from(arguments))}function Va(){return On().container.inputStart}function Ka(){return On().container.inputCancel}function Xa(){return"pc"===rt()||ct()?On().conversation.deleteAgent:On().container.deleteAgent}function Ya(){return"pc"===rt()||ct()?On().conversation.search:On().container.search}function Za(){return On().conversation.search}function ti(){return"pc"===rt()||ct()?On().conversation.hoverRespond:On().container.longPressRespond}function ei(){return On().conversation.updateInputBorder}function ni(){return On().container.updateCapsule}function ai(t,e,n,a){var i,o,r=String((null==e||null==(i=e.errorInfo)?void 0:i.stack)||""),s=0;r&&(s=r.includes(Ut.FETCH_FAIL)?1:r.includes(Ut.FETCH_TIMEOUT_ERROR)?2:"error"===r?4:3);var c={conversationLogId:t,query:e.query,chatNum:e.chatNum,nextSearchTips:e.nextSearchTips||[],lid:e.lid,perfInfo:{paint_time:null==(o=e.perfInfo)?void 0:o.baseDataTime,fe_stage:e.perfInfo,fe_error_code:s,error_info:r,fe_ext:e.ext}};"invoke"===n&&On().conversation.complete.emit(c),"perf"===n&&0===s&&function(t,e){var n;void 0===e&&(e={});var a=t.perfInfo;if(!Je.getState("isDev")&&a){var i=(Je.getState("chatParams")||{}).setype||"other";tn.sendPerf({group:"chatsearch",info:Ve({request2RenderTime:+a.renderAfter-+a.renderStart,insertHtmlTime:+a.insertHtmlAfter-+a.insertHtmlBefore,parseHtmlTime:+a.parseHtmlAfter-+a.parseHtmlBefore,requestTime:+a.requestEnd-+a.requestStart,jsInsertTime:+a.insertJsAfter-+a.insertJsBefore,paintTime:(+a.generatingStartTime||+a.insertHtmlAfter)-t.startTimeList[t.chatNum]},t.naInjectTime?{naInjectTime:t.naInjectTime}:{}),dim:{type:"word",rank:1===t.chatNum?"first":"other",setype:i,entrance:e.entrance,isAgent:(null==(n=Je.getState("agentInfo"))?void 0:n.agentName)?"1":"0",isSync:Je.getState("isSync"),loadMode:1===t.chatNum?"1"===Je.getState("isSync")?"first_sync":"first_async":"non_first_async"}})}}(e,a)}function ii(t,e){if(void 0===e&&(e={}),"pc"!==rt()){var n=ts(t,e.startIndex,e.endIndex),a=n.prefix,i=n.suffix,o=n.keyword,r=a+i,s=t;o&&(s=""+a+o+" "+i);var c={csaitab:{content:s,timestamp:Date.now()}};if(e&&e.agentId){var l,d,u=function(t,e,n){void 0===n&&(n={});if(!t)return"";var a=/(_baiduboxapp=)([^&]*)/,i=t.match(a),o={from:""};if(i){var r=decodeURIComponent(i[2]);o=JSON.parse(r)}else o={from:""};return o.from=e,o=Kr({},o,n),t.replace(a,"$1"+encodeURIComponent(JSON.stringify(o)))}((null==(l=e.jumpUrl)?void 0:l.zbios)||(null==(d=e.jump_url)?void 0:d.zbios),ee.SIDEBAR);c.agent=Ja({},e,{content:r,timestamp:Date.now(),scheme:u})}On().conversation.sidebarUpdate.emit(c)}}function oi(){return On().component.handleMindMapAction}function ri(){return On().component.handleWenkuAction}function si(){return On().component.handlePptDownloadAction}function ci(){return On().component.checkOutlineTitle}function li(){return On().component.handlePptViewerPack}function di(){return On().component.hitHintsDanger}function ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function pi(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function hi(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){pi(o,a,i,r,s,"next",t)}function s(t){pi(o,a,i,r,s,"throw",t)}r(void 0)}))}}function fi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ui(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gi(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var mi=0,vi=!1,yi=40,bi=25,wi=200;function _i(){vi||(mi=document.documentElement.clientHeight,Va().on(Si.bind(this)),vi=!0)}var ki=hi((function(t){return gi(this,(function(e){return t.target.closest('#tagItemId[class*="category-item"]')||On().conversation.closeInput.emit({conversationLogId:Je.getState("conversationLogId")}),[2]}))}));function Si(t){for(var e,n=function(){var n=e.value;if(null==n?void 0:n.querySelector('span[class*="active"]'))return setTimeout(hi((function(){var e,a,o,r,s,c,l,d;return gi(this,(function(u){switch(u.label){case 0:if(e=Number(t.params.keyboardHeight)/i,a=Number(t.params.inputHeight||0)/i,o=n.getBoundingClientRect(),r=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,s=mi-document.documentElement.clientHeight>wi,c=s?document.documentElement.clientHeight:mi-e-a,!((l=document.documentElement.offsetHeight-o.bottom-r)<e+a)||s)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,document.body.animate([{marginBottom:"0px"},{marginBottom:e+a+yi+"px"}],{duration:10,fill:"forwards"}).finished];case 2:return u.sent(),[3,4];case 3:return u.sent(),document.body.style.marginBottom=e+a+yi+"px",[3,4];case 4:return setTimeout((function(){o=n.getBoundingClientRect(),window.scrollTo({top:r+o.bottom-c+bi,behavior:"smooth"})}),100),d=function(){if(l<e+a&&!s)try{document.body.animate([{marginBottom:e+a+yi+"px"},{marginBottom:"0px"}],{duration:200,fill:"forwards"})}catch(t){document.body.style.marginBottom=""}Ka().off(d)},Ka().on(d),n.addEventListener("click",ki),[2]}}))})),250),"break"},a=dn(Ft),i=Ga?window.devicePixelRatio:1,o=fi(a);!(e=o()).done;){if("break"===n())break}}var xi=a.defineComponent({trimWhitespace:"all",template:'\n        <div s-if="showDanger" class="cs-new-chat-tips">\n             <h3 s-if="showTitle" class="cs-new-chat-line">\n                <div class="new-chat-line new-chat-line-before"></div>\n                <div>新话题已开启</div>\n                <div class="new-chat-line new-chat-line-after"></div>\n            </h3>\n            <div class="cs-new-chat-bubble {{!showTitle ? \' new-chat-bubble-top\' : \'\'}}">\n                <div>\n                    <span>{{guideText}}</span>\n                </div>\n            </div>\n        </div>\n    ',initData:function(){return{showTitle:!0,queryIsDanger:"",showDanger:!1,rank:0,onlyOpenNewChat:!1,guideText:"让我们换个话题聊聊吧。"}},listenHitDanger:null,attached:function(){var t=this;this.data.get("onlyOpenNewChat")?setTimeout((function(){Dr({element:t.el,block:"start"})}),100):(this.watch("queryIsDanger",(function(e){"1"===e&&setTimeout((function(){t.data.set("showDanger",!0)}),100)})),this.listenHitDanger=function(e){e.rank===t.data.get("rank")&&"delete-rank-show-toast"!==e.type&&t.nextTick((function(){t.data.set("showDanger",!0)}))},Mn().on(this.listenHitDanger))},disposed:function(){this.listenHitDanger&&Mn().off(this.listenHitDanger),this.listenHitDanger=null}});function Ii(t){var e=t||(new Date).getTime();e=Li(e);var n=new Date(e),a=new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime(),i=new Date,o=new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime();return Math.floor((o-a)/864e5)}function Ti(t){t=t||(new Date).getTime();var e=new Date(t);return{year:e.getFullYear(),monthe:e.getMonth()+1,day:e.getDate(),week:e.getDay(),hour:e.getHours(),minute:e.getMinutes(),dayDiff:Ii(t)}}function Ci(t){return(t<10?"0":"")+t}function Li(t){return t<1e10?1e3*t:t}function Pi(t,e){return Pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pi(t,e)}var Di=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pi(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{timestamp:16832412e5}},n.attached=function(){},e}(a.Component);Di.components={},Di.computed={timestampText:function(){return function(t){if(!t)return"";var e=Ti(t),n=Ti(+new Date),a=e.year,i="星期";switch(e.week){case 1:i+="一";break;case 2:i+="二";break;case 3:i+="三";break;case 4:i+="四";break;case 5:i+="五";break;case 6:i+="六";break;case 0:i+="日"}var o=Ci(e.monthe),r=Ci(e.day),s=Ci(e.hour),c=Ci(e.minute);return Math.abs(e.year-n.year)>0?a+"-"+o+"-"+r+" "+s+":"+c:e.dayDiff>7?o+"-"+r+" "+s+":"+c:e.dayDiff>1?i+" "+s+":"+c:1===e.dayDiff?"昨天 "+s+":"+c:"今天 "+s+":"+c}(+this.data.get("timestamp"))}};var Ai={};Ai=Object.assign(Ai,{timestamp:"timestamp_4zha3_1"}),Di.template="\n    <div class=\"{{$style['timestamp']}}\">\n        {{timestampText}}\n    </div>\n";var Ei,Oi,Ri="function"==typeof Di?Di.prototype.initData||Ni:Di.initData||Ni;function Ni(){return{$style:Ai}}function qi(){return Object.assign({},Ri.call(this),{$style:Ai})}function Mi(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ji(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Mi(o,a,i,r,s,"next",t)}function s(t){Mi(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Bi(){return Bi=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Bi.apply(this,Array.from(arguments))}function Hi(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Di?Di.prototype.initData=qi:Di.initData=qi,function(t){t.SENDING="SENDING",t.WAITING="WAITING",t.GENERATING="GENERATING",t.COMPLETE="COMPLETE",t.ABORT="ABORT"}(Ei||(Ei={})),function(t){t.THINKING="0",t.PLUGIN="1",t.GENERATING="2",t.COMPLETE="3"}(Oi||(Oi={}));var $i=function(t){var e=this,n=this;this.useModel=je,this.permissionURI="/aichat/api/getModelPermission?tk="+$r(),this.getCurrentModel=function(){return e.botStore.getState("usedModel")},this.getUsableModel=function(){return e.botStore.getState("usableModel")},this.handleCheckPermission=function(t){return new Promise((function(n,a){fetch(e.permissionURI,{method:"post",credentials:"include",body:JSON.stringify({modelType:t})}).then((function(t){n(t.json())})).catch((function(t){a(t)}))}))},this.getGuideTip=function(){return e.useModel.guideTip},this.handleChangeModel=ji((function(t){var e,a,i,o,r,s,c,l,d,u;return Hi(this,(function(p){switch(p.label){case 0:if(e=t.modelName,a=t.hasModelPermissions,void 0===a||a)return[2,{usedModel:n.useModel.setUsedModel(t),usableModel:n.getUsableModel()}];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,n.handleCheckPermission(e)];case 2:return(i=p.sent())&&i.data?(o=i.data,s=(r=void 0===o?[]:o).find((function(t){return t.modelName===e})),c=s.hasModelPermissions,l=void 0!==c&&c,d=n.useModel.setUsableModel(r),n.useModel.showToast(d),l?(u=n.useModel.setUsedModel(t),[2,{usableModel:d,usedModel:u}]):[2,{usableModel:d,usedModel:n.getCurrentModel()}]):[3,4];case 3:return p.sent(),[2,{usableModel:n.getUsableModel(),usedModel:n.getCurrentModel()}];case 4:return[2,{usableModel:n.getUsableModel(),usedModel:n.getCurrentModel()}]}}))})),this.handleSelectModel=ji((function(t){var e,a,i,o,r;return Hi(this,(function(s){switch(s.label){case 0:return e=n.getUsableModel(),a=e.find((function(e){return e.modelName===(null==t?void 0:t.name)})),[4,n.handleChangeModel(a)];case 1:return(i=s.sent())&&(o=i.usedModel,r=i.usableModel,n.botStore.dispatch("update",{usedModel:o,usableModel:r})),[2]}}))})),this.refreshUsableModel=ji((function(){var t,e;return Hi(this,(function(a){switch(a.label){case 0:return[4,n.handleCheckPermission()];case 1:return(t=a.sent())&&t.data&&(e=t.data,n.botStore.dispatch("update",{usableModel:e})),[2]}}))})),this.handleChangeUsedModelStatus=function(t,n){var a=e.getCurrentModel(),i=e.getUsableModel();if(t===a.modelName){var o=Bi({},a,n);e.botStore.dispatch("update",{usedModel:e.useModel.setUsedModel(o)})}else{var r=i.find((function(e){return e.modelName===t}));if(r){var s=Bi({},e.useModel.setUsedModel(r),n);e.botStore.dispatch("update",{usedModel:e.useModel.setUsedModel(s)}),e.refreshUsableModel()}}},this.botStore=t},Ui=function(){var t=navigator.userAgent,e=[],n="";return(e=/([\d+.]+)_(?:diordna|enohpi)_/.exec(t))?(e=e[1].split("."),n=e.reverse().join(".")):((e=/baiduboxapp\/([\d+.]+)/.exec(t))||(e=/searchcraft\/([\d+.]+)/i.exec(t)))&&(n=e[1]),Ui=function(){return n},n};function Fi(t,e){e+="";for(var n=(t+="").split("."),a=e.split("."),i=Math.max(n.length,a.length),o=0;o<i;o++){if(n[o]&&!a[o]&&parseInt(n[o],10)>0||parseInt(n[o],10)>parseInt(a[o],10))return 1;if(a[o]&&!n[o]&&parseInt(a[o],10)>0||parseInt(n[o],10)<parseInt(a[o],10))return-1}return 0}function Gi(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Wi(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Gi(o,a,i,r,s,"next",t)}function s(t){Gi(o,a,i,r,s,"throw",t)}r(void 0)}))}}function zi(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Qi=function(t){var e=this,n=this;this.useModelData=He,this.permissionURI="/aichat/api/getModelPermission?tk="+$r(),this.getCurrentModel=function(){return e.botStore.getState("usedModel")},this.getModelList=function(){return e.botStore.getState("modelList")},this.showGuideList=["ERINE","DeepSeek"],this.checkLoginList=["ERINE-X1"],this.handleCheckPermission=function(t){return new Promise((function(n,a){fetch(e.permissionURI,{method:"post",credentials:"include",body:JSON.stringify({modelId:t})}).then((function(t){n(t.json())})).catch((function(t){a(t)}))}))},this.updateModelList=function(t){e.botStore.dispatch("update",{modelList:[].concat(t)})},this.updateUsedModel=function(t){var n={modelName:t.id,modelFunction:t.modelFunction};e.botStore.dispatch("update",{usedModel:n}),e.useModelData.setLocalModelData(n)},this.handleShowGuide=function(t){if(e.showGuideList.includes(t)){var n=e.botStore.getState("generateStatus");if(n&&n!==Oi.COMPLETE)return;var a=e.useModelData.getGuideShowData(t);a&&(Gn().emit(),On().component.showGuide.emit({multiRecommendWord:a,id:"init"}))}},this.updateModelListPermission=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=[]),t.map((function(t){var n=e.find((function(e){return t.id===e.id}));return n&&(t.hasPermission=n.hasPermission,t.enable=n.enable),t}))},this.handleChangeModel=Wi((function(t){var e,a,i,o,r,s,c,l,d,u,p;return zi(this,(function(h){switch(h.label){case 0:if(e=t.id,t.hasPermission&&e!==qe.ERINE)return a=n.getModelList(),a=n.useModelData.handleModelUi(a,e),n.updateModelList(a),n.updateUsedModel(t),n.handleShowGuide(e),[2,!0];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.handleCheckPermission(e)];case 2:return(i=h.sent())&&i.data&&(o=i.data,s=(r=void 0===o?[]:o).find((function(t){return t.id===e})),c=s.hasPermission,l=void 0!==c&&c,d=n.getCurrentModel(),u=l?e:d.modelName,p=n.getModelList(),p=n.updateModelListPermission(p,r),p=n.useModelData.handleModelUi(p,u),n.updateModelList(p),l)?(n.updateUsedModel(t),n.handleShowGuide(e),[2,!0]):[3,4];case 3:return h.sent(),[3,4];case 4:return[2,!1]}}))})),this.handleSelectModel=Wi((function(t){var e,a,i,o;return zi(this,(function(r){switch(r.label){case 0:if(e=n.getModelList(),!(a=e.find((function(e){return e.id===(null==t?void 0:t.id)}))))return[2,!1];if(!n.checkLoginList.includes(a.id))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ws()];case 2:return r.sent(),[3,4];case 3:return r.sent(),Bn().emit({text:"登录失败，请稍后再试"}),[2,!1];case 4:return[4,n.handleChangeModel(a)];case 5:return(i=r.sent())||Bn().emit({text:a.failText||me}),ut()&&Fi(Ui(),"15.7")>=0&&(o=i?t.id:n.botStore.getState("usedModel").modelName,On().conversation.updateModelList.emit({selectedId:o,modelList:e})),[2,i]}}))})),this.toggleInternetSearch=function(){var t=e.getCurrentModel(),n=e.getModelList(),a=n.find((function(e){return e.id===t.modelName}));a.modelFunction.internetSearch=a.modelFunction.internetSearch===ke.OPEN?ke.CLOSE:ke.OPEN,e.updateModelList(n),e.updateUsedModel(a)},this.toggleDeepThink=function(){var t=e.getCurrentModel(),n=e.getModelList(),a=n.find((function(e){return e.id===t.modelName}));a.modelFunction.deepThink=a.modelFunction.deepThink===Se.OPEN?Se.CLOSE:Se.OPEN,e.updateModelList(n),e.updateUsedModel(a)},this.botStore=t};function Ji(t){if("object"!==(void 0===t?"undefined":function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(t)))return t;var e={};return Object.keys(t).forEach((function(n){var a=n.replace(/_([a-z])/g,(function(t,e){return e.toUpperCase()}));e[a]=t[n]})),e}function Vi(t){if(!be(t)&&!ye(t))return t;var e=Array.isArray(t)?[]:{};return Object.keys(t).forEach((function(n){var a=n.replace(/_([a-z])/g,(function(t,e){return e.toUpperCase()}));e[a]=Vi(t[n])})),e}function Ki(t){return void 0===t&&(t=""),t.replace(/_([a-z])/g,(function(t,e){return e.toUpperCase()}))}var Xi=!1,Yi=!1,Zi=/^#.*#$/;function to(t,e){if(void 0===e&&(e=!1),e||!Xi&&t&&o.canIUse("search.getMultiTabBarInfo")&&!ct()){try{eo(t)}catch(t){console.error(t)}Xi=!0}}function eo(t){Xi=!0;var e=new URL(t),n=document.createElement("iframe"),a=e.searchParams.get("params"),i=JSON.parse(a),o=Fi(Ui(),"13.53.0")>=0;(!window.page.comm.isAndroid||window.page.comm.isAndroid&&o)&&(i.noUpdateTabList=1),e.searchParams.set("params",JSON.stringify(i)),n.style.display="none",n.src=e.toString(),document.body.appendChild(n),setTimeout((function(){document.body.removeChild(n)}),0)}function no(){Je.getState("iosSlipPrefetchEnable")&&!Yi&&(Yi=!0,On().conversation.receiveFirstChunk.emit({prefetch_confirm_url:""}))}function ao(t,e){if(!ct()){var n=yt(e||Je.getState("query"));if(!n||Zi.test(n)){if(Xi)return;e=Jt}var a=Hr(e||Je.getState("query")||Jt,!0),i=a.data,o=a.headers;i.mod=1,i.isShowHello=1;var r="/s?"+Ot(i);fetch(r,{headers:o}).then((function(t){return t.ok?t.text():Promise.reject({status:-2})})).then((function(e){var n=document.createElement("div");n.innerHTML=e;var a=pn(n.querySelector("#NATab"),"src");a&&to(a,t)}))}}function io(t){if(Je.getState("isWiseNewCsaitab")&&o.canIUse("search.getMultiTabBarInfo")&&!ct()){var e;if(t=yt(t||Je.getState("query")).trim(),void 0===(e=t)&&(e=""),!(t=e.replace("？","?").replace("，",","))||Zi.test(t)){if(Xi)return;t=Jt}var n=Je.getState("tabData"),a=n.logUrl,i=n.showTabCount,r=n.showTagCount,s=n.hasSearchTag,c=n.data,l=n.logParams,d=n.lid,u=Je.getState("user"),p={query:t||Jt,data:[],logParams:{},logUrl:a,showTabCount:i,showTagCount:r||4,hasSearchTag:s||!1};Array.isArray(c)&&c.forEach((function(e,n){var a=e.link,i=e.text,o=e.pd,r=e.ct,s=e.cst,c=e.log,h=e.select,f=e.nadegrate,g=e.source,m=e.productid,v=e.common,y=void 0===v?{}:v,b=e.tagImg,w={title:i||"",url:null==a?void 0:a.replace("word=","word="+encodeURIComponent(t)),pd:o};if(b&&(w.tagImg=b),f&&(w.naDegrate=f),g&&(w.source=g),m&&(w.productId=m),"ps"===c&&(w.isSearch=1),1===h&&(w.isSelected=1,p.logParams={tcreq4log:1,ssid:l.ssid,from:l.from,bd_page_type:1,uid:u.uid||"0",pu:l.pu,baiduid:(null==u?void 0:u.baiduid)||"",ref:l.ref,w:l.pn+"_"+l.rn+"_"+t,ct:r,cst:s,pos:n,lid:d||Je.getState("lid"),anchorTime:Math.round((new Date).getTime()/1e3),clk_info:{type:"vs_tab",applid:l.applid}}),e.pd){var _=e.vs?e.vs:"https://m.baidu.com/sf/vsearch?pd="+e.pd+"&tn=vsearch";e.args&&(_+="&"+e.args),_+="&word=",w.vs=_}Object.keys(y).forEach((function(t){w[t]=y[t]})),p.data.push(w)})),eo("baiduboxapp://searchframe/multiTabBarInfo?params="+encodeURIComponent(JSON.stringify(p)))}}function oo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function ro(){return ro=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ro.apply(this,Array.from(arguments))}function so(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return oo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oo(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var co=function(){function t(){this.RANK_ANSWER_BOX=".answer-box",this.SHOW_AREA="[data-show-area]",this.SUBPOS_SHOW_EXT="data-show-ext",this.NEED_SHOW_LOG="need-show-log",this.BASE_SHOW_EXT="data-show-log",this.subPosList=[],this.areaDataList=[],this.init()}var e=t.prototype;return e.addEle=function(t){var e=this;(t&&t.dom?this.getSubPosList([t.dom]):this.getSubPosList(this.areaDataList)).forEach((function(t){var n;t.dom.dataset.observered?e.subPosList=e.subPosList.map((function(e){return e.dom===t.dom?t:e})):(null==(n=e.subPosObserver)||n.observe(t.dom),t.dom.dataset.observered=!0,e.subPosList.push(t))}));for(var n=0;n<this.subPosList.length;n++){var a=this.subPosList[n].dom;a&&a.closest("body")||this.subPosList.splice(n,1)}},e.init=function(){var t=this;this.startSubPosObserver(),window.addEventListener("unload",(function(){return t.destroy()})),this.updateListenDom()},e.updateListenDom=function(){var t=this;new MutationObserver((function(e){for(var n,a=so(e);!(n=a()).done;){var i=n.value;i.addedNodes&&i.addedNodes.length>0&&1===i.addedNodes[0].nodeType&&i.addedNodes[0].hasAttribute("data-show-area")&&(!i.addedNodes[0].hasAttribute(t.NEED_SHOW_LOG)||"true"===i.addedNodes[0].getAttribute(t.NEED_SHOW_LOG))&&(t.areaDataList.push(i.addedNodes[0]),t.addEle({dom:i.addedNodes[0]}))}})).observe(document.body,{childList:!0,subtree:!0})},e.destroy=function(){this.subPosObserver&&this.subPosObserver.disconnect()},e.forceTrigger=function(t){this.subPosObserver.unobserve(t),this.subPosObserver.observe(t)},e.startSubPosObserver=function(){var t=this;this.subPosObserver=new IntersectionObserver((function(e){e.forEach((function(e){e.intersectionRatio>=.6&&t.subPosList.forEach((function(t){if(t.dom===e.target){var n=t.ubcId,a=t.page,i=t.source;Aa(ro({type:"show",value:t.value},n?{ubcId:n}:{},a?{page:a}:{},i?{source:i}:{},{ext:ro({},t,{valueInfo:Array.isArray(t.valueInfo)?t.valueInfo:[t.valueInfo],agent_id:t.agentId,agent_name:t.agentName,guide_word_type:t.guideWordType})}))}}))}))}),{threshold:[.4,.6]})},e.getAreaDataList=function(){return document.querySelectorAll(this.SHOW_AREA)},e.getSubPosList=function(t){var e=this,n=[];return t.forEach((function(t){var a,i=null==t||null==(a=t.parentNode)?void 0:a.querySelectorAll("["+e.SUBPOS_SHOW_EXT+"]");i&&i.length&&i.forEach((function(t){var a=e.getSubPosInfo(t);(a=De(a)).value&&n.push(ro({dom:t},a))}))})),n},e.getSubPosInfo=function(t){if(!t)return{};var e={},n=null,a=null,i=void 0,o=void 0,r=void 0;try{var s=t.getAttribute(this.SUBPOS_SHOW_EXT);n=JSON.parse(s);var c=t.closest("["+this.BASE_SHOW_EXT+"]");if(c){var l=c.getAttribute(this.BASE_SHOW_EXT);a=l&&JSON.parse(l)}}catch(t){n=null}return n&&(e=n.component_content||{},i=n.agent_id||(null==a?void 0:a.agent_id),o=n.agent_name||(null==a?void 0:a.agent_name),r=n.guide_word_type),ro({valueInfo:e,agentId:i,agentName:o,guideWordType:r,ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid")},a,n)},e.updateTransDom=function(){var t=this;document.querySelectorAll("[data-show-area]").forEach((function(e){t.areaDataList.includes(e)||e.hasAttribute(t.NEED_SHOW_LOG)&&"true"!==e.getAttribute(t.NEED_SHOW_LOG)||(t.areaDataList.push(e),t.addEle({dom:e}))}))},e.deleteTransDom=function(t){this.areaDataList.includes(t)&&(this.areaDataList=this.areaDataList.filter((function(e){return e!==t})),this.subPosList=this.subPosList.filter((function(e){return e.dom!==t})),t.dataset.observered="",this.subPosObserver.unobserve(t))},t}(),lo=new co;function uo(t){lo.addEle(t)}function po(){lo.updateTransDom()}function ho(t){return 0===t.indexOf("https://pan.baidu.com/s/")}var fo=function(t){return!t||!Object.keys(t).length};function go(){return go=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},go.apply(this,Array.from(arguments))}var mo=null,vo=navigator.userAgent,yo=/baiduboxapp\/([\d.]+)/i;function bo(t){var e=t.url;"replace"===t.type?window.location.replace(e):window.open(e,"_blank")}function wo(t,e,n){var a,i;if("object"==(void 0===t?"undefined":(i=t)&&"undefined"!=typeof Symbol&&i.constructor===Symbol?"symbol":typeof i))if("_drawer"!==(null==t?void 0:t.target)){var r=(null==(a=e.env)?void 0:a.platform)||"";switch(vo&&yo.test(vo)&&(r="na"),r){case"pc":bo({url:t.pcUrl||t.url,type:t.h5JumpType});break;case"na":var s;if(t.easyBrowser&&o.canIUse("easyBrowser.open")){o.easyBrowser.open(go({},t.easyBrowser,{fail:function(e){bo({url:t.url,type:t.h5JumpType})}}));break}if(t.deeplink){o.canIUse("ad.deeplink")?o.ad.deeplink({webUrl:"baiduboxapp://v1/easybrowse/open?newbrowser=1&append=1&url="+encodeURIComponent(t.url),appUrl:t.deeplink}):bo({url:t.url,type:t.h5JumpType});break}if(null==(s=t.swan)?void 0:s.appKey)return void function(){if(mo)return mo;var t=document.createElement("script");return t.type="text/javascript",t.src="https://b.bdstatic.com/searchbox/icms/searchbox/js/swanInvoke.js",document.body.appendChild(t),mo=new Promise((function(e){return t.onload=function(){e(!0)}}))}().then((function(){var e,n,a,i,o=(null==(e=t.swan)?void 0:e.query)?(null==(n=t.swan)?void 0:n.path)+"?"+(null==(a=t.swan)?void 0:a.query):null==(i=t.swan)?void 0:i.path;window.swanInvoke({appKey:t.swan.appKey,path:o})}));if(ho(t.url)&&o.canIUse("netdisk.gotoPanLinkPage"))return void o.netdisk.gotoPanLinkPage({panLink:t.url,ubcSource:"ai_assistant",fail:function(){bo({url:t.url,type:t.h5JumpType})}});bo({url:t.url,type:t.h5JumpType});break;default:bo({url:t.url,type:t.h5JumpType})}}else{var c=t.percent,l=t.title,d=t.url,u=n.type,p=n.renderContextId;va().emit({rank:p,halfScreenData:{percent:c,title:l,url:d,type:u}})}else console.error("跳转失败：LinkApiParams 参数错误")}var _o=null,ko={link:function(t,e){return wo(t,_o,e)},showToast:function(t){Bn().emit({text:t})},request:function(t,e){void 0===e&&(e=500);var n=t.options,a=t.url,i=a,o=n||{},r=o.data,s=void 0===r?"":r,c=o.method;if(s)if("GET"===(void 0===c?"GET":c)){var l=new URLSearchParams(s).toString();i=l?a+"?"+l:a}else n.body=JSON.stringify(s),n.headers["Content-Type"]="application/json";return ja(i,n,e)}},So=function(t){_o=t},xo=function(){return ko};function Io(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function To(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Io(o,a,i,r,s,"next",t)}function s(t){Io(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Co(){return Co=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Co.apply(this,Array.from(arguments))}function Lo(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Po=!1,Do=new Map,Ao=[];function Eo(){if(!Po){var t={type:"chat-view",platform:"pc"===rt()?"pc":"wise"},e={apis:xo(),env:t};So(e),s.sdk.init({env:t,showProgress:!0,apis:xo()}),Po=!0}}function Oo(t){Eo();var e=(null==t?void 0:t.pluginInfo)||[],n=null==t?void 0:t.agentId;Array.isArray(e)&&e.forEach((function(t){if(Array.isArray(t.components)){var e=t.components,a=[];if(e.forEach((function(t){var e={};try{e=JSON.parse(t.component_desc)}catch(t){e={}}if(e.moduleId&&!Ao.includes(e.moduleId)){var n=Co({resourceUrl:t.component_address||""},e);a.push(n)}})),0!==a.length&&n&&!Do.get(n)){var i=s.sdk.loadResource(a);Do.set(n,i)}}}))}function Ro(t){return new Promise(To((function(e,n){var a,i,o,r,s,c;return Lo(this,(function(l){switch(l.label){case 0:(a=null==t?void 0:t.agentId)||e(1),l.label=1;case 1:return l.trys.push([1,5,,6]),(i=Do.get(a))?[4,i]:[3,3];case 2:return 0===(o=l.sent()).failedAssistants.length?(r=Ao.concat(o.successfulAssistants.map((function(t){return t.moduleId}))),s=new Set(r),Ao=Array.from(s),Do.delete(a),e(1)):n("render assistant failed"),[3,4];case 3:e(1),l.label=4;case 4:return[3,6];case 5:return c=l.sent(),n(c),[3,6];case 6:return[2]}}))})))}function No(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function qo(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Mo(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){qo(o,a,i,r,s,"next",t)}function s(t){qo(o,a,i,r,s,"throw",t)}r(void 0)}))}}function jo(){return jo=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},jo.apply(this,Array.from(arguments))}function Bo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return No(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?No(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ho(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var $o,Uo="";function Fo(t){Uo||(Uo=t)}!function(t){t[t.NORMAL=0]="NORMAL",t[t.LOADING=1]="LOADING",t[t.FAIL=2]="FAIL",t[t.NOMORE=3]="NOMORE",t[t.SUCCESS=4]="SUCCESS"}($o||($o={}));var Go="拉取历史失败",Wo="pc"===rt();function zo(t){Aa({type:"show",value:t,ext:{setype:"csaitab"}})}function Qo(t){void 0===t&&(t={});var e=Je.getState("chatParams")||{},n=Je.getState("oriLid"),a=Je.getState("pn");return{data:jo({},t.reqType?{req_type:t.reqType}:{},{from:"chat_search",sge_lid:e.sge_lid,token:$r(),pn:a,rn:oe,search_before_lid:Uo,landingPageSwitch:Je.getState("landingPageSwitch"),landingPage:ct()?"deepseek":"aitab",cur_ori_lid:n||Uo,deepseek:ct()?1:0})}}function Jo(){return Fi(Ui(),"15.5")>=0&&!dt()&&!lt()}function Vo(t){var n=t.status,a=t.isEmpty;t.data;var i=t.length,o=t.options,r=void 0===o?{}:o,s=r.appendRender,c=r.isAiCall;if(0!==n)return c?void oa().emit(!1):(Wn().emit({state:2,appendRender:s}),Je.dispatch("update",{isHistoryLoading:!1}),void zo("refresh_fail"));if(a){var l=Je.getState("pn");return Wo&&0===l?(e.Toast.show({message:Go}),qa({isShowHello:"1",extParams:JSON.stringify({enter_type:"sidebar_dialog"})})):Jo()&&0===l&&!c&&(e.Toast.show({message:Go}),qa({word:"百度AI助手",isShowHello:"1",pd:"csaitab",setype:"csaitab",extParams:JSON.stringify({enter_type:"new_chat"})})),c?void oa().emit(!1):(Wn().emit({state:3,appendRender:s}),Je.dispatch("update",{isHistoryLoading:!1}),void zo("refresh_nomore"))}if(Wn().emit({state:4,appendRender:s}),zo("refresh_succ"),!s){var d=Je.getState("pn");Je.dispatch("update",{pn:d+1})}if(c){var u=Je.getState("rank");Je.dispatch("update",{rank:u+i}),Qn().emit()}else{if(!Wo){var p=Je.getState("topRank");Je.dispatch("update",{topRank:p-i})}s&&Je.dispatch("update",{rank:1})}zn().on((function(t){var e=t.initShowHistory,n=t.isAiCall;e&&ai(Je.getState("conversationLogId"),{lid:"",query:yt(Je.getState("query")),chatNum:1,perfInfo:{baseDataTime:String(Date.now())},startTimeList:Je.getState("startTimeList"),naInjectTime:Je.getState("naInjectTime")},"invoke",{});setTimeout((function(){var t=Je.getState("pn"),a=Jo()||Wo;if(!e&&function(t){void 0===t&&(t="top");_r.showHistory(t)}(a&&1===t?"bottom":"top"),po(),Je.dispatch("update",{isHistoryLoading:!1}),n){var i=un('.cs-rank-container[rank="'+Je.getState("rank")+'"]'),o=un(".capsules-box");i&&Dr({element:i,block:"end",margin:o?53:8,behavior:"instant"})}}),50)}),{once:!0})}function Ko(t){return Xo.apply(this,Array.from(arguments))}function Xo(){return Xo=Mo((function(t){return Ho(this,(function(e){return[2,new Promise((function(e){ja(t,{},1e4,Wo).then((function(t){e(Wo?t||"":(null==t?void 0:t.singCardContent)||"")})).catch((function(){e("")}))}))]}))})),Xo.apply(this,Array.from(arguments))}var Yo=["questionClosely","input","searchingSteps","askBack","agentRec","shortcuts"],Zo=["thinkingSteps"],tr=["base-clue-form"],er=["markdown","markdown-yiyan","markdown-hamburg"],nr=["writing","officeWriting"],ar='[authority-title](javascript:void(0)){type="authority"} ';function ir(t,e,n){var a=!1,i=[],o=!1,r={},s=!1,c=1,l={},d={sessionId:"",deleteQidList:[]},u=[],p="",h=Je.getState("isShowHello"),f=n||h?function(t){var e=new Set(["questionClosely","askBack"]);return t.reduce((function(t,n){var a,i=null==n||null==(a=n.data.message.content)?void 0:a.generator;if(i)for(var o,r=Bo(i);!(o=r()).done;){var s=o.value;if(e.has(null==s?void 0:s.component)){t.push({data:{content:{generator:s}}});break}}return t}),[])}(t):[],g=t.map((function(t){var n,h,f,g,m,v;(null==t||null==(n=t.data.message.content)?void 0:n.shareId)&&(r.shareId=null==t||null==(v=t.data.message.content)?void 0:v.shareId);var y=null==t||null==(h=t.data.message.content)?void 0:h.generator;l=null==t||null==(f=t.data.message.content)?void 0:f.hints;var b,w,_,k=null==(m=t.data.message.content.agentInfo)||null==(g=m.agentMeta)?void 0:g[0],S="",x=[],I=null;if((null==t?void 0:t.sessionId)&&!d.sessionId&&(d.sessionId=t.sessionId),e&&(null==t?void 0:t.qid)&&Fo(t.qid),(null==t?void 0:t.qid)&&!d.deleteQidList.includes(t.qid)&&d.deleteQidList.push(t.qid),k&&k.agentName&&k.logo){var T,C,L=Wo?null==k||null==(T=k.jumpUrl)?void 0:T.h5:null==k||null==(C=k.jumpUrl)?void 0:C.zbios;b=k.agentName,w=L,_=k.logo,S="["+b+"]("+(w=w||"javascript:void(0)")+'){type="agent" src="'+_+'"}'}var P=!1,D=[];return null==y||y.forEach((function(t){var e,n;t.sectionId&&(s=!0);var i=t.component;if(i){var r,l;if("uiMeta"===t.dataType&&(I=t),"chatForm"===i&&(t.data.isHistory=!0),!o&&t.hideAlaCard&&(o=t.hideAlaCard),I&&"uiData"===t.dataType)return I.data.historyUiData||(I.data.historyUiData=[]),tr.includes(null==I||null==(l=I.data)||null==(r=l.component)?void 0:r.type)?void(I.data={}):void I.data.historyUiData.push(t.data);if(!Yo.includes(i)&&(!Zo.includes(i)||Wo)){var d;if(t.data&&(t.data.backgroundImage||(null==(e=t.data)?void 0:e.bgLinearGradient)))t.bgProps={backgroundImage:t.data.backgroundImage,backgroundImageDark:t.data.backgroundImageDark,bgLinearGradient:null==(d=t.data)?void 0:d.bgLinearGradient};var h=null==t?void 0:t.authorityInfo,f=ar,g=er.includes(i);h&&h.title&&g&&(f=f.replace("authority-title",h.title),t.data.value=f+t.data.value),S&&!P&&0===x.length&&(P=!0,g?(p+="transform: translateY(calc((var(--font-size-scale)*-4px)));",t.data.value=S+t.data.value):u.push({component:"markdown",data:{value:S,type:"entry"}}));var m=a?D:x;if(-1!==nr.indexOf(i)&&m.length>0&&m[m.length-1].component===i)return m[m.length-1].data.content=m[m.length-1].data.content||"",m[m.length-1].data.content+=t.data.content||"",m[m.length-1].data.typing=null,void(m[m.length-1].data.isEnd=t.data.isEnd);if(1===(null==(n=t.data)?void 0:n.isIndependenGuide))a=!0;else if(a)return void D.push(t);g&&x.length>0&&x[x.length-1].component===i?s&&c!==t.sectionId?(x.push(t),c=t.sectionId):x[x.length-1].data.value+=t.data.value:(t.agentInfo=k,g&&!t.data.value||x.push(t))}}})),D.length&&i.push(D),[].concat(u,x)}));return{blocksList:g=g.filter((function(t){return t&&t.length>0})),hints:l,independenBlocks:i,hideAlaCard:o,shareParams:JSON.stringify(r),deleteParams:JSON.stringify(d),aiEntryStyle:p,isSeparateBub:s,historyAskMessage:f}}function or(t){var e=t.question,n=t.appendRender,a=t.isAiCall,i=Je.getState("syncTabData");if(n&&!a){var o,r;Je.dispatch("update",jo({query:null===e?Jt:e[0].data.question.question,agentQuery:null===e?"":e[0].data.question.agentQuery},e&&(null==(o=e[0])?void 0:o.data.agentInfo)?{agentInfo:e[0].data.agentInfo}:{}));var s=e&&"text"!==(null==(r=e[0])?void 0:r.type)?Jt:"";Je.getState("isWiseNewCsaitab")?io(s):ao(!0,s)}else if(n&&a&&i&&e){var c,l=null==(c=e[0].data.question)?void 0:c.question;Je.getState("isWiseNewCsaitab")?io(l):ao(!0,l)}}function rr(t){var e=t.mmsQuery,n=t.query,a=t.createTime,i=t.reRank,o=t.agentInfo,r=t.appendRender,s=t.isAiCall;if(null!==n){var c=function(t){var e,n=(null==t?void 0:t.agentMeta)&&t.agentMeta[0],a=(null==t?void 0:t.agentId)&&t.agentId[0];if(n&&a){var i={agentId:null==n?void 0:n.agentId,agentName:null==n?void 0:n.agentName,agentSearchId:a||"",description:null==n?void 0:n.description,startIndex:0,endIndex:(null==n||null==(e=n.agentName)?void 0:e.length)||0,guides:[],jumpUrl:null==n?void 0:n.jumpUrl,logo:null==n?void 0:n.logo,pluginInfo:null==n?void 0:n.pluginInfo};return Oo(i),i}}(o),l="",d="",u=[],p=null,h=[];Array.isArray(n)&&n.forEach((function(t){var e=t.data;switch(t.type){case"TEXT":l+=e.text.query,d+=e.text.text_type,p||(p=t,h.push(p)),p.data.text.query=l,p.data.text_type=d;break;case"IMAGE":u.push(e.image);break;case"FILE":h.push(t)}})),u.length&&h.push({type:"IMAGE",data:{image:u}});var f=(Array.isArray(n)?h:[n]).map((function(t,n){var o,s;return function(t){var e,n,a,i=t.queryInfo,o=t.reRank,r=t.text_type,s=t.agentInfoResult,c=t.createTime,l=t.mmsQuery,d=t.index,u=t.appendRender,p={type:"text",data:{question:{mmsQuery:l,hisRank:o,text_type:r,question:"",createTime:c,reRank:o,agentQuery:(null==(n=i.data)||null==(e=n.text)?void 0:e.query)||""},isHistory:!0,initShowHistory:u,agentInfo:s}},h=p.data.question;return"string"==typeof i?(p.type=l?"image":"text",h.question=l?l.value:i,p):"TEXT"===i.type?(h.hisRank=0===d?h.hisRank:0,h.question="pc"!==rt()&&!Je.getState("isWiseNewCsaitab")&&s?"@"+s.agentName+i.data.text.query:i.data.text.query,p):"IMAGE"===i.type?(p.type="image",h.hisRank=0===d?h.hisRank:0,h.question=null==(a=i.data.image)?void 0:a.map((function(t){return Ji(t)})),p):"FILE"===i.type?(p.type="file",h.question=i.data.file?Ji(i.data.file):{},p):void 0}({queryInfo:t,reRank:i,text_type:(null==(s=t.data)||null==(o=s.text)?void 0:o.text_type)||"",agentInfoResult:c,createTime:a,mmsQuery:e,index:n,appendRender:r})}))||{};return or({question:f,appendRender:r,isAiCall:s}),f}or({question:n,appendRender:r,isAiCall:s})}function sr(t){return cr.apply(this,Array.from(arguments))}function cr(){return cr=Mo((function(t,e){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_,k,S,x,I,T,C,L,P,D,A,E,O,R,N,q,M,j,B,H,$,U;return Ho(this,(function(F){switch(F.label){case 0:return void 0===e&&(e={}),d=e.fetchCard,u=void 0===d||d,p=e.appendRender,h=e.isAiCall,f=t.chatResponse||[],g=rr({mmsQuery:t.mmsQuery,query:t.query,text_type:t.text_type,createTime:t.createTime,reRank:t.reRank,agentInfo:null==(o=f[0])||null==(i=o.data)||null==(a=i.message)||null==(n=a.content)?void 0:n.agentInfo,appendRender:p,isAiCall:h}),m=Je.getState("rank"),v=Je.getState("topRank"),(Wo||Jo())&&+(null==t?void 0:t.reRank)>+m&&(Je.dispatch("update",{rank:+t.reRank,curRankInfo:{rank:+t.reRank},qaPairIdDiff:+t.reRank}),b=null==(y=f[0])?void 0:y.useModel,Jo()&&b&&new Qi(Je).handleSelectModel({id:b})),Wo&&+t.reRank<+v&&Je.dispatch("update",{topRank:+t.reRank}),w="",_=!1,k=ir(f,p,h),S=k.blocksList,x=k.independenBlocks,I=k.hideAlaCard,T=k.shareParams,C=k.deleteParams,L=k.hints,P=void 0===L?{}:L,D=k.aiEntryStyle,A=k.isSeparateBub,E=k.historyAskMessage,(O=null==(l=f[0].data)||null==(c=l.message)||null==(s=c.content)||null==(r=s.alaCards)?void 0:r.url)&&!I&&u?[4,Ko(O)]:[3,2];case 1:w=F.sent(),_=!0,F.label=2;case 2:p&&oa().emit(!1),R=[],N=Bo(S),F.label=3;case 3:if((q=N()).done)return[3,13];M=q.value,j=[],B=Bo(M),F.label=4;case 4:if((H=B()).done)return[3,11];if("uijson"!==($=H.value).component)return[3,9];F.label=5;case 5:return F.trys.push([5,7,,8]),[4,Ro($.agentInfo)];case 6:return 1===F.sent()&&j.push($),[3,8];case 7:return F.sent(),[3,8];case 8:return[3,10];case 9:j.push($),F.label=10;case 10:return[3,4];case 11:R.push(j),F.label=12;case 12:return[3,3];case 13:return U=!1,_?function(t){if(!t)return!1;var e=document.createElement("div");return e.innerHTML=t,"pc"===rt()?!!e.querySelectorAll(".result-op[tpl],.result[tpl]").length:!!e.querySelector(".se-page-bd")&&e.querySelectorAll(".c-result:not([tpl=ai_index])").length}(w)||(U=!0):I&&S.length||(U=!0),ft()&&(U=!0,P.parts||(P.parts=[{text:""}]),P.parts[0].text="暂不支持此类历史消息展示，请到网页版查看"),[2,{question:g,answer:{blocksList:R,independenBlocks:x,cardHtml:w,shareParams:T,deleteParams:C,initShowHistory:p,aiEntryStyle:D,isSeparateBub:A,hints:U?P:{},historyAskMessage:E,isAiCall:h}}]}}))})),cr.apply(this,Array.from(arguments))}var lr=St.connect(Je,{user:"user"})(a.defineComponent({components:{"answer-timestamp":Di},computed:{tipText:function(){var t=this.data.get("loadingText"),e=this.data.get("loadingFailText"),n=this.data.get("noMoreText");switch(this.data.get("loadState")){case 1:return t;case 2:return e;case 3:return n;default:return""}},historyLineText:function(){var t=this.data.get("user.isUserLogin"),e=this.data.get("showTimestamp"),n=this.data.get("isHeader");return t||!n?"以上为历史消息":e?"登录后查看更多历史消息":"登录后查看历史消息"}},initData:function(){return{showHistoryLine:!1,isHistoryLine:!0,loadingText:"正在加载...",loadingFailText:"加载失败，请重试",noMoreText:"没有更多消息了",loadState:0,scrollToHeader:!1,createTime:+new Date,showTimestamp:!1,isPulldownLoading:!1,listenRenderfinished:!1,isPulldown:!1,moveState:"",isHeader:!0,isPc:"pc"===rt()}},listenBeforeCreateNewContext:null,attached:function(){var t=this;this.data.get("scrollToHeader")&&this.nextTick((function(){Dr({element:t.el,block:"start"})})),this.listenBeforeCreateNewContext=function(e){void 0===e&&(e={}),!e.agentGuide&&t.data.set("showTimestamp",!0)},Fn().on(this.listenBeforeCreateNewContext),this.data.get("isPulldownLoading")&&this.listenHistoryStateChange(),this.data.get("listenRenderfinished")&&this.listenRenderfinished()},listenHistoryRenderFinished:null,listenRenderfinished:function(){var t=this;this.listenHistoryRenderFinished=function(e){e.initShowHistory?t.listenRenderfinished():t.data.set("listenRenderfinished",!1)},zn().on(this.listenHistoryRenderFinished,{once:!0})},listenGetHistoryStateChange:null,listenShowHistoryTips:null,listenHistoryStateChange:function(){var t=this,e=this.data.get("isPc"),n=Jo();e||n||this.nextTick((function(){Or({type:"historyTips",data:{isHistoryLine:!0,loadState:0,scrollToHeader:!1,isPulldownLoading:!1,showTimestamp:t.data.get("showTimestamp"),listenRenderfinished:!0,isHeader:!1,showHistoryLine:!0}},"ahead")})),this.listenGetHistoryStateChange=function(e){var n=e.state;if(e.appendRender)n===$o.NOMORE&&(Je.dispatch("update",{pulldownDisabled:!0}),t.data.set("showHistoryLine",!1));else{if(t.data.set("isPulldown",!0),n===$o.SUCCESS)return zn().on((function(){t.setLoadState($o.NORMAL)}),{once:!0}),void(t.data.get("isHistoryLine")&&t.data.set("isHistoryLine",!1));t.setLoadState(n),n!==$o.FAIL&&n!==$o.NOMORE||setTimeout((function(){t.setLoadState($o.NORMAL)}),2e3)}},Wn().on(this.listenGetHistoryStateChange),this.listenShowHistoryTips=function(e){var n=e.showHistoryLine;t.data.set("showHistoryLine",n)},ma().on(this.listenShowHistoryTips)},disposed:function(){this.listenBeforeCreateNewContext&&(Fn().off(this.listenBeforeCreateNewContext),this.listenBeforeCreateNewContext=null),this.listenHistoryRenderFinished&&(zn().off(this.listenHistoryRenderFinished),this.listenHistoryRenderFinished=null),this.listenGetHistoryStateChange&&(Wn().off(this.listenGetHistoryStateChange),this.listenGetHistoryStateChange=null),this.listenShowHistoryTips&&(ma().off(this.listenShowHistoryTips),this.listenShowHistoryTips=null)},setLoadState:function(t){var e=this;this.data.get("isHistoryLine")||t!==$o.LOADING?(this.data.set("moveState","tips-leave"),setTimeout((function(){e.data.set("loadState",t),e.data.set("moveState","tips-enter")}),100)):this.data.set("loadState",t)}})),dr={};dr=Object.assign(dr,{tipsContainer:"tips-container_1mw3o_1","tips-container":"tips-container_1mw3o_1",tipsLeave:"tips-leave_1mw3o_29","tips-leave":"tips-leave_1mw3o_29",historyTextMove:"historyTextMove_1mw3o_1",tipsEnter:"tips-enter_1mw3o_32","tips-enter":"tips-enter_1mw3o_32",historyTextEnter:"historyTextEnter_1mw3o_1",tipText:"tip-text_1mw3o_35","tip-text":"tip-text_1mw3o_35",tipsContainerHeader:"tips-container-header_1mw3o_41","tips-container-header":"tips-container-header_1mw3o_41",tipsContainerContent:"tips-container-content_1mw3o_45","tips-container-content":"tips-container-content_1mw3o_45",historyLine:"history-line_1mw3o_50","history-line":"history-line_1mw3o_50",historyLineBefore:"history-line-before_1mw3o_54","history-line-before":"history-line-before_1mw3o_54",historyLineAfter:"history-line-after_1mw3o_58","history-line-after":"history-line-after_1mw3o_58",loadingIcon:"loading-icon_1mw3o_73","loading-icon":"loading-icon_1mw3o_73",historyIconRotate:"historyIconRotate_1mw3o_1",loadingText:"loading-text_1mw3o_91","loading-text":"loading-text_1mw3o_91",historyTextOpacity:"historyTextOpacity_1mw3o_1",historyTextLeave:"historyTextLeave_1mw3o_1"}),lr.template="\n    <div>\n        <div\n            s-if=\"!listenRenderfinished && showHistoryLine\"\n            class=\"{{$style['tips-container']}}\n                {{!isHistoryLine && loadState === 0 ? '' :\n                (isPulldownLoading ? $style['tips-container-header'] : $style['tips-container-content'])}}\n                {{$style[moveState]}}\"\n        >\n            <fragment s-if=\"isHistoryLine && loadState === 0\">\n                <fragment s-if=\"showTimestamp && user.isUserLogin\">\n                    <answer-timestamp\n                        timestamp=\"{{createTime}}\"\n                    />\n                </fragment>\n                <fragment s-else>\n                    <div s-transition=\"moveTransition\" class=\"{{$style['tip-text']}}\">\n                        <div class=\"{{$style['history-line']}} {{$style['history-line-before']}}\"></div>\n                        <span>{{historyLineText}}</span>\n                        <div class=\"{{$style['history-line']}} {{$style['history-line-after']}}\"></div>\n                    </div>\n                </fragment>\n            </fragment>\n\n            <fragment s-else>\n                <div class=\"{{$style['tip-text']}}\">\n                    <div s-if=\"loadState === 1\" class=\"{{$style['loading-icon']}}\"></div>\n                    <span class=\"{{loadState === 1 ? $style['loading-text'] : ''}}\">{{tipText}}</span>\n                </div>\n            </fragment>\n        </div>\n    </div>\n";var ur="function"==typeof lr?lr.prototype.initData||pr:lr.initData||pr;function pr(){return{$style:dr}}function hr(){return Object.assign({},ur.call(this),{$style:dr})}"function"==typeof lr?lr.prototype.initData=hr:lr.initData=hr;var fr=function(){var t=Je.getState("chatStatus");return t===Ei.WAITING||t===Ei.SENDING||t===Ei.GENERATING};function gr(t,e){var n,a;if(void 0===e&&(e=!1),e&&Date.now()-((null==(a=performance)||null==(n=a.timing)?void 0:n.navigationStart)||Date.now())<864e5)return!1;var i=new URL(document.URL),o=Je.getState("agentInfo"),r=Je.getState("landingPageSwitch"),s=Je.getState("chatSearchAcitonId"),c="pc"===rt();return i.search="",c||(i.pathname=Je.getState("isWiseNewCsaitab")?ct()?fe.DEEPSEEK.path:fe.CHAT.path:"/searchframe",i.searchParams.set("chatsearch_action_id",s),i.searchParams.set("do_not_intercept","1"),gs()&&i.searchParams.set("isLoggedIn","1")),!e&&i.searchParams.set("k_tag","1"),i.searchParams.set("word",t),i.searchParams.set("setype","csaitab"),r&&i.searchParams.set("landingPageSwitch",r),Object.keys(o).length&&(o.isUpperBox=!0,i.searchParams.set("agentInfo",encodeURIComponent(JSON.stringify(o)))),i.searchParams.set("extParamsJson",JSON.stringify({ori_word:t,ori_lid:Je.getState("oriLid")})),window.history.replaceState(null,"",i.toString()),location.reload(),!0}function mr(t){On().conversation.updateSearchtips.emit({nextSearchTips:t})}function vr(){Bn().emit({text:Xt,type:"warn"}),_r.renderTip({type:"dangerTip",data:{showDanger:!0}}),mr([])}var yr="kunlun_popup",br=0;function wr(t){if(!br){br=1;var e="pc"===rt();Bn().emit({text:e?"为保证服务安全，请验证后重试":"抱歉，出了点小问题，请稍后重试",type:"warn"}),setTimeout((function(){gr(t)}),700)}}var _r,kr={prerenderConfirmPromise:null};function Sr(t){return kr[t]}function xr(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Ir(){return Ir=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ir.apply(this,Array.from(arguments))}function Tr(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function Cr(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Lr,Pr="pc"===rt();function Dr(t){return _r.scrollElementIntoView(t)}function Ar(t){return Er.apply(this,Array.from(arguments))}function Er(){var t;return t=function(t,e,n){var a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_,k,S,x,I,T,C,L,P,D,A,E,O,R,N,q,M,j,B,H,$,U,F,G,W,z,Q,J,V;return Cr(this,(function(K){switch(K.label){case 0:if(a=t.query,i=t.extParams,o=void 0===i?{}:i,r=t.conversationLogId,s=t.agentQuery,c=void 0===s?"":s,l=t.showQAPair,d=void 0===l||l,u=t.showQuestion,p=void 0===u||u,h=t.clickTime,void 0===e&&(e=!1),m=Je.getState("curRankInfo.rank"),v=Je.getState("isWiseNewCsaitab"),y=Sr("prerenderConfirmPromise"),b=Je.getState("agentInfo"),w=+Je.getState("isShowHello"),!(Pr&&(null==b?void 0:b.agentName)||m>=xs()||ft()))return[3,4];K.label=1;case 1:return K.trys.push([1,3,,4]),[4,ws()];case 2:return _=K.sent(),Pr&&!_?[2]:[3,4];case 3:return K.sent(),ft()?[2,On().component.login.emit()]:[2,Bn().emit({text:"登录失败，请稍后再试"})];case 4:if(gs()||Pr||(On().component.showLoginToast.emit(3e3),_s&&(ws(),Ss(0))),Eo(),Je.getState("rank")&&Je.dispatch("update",{hideTopAgentList:!1}),p||0!==m||Je.dispatch("update",{firstRankHideQuery:!0}),k=Je.getState("iosSlipPrefetchEnable"),S=(null==(g=performance)||null==(f=g.timing)?void 0:f.navigationStart)||+new Date,x=e?S:h||+new Date,I=Je.getState("startTimeList")||{},fr()&&(T=Je.getState("curRankInfo"),C=T.rank,L=T.timstamp,P=T.agentInfo,D=T.lid,A=T.oriLid,Aa({type:"click",value:"stop_create_send_new",ext:{re_rank:String(C),agent_id:null==P?void 0:P.agentSearchId,agent_name:null==P?void 0:P.agentName,lid:D,query_time_stamp:L,ori_lid:A,create_stage:Je.getState("generateStatus")}})),E=[{type:"TEXT",data:{text:{query:"",text_type:""}}}],O=[{type:"text",data:{question:{question:""}}}],!v&&"wise"===rt()&&"string"==typeof a&&gr(a,!0))return[2];if("string"==typeof a){E[0].data.text.query=a,Object.assign(O[0].data.question,{question:a,showQuestion:p}),R=Je.getState("csextdata"),N={};try{N=JSON.parse(R)}catch(t){N={}}(q=N.query_text_type||"")&&(E[0].data.text.text_type=q)}return Array.isArray(a)&&(M="",j="",B=[],(E=a).forEach((function(t){var e=t.data;switch(t.type){case"TEXT":var n;M+=e.text.query,j+=null==(n=e.text)?void 0:n.text_type;break;case"IMAGE":var a,i;if(B.push(Ir({},e.image,{imageUrl:null==(a=e.image)?void 0:a.image_url,imageB64:null==(i=e.image)?void 0:i.image_b64})),e.image.imageInfo=void 0,Pr){var o,r=null==(o=e.image)?void 0:o.image_id;e.image={image_id:r}}break;case"FILE":var s,c,l,d,u,p;if(O.push({type:"file",data:{question:{question:{fileId:null==(s=e.file)?void 0:s.file_id,fileName:null==(c=e.file)?void 0:c.file_name,fileUrl:null==(l=e.file)?void 0:l.file_url,filePath:null==(d=e.file)?void 0:d.file_path,fileSize:null==(u=e.file)?void 0:u.file_size,status:1,fileType:null==(p=e.file)?void 0:p.file_type}}}}),Pr){var h,f=null==(h=e.file)?void 0:h.file_id;e.file={file_id:f}}}})),Object.assign(O[0].data.question,{question:M,showQuestion:p}),j&&(O[0].data.question.text_type=j),B.length&&O.push({type:"image",data:{question:{question:B}}})),O=(null==(X=O)?void 0:X.length)?X.filter((function(t){var e;return!("text"===(null==t?void 0:t.type)&&!(null==t||null==(e=t.data)?void 0:e.question.question))})):X,Je.dispatch("update",{query:E,agentQuery:c}),function(t){var e,n,a=null==t?void 0:t.agentId,i=null==t?void 0:t.agentSearchId,o=null==t||null==(e=t.agentParams)?void 0:e.app_key,r=null==t||null==(n=t.agentParams)?void 0:n.agent_id,s=o||a,c=r||i;if(ns!==s&&ns!==c?(Je.dispatch("update",{agentRank:1}),Je.dispatch("update",{agentSessionCount:Je.getState("agentSessionCount")+1}),ns="16"===s?c:s):Je.dispatch("update",{agentRank:Je.getState("agentRank")+1}),t&&t.agentSearchId){var l=Je.getState("agentSa"),d=Je.getState("sa")||"",u=ne.some((function(t){return d.startsWith(t)}))||""===d,p=ae.some((function(t){return d.startsWith(t)})),h=ie.some((function(t){return l.startsWith(t)}));u&&h&&!p&&Je.dispatch("update",{sa:d?d+"_"+l:l})}}(b),_i(),I[m+1]=k?0:x||+new Date,Je.dispatch("update",{startTimeList:I,isSync:e?"1":"0"}),Hn().emit({fromNa:o.fromNa}),[4,ls()];case 5:K.sent(),r||(r="-1",Je.dispatch("update",{conversationLogId:"-1"})),function(t,e){var n=new URLSearchParams(window.location.search);n.set("word",e);var a={query:e,url:location.origin+location.pathname+"?"+n.toLocaleString(),conversationLogId:t};On().conversation.launchSearch.emit(a)}(r,a),Je.getState("syncTabData")&&Fi(Ui(),"13.74")>=0&&(v?io():ao(!0)),H=Je.getState("hasPullHistory"),$=o.searchIntent,U=o.interactionType,F=o.searchInfo,delete o.searchIntent,delete o.interactionType,delete o.searchInfo,G=Ir({},o,{rank:m+1}),W=G.csextdata||Je.getState("csextdata");try{W=W&&"string"==typeof W?JSON.parse(W):W}catch(t){console.error(t)}return Je.dispatch("update",{implicitAgentInfo:{agentId:G.agent_id||"",agentP:G.agent_p||""}}),Je.dispatch("update",{chatStatus:Ei.SENDING}),y?[4,y]:[3,7];case 6:K.sent(),K.label=7;case 7:return z=Je.getState("subSession"),Q=Je.getState("withoutStopSseRanks"),J=Je.getState("rank"),V=!!(null==Q?void 0:Q.includes(J)),setTimeout((function(){_r.sendPrompt({question:O,sseExtraData:Ir({},G,{message:Ir({},{content:Ir({},G.agent_id?{agentInfo:{agent_id:[G.agent_id||""],params:G.agent_p||""}}:{},G.aitab_ct?{aitab_ct:G.aitab_ct}:{},"object"===(void 0===W?"undefined":Tr(W))&&null!==W?{extData:W}:{})},{searchInfo:Ir({},F,{showMindMap:Je.getState("showMindMap"),sa:o.sa||Je.getState("sa")},$&&{search_intent:$},o.usedModel?{usedModel:o.usedModel}:{},w&&{isShowHello:w},o.share_id?{share_id:o.share_id}:{},U?{interaction_type:U}:{},(null==z?void 0:z.entrance)?{sub_session:{entrance:z.entrance,ori_lid:z.oriLid,re_rank:String(z.reRank+1)}}:{})}),withoutStopLastSse:V}),promptContent:o.queryPromise?o.queryPromise:E,extraData:Ir({},o,{rank:m+1}),scrollToTop:0!==m||0===m&&H||Pr},n||"SSE",Je.getState("hasInitContext")||d)}),0),Je.dispatch("update",{curRankInfo:{rank:m+1,timstamp:String(Date.now()),agentInfo:b,lid:Je.getState("lid"),oriLid:Je.getState("oriLid")},subSession:Ir({},z,{reRank:z.reRank+1})}),[2]}var X}))},Er=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){xr(o,a,i,r,s,"next",t)}function s(t){xr(o,a,i,r,s,"throw",t)}r(void 0)}))},Er.apply(this,Array.from(arguments))}function Or(t,e){_r.renderTip(t,e)}function Rr(t,e,n){return _r.getHistory(t,e,n)}function Nr(){_r.startBottomAlign(rt())}function qr(){return _r.stopBottomAlign()}function Mr(){return _r.stopChangeBottomAlign()}function jr(t){return _r.contentHasOverflow(t)}function Br(t,e){var n,a="";0!==t&&"16"===(null==e?void 0:e.agentSearchId)&&(a=null==e||null==(n=e.agentParams)?void 0:n.agent_id);return a}function Hr(t,e){void 0===e&&(e=!1),t=yt(t);var n=Je.getState("apagelid"),a=Je.getState("oriLid"),i=Je.getState("sgeLid"),o=Je.getState("chatParams"),r=Je.getState("sid"),s=Je.getState("rank"),c=Je.getState("connectPreQuery"),l=Je.getState("iosSlipPrefetchEnable"),d=Je.getState("appUrlParams"),u=s+1,p=Je.getState("agentInfo"),h=Je.getState("aitab_ct"),f=Je.getState("actiontype"),g=Je.getState("landingPageSwitch"),m=Je.getState("csextdata"),v=Je.getState("sa"),y=Je.getState("enterType"),b={};try{b=JSON.parse(m)}catch(t){b={}}b.enter_type=y;var w=!!(null==b?void 0:b.operationPlatform);m="{}"===(m=JSON.stringify(b))?"":m,b&&"aicc"in b&&delete b.aicc,!e&&Je.dispatch("update",{aitab_ct:"",actiontype:"",csextdata:w?JSON.stringify({operationPlatform:null==b?void 0:b.operationPlatform}):JSON.stringify(b)});var _=Je.getState("clientHeaders"),k=Je.getState("cosmicVersion"),S=Je.getState("scVersion");if(p&&Object.keys(p).length>0&&-1!==t.indexOf(p.agentName)){var x=ts(t,p.startIndex,p.endIndex);t=x.prefix+x.suffix}var I=Rt(new URL(location.href).searchParams);return{data:Object.assign(I,d,Pe(Ir({word:c?c+" "+t:t,apagelid:n,ori_lid:a,sge_lid:o.sge_lid||i,setype:o.setype,pd:o.pdvalue,sid:r,re_rank:u,cstabpage:1,mod:l?1:"",sa:v,chat_token:o.chat_token,agent_id:Br(s,p)||(null==p?void 0:p.agentSearchId)||"",agent_p:JSON.stringify(Ir({},(null==p?void 0:p.agentSearchId)?Ir({isUpperBox:!!(null==p?void 0:p.isUpperBox)},(null==p?void 0:p.agentParams)||{},{noRewrite:+!!Je.getState("agentRecData")}):{},{agt_rk:Je.getState("agentRank"),agt_sess_cnt:Je.getState("agentSessionCount")})),aitab_ct:h,actiontype:f},u>1?{cv:k,scv:S}:{},{agt_rk:Je.getState("agentRank"),agt_sess_cnt:Je.getState("agentSessionCount"),a_srcid:Je.getState("srcid")||"",a_order:Je.getState("order")||"",a_tplname:Je.getState("tplname")||"",csextdata:Ir({},JSON.parse(m),{blockCmpt:Je.getState("blockCmptList")[a]||[]}),enterType:y}))),headers:Ir({},_,{landingPageSwitch:g})}}function $r(t){var e=yt(t||""),n=Je.getState("searchframeLid"),a=Je.getState("token");return window.btoa(a+"|"+encodeURIComponent(e)+"|"+Date.now()+"|"+n)+"-"+n}function Ur(t,e){for(var n in e)e.hasOwnProperty(n)&&("object"===Tr(e[n])&&null!==e[n]?"object"===Tr(t[n])&&null!==t[n]?Ur(t[n],e[n]):t[n]=Ir({},e[n]):t[n]=e[n]);return t}function Fr(t){var e=Je.getState("agentInfo")||{},n=Je.getState("pcClickInfo"),a=Je.getState("searchParams"),i=Je.getState("sa"),o=Je.getState("landingPageSwitch"),r=Je.getState("connectPreQuery"),s=decodeURIComponent(a.extParams||a.extParamsJson||"{}"),c={};try{c=JSON.parse(s)}catch(t){console.error(t),c=jt(s)}var l,d=Je.getState("chatParams"),u=Je.getState("rank"),p=u+1,h=Je.getState("aitab_ct"),f=function(t){var e=1;return Array.isArray(t)&&t.forEach((function(t){"IMAGE"===t.type&&(e=3,t.data.image.ext&&(e=2))})),e}(t),g={},m="pc"===rt()?"pc_csaitab":"wise_csaitab",v=Je.getState("cosmicVersion"),y=Je.getState("scVersion"),b=Je.getState("oriLid"),w=Je.getState("pluginPromptType"),_=r?function(t,e){var n=e.prefix,a=void 0===n?"":n,i=e.suffix,o=void 0===i?"":i,r=""+a+t+o;if(Array.isArray(t))try{r=JSON.parse(JSON.stringify(t)).map((function(t){return t.data.text&&(t.data.text.query=""+a+t.data.text.query+o),t}))}catch(e){r=t,console.error(e)}return r}(t,{prefix:r+" "}):t,k=1===f?String(yt(_)):"",S=yt(t),x=Je.getState("usedModel"),I=Je.getState("aPageWord"),T=+Je.getState("isShowHello"),C=+Je.getState("apagelid"),L=I&&I!==S||T||u>1||!C?2:I&&I===S?1:0;window.page&&window.page.amd&&window.page.amd.version&&(l=window.page.amd.version.searchUi),c.aicc&&(g.aicc=c.aicc,delete c.aicc,a.extParams=encodeURIComponent(JSON.stringify(c)),Je.dispatch("update",{searchParams:a})),w&&Je.dispatch("update",{pluginPromptType:0});var P={message:{inputMethod:"chat_search",isRebuild:!1,content:Ir({query:"",agentInfo:{agent_id:[Br(u,e)||(null==e?void 0:e.agentSearchId)||""],params:JSON.stringify(Ir({},(null==e?void 0:e.agentSearchId)?Ir({isUpperBox:!!e.isUpperBox},e.agentParams||{},{noRewrite:+!!Je.getState("agentRecData")}):{},{agt_rk:Je.getState("agentRank"),agt_sess_cnt:Je.getState("agentSessionCount")}))}},w&&{pluginQuery:{promptType:w}}),searchInfo:{srcid:String(Je.getState("srcid")||""),order:Je.getState("order")||"",tplname:Je.getState("tplname")||"",re_rank:String(+Je.getState("rank")+1),ori_lid:Je.getState("oriLid"),sa:i,chatParams:{setype:"csaitab"},blockCmpt:Je.getState("blockCmptList")[b]||[],usedModel:x,landingPageSwitch:Je.getState("landingPageSwitch"),landingPage:ct()?"deepseek":"aitab"},from:ft()?"aichat_plugin":"",source:"wise_csaitab",query:t}};switch(f){case 1:Ur(P.message,{content:{qtype:0,aitab_ct:h},searchInfo:Ir({},g,{isInnovate:L,applid:c.applid||Je.getState("applid")||"",a_lid:c.apagelid||Je.getState("apagelid")||"",enter_type:Pr?Je.getState("pcEnterType")||"ai_tab_url":Je.getState("enterType")},p>1?{cv:v,scv:y}:{},{suv:l,chatParams:{chat_samples:"WISE_NEW_CSAITAB",sge_lid:d.sge_lid,chat_token:$r(r?r+" "+S:S),scene:""}}),source:m,anti_ext:{inputT:Je.getState("pcInputTime"),ck1:n.clickTimeDiff,ck9:n.clientX,ck10:n.clientY},query:_});break;case 2:Ur(P.message,{inputMethod:"graph_search",searchInfo:{lid:"",srcid:""},content:{agentInfo:void 0},agent_id:""});break;case 3:Ur(P.message,{content:{agentInfo:{params:(null==e?void 0:e.agentSearchId)?JSON.stringify(Ir({isUpperBox:!!e.isUpperBox,forceGen:1},e.agentParams||{},{noRewrite:+!!e.noRewrite})):""}},source:m,searchInfo:{lid:"",chatParams:{sge_lid:d.sge_lid,chat_token:$r(r?r+" "+S:S)}},agent_id:""})}return{data:P,headers:Ir({source:m,landingPageSwitch:o,"X-Chat-Message":"query:"+encodeURIComponent(k.slice(0,500))},ct()||(null==x?void 0:x.modelName)?{isDeepseek:"1"}:{},nt?{"debug-user-agent":ot.debugUA}:{})}}function Gr(t){var e=Je.getState("chatParams");return{data:{query:"string"==typeof(t=yt(t))?t:"",sge_lid:e.sge_lid,token:$r(t)}}}function Wr(t){0!==t.status&&Bn().emit({text:"删除失败，请稍后再试"})}function zr(t){if(!nt)return t;var e=new URL(location.href),n={};return se.forEach((function(t){var a=e.searchParams.get(t);a&&(n[t]=a)})),qt(t,n)}!function(t){t[t.TEXT_SEARCH=1]="TEXT_SEARCH",t[t.GRAPH_SEARCH=2]="GRAPH_SEARCH",t[t.PIC_SEARCH=3]="PIC_SEARCH"}(Lr||(Lr={}));var Qr=null;function Jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Vr(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Kr(){return Kr=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Kr.apply(this,Array.from(arguments))}function Xr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Jr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jr(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yr(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Zr={agentInfo:{},data:{isShort:"0",isSingleCol:"1",recommendWord:[]},type:"entry",isFinished:!1,component:"questionClosely"};function ts(t,e,n){return void 0===t&&(t=""),void 0===e&&(e=0),void 0===n&&(n=-1),e=e||0,n=n||-1,{prefix:t.substring(0,e),keyword:t.substring(e,n+1),suffix:t.substring(n+1)}}function es(t,e){if(void 0===t&&(t={}),void 0===e&&(e="agent"),!t.agentSearchId)return Je.dispatch("update",{agentInfo:t,agentSa:"agent"});var n=Je.getState("agentInfo")||{},a={agentInfo:t};t.agentSearchId!==n.agentSearchId&&(da().emit(),a.agentSa=e||"agent"),Je.dispatch("update",a)}var ns="";function as(t,e){var n,a=t.agentName;n=e,e=Array.isArray(n)&&0===(n=n.filter((function(t){return"TEXT"===t.type&&!!t.data.text.query}))).length?"":n;var i="pc"===rt();gs()&&jn().emit({word:i?"":"@"+a,agentInfo:Kr({startIndex:0,endIndex:a.length},us(t)),noClear:!e,invokeKeyboard:0}),e&&Ar({query:e,agentQuery:e});var o=(t.guides||[]).map((function(t){return{text:t}}));Zr.data.recommendWord=o,Zr.agentInfo=t,e&&Je.dispatch("update",{agentRecData:Zr,agentQuery:e})}function is(t,e){return e&&e.agentName?(t=yt(t)).replace("@"+e.agentName,""):t}function os(t,e){if(!t||"string"!=typeof t)return"";if(!e)return t;var n=Je.getState("apagelid"),a=Je.getState("lid"),i=Je.getState("tplname"),o=Je.getState("srcid"),r=Je.getState("order"),s=Je.getState("agentInfo"),c=s.agentName,l=s.agentId,d=/(_baiduboxapp=)([^&]*)/.exec(t),u={};if(d){var p=decodeURIComponent(d[2]);try{u=p&&JSON.parse(p)}catch(t){u={}}}else u={};var h=function(t){var e=t.split("?")[1];if(!e)return"";for(var n,a=Xr(e.split("&"));!(n=a()).done;){var i=n.value.split("="),o=i[0],r=i[1];if("url"===o)return decodeURIComponent(r)}return""}(t),f=rs(h,u),g={_baiduboxapp:Kr({from:ee.CHAT,lingjing_type:"1",ext:Kr({agent_id:l,agnet_name:c,csaitab_lid:a||"10000",searchid:n||"10001"},i?{tplname:i}:{},o?{srcid:o}:{},r?{order:r}:{},{token:"swanubc",third_ext:{ivkSource:"h5_schema",token:"swanubc",pd:"csaitab"},referpd:"B"})},u)},m=e._baiduboxapp,v=e.chatExt,y=e._chatQuery,b=e.searchParams;if(m){var w=e._baiduboxapp,_=w.ext,k=function(t,e){if(null==t)return{};var n,a,i={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(w,["ext"]);g._baiduboxapp=_?Kr({},g._baiduboxapp,k,{ext:Kr({},g._baiduboxapp.ext,_)}):Kr({},g._baiduboxapp,k)}v&&(g.chatExt=e.chatExt),y&&(g._chatQuery=e._chatQuery),b&&(g.searchParams=e.searchParams);var S=function(t,e,n){var a="";try{var i=new URL(t);n&&i.searchParams.set("url",n),Object.keys(e).forEach((function(t){var n=JSON.stringify(e[t]);i.searchParams.set(t,n)})),a=i.toString()}catch(t){console.error("[ERROR]：CREATE URL ERROR: "+t)}return a}(t,g,f);return S}function rs(t,e){if(!t)return"";var n=yt(Je.getState("query"))||"",a=Je.getState("lid"),i=Je.getState("apagelid"),o=Je.getState("tplname"),r=Je.getState("srcid"),s=Je.getState("order"),c=Kr({_chatQuery:encodeURIComponent(n),csaitab_lid:a||"",searchid:i||""},o?{tplname:o}:{},r?{srcid:r}:{},s?{order:s}:{},{_swebScene:ee.CHAT,_chatExt:e?encodeURIComponent(JSON.stringify(e)):""}),l=(Object.entries(c)||[]).map((function(t){return t[0]+"="+t[1]})).join("&")||"",d=-1===t.indexOf("?")?"?":"&";return t+d+l}var ss=null;function cs(t){var e,n;if(t.agentId){var a=new URL("https://chat.baidu.com/bot/runs/cancel?pd=9001");return ss=fetch(a.toString(),{body:JSON.stringify({agent_id:t.agentId,thread_id:t.sessionId,user_info:{uid:null==(n=Je.getState("user"))||null==(e=n.userInfo)?void 0:e.uid},channel:{from:"aitab"},logid:t.lid}),method:"POST",mode:"cors",credentials:"include"}).catch((function(t){console.error(t)})).finally((function(){ss=null}))}}function ls(){return ds.apply(this,Array.from(arguments))}function ds(){var t;return t=function(){var t;return Yr(this,(function(e){switch(e.label){case 0:if(!ss)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.race([ss,new Promise((function(t){return setTimeout(t,2e3)}))])];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),console.error(t),[3,4];case 4:return[2]}}))},ds=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Vr(o,a,i,r,s,"next",t)}function s(t){Vr(o,a,i,r,s,"throw",t)}r(void 0)}))},ds.apply(this,Array.from(arguments))}function us(t){var e,n;"16"===(null==t?void 0:t.agentSearchId)&&((null==(t=$a(t))||null==(e=t.agentParams)?void 0:e.agent_id)&&(t.agentSearchId=t.agentParams.agent_id),(null==t||null==(n=t.agentParams)?void 0:n.app_key)&&(t.agentId=t.agentParams.app_key));return t}function ps(t,e){return t.startIndex?e.slice(0,t.startIndex)+"@"+t.agentName+e.slice(t.startIndex):"@"+t.agentName+e}function hs(){return hs=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},hs.apply(this,Array.from(arguments))}var fs=void 0;function gs(){return Je.getState("user.isUserLogin")}function ms(){Ba(""+Je.getState("chatParams").sse_host+$t.loginConfirmation,{session_id:Je.getState("oriLid")||"",tk:$r()},5e3)}function vs(t){var e;return(null==(e=window.passport)?void 0:e.pop)?(fs=window.passport.pop.init({loginVersion:"v5",composeTemplate:1,apiOpt:{staticPage:"https://chat.baidu.com/bot/v3Jump.html",loginType:1,product:"search_aichat",u:window.location.href,safeFlag:0,memberPass:!0,sms:5},cache:!0,forgetLink:"https://passport.baidu.com/?getpass_index&tpl=mn&u="+encodeURIComponent(window.location.href),registerLink:"https://passport.baidu.com/v2/?reg&regType=1&tpl=mn&u="+encodeURIComponent(window.location.href),authsite:["tsina","weixin","qzone"],tangram:!0,onLoginSuccess:function(t){Ys().then((function(t){t.isUserLogin&&(Je.dispatch("update",{user:t}),ra().emit({type:"loginSuccess"}),function(){var t=Je.getState("agentInfo"),e="pc"===rt();t.agentName&&jn().emit({word:e?"":"@"+t.agentName,agentInfo:Kr({startIndex:0,endIndex:t.agentName.length},us(t)),invokeKeyboard:0})}(),ms(),"/aichat/history"===location.pathname&&location.reload())})),fs.hide(),t.returnValue=!1},onHide:function(){gs()||ra().emit({type:"loginCancel"})}}),t()):function(t){var e=location.protocol+"//passport.baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+(new Date).getTime(),n=document.createElement("script");n.setAttribute("src",e),n.onload=t,document.body.appendChild(n)}((function(){return vs(t)}))}function ys(){return fs?fs.show():vs((function(){return ys()}))}function bs(t){var e=Je.getState("user");return Je.dispatch("update",{user:hs({},e,{isUserLogin:t})})}function ws(t){return void 0===t&&(t=""),new Promise((function(e,n){if("pc"===rt()){if(gs()){var a=Je.getState("user");return e(a)}if(!ft())return ys(),e();Ys().then((function(t){t.isUserLogin?(Je.dispatch("update",{user:t}),e(t)):n()})).catch((function(){return n()}))}else{if(pt()){if(Je.getState("user.isUserLogin"))return e();window.addEventListener("pageshow",(function(t){t.persisted&&window.location.reload()}));var i=window.location.href,r="https://wappass.baidu.com/passport/?login&sms=1&u="+encodeURIComponent(i)+"&tpl=wise";return window.location.href=r,n(t)}if(gs()){var s=Je.getState("user");return e(s)}if(!o.canIUse("account.login"))return console.error("模拟器环境未登录"),e();o.account.login({loginType:"fast",showThirdLogin:"1",loginSource:"search_ai",normalizeAccount:"0",success:function(t){0===t.status&&(bs(!0),ms(),e())},fail:function(){n(t)}})}}))}var _s=ut()&&ot.isHuawei&&Fi(Ui(),"15.6")>=0,ks=_s?1:9999;function Ss(t){ks=t}var xs=function(){return rt(),ks};function Is(t){var e=document.createElement("iframe");e.style.display="none",e.src=t;var n=document.body||document.getElementsByTagName("body")[0];n.appendChild(e),setTimeout((function(){n.removeChild(e),e=null}),0)}var Ts=17592352028333;function Cs(){if(!ct()){var t=Je.getState("chatParams").sse_host+"/aichat/api/impush",e={call_from:"aitab",logid:Je.getState("lid"),pa_uid:Ts,msg_readed:1};fetch(t,{headers:{"Content-Type":"application/json"},method:"post",mode:"cors",credentials:"include",body:JSON.stringify(e)})}}function Ls(){if(ut()){var t=JSON.stringify({targetId:Ts,category:0}),e=encodeURIComponent(t),n="im_callback_"+ +new Date,a="baiduboxapp://message/readAllMessagesWithCommand?params="+e+"&callback="+n;window[n]=function(){},Is(a)}}function Ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Ds(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function As(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Ds(o,a,i,r,s,"next",t)}function s(t){Ds(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Es(){return Es=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Es.apply(this,Array.from(arguments))}function Os(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ps(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ps(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Rs(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Ns=3e3,qs="/aichat/api/aitabserver",Ms="Hi，初次见面很开心！我是你的智能搜索助手，我可以为你答疑解惑，还能进行绘画和文案创作，也能陪你聊聊天，有任何问题可以随时找我。",js="pc"===rt(),Bs="wise"===rt(),Hs=!1;function $s(){var t=Je.getState("chatParams");ja(Je.getState("chatParams").sse_host+"/aichat/api/aitabserver?action=wise&ctl=shortcuts&landingPageSwitch=1&t="+(t.sge_lid||(new Date).getTime())+"&tk="+$r(),{credentials:"include"},2e3).then((function(t){var e,n,a,i,o,r;if(0===t.status&&t.data){for(var s,c=t.data.shortcutsBlocks||{},l=Je.getState("modelList")||[],d={DeepSeek:(null==(n=c.DeepSeek)||null==(e=n.data)?void 0:e.items)||{},smartMode:(null==(i=c.smartMode)||null==(a=i.data)?void 0:a.items)||{},ERINE:(null==(r=c.ERINE)||null==(o=r.data)?void 0:o.items)||{}},u=Os(l);!(s=u()).done;)for(var p,h=s.value,f=h.id||"",g=Os(Object.entries(d));!(p=g()).done;){var m=p.value,v=m[0],y=m[1];f.includes(v)&&(h.modelFuncData=y)}var b=Je.getState("modelList").find((function(t){return!0===t.checked})),w=(null==b?void 0:b.modelFuncData)||d.smartMode;Je.dispatch("update",{modelList:[].concat(l),modelFuncData:w}),On().component.showModelFunData.emit({modelFuncData:w})}})).catch((function(){}))}function Us(t,e,n){void 0===t&&(t=""),void 0===n&&(n={});var a=Je.getState("chatParams"),i=Je.getState("agentInfo")||{},o=Je.getState("helloInfo")||{},r=js?Je.getState("pcEnterType"):"",s=Je.getState("messageReadStyle"),c=Es({},o,{enter_type:r,messageReadStyle:s}),l=Je.getState("isWiseNewCsaitab"),d=js||l?$r(e):a.chat_token,u=t||Je.getState("chatParams").sse_host+qs;return u+(u.includes("?")?"&":"?")+new URLSearchParams(n).toString()+"&t="+(a.sge_lid||(new Date).getTime())+"&tk="+d+"&query="+encodeURIComponent(e)+"&agent_p="+(i.agentParams?encodeURIComponent(JSON.stringify(i.agentParams)):"")+"&extParamsJson="+(o.helloKey||s?encodeURIComponent(JSON.stringify(c)):"")+"&agent_id="+(i.agentSearchId||"")}var Fs=0,Gs=0;function Ws(){return zs.apply(this,Array.from(arguments))}function zs(){return zs=As((function(t,e){var n,a,i,o;return Rs(this,(function(r){switch(r.label){case 0:return void 0===t&&(t=""),n=Date.now(),a=Je.getState("urlInfo")||{},i=a.guideWordsUrl,(js||!i||t||Je.getState("messageReadStyle"))&&(i=Us(i,t,{ctl:"guidewords",work_enhance:1,from:ft()?"aichat_plugin":""})),ct()&&(i=qt(i,{deepseek:1})),function(t){void 0===t&&(t=!1),js||"message"===Je.getState("enterType")||Fi(Ui(),"13.80")<0||(t&&Gs++,On().container.guidewordsReqIntercept.on((function(t){t.params&&(1!==t.params.success?tn.sendExcept({info:{msg:t.params.msg||"-",enterType:Je.getState("enterType"),sa:Je.getState("sa")},group:"guideword-intercept-fail",sample:1}):Fs++)})))}(e),[4,ja(i,{credentials:"include"},Ns).then((function(t){if(0!==t.status)return Promise.reject();var e=t.data;return{guideWord:e.guide_words,blocks:e.blocks,recFunctionalList:e.recFunctionalList,isNewUser:e.isNewUser||!1,hasPushMessage:e.hasPushMessage||!1,pushMessageQuery:e.pushMessageQuery||"",homeRec:e.home_rec||{},inputPanel:e.input_panel||[],usableModel:e.usableModel||[]}})).catch((function(){return{guideWord:Ms,blocks:[],recFunctionalList:[],isNewUser:!1,hasPushMessage:!1,pushMessageQuery:"",homeRec:{},inputPanel:[],usableModel:[]}})).finally((function(){no()}))];case 1:return o=r.sent(),nn(Date.now()-n),Gs&&setTimeout((function(){tn.sendCount({info:{all:Gs,success:Fs},group:"guideword-intercept",sample:1})}),1e3),[2,o]}}))})),zs.apply(this,Array.from(arguments))}function Qs(){return Js.apply(this,Array.from(arguments))}function Js(){return Js=As((function(){var t,e,n;return Rs(this,(function(a){return oa().emit(!0),t=Je.getState("chatParams")||{},e={data:{from:"chat_search",sge_lid:t.sge_lid,token:$r(),pn:0,rn:1,search_before_lid:"",cur_ori_lid:"",landingPageSwitch:Je.getState("landingPageSwitch"),landingPage:ct()?"deepseek":"aitab"}},n=new Promise((function(t){var e=function(n){var a=n.state;n.appendRender&&(a===$o.SUCCESS?t(!0):a!==$o.FAIL&&a!==$o.NOMORE||t(!1),Wn().off(e))};Wn().on(e)})),Rr(e,{appendRender:!0}),[2,n]}))})),Js.apply(this,Array.from(arguments))}function Vs(t){return Ks.apply(this,Array.from(arguments))}function Ks(){return Ks=As((function(t,e){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_,k,S,x,I,T,C,L,P,D,A,E,O,R,N,q,M,j;return Rs(this,(function(B){switch(B.label){case 0:return void 0===e&&(e=!1),i=t.clickTime||(js||e)&&(null==(a=performance)||null==(n=a.timing)?void 0:n.navigationStart)||Date.now(),o=Date.now()-i,Je.getState("chatPageInitialized")?[2]:(Je.dispatch("update",{chatPageInitialized:!0}),r="",s=!1,c=0,l="",d="",ye(t)?(r=t.query,s=t.initShowHistory,c=t.isShowHello,l=t.triggerType,d=t.oriLid):r=t,bs(u=gs()),Ls(),p=Je.getState("isWiseNewCsaitab"),h=Je.getState("messageReadStyle"),f=!(!h||"0"===h),g=Je.getState("subEnterType"),m=!("his_middle"!==g||!d),Jo()||js||(m=!1),m&&Rr(Qo({reqType:"5"})),v=!1,f||!s?[3,2]:[4,Qs()]);case 1:(v=B.sent())||(p?io(Jt):ao(!0,Jt)),r=Je.getState("query"),B.label=2;case 2:return function(t){return void 0===t&&(t=""),new Promise((function(e){ja(Us("",t,{ctl:"agent",action:"shortcuts",landingPageSwitch:Je.getState("landingPageSwitch"),landingPage:ct()?"deepseek":"aitab"}),{credentials:"include"},Ns).then((function(t){if(0===t.status){var n=t.data.blocks;return e({blocks:n})}return Promise.reject()})).catch((function(){e({blocks:[]})}))}))}(y=!c||js||v&&!f?r:"").then((function(t){var e,n,a=function(t){void 0===t&&(t=[]);for(var e={},n={},a={},i={},o=0,r=0;r<t.length;r++){var s;if("shortcuts"===t[r].component)o=null==(s=t[r].data)?void 0:s.showHelloIndex,e=Es({},t[r].data,{capsuleData:t[r].data.items});else if("questionClosely"===t[r].component)i={component:"questionClosely",data:Es({},t[r].data.value[0],{guideWord:"",type:"primary",componentArea:"agent_guide",showLoading:!1,jumpTypes:["multiSearch"],context:{app:"bdbox",scene:"chat-search"}})};else if("markdown"===t[r].component){var c=(t[r].data||{}).value||[],l=Array.isArray(c)?c[0]:{};n={component:"markdown",data:Es({},l,{content:l.value||""})}}else"inputCustom"===t[r].component&&(a={component:"ai-input-custom",data:Es({},t[r].data.value[0])})}return{recommendData:i,shortcutsData:e,helloTipComponent:n,customInputData:a,showHelloIndex:o}}(t.blocks),i=a.shortcutsData,o=a.helloTipComponent,r=a.customInputData;if(r.hasOwnProperty("data")){var s=r.data.content||[];Array.isArray(s)&&0!==s.length&&jn().emit({inputCustom:s})}"1"===(null==i||null==(n=i.capsuleData)||null==(e=n[0])?void 0:e.options.isDeepSeek)&&Ca().emit(),m?Bs&&m&&fa().emit({shortcutsData:i,id:"init"}):fa().emit({shortcutsData:i,helloTipComponent:o,customInputData:r,id:"init"})})),Je.getState("hideTopAgentList")?[3,7]:((!m||Bs&&m)&&Or({type:"guide",data:{id:"init",waitData:!0,triggerType:l}}),[4,Ws(y,c)]);case 3:return b=B.sent(),w=b.guideWord,_=b.blocks,k=void 0===_?[]:_,S=b.recFunctionalList,x=b.isNewUser,I=b.hasPushMessage,T=b.pushMessageQuery,C=b.homeRec,L=b.inputPanel,f&&I&&(p?io(Jt):ao(!0,Jt)),wa().emit(L),(P=Je.getState("openInputPanel"))&&ba().emit(P),D=Je.getState("agentInfo"),((A=Je.getState("upperSearchbox"))||D.agentName)&&(jn().emit(Es({word:js?"":"@"+D.agentName},A,D.agentName?{agentInfo:Es({},us(D),{startIndex:0,endIndex:D.agentName.length})}:{},{invokeKeyboard:0})),E=Je.getState("sa"),A&&E&&xa().emit({sa:E})),x&&!js&&u||!m&&(Jo()||js)?(Wn().emit({state:$o.NOMORE,appendRender:!0}),[3,6]):[3,4];case 4:return ma().emit({showHistoryLine:!0}),f?I||!s?[3,6]:[4,Qs()]:[3,6];case 5:!(v=B.sent())&&(p?io(Jt):ao(!0,Jt)),r=Je.getState("query"),B.label=6;case 6:I&&c&&(Je.dispatch("update",{sa:"message_push"}),Ar({query:T,showQuestion:!1})),O=function(t){void 0===t&&(t=[]);for(var e={},n=null,a={},i={},o=0;o<t.length;o++)"multiRecommendWord"===t[o].component?e=t[o].data.value[0]:"promptRecommend"===t[o].component?n=t[o].data:"questionClosely"===t[o].component?a={component:"questionClosely",data:Es({},t[o].data.value[0],{guideWord:"",type:"primary",componentArea:"agent_guide",showLoading:!1,jumpTypes:["multiSearch"],context:{app:"bdbox",scene:"chat-search"}})}:"modelGuideData"===t[o].component&&(i=t[o].data.value[0])&&He.setGuideShowData(i);return{multiRecommendWord:e,promptRecommend:n,recommendData:a,modelGuideData:i}}(k),R=O.multiRecommendWord,N=O.promptRecommend,q=O.recommendData,function(){var t=Je.getState("modelList");if(Array.isArray(t)&&0!==t.length){var e=Je.getState("chatParams");ja(Je.getState("chatParams").sse_host+"/aichat/api/aitabserver?action=shortcuts&ctl=deepseek&t="+(e.sge_lid||(new Date).getTime())+"&tk="+$r(),{credentials:"include"},2e3).then((function(e){if(0===e.status&&e.data){var n,a,i,o=(null==(n=e.data.blocks)?void 0:n[0])||{},r=(null==(i=o.data)||null==(a=i.items)?void 0:a[0])||{};if("shortcuts"===o.component&&"deepseek_online"===r.type){var s={};try{var c=JSON.parse(localStorage.getItem(he))||{};"DeepSeek-R1"===c.modelName&&(s=c)}catch(t){s=Je.getState("usedModel")||{}}t=Je.getState("modelList"),r.text&&t.forEach((function(t){var e;"DeepSeek-R1"===t.name&&(t.shortcuts=[r],t.modelFunction=Es({},t.modelFunction,{internetSearch:(null==s||null==(e=s.modelFunction)?void 0:e.internetSearch)||"0"}))})),Je.dispatch("update",{modelList:[].concat(t)})}}})).catch((function(){}))}}(),$s(),Je.dispatch("update",{guideWord:w}),s&&oa().emit(!1),M=(null==R?void 0:R.recommendWord)?"":w,m||fa().emit({guideWord:M,id:"init",triggerType:l,recFunctionalList:S,multiRecommendWord:R,promptRecommend:N,recommendData:q,homeRec:C}),B.label=7;case 7:return _r.showQAPair(),Je.dispatch("update",{hasInitContext:!0}),c&&(ai(Je.getState("conversationLogId"),{lid:"",query:r,chatNum:1,perfInfo:{baseDataTime:String(Date.now())},startTimeList:Je.getState("startTimeList"),naInjectTime:Je.getState("naInjectTime")},"invoke",{}),_s&&(Ss(0),ws())),Hs||(Hs=!0,j=Je.getState("enterType")||Je.getState("pcEnterType"),H={pageShowTime:o,contentPaintTime:Date.now()-i},$={isShowHello:c?1:0,platform:rt(),enterType:j,sync:e?1:0},!Je.getState("isDev")&&H&&tn.sendPerf({group:"chatPagePerf",info:H,dim:$}),"wise"===rt()&&function(t,e){st()&&tn.sendCount({group:"async_count",info:t,dim:e})}({all:1,async:e?0:1},{enterType:j})),[2]}var H,$}))})),Ks.apply(this,Array.from(arguments))}var Xs=new Promise((function(t){}));function Ys(){return Zs.apply(this,Array.from(arguments))}function Zs(){return(Zs=As((function(){return Rs(this,(function(t){switch(t.label){case 0:return ft()&&Xs?[4,Xs]:[3,2];case 1:t.sent(),t.label=2;case 2:return Xs=null,[4,ja(Je.getState("chatParams").sse_host+qs+"?ctl=userinfo&tk="+$r(),{credentials:"include"},Ns).then((function(t){return 0===t.status?t.data.userInfo:Promise.reject()})).catch((function(){return Promise.reject()}))];case 3:return[2,t.sent()]}}))}))).apply(this,Array.from(arguments))}function tc(){return ec.apply(this,Array.from(arguments))}function ec(){return ec=As((function(){var t,e;return Rs(this,(function(n){switch(n.label){case 0:return ft()?[2,Promise.resolve({})]:(t=Date.now(),[4,ja("/csaitab/sidebar/list",{credentials:"include",mode:"cors"},Ns).then((function(t){if(0===t.status){var e=t.data||{},n=[],a={pcUrl:"https://agents.baidu.com/center",logo:"https://search-operate.cdn.bcebos.com/a274bece2eb8065f19aa1e3973b73435.png",name:"探索更多智能体",content:"海量智能体等你来聊"};e.agent&&(n=e.agent.historyList||[],a=e.agent.appSquare||a);var i=e.feedBack||{};return{historyList:Array.isArray(n)?n:[],appSquare:a,feedback:i}}return Promise.reject()})).catch((function(){return{historyList:[],appSquare:{},mainAgent:{}}}))]);case 1:return e=n.sent(),nn(Date.now()-t),[2,e]}}))})),ec.apply(this,Array.from(arguments))}function nc(){return nc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},nc.apply(this,Array.from(arguments))}function ac(t){return t.includes("_chatSource")?t:t+"&_chatSource=csaitab&_swebScene=3741000310000000"}function ic(t){return Array.isArray(t)?t.map((function(t){return nc({},t,{logo:t.logo||t.avatar,realUrl:ac(t.pcUrl||t.realUrl||t.linkUrl),pcUrl:ac(t.pcUrl||t.realUrl||t.linkUrl),description:t.content||t.intro||t.description,agentName:t.name||t.agentName,name:t.name||t.agentName,agentId:t.appId||t.agentId||t.appKey})})):[]}function oc(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function rc(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){oc(o,a,i,r,s,"next",t)}function s(t){oc(o,a,i,r,s,"throw",t)}r(void 0)}))}}function sc(t,e){return sc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},sc(t,e)}function cc(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var lc=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sc(t,e)}(e,t);var n=e.prototype;return n.initCurrentPage=function(){var t=window.location.pathname,e=new URLSearchParams(window.location.search).get("agentInfo")||"";if(this.handleUrlPathChange(t),t===fe.AGENT.path){var n={};try{n=JSON.parse(decodeURIComponent(e))}catch(t){n={}}this.openAgentPage(n)}},n.handleUrlPathChange=function(t){if(t)switch(t){case fe.CHAT.path:this.data.set("currentPage","main");break;case fe.SQUARE.path:this.data.set("currentPage","square");break;case fe.HISTORY.path:this.data.set("currentPage","history");break;case fe.AGENT.path:this.data.set("currentPage","lingjing");break;default:this.data.set("currentPage","main")}},n.getSideData=function(){var t=this;return rc((function(){var e,n,a,i,o,r,s,c;return cc(this,(function(l){switch(l.label){case 0:return[4,tc()];case 1:return e=l.sent(),n=e.appSquare,a=e.historyList,i=void 0===a?[]:a,o=e.feedback,r=ic(i),t.addAgentHistoryList(r),t.data.assign({appSquare:n,feedback:o}),Je.getState("tabName"),s=Je.getState("tplname"),c=Je.getState("agentInfo")||{},(Je.getState("openLeftAgent")||"ai_hotlist_recommend"===s)&&Object.keys(c).length>0&&t.openAgentPage(c),[2]}}))}))()},n.openAgentPage=function(t){var e=this.data.get("currentPage"),n=this.data.get("currentAgent"),a=ic([t])[0];"lingjing"===e&&(null==n?void 0:n.agentId)===a.agentId||!a.agentId||((this.data.get("agentList")||[]).some((function(t){return t.agentId===a.agentId}))||this.addAgentHistoryList([a]),this.data.set("currentPage","lingjing"),this.data.set("currentAgent",a),function(t){bn.router.push({path:fe.AGENT.path,query:{agentInfo:encodeURIComponent(JSON.stringify(t))}})}(a))},n.addAgentHistoryList=function(t){var e=this.data.get("agentList")||[],n=[].concat(t,e);this.data.set("agentList",n.splice(0,1))},n.created=function(){var t=this;this.getSideData().then((function(){t.initCurrentPage()})),ca().on((function(e){t.openAgentPage(e)})),Sa().on((function(){t.handleSquareClick()}))},n.initData=function(){return{agentList:[],appSquare:null,currentPage:"main",currentAgent:null,lastIndex:-1,feedback:{}}},n.attached=function(){this.handleAgentItemClick=_n(this.handleAgentItemClick,1e3,{leading:!0,trailing:!1});var t={container:this.ref("mainAgent"),renderer:"svg",loop:!1,autoplay:!0,path:"https://psstatic.cdn.bcebos.com/basics/chat/pc-lottie_1737460712000.json"};this.loadingInstance=i.loadAnimation(t),this.listenRouteChange()},n.listenRouteChange=function(){var t=this;this.unListenRouteChange(),this.routeChange=function(e){t.handleUrlPathChange(e.path)},bn.router.listen(this.routeChange)},n.unListenRouteChange=function(){this.routeChange&&bn.router.unlisten(this.routeChange),this.routeChange=null},n.agentShowLog=function(t,e){return"square"===e?JSON.stringify({value:"agent_center_entrance"}):JSON.stringify({value:"agent_list",agent_id:t.agentId,agent_name:t.agentName,agent_pos:+t.sequence+1})},n.agentClickLog=function(t,e){return"square"===e?JSON.stringify({value:"agent_center_entrance"}):JSON.stringify({value:"agent_list",ubcExt:{agent_id:t.agentId,agent_name:t.agentName,agent_pos:+t.sequence+1}})},n.handleAgentItemClick=function(t){this.openAgentPage(t)},n.handleSquareClick=function(){if("square"!==this.data.get("currentPage")){var t=this.data.get("appSquare");1==+t.jump_discovery_page&&t.pcSquareUrl?(this.data.set("currentPage","square"),function(t){bn.router.push({path:fe.SQUARE.path,query:{appSquare:encodeURIComponent(JSON.stringify(t))}})}(t)):window.open(t.pcUrl,"_blank")}},n.handleMainClick=function(){"main"!==this.data.get("currentPage")&&(this.data.set("currentPage","main"),Ra?bn.router.push(Ra):qa({isShowHello:"1",extParams:JSON.stringify({enter_type:"sidebar_dialog"})}))},n.handleNewChatClick=function(){this.data.set("currentPage","main"),Aa({type:"click",value:"sidebar_dialog",page:"resultpage",ext:{re_rank:String(Je.getState("rank"))}}),qa({isShowHello:"1",extParams:JSON.stringify({enter_type:"sidebar_dialog"})})},n.startMainAgentAnimation=function(){var t,e;null==(t=this.loadingInstance)||t.stop(),null==(e=this.loadingInstance)||e.play()},n.handleHistoryClick=function(){var t=this;return rc((function(){return cc(this,(function(e){return"history"===t.data.get("currentPage")||(Aa({type:"click",value:"his_dialog",page:"resultpage"}),t.data.set("currentPage","history"),bn.router.push({path:fe.HISTORY.path})),[2]}))}))()},n.handleFeedbackClick=function(){var t,e,n,a=Je.getState("rank"),i=kn(a),o=Je.getState("query"),r=Array.isArray(o)?null==(n=o[0])||null==(e=n.data)||null==(t=e.text)?void 0:t.query:"";Aa({type:"click",value:"cust_qrcode",ext:{setype:"csaitab",lid:Je.getState("lid"),ori_lid:Je.getState("oriLid"),sa:Je.getState("oriSa"),re_rank:String(a),a_lid:Je.getState("apagelid"),query:Je.getState("query")||"",enter_type:Je.getState("pcEnterType")||"ai_tab_url"}});var s=Je.getState("queryIndustry"),c=Je.getState("queryIntent"),l=Je.getState("agentInfo").agentName,d="https://ufosdk.baidu.com/ufosdk/report/99gI0SpRFv2dCvY9eEbr1g%3D%3D/294248?question="+encodeURIComponent(r)+"&answer_url="+encodeURIComponent(i)+"&extend_is_znt="+(l?1:2)+"&extend_industry="+encodeURIComponent(s)+"&extend_intention="+encodeURIComponent(c);window.open(d,"_blank")},n.handleMouseEnter=function(){Aa({type:"show",value:"cust_qrcode",ext:{setype:"csaitab",enter_type:Je.getState("pcEnterType")||"ai_tab_url",lid:Je.getState("lid"),sa:Je.getState("oriSa"),re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid"),query:Je.getState("query")||"",ori_lid:Je.getState("oriLid"),title:this.data.get("feedback").guideTitle,content:this.data.get("feedback").guideWord}})},n.disposed=function(){this.loadingInstance.destroy(),this.loadingInstance=null,this.unListenRouteChange()},e}(a.Component);function dc(){return dc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},dc.apply(this,Array.from(arguments))}lc.components={"cos-tooltip":e.Tooltip,"cos-icon":e.Icon},lc.computed={historyListLength:function(){var t=this.data.get("agentList")||[];return Array.isArray(t)?t.length:0},ubcClickLog:function(){var t=this.data.get("lastIndex")===(this.data.get("historyListLength")||0)-1?"find_agent":"";return JSON.stringify({type:"click",value:"ai_helper_title",ubcExt:{enter_type:t}})},ubcShowLog:function(){return JSON.stringify({type:"show",value:"ai_helper"})},historyBtnShowLog:function(){return JSON.stringify({value:"his_dialog"})},newChatBtnShowLog:function(){return JSON.stringify({value:"sidebar_dialog"})}},lc.template='\n        <div class="chat-left-bar-wrapper">\n            <div class="chat-left-bar cos-flex cos-flex-col cos-items-center" s-ref="chatLeftBar">\n                \x3c!-- 对话页面按钮 --\x3e\n                <div\n                    class="\n                        main-agent agent-item\n                        agent-item-animation\n                        {{currentPage === \'main\' ? \'agent-item-active\' : \'\'}}\n                    "\n                    on-mouseenter="startMainAgentAnimation"\n                >\n                    <cos-tooltip\n                        position="right"\n                        content="百度AI"\n                        bubble-class="chat-left-bar-tooltip"\n                    >\n                        <div\n                            class="agent-item-content"\n                            need-click-log\n                            data-click-log="{{ubcClickLog}}"\n                            data-show-ext="{{ubcShowLog}}"\n                            data-show-area\n                            on-click="handleMainClick"\n                        >\n                            <div class="main-agent-icon">\n                            </div>\n                            <div s-ref="mainAgent" class="main-agent-lottie"></div>\n                        </div>\n                    </cos-tooltip>\n                </div>\n\n                \x3c!-- 开启新对话按钮 --\x3e\n                <div\n                    class="\n                        agent-item\n                        agent-tool-item\n                    "\n                >\n                    <cos-tooltip\n                        position="right"\n                        content="开启新话题"\n                        bubble-class="chat-left-bar-tooltip"\n                    >\n                        <div\n                            class="agent-tool-item-icon-wrapper"\n                            s-ref="agent-square"\n                            data-show-ext="{{newChatBtnShowLog}}"\n                            data-show-area\n                            on-click="handleNewChatClick"\n                        >\n                            <div class="agent-item-content-avatar icon-new-chat" />\n                            新对话\n                        </div>\n                    </cos-tooltip>\n                </div>\n\n                \x3c!-- 历史页面按钮 --\x3e\n                <div\n                    class="\n                        agent-item\n                        agent-tool-item\n                        {{currentPage === \'history\' ? \'agent-item-active\' : \'\'}}\n                    "\n                >\n                    <cos-tooltip\n                        position="right"\n                        content="历史对话"\n                        bubble-class="chat-left-bar-tooltip"\n                    >\n                        <div\n                            class="agent-tool-item-icon-wrapper"\n                            s-ref="agent-square"\n                            data-show-ext="{{historyBtnShowLog}}"\n                            data-show-area\n                            on-click="handleHistoryClick"\n                        >\n                            <div class="agent-item-content-avatar icon-history" />\n                            历史\n                        </div>\n                    </cos-tooltip>\n                </div>\n\n                \x3c!-- 分割线 --\x3e\n                <div class="cos-divider chat-left-bar-divider"></div>\n\n                \x3c!-- agent按钮 --\x3e\n                <div\n                    s-for="item, index in agentList"\n                    class="\n                        agent-item\n                        {{!hasClick ? \'agent-item-animation\' : \'\'}}\n                        {{currentPage === \'lingjing\'\n                        && currentAgent.agentId === item.agentId ? \'agent-item-active\' : \'\'}}\n                        {{index === (historyListLength - 2) ? \'agent-item-last-animation\' : \'\'}}\n                    "\n                >\n                    <cos-tooltip\n                        position="right"\n                        content="{{item.name}}"\n                        bubble-class="chat-left-bar-tooltip"\n                    >\n                        <div\n                            s-ref="{{\'agent-\' + index}}"\n                            class="agent-item-content agent-item-agent-height"\n                            need-click-log\n                            data-click-log="{{agentClickLog(item)}}"\n                            data-show-ext="{{agentShowLog(item)}}"\n                            data-show-area\n                            on-click="handleAgentItemClick(item, index)"\n                        >\n                            <img\n                                class="agent-item-content-avatar"\n                                src="{{item.logo}}"\n                                alt="{{item.name}}"\n                            />\n                            <div class="right-area" style="display: none;">\n                                <div class="top-zone  cos-line-clamp-1">{{item.name}}</div>\n                                <div class="description-zone  cos-line-clamp-1">{{item.content}}</div>\n                            </div>\n                        </div>\n                    </cos-tooltip>\n                </div>\n\n                \x3c!-- 智能体广场按钮 --\x3e\n                <div\n                    s-if="{{appSquare}}"\n                    class="\n                        agent-item\n                        agent-tool-item\n                        {{currentPage === \'square\' ? \'agent-item-active\' : \'\'}}\n                    "\n                >\n                    <cos-tooltip\n                        position="right"\n                        content="{{appSquare.name}}"\n                        bubble-class="chat-left-bar-tooltip"\n                    >\n                        <div\n                            class="agent-tool-item-icon-wrapper"\n                            s-ref="agent-square"\n                            need-click-log\n                            data-click-log="{{agentClickLog(item, \'square\')}}"\n                            data-show-ext="{{agentShowLog(item, \'square\')}}"\n                            data-show-area\n                            on-click="handleSquareClick(appSquare)"\n                        >\n                            <div class="agent-item-content-avatar icon-square" />\n                            智能体\n                        </div>\n                    </cos-tooltip>\n                </div>\n\n                \x3c!-- 反馈hover按钮 --\x3e\n                <div\n                    class="agent-item agent-tool-item feedback-hover-show"\n                    on-mouseenter="handleMouseEnter"\n                    on-mouseleave="handleMouseLeave"\n                >\n                    <div class="agent-tool-item-icon-wrapper">\n                        <div class="agent-item-content-avatar icon-feedback" />\n                        反馈\n                    </div>\n                    <div\n                        s-ref="feedbackRef"\n                        class="agent-tool-feedback-group-wrapper"\n                    >\n                        <div class="agent-tool-feedback-group">\n                            <div class="agent-tool-feedback-group-title">{{feedback.guideTitle}}</div>\n                            <div class="agent-tool-feedback-group-subtitle">\n                                {{feedback.guideWord}}\n                            </div>\n                            <div class="agent-tool-feedback-group-img">\n                                <img\n                                    class="agent-tool-feedback-group-img-qrcode"\n                                    src="{{feedback.wxCode}}"\n                                />\n                                <img\n                                    class="agent-tool-feedback-group-img-wx"\n                                    src="https://gips0.baidu.com/it/u=3991094743,1489192704&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f67_67"\n                                />\n                            </div>\n                            <div\n                                class="agent-tool-feedback-group-text"\n                                on-click="handleFeedbackClick"\n                            >\n                                <span class="agent-tool-feedback-group-text-feedback">意见反馈</span>\n                                <div class="agent-tool-feedback-group-text-icon"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ';var uc=St.connect(Je,{query:"query",userInfo:"user"})(a.defineComponent({trimWhitespace:"all",template:'\n        <div class="chat-container-header">\n            <a href=\'//www.baidu.com\' target="_self" class="chat-header-logo">\n                <img\n                    class="index-logo-srcnew"\n                    src="//www.baidu.com/img/flexible/logo/pc/result@2.png"\n                    alt="到百度首页"\n                    title="到百度首页"\n                >\n            </a>\n           <div class="chat-header-tab">\n                <a\n                    s-for="item, index in tabList"\n                    href="{{item.realUrl || item.orig_link}}"\n                    target="_self"\n                    class="\n                        chat-header-tab-item\n                        {{!item.tabImgUrl ? \'chat-header-tab-\' + item.log : \'\'}}\n                    "\n                >\n                    <img s-if="item.tabImgUrl" src="{{item.tabImgUrl}}" class="header-tab-image" />\n                    <span s-else>{{item.text}}</span>\n\n                    \x3c!-- 底部线条 --\x3e\n                    <div s-if="{{item.log === \'csaitab\'}}"\n                        class="{{[\'bottom-line\', getBottomLineClass(aiTabSample)]}}"\n                    ></div>\n                </a>\n            </div>\n            <div class="chat-header-nav">\n                <a\n                    class="chat-header-nav-item"\n                    href="//www.baidu.com"\n                    target="_self"\n                >\n                    百度首页\n                </a>\n                <div\n                    s-if="userInfo.isUserLogin"\n                    class="user-mask"\n                >\n                    <div class="user-info">\n                        <div class="avatar">\n                            <cos-avatar\n                                class="avatar-content"\n                                src="{{userInfo.headImg}}"\n                                size="sm"\n                            />\n                        </div>\n                        <span class="cos-line-clamp-1">{{userInfo.name}}</span>\n                    </div>\n                    <div\n                        class="user-menu"\n                    >\n                        <div class="user-menu-content">\n                            <a href="//www.baidu.com/my/index" target="_self" class="user-menu-item cos-link">个人中心</a>\n                            <a href="//passport.baidu.com" target="_self" class="user-menu-item cos-link">账号设置</a>\n                            <div class="user-menu-item cos-link" on-click="handleLogout">退出登录</div>\n                        </div>\n                    </div>\n                </div>\n                <div s-else class="login-btn">\n                    <div on-click="handleLogin">登录</div>\n                </div>\n            </div>\n        </div>\n    ',components:{"cos-avatar":e.Avatar},initData:function(){var t,e;return{tabList:Je.getState("tabList"),userInfo:Je.getState("user"),sample:Je.getState("sample"),aiTabSample:null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.PC_INDEX_EXP,aiTabImages:{AsstOne:"https://gips1.baidu.com/it/u=2324779682,4137008596&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f147_42",AsstThree:"https://gips3.baidu.com/it/u=1372663774,1923026649&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f105_42",AsstFour:"https://gips2.baidu.com/it/u=758713753,2013802961&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f147_42"}}},attached:function(){var t=this,e=yt(this.data.get("query")||"");this.changeTabListLink(e||""),this.watch("query",(function(e){var n=yt(e);t.changeTabListLink(n)})),this.watch("userInfo",(function(e){t.data.set("userInfo",e)}))},getBottomLineClass:function(t){return"AsstOne"===t||"AsstFour"===t?"bottom-line-long":"AsstThree"===t?"bottom-line-short":""},changeTabListLink:function(t){var e=this.data.get("tabList")||[];try{var n=e.filter((function(t){return t.orig_link})).map((function(e){return dc({},e,{realUrl:e.orig_link.replace(/_QUERY_/g,t)||""})}));this.data.set("tabList",n)}catch(t){}},handleLogin:function(){this.fire("login")},handleLogout:function(){!function(){if(ft())fetch("https://passport.baidu.com/?logout&u=https://chat.baidu.com",{mode:"cors"}).catch((function(){})).then((function(){Je.dispatch("update",{user:{isUserLogin:!1}})}));else{var t=window.location.href;window.location.href="https://passport.baidu.com/?logout&u="+encodeURIComponent(t)}}()}}));function pc(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function hc(){return hc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},hc.apply(this,Array.from(arguments))}function fc(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var gc=St.connect(Je,{topRank:"topRank"})(a.defineComponent({components:{},initData:function(){return{agentSugList:[],textSugList:[],type:"agent",showSug:!1}},computed:{sugList:function(){return"agent"===this.data.get("type")?this.data.get("agentSugList"):this.data.get("textSugList")}},created:function(){this.getSugList=wn(this.getSugList.bind(this),300)},attached:function(){},clickSug:function(t){this.dispatch("sug-click",hc({},t,{type:this.data.get("type")})),this.closeSug()},openSug:function(t){var e=this;void 0===t&&(t="common"),this.data.set("type",t),!this.data.get("showSug")&&this.nextTick((function(){e.data.set("showSug",!0)}))},closeSug:function(){this.data.set("showSug",!1),this.data.set("textSugList",[]),this.data.set("agentSugList",[])},updateSug:function(t){},getSugList:function(t,e){return(n=function(){var n;return fc(this,(function(a){switch(a.label){case 0:return n=this,t||"common"!=e?(Je.getState("chatParams"),[4,ja(Je.getState("chatParams").sse_host+"/aichat/api/aitabserver?ctl=sug&action="+e+"&tk="+$r(t)+"&query="+t+"&lid="+(Je.getState("lid")||"")+"&ori_lid="+(Je.getState("oriLid")||""),{credentials:"include"},2e3).then((function(t){if(1003===t.status&&n.closeSug(),0!==t.status||!t.data)return Promise.reject();"common"===e?n.data.set("textSugList",t.data.common_sugs):"agent"===e&&n.data.set("agentSugList",t.data.agent_input_sugs)})).catch((function(t){}))]):(this.closeSug(),[2]);case 1:return a.sent(),[2]}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(a,i){var o=n.apply(t,e);function r(t){pc(o,a,i,r,s,"next",t)}function s(t){pc(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var n}})),mc={};mc=Object.assign(mc,{sugWarp:"sug-warp_1mqhe_1","sug-warp":"sug-warp_1mqhe_1",sugContainer:"sug-container_1mqhe_5","sug-container":"sug-container_1mqhe_5",sugList:"sug-list_1mqhe_18","sug-list":"sug-list_1mqhe_18",sugTitle:"sug-title_1mqhe_24","sug-title":"sug-title_1mqhe_24",textSugItem:"text-sug-item_1mqhe_31","text-sug-item":"text-sug-item_1mqhe_31",agentSugItem:"agent-sug-item_1mqhe_48","agent-sug-item":"agent-sug-item_1mqhe_48",avatar:"avatar_1mqhe_61",right:"right_1mqhe_70",top:"top_1mqhe_76",name:"name_1mqhe_81",tag:"tag_1mqhe_90",description:"description_1mqhe_100"}),gc.template='\n    <div class="{{$style[\'sug-warp\']}}">\n        <div s-show="{{\n            showSug\n            && (\n                type === \'agent\' && agentSugList.length \n                || type === \'common\' && textSugList.length\n            )\n            }}" class="{{$style[\'sug-container\']}}"\n        >\n            <div class="{{$style[\'sug-list\']}}">\n                <div s-if="{{type === \'agent\'}}" class="{{$style[\'sug-title\']}}">选择智能体</div>\n                <fragment s-for="item, index in sugList">\n                    <div\n                        s-if="{{type === \'common\'}}"\n                        class="{{$style[\'text-sug-item\']}}"\n                        on-click="clickSug(item)"\n                    >\n                        {{item.word}}\n                    </div>\n                    <div s-else class="{{$style[\'agent-sug-item\']}}" on-click="clickSug(item)">\n                        <img\n                            class="{{$style[\'avatar\']}}"\n                            src="{{item.logo}}"\n                            size="md"\n                        />\n                        <div class="{{$style[\'right\']}}">\n                            <div class="{{$style[\'top\']}}">\n                                <div class="{{$style[\'name\']}} c-fwb">\n                                    <div class="cos-line-clamp-1">\n                                        {{item.source_name}}\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="{{$style[\'description\']}} cos-line-clamp-1">{{item.description}}</div>\n                        </div>\n                    </div>\n                </fragment>\n            </div>\n        </div>\n    </div>\n';var vc="function"==typeof gc?gc.prototype.initData||yc:gc.initData||yc;function yc(){return{$style:mc}}function bc(){return Object.assign({},vc.call(this),{$style:mc})}function wc(){return wc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},wc.apply(this,Array.from(arguments))}function _c(){var t=document.getElementById("chat-input-box");t&&(t.focus(),requestAnimationFrame((function(){var e=window.getSelection(),n=document.createRange();n.selectNodeContents(t),n.collapse(!1),e.removeAllRanges(),e.addRange(n)})))}function kc(t){for(var e=[],n=0;n<t.length;n+=4)e.push(t.slice(n,n+4));return e}"function"==typeof gc?gc.prototype.initData=bc:gc.initData=bc;var Sc="url(https://gips0.baidu.com/it/u=161044061,4252923122&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f60_60)",xc="url(https://gips2.baidu.com/it/u=787057621,2047762553&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f60_60)";var Ic=a.defineComponent({template:'\n        <div class="input-panel-header {{title ? \'\' : \'input-panel-header-no-title\'}}">\n            <div s-if="title" class="input-panel-header-title">{{title}}</div>\n            <cos-icon on-click="native:handleClose" class="input-panel-header-close" name="close" />\n        </div>\n    ',components:{"cos-icon":e.Icon},initData:function(){return{title:""}},handleClose:function(){this.dispatch("ui:input-panel-header-close"),this.fire("close")}}),Tc=a.defineComponent({template:'\n        <div s-ref="creatItem" class="input-panel-creat-item {{selected ? \'input-panel-creat-item-selected\' : \'\'}}">\n            <img class="input-panel-creat-item-icon" src="{{data.icon}}" />\n            <div class="input-panel-creat-item-title cos-line-clamp-1">{{data.text}}</div>\n            <div class="input-panel-creat-item-desc cos-line-clamp-1">\n                <img class="input-panel-creat-item-logo" s-if="data.descIcon" src="{{data.descIcon}}" />\n                {{data.desc}}\n            </div>\n        </div>\n    ',initData:function(){return{data:{},selected:!1,order:-1}},attached:function(){this.observer()},observer:function(){var t=this,e=this.el,n=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){var n=t.data.get("data"),a=t.data.get("order");n.order=a,t.dispatch("ui:input-panel-creat-item-show",n)}}))}),{root:null,threshold:.6});e&&n.observe(e)}});function Cc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Lc(){return Lc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Lc.apply(this,Array.from(arguments))}function Pc(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Cc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cc(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Dc=a.defineComponent({template:'\n        <div class="input-panel-creat">\n            <header\n                title="{{title}}"\n                on-close="handleClose"\n            />\n\n            <div class="input-panel-creat-tab">\n                <cos-swiper s-ref="swiper" spaceBetween="{{8}}">\n                    <cos-swiper-item\n                        s-for="item in tabList"\n                    >\n                        <div\n                            class="input-panel-creat-tab-item\n                                {{selectedTab === item.tabId ? \'input-panel-creat-tab-item-selected\' : \'\'}}\n                            "\n                            on-click="handleTabClick(item.tabId)"\n                        >\n                            {{item.tabName}}\n                        </div>\n                    </cos-swiper-item>\n                </cos-swiper>\n            </div>\n\n            <div class="input-panel-creat-content">\n                <div\n                    s-for="itemList, index in showContentList"\n                    class="input-panel-creat-content-list"\n                >\n                    <creae-item\n                        s-for="item, itemIndex in itemList"\n                        data="{{item}}"\n                        order="{{index * 4 + itemIndex}}"\n                        selected="{{selectedBtn === item.buttonId}}"\n                        on-click="native:handleItemClick(item, index * 4 + itemIndex)"\n                        class="input-panel-creat-content-list-item"\n                    />\n                </div>\n            </div>\n        </div>\n    ',components:{"creae-item":Tc,header:Ic,"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem},initData:function(){return{data:{},selectedTab:"all",selectedBtn:"",showBtnList:[],triggerType:""}},messages:{"ui:input-panel-creat-item-show":function(t){this.collectShowBtn(t.value)}},computed:{title:function(){return this.data.get("data.jumpPanel.data.officeCreate.title")||""},tabList:function(){var t=this.data.get("data.jumpPanel.data.officeCreate.tabList")||[],e=[].concat(t);return e.unshift({tabId:"all",tabName:"全部"}),e},showContentList:function(){var t=this.data.get("selectedTab"),e=this.data.get("data.jumpPanel.data.officeCreate.list")||[];return kc("all"===t?e:e.filter((function(e){return(null==e?void 0:e.tabId)===t})))}},attached:function(){var t=this;this.nextTick((function(){var e;null==(e=t.ref("swiper"))||e.updatedWidth()})),this.watch("selectedTab",(function(e,n){var a=n.oldValue;t.sendShowLog(a)}))},detached:function(){this.sendShowLog()},handleTabClick:function(t){this.data.get("selectedTab")!==t&&this.data.set("selectedTab",t)},handleItemClick:function(t,e){this.data.set("selectedBtn",t.buttonId);var n=(null==t?void 0:t.function)||{};if("input"===n.type){var a,i=(null==(a=n.data)?void 0:a.input)||{},o=null==i?void 0:i.interactionType;xa().emit({sa:"functab_office_"+Ki(null==t?void 0:t.buttonId)}),jn().emit(Lc({agentInfo:i.agentInfo,inputCustom:null==i?void 0:i.inputCustom},o?{interactionType:o}:{}))}this.sendClickLog(t,e)},getBtnLogData:function(t,e){var n={function_click_type:"text",function_name:t.buttonId,function_pos:String((null!=e?e:t.order)+1)};return t.agentInfo&&(n.agent_id=t.agentInfo.agentId,n.agent_name=t.agentInfo.agentName),n},sendClickLog:function(t,e){var n=this.data.get("selectedTab"),a=this.data.get("triggerType");Aa({ubcId:"17132",type:"click",value:"function_panel",ext:{setype:"csaitab",function_type:"text",function_tab:n,valueInfo:[this.getBtnLogData(t,e)],trigger_type:a}})},collectShowBtn:function(t){for(var e,n=Pc(this.data.get("showBtnList"));!(e=n()).done;){if(e.value.buttonId===t.buttonId)return}this.data.push("showBtnList",t)},sendShowLog:function(t){var e=this,n=this.data.get("showBtnList"),a=[],i=this.data.get("selectedTab");n.forEach((function(t){a.push(e.getBtnLogData(t))})),this.data.set("showBtnList",[]);var o=this.data.get("triggerType");Aa({ubcId:"17132",type:"show",value:"function_panel",ext:{setype:"csaitab",function_type:"text",function_tab:t||i,valueInfo:a,trigger_type:o}})}}),Ac={pdf:"PDF",doc:"WORD",docx:"WORD",txt:"TXT",xls:"EXCEL",xlsx:"EXCEL",ppt:"PPT",pptx:"PPT",csv:"EXCEL"};function Ec(t){if(!t)return"unknown";var e=t.toLowerCase();return Ac[e]||"unknown"}var Oc=/\.(\w+)$/;function Rc(t){var e=Oc.exec(t);return e?Ec(e[1]):"unknown"}function Nc(t){if("[object Number]"!==ve(t))return"0B";if(t<1024)return t+"B";if(t<1048576){var e=t/1024;return Math.round(100*e)/100+"KB"}var n=t/1048576;return Math.round(100*n)/100+"MB"}var qc=a.defineComponent({template:'\n        <div class="input-panel-draw-item" on-click="handleBtnClick">\n            <img class="input-panel-draw-item-img" src="{{data.icon}}" />\n            <div class="input-panel-draw-item-text cos-line-clamp-1">{{desc}}</div>\n            <div class="input-panel-draw-item-mark"></div>\n            <div class="input-panel-draw-item-btn">\n                <img class="input-panel-draw-item-btn-icon" src="{{editIcon}}" />\n                <span class="input-panel-draw-item-btn-text">画同款</span>\n            </div>\n        </div>\n    ',computed:{desc:function(){var t=this.data.get("data.text"),e=this.data.get("data.agentInfo");return(null==e?void 0:e.agentName)?"@"+e.agentName:t}},initData:function(){return{data:{},editIcon:"https://gips0.baidu.com/it/u=4283482391,4095503797&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f43_43",order:-1}},attached:function(){this.observer()},handleBtnClick:function(){this.fire("btn-click")},observer:function(){var t=this,e=this.el,n=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){var n=t.data.get("data"),a=t.data.get("order");n.order=a,t.dispatch("ui:input-panel-draw-item-show",n)}}))}),{root:null,threshold:.6});e&&n.observe(e)}}),Mc="CHAT_SEARCH_DRAW_ITEM_SHUFFLE",jc="CHAT_SEARCH_DRAW_ITEM_SHUFFLE_TIME",Bc=a.defineComponent({template:'\n        <div class="input-panel-draw">\n            <header title="{{title}}"></header>\n            <div class="cos-divider cos-space-mt-md input-panel-draw-divider"></div>\n\n            <div class="input-panel-draw-tools">\n                <div class="input-panel-draw-tools-title">{{toolsData.title}}</div>\n                <div class="input-panel-draw-tools-list">\n                    <div\n                        s-for="item, index in toolsData.list"\n                        class="input-panel-draw-tools-list-item"\n                        on-click="native:handleToolsBtnClick(item, index)"\n                    >\n                        <img class="input-panel-draw-tools-list-item-icon" src="{{item.icon}}" />\n                        {{item.text}}\n                    </div>\n                </div>\n            </div>\n\n            <div class="input-panel-draw-content">\n                <div class="input-panel-draw-content-title">{{contentTitle}}</div>\n                <div class="input-panel-draw-content-list">\n                    <div\n                        s-for="itemList, index in showContentList"\n                        class="input-panel-draw-content-list-item"\n                    >\n                        <fragment s-for="item, itemIndex in itemList">\n                            <div s-if="itemIndex !== 0" class="input-panel-draw-content-list-item-space"></div>\n                            <draw-item\n                                class="input-panel-draw-content-list-item-btn"\n                                data="{{item}}"\n                                order="{{index * 4 + itemIndex}}"\n                                on-btn-click="handleDrawBtnClick(item, index * 4 + itemIndex)"\n                            />\n                        </fragment>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',components:{header:Ic,"draw-item":qc},messages:{"ui:input-panel-draw-item-show":function(t){this.collectShowBtn(t.value)}},computed:{title:function(){return this.data.get("data.jumpPanel.data.photoEditing.title")||""},toolsData:function(){return this.data.get("data.jumpPanel.data.photoEditing.tools")||[]},contentTitle:function(){return this.data.get("data.jumpPanel.data.photoEditing.sameStyle.title")||""}},initData:function(){return{triggerType:"",showBtnList:[],showContentList:[[]]}},attached:function(){this.data.set("showContentList",this.getRandomContentList())},detached:function(){this.sendShowLog(),this.data.set("showContentList",this.getRandomContentList())},getRandomContentList:function(){var t,e;try{t=JSON.parse(window.localStorage.getItem(Mc)||"[]"),e=Number(window.localStorage.getItem(jc)||0)}catch(n){t=[],e=0}var n=kc(this.data.get("data.jumpPanel.data.photoEditing.sameStyle.list")||[]);(!e||t.length!==n.length||Ii(e)>0)&&(t=function(t){if(!be(t))return[];for(var e=t.slice(),n=e.length-1;n>0;n--){var a,i=Math.floor(Math.random()*(n+1));a=[e[i],e[n]],e[n]=a[0],e[i]=a[1]}return e}(Array.from({length:n.length},(function(t,e){return e}))),window.localStorage.setItem(Mc,JSON.stringify(t)),window.localStorage.setItem(jc,String(+new Date)));var a=[];return t.forEach((function(t,e){a[t]=n[e]})),a},handleToolsBtnClick:function(t,e){var n,a,i=(null==t?void 0:t.function)||{};"link"===i.type&&(this.sendClickLog(t,e),window.open(null==(a=i.data)||null==(n=a.link)?void 0:n.url))},handleDrawBtnClick:function(t,e){var n,a,i=(null==t?void 0:t.function)||{};"input"===i.type&&(xa().emit({sa:"functab_pic_"+Ki(null==t?void 0:t.buttonId)}),jn().emit({inputCustom:null==(a=i.data)||null==(n=a.input)?void 0:n.inputCustom}));this.sendClickLog(t,e)},getBtnLogData:function(t,e){var n,a={function_click_type:"link"===(null==t||null==(n=t.function)?void 0:n.type)?"click":"text",function_name:t.buttonId,function_pos:String((null!=e?e:t.order)+1)};return t.agentInfo&&(a.agent_id=t.agentInfo.agentId,a.agent_name=t.agentInfo.agentName),a},sendClickLog:function(t,e){var n=this.data.get("triggerType");Aa({ubcId:"17132",type:"click",value:"function_panel",ext:{setype:"csaitab",function_type:"pic",function_tab:"all",valueInfo:[this.getBtnLogData(t,e)],trigger_type:n}})},collectShowBtn:function(t){for(var e=this.data.get("showBtnList"),n=0;n<e.length;n++)if(e[n].buttonId===t.buttonId)return;this.data.push("showBtnList",t)},sendShowLog:function(){var t=this,e=this.data.get("showBtnList"),n=this.data.get("toolsData"),a=[];e.forEach((function(e){a.push(t.getBtnLogData(e))})),n.list.forEach((function(e,n){a.push(t.getBtnLogData(e,n))})),this.data.set("showBtnList",[]);var i=this.data.get("triggerType");Aa({ubcId:"17132",type:"show",value:"function_panel",ext:{setype:"csaitab",function_type:"pic",function_tab:"all",valueInfo:a,trigger_type:i}})}}),Hc=a.defineComponent({template:'\n        <div class="input-panel-read">\n            <header title="{{title}}" />\n\n            <div class="input-panel-read-content">\n                <div\n                    on-click="handleBtnClick(item, index)"\n                    s-for="item, index in list"\n                    class="input-panel-read-content-btn"\n                >\n                    <img class="input-panel-read-content-btn-img" src="{{item.icon}}" />\n                    <div class="input-panel-read-content-btn-name">{{item.text}}</div>\n                    <div class="input-panel-read-content-btn-desc">{{item.desc}}</div>\n                    <div class="input-panel-read-content-btn-limit">{{item.limit}}</div>\n                </div>\n            </div>\n        </div>\n    ',components:{header:Ic},computed:{title:function(){return this.data.get("data.jumpPanel.data.aiRead.title")||""},list:function(){return this.data.get("data.jumpPanel.data.aiRead.list")||[]}},detached:function(){this.sendShowLog()},handleBtnClick:function(t,e){if("upload"===t.function.type)this.dispatch("ui:input-upload",0===e?"file":"image");else if("input"===t.function.type){var n,a;jn().emit({inputCustom:null==(a=t.function.data)||null==(n=a.input)?void 0:n.inputCustom})}"readPanel_tianjialianjie"===t.buttonId&&this.dispatch("ui:input-panel-button-click",t),xa().emit({sa:"functab_read_"+Ki(null==t?void 0:t.buttonId)}),this.sendBtnClickLog(t,e)},sendBtnClickLog:function(t,e){var n=this.data.get("triggerType");Aa({ubcId:"17132",type:"click",value:"function_panel",ext:{setype:"csaitab",function_type:"read",function_tab:"all",valueInfo:[this.getBtnLogData(t,e)],trigger_type:n}})},getBtnLogData:function(t,e){var n,a={function_click_type:"upload"===(null==t||null==(n=t.function)?void 0:n.type)?"upload":"text",function_name:t.buttonId,function_pos:String((null!=e?e:t.order)+1)};return t.agentInfo&&(a.agent_id=t.agentInfo.agentId,a.agent_name=t.agentInfo.agentName),a},sendShowLog:function(){var t=this,e=this.data.get("list"),n=[];e.forEach((function(e,a){n.push(t.getBtnLogData(e,a))}));var a=this.data.get("triggerType");Aa({ubcId:"17132",type:"show",value:"function_panel",ext:{setype:"csaitab",function_type:"read",function_tab:"all",valueInfo:n,trigger_type:a}})}});function $c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Uc(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Fc(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Uc(o,a,i,r,s,"next",t)}function s(t){Uc(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Gc(){return Gc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Gc.apply(this,Array.from(arguments))}function Wc(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$c(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zc(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Qc="CHAT_SEARCH_USED_GUIDE",Jc=[{type:"input-model",init:!1},{type:"input-panel-ai_ppt",init:!1}],Vc=function(){function t(){this.taskQueue=[],this.isProcessing=!1,this.currentTask=null,this.toolTipMap=$a(Jc),this.initLocalStorage()}var e=t.prototype;return e.initLocalStorage=function(){var t=localStorage.getItem(Qc);if(t)try{var e=JSON.parse(t);(null==e?void 0:e.selectModelGuide)&&localStorage.setItem(Qc,JSON.stringify(Gc({},e,{"input-model":!0})))}catch(t){console.error("初始化本地存储失败:",t),localStorage.setItem(Qc,JSON.stringify({}))}else localStorage.setItem(Qc,JSON.stringify({}))},e.init=function(t){var e=t.type,n=this.toolTipMap.findIndex((function(t){return t.type===e}));n>-1&&(this.toolTipMap[n]=Gc({},t,{init:!0})),this.toolTipMap.every((function(t){return t.init}))&&this.action()},e.getToolTipMap=function(){return this.toolTipMap},e.closeToolTip=function(t){var e;if((null==(e=this.currentTask)?void 0:e.type)===t){var n=this.currentTask,a=n.close,i=n.resolve,o=n.timeoutId;null==a||a(),null==i||i(),o&&clearTimeout(o)}},e.action=function(){for(var t,e=Wc(this.toolTipMap);!(t=e()).done;){var n=t.value,a=n.type,i=(null==n?void 0:n.localStorageKey)||a;this.getLocalStorage(i)||this.taskQueue.push(n)}var o=this.taskQueue.shift();o&&this.processTask(o)},e.getLocalStorage=function(t){try{var e=localStorage.getItem(Qc);return(e?JSON.parse(e):{})[t]}catch(t){return console.error("读取本地存储失败:",t),{}}},e.setLocalStorage=function(t){try{var e,n=localStorage.getItem(Qc),a=n?JSON.parse(n):{};localStorage.setItem(Qc,JSON.stringify(Gc({},a,((e={})[t]=!0,e))))}catch(e){var i;console.error("设置本地存储失败:",e);var o=((i={})[t]=!0,i);localStorage.setItem(Qc,JSON.stringify(o))}},e.reset=function(){this.taskQueue=[],this.isProcessing=!1,this.currentTask=null},e.processNextTask=function(){var t=this;return Fc((function(){var e;return zc(this,(function(n){switch(n.label){case 0:return t.isProcessing||0===t.taskQueue.length?[2]:(t.isProcessing=!0,(e=t.taskQueue.shift())?[4,t.processTask(e)]:[3,2]);case 1:n.sent(),n.label=2;case 2:return t.isProcessing=!1,t.processNextTask(),[2]}}))}))()},e.processTask=function(t){var e=this;return Fc((function(){var n,a,i,o,r,s;return zc(this,(function(c){switch(c.label){case 0:n=t.type,a=t.close,i=t.open,o=t.autoCloseTime,c.label=1;case 1:return c.trys.push([1,3,,4]),i(),r=(null==t?void 0:t.localStorageKey)||n,e.setLocalStorage(r),[4,new Promise((function(n){var i=setTimeout((function(){a(),n()}),o||3e3);e.currentTask=Gc({},t,{timeoutId:i,resolve:n})}))];case 2:return c.sent(),[3,4];case 3:return s=c.sent(),console.error("处理ToolTip任务失败:",s),[3,4];case 4:return[2]}}))}))()},t}(),Kc=new Vc;function Xc(){return Xc=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Xc.apply(this,Array.from(arguments))}var Yc="CHAT_SEARCH_INPUT_PANEL_GUIDE";function Zc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function tl(){return tl=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},tl.apply(this,Array.from(arguments))}function el(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Zc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zc(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var nl,al={office_create:"cs-input-creat",photo_editing:"cs-input-draw",ai_read:"cs-input-read"},il={7:"office_create",8:"photo_editing"},ol=a.defineComponent({resizeObservers:new Map,template:'\n        <div s-if="panelData && panelData.length" class="input-panel-wapper" data-show-area >\n            <div s-if="isShowPanelBtn" class="input-panel-btn-list">\n            <template s-for="item in panelData">\n                <cos-tooltip\n                    s-ref="{{\'tooltip\' + item.type}}"\n                    content="{{item.guide}}"\n                    position="top-start"\n                    trigger="custom"\n                    open="{{showGuide[item.type] && item.guide}}"\n                    bubbleClass="cs-input-panel-guide-tip"\n                >\n                    <div\n                        class="\n                            input-panel-btn\n                            {{\n                                item.guide && !hasClickGuide[item.type]\n                                    ? \'input-panel-btn-guide\'\n                                    : \'\'\n                            }}\n                        "\n                        on-click="handleBtnClick(item)"\n                        data-show-ext="{{item | inputPanelBtnRealShowExt}}"\n                    >\n                        <img class="input-panel-btn-icon" src="{{item.icon}}" />\n                        <div class="input-panel-btn-text">{{item.text}}</div>\n                    </div>\n                </cos-tooltip>\n            </template>\n            <div s-if="showPanel" class="input-panel-container {{showPanelTrans ? \'input-panel-show\' : \'\'}}">\n                <fragment s-for="panelItem in panelData">\n                    <div\n                        s-if="showPanel === panelItem.type"\n                        s-is="{{panelComponents[panelItem.type]}}"\n                        data="{{panelItem}}"\n                        is-show="{{showPanel === panelItem.type}}"\n                        trigger-type="{{triggerType}}"\n                    ></div>\n                </fragment>\n            </div>\n        </div>\n    ',messages:{"ui:input-panel-header-close":function(){this.closePanel()}},components:(nl={},nl[al.office_create]=Dc,nl[al.photo_editing]=Bc,nl[al.ai_read]=Hc,nl["cos-tooltip"]=e.Tooltip,nl),computed:{},filters:{inputPanelBtnRealShowExt:function(t){return JSON.stringify({value:"capsule_office",valueInfo:[{component_name:"shortcuts",component_content:t.buttonId}]})}},initData:function(){return{showPanel:"",panelComponents:al,panelData:[],isShowPanelBtn:!ft(),triggerType:"",showGuide:{},hasClickGuide:{}}},attached:function(){this.listener(),this.data.get("isShowPanelBtn")&&this.setChatContainerPaddingBottom(49)},initClickGuide:function(t){var e=function(t){try{var e=localStorage.getItem(Yc);return(e?JSON.parse(e):{})[t]}catch(t){return console.error("读取本地存储失败:",t),{}}}(t);this.data.set("hasClickGuide."+t,e)},initToolTip:function(t){var e=this,n="input-panel-"+t,a=Kc.getLocalStorage(n);if(Kc.init({type:n,init:!0,open:function(){e.data.set("showGuide."+t,!0)},close:function(){e.data.set("showGuide."+t,!1)}}),!a&&window.ResizeObserver){var i=new ResizeObserver(_n((function(n){var a=e.resizeObservers.get(t);(null==a?void 0:a.rafId)&&cancelAnimationFrame(a.rafId);var o=requestAnimationFrame((function(){for(var a,i=el(n);!(a=i()).done;){if(a.value.target.classList.value.includes("chat-container-main-wrapper")){var o=e.ref("tooltip"+t);o&&o.pagePositionChange()}}}));e.resizeObservers.set(t,{observer:i,rafId:o})}),50)),o=document.querySelector("[class*=chat-container-main-wrapper]");o&&(i.observe(o),this.resizeObservers.set(t,{observer:i,rafId:null}))}},detached:function(){this.setChatContainerPaddingBottom(18)},listenSendInputPanelData:null,listenOpenInputPanel:null,listenCloseInputPanel:null,listener:function(){var t=this;this.watch("isShowPanelBtn",(function(e){e&&!ft()?t.setChatContainerPaddingBottom(49):t.setChatContainerPaddingBottom(18)})),this.watch("showPanel",(function(e){e?setTimeout((function(){t.data.set("showPanelTrans",!0)}),0):t.data.set("showPanelTrans",!1)})),this.listenSendInputPanelData=function(e){t.data.set("panelData",Vi(e));var n=Je.getState("searchParams").openInputMode;n&&il[n]&&t.openPanel(il[n]);for(var a,i=el(t.data.get("panelData"));!(a=i()).done;){var o=a.value;o.guide&&(t.initToolTip(o.type),t.initClickGuide(o.type))}},wa().on(this.listenSendInputPanelData),this.listenOpenInputPanel=function(e){var n=e.type,a=e.triggerType;t.openPanel(n,a)},ba().on(this.listenOpenInputPanel),this.listenCloseInputPanel=function(e){"Escape"===e.key&&t.closePanel()},document.addEventListener("keydown",this.listenCloseInputPanel)},disposed:function(){this.clickListener&&document.removeEventListener("click",this.clickListener),this.listenSendInputPanelData&&(wa().off(this.listenSendInputPanelData),this.listenSendInputPanelData=null),this.listenOpenInputPanel&&(ba().off(this.listenOpenInputPanel),this.listenOpenInputPanel=null),this.listenCloseInputPanel&&(document.removeEventListener("keydown",this.listenCloseInputPanel),this.listenCloseInputPanel=null),this.resizeObservers&&(this.resizeObservers.forEach((function(t){t.rafId&&cancelAnimationFrame(t.rafId),t.observer&&t.observer.disconnect()})),this.resizeObservers.clear())},setChatContainerPaddingBottom:function(t){var e=document.querySelector("[class*='chat-container-main-stream']");e&&(e.style.paddingBottom=t+"px")},handleBtnClick:function(t){if(Aa({ubcId:"17132",type:"click",value:"capsule_office",ext:{setype:"csaitab",valueInfo:[{component_name:"shortcuts",component_content:t.buttonId}]}}),t.jumpPanel?this.openPanel(t.type,"search_box"):this.handlePptBtnClick(t),t.guide){Kc.closeToolTip("input-panel-"+t.type),function(t){try{var e,n=localStorage.getItem(Yc),a=n?JSON.parse(n):{};localStorage.setItem(Yc,JSON.stringify(Xc({},a,((e={})[t]=!0,e))))}catch(e){var i;console.error("设置本地存储失败:",e);var o=((i={})[t]=!0,i);localStorage.setItem(Yc,JSON.stringify(o))}}(t.type);var e,n=this.data.get("hasClickGuide");this.data.set("hasClickGuide",tl({},n,((e={})[t.type]=!0,e)))}},handlePptBtnClick:function(t){var e=null==t?void 0:t.buttonId;this.data.set("selectedBtn",e);var n=(null==t?void 0:t.function)||{};if("input"===n.type){var a,i=(null==(a=n.data)?void 0:a.input)||{},o=null==i?void 0:i.interactionType;xa().emit({sa:"aippt_capsule"}),jn().emit(tl({agentInfo:i.agentInfo,inputCustom:null==i?void 0:i.inputCustom},o?{interactionType:o}:{}))}},openPanel:function(t,e){var n,a=this;void 0===e&&(e="search_box"),this.data.set("triggerType",e),this.data.set("showPanel",t);var i=null==(n=this.data.get("panelData"))?void 0:n.find((function(e){return e.type===t}));i&&this.dispatch("ui:input-panel-change",{type:"open",showPanelData:i});this.clickListener&&document.removeEventListener("click",this.clickListener),this.clickListener=function(t){t.target&&!t.target.closest(".chat-input-box-pc")&&a.closePanel()},document.addEventListener("click",this.clickListener,!0)},closePanel:function(){var t,e=this.data.get("showPanel");this.data.set("showPanel","");var n=null==(t=this.data.get("panelData"))?void 0:t.find((function(t){return t.type===e}));n&&this.dispatch("ui:input-panel-change",{type:"close",showPanelData:n}),this.clickListener&&document.removeEventListener("click",this.clickListener),this.clickListener=null}}),rl=a.defineComponent({template:'\n        <div class="cs-input-file-container">\n            <fragment s-for="fileItem, index in fileList">\n                \x3c!-- 文件类型 --\x3e\n                <div\n                    s-if="fileItem.uploadType === \'file\'"\n                    class="cs-input-file\n                        {{fileItem.status === 0 ? \'cs-input-file-uploading\' : \'\'}}\n                        {{fileItem.status === 2 ? \'cs-input-file-failed\' : \'\'}}\n                    "\n                    on-click="handleFileClick($event, fileItem)"\n                >\n                    <div class="cs-input-file-icon">\n                        <img\n                            class="cs-input-file-icon-img"\n                            src="{{getFileIcon(fileItem)}}"\n                        />\n                        <img\n                            s-if="{{fileItem.status === 0}}"\n                            class="cs-input-file-icon-loading"\n                            src="{{loadingIcon}}"\n                        />\n                    </div>\n                    <div class="cs-input-file-content">\n                        <div class="cs-input-file-name cos-line-clamp-1">{{fileItem.fileName}}</div>\n                        <div class="cs-input-file-desc">\n                            <div s-if="{{fileItem.status === 1}}" class="cs-input-file-desc-success">\n                                <div class="cs-input-file-desc-success-name cos-line-clamp-1">{{fileItem.fileType}}</div>\n                                <div class="cs-input-file-desc-success-size cos-line-clamp-1">{{formatBytes(fileItem.fileSize)}}</div>\n                            </div>\n                            <div s-else class="cos-line-clamp-1">{{getFileDesc(fileItem)}}</div>\n                        </div>\n                    </div>\n                    <div on-click="handleDelete($event, fileItem)" class="cs-input-file-delete">\n                        <img class="cs-input-file-delete-icon" src="{{deleteIcon}}" />\n                    </div>\n                </div>\n\n                \x3c!-- 图片类型 --\x3e\n                <div\n                    class="cs-input-image\n                        {{fileItem.status === 0 ? \'cs-input-image-uploading\' : \'\'}}\n                        {{fileItem.status === 2 ? \'cs-input-image-uploading\' : \'\'}}"\n                    s-elif="fileItem.uploadType === \'image\'"\n                >\n                    <img\n                        on-click="handleFileClick($event, fileItem)"\n                        class="cs-input-image-bg"\n                        src="{{getImageUrl(fileItem)}}"\n                    />\n                    <img\n                        s-if="{{fileItem.status === 0}}"\n                        class="cs-input-file-icon-loading"\n                        src="{{loadingIcon}}"\n                    />\n                    <div on-click="handleDelete($event, fileItem)" class="cs-input-file-delete">\n                        <img class="cs-input-file-delete-icon" src="{{deleteIcon}}" />\n                    </div>\n                </div>\n            </fragment>\n        </div>\n    ',components:{},initData:function(){return{fileList:[],deleteIcon:"https://gips2.baidu.com/it/u=3959794902,1704569041&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f40_40",uploadIcon:"https://gips3.baidu.com/it/u=4026099389,3432486988&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f108_108",loadingIcon:"https://gips0.baidu.com/it/u=1698361030,3674932214&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f48_48",imgLoadingIcon:"https://gips2.baidu.com/it/u=2243689421,1478809053&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f180_180",reuploadIcon:"https://gips0.baidu.com/it/u=3781075682,3319294780&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f108_108",reuploadImgIcon:"https://gips3.baidu.com/it/u=3971192352,3667158809&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f180_180"}},created:function(){},attached:function(){this.preload()},preload:function(){!function(t){void 0===t&&(t=[]),t.forEach((function(t){var e=new Image;e.src=t,e.onerror=function(e){console.error("Failed to preload "+t,e)}}))}([this.data.get("deleteIcon"),this.data.get("uploadIcon"),this.data.get("loadingIcon"),this.data.get("imgLoadingIcon"),this.data.get("reuploadIcon"),this.data.get("reuploadImgIcon")])},handleDelete:function(t,e){t.stopPropagation(),t.preventDefault(),this.dispatch("ui:input-delete-file",e)},getFileIcon:function(t){return 0===t.status?this.data.get("uploadIcon"):1===t.status?de[t.fileType]:(t.status,this.data.get("reuploadIcon"))},getFileDesc:function(t){return 0===t.status?"上传中 "+Math.round(1e4*t.progress)/100+"%":1===t.status?t.fileType+" "+Nc(t.fileSize):2===t.status?"点击图标重新上传":void 0},formatBytes:function(t){return Nc(t)},handleFileClick:function(t,e){this.dispatch("ui:input-file-click",e)},getImageUrl:function(t){return 1===t.status?t.url:2===t.status?this.data.get("reuploadImgIcon"):this.data.get("imgLoadingIcon")}});function sl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function cl(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ll(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){cl(o,a,i,r,s,"next",t)}function s(t){cl(o,a,i,r,s,"throw",t)}r(void 0)}))}}function dl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sl(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ul(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var pl=void 0;"pc"===rt()&&new Promise((function(e,n){t(["./baidubce-sdk.bundle.min.pc.Dl2RPL9u"],e,n)})).then((function(t){return t.baidubceSdk_bundle_min})).then((function(t){pl=t.default}));var hl="https://chat.baidu.com",fl=function(){function t(t){this.options=t,this.sdk=pl}var e=t.prototype;return e.getFile=function(){var t=this;return ll((function(){return ul(this,(function(e){return[2,new Promise((function(e,n){try{var a=document.createElement("input");a.type="file",a.accept="image"===t.options.type?".jpeg, .png, .jpg, .bmp, .webp":".pdf, .doc, .docx, .txt, .xls, .xlsx, .csv, .ppt, .pptx",a.multiple=t.options.maxNum>1,a.onchange=function(a){return t.handleFileChange(a,e,n)},a.click()}catch(t){n(t)}}))]}))}))()},e.handleFileChange=function(t,e,n){var a=this;return ll((function(){var i,o,r,s,c,l;return ul(this,(function(d){switch(d.label){case 0:if(d.trys.push([0,2,,3]),i=null==t?void 0:t.target,(o=Array.from(i.files||[])).length>a.options.maxNum)return a.options.callback({status:4}),n(new Error("File selection failed")),[2];for(r=dl(o);!(s=r()).done;){if((c=s.value).size>1024*a.options.maxSize*1024)return a.options.callback({status:5}),n(new Error("File selection failed")),[2];if(0===c.size)return a.options.callback({status:3}),n(new Error("File selection failed")),[2]}return a.files=o,[4,Promise.all(o.map((function(t,e){return a.uploadFile(t,e)})))];case 1:return d.sent(),e(),[3,3];case 2:return l=d.sent(),n(l),[3,3];case 3:return[2]}}))}))()},e.uploadFile=function(t,e){void 0===e&&(e=0);var n=this;return ll((function(){return ul(this,(function(a){return[2,new Promise(ll((function(a,i){var o,r,s,c,l,d,u,p,h,f,g,m,v,y,b;return ul(this,(function(w){switch(w.label){case 0:return w.trys.push([0,3,,4]),t?(n.files||(n.files=[t]),t.size>1024*n.options.maxSize*1024?(n.options.callback({status:5}),i(new Error("File selection failed")),[2]):0===t.size?(n.options.callback({status:3}),i(new Error("File selection failed")),[2]):(n.sdk||navigator.onLine||n.options.callback({status:2,fileInfo:{fileIndex:e}}),[4,n.getSts()])):[2];case 1:return r=w.sent(),s=r.ak,c=r.sk,l=r.token,d=r.preFixPath,n.options.callback({status:-1,progress:0,fileInfo:{fileName:t.name,fileType:t.type,fileSize:t.size,fileIndex:e}}),u=n.sdk.BosClient,p=new u({endpoint:"https://aisearch.bj.bcebos.com",credentials:{ak:s,sk:c},sessionToken:l}),h=null==(o=t.name)?void 0:o.split(".").pop(),f=n.sdk.MimeType.guess(h),g=(Date.now()+e).toString(),m=g+"."+h,f.startsWith("text/")&&(f+="; charset=UTF-8"),v=p.putSuperObject({bucketName:"aisearch",objectName:""+d+m,chunkSize:1048576,ContentLength:t.size,ContentType:f,data:t,onProgress:function(t){var a=t.progress;n.options.callback({status:0,progress:a,fileInfo:{fileIndex:e}})},onStateChange:ll((function(o,r){var s,c,l,d,u,p;return ul(this,(function(h){switch(h.label){case 0:if("completed"!==o)return[3,5];h.label=1;case 1:return h.trys.push([1,3,,4]),n.options.callback({status:0,progress:1,fileInfo:{fileIndex:e}}),s=r.data.key,c=btoa(s.split("/").pop()),[4,n.upLoadConfirm({path:s,size:t.size,name:t.name,id:c,type:n.options.type})];case 2:return l=h.sent(),d=l.file_url,n.options.callback({status:1,progress:1,fileInfo:{fileIndex:e,fileId:c,fileUrl:d,filePath:s}}),a(),[3,4];case 3:return u=h.sent(),p=u.status||2,n.options.callback({status:p,fileInfo:{fileIndex:e}}),[3,4];case 4:return[3,6];case 5:"failed"===o&&(n.options.callback({status:2,fileInfo:{fileIndex:e}}),i(new Error("Network disconnected"))),h.label=6;case 6:return[2]}}))}))}),[4,v.start()];case 2:return w.sent(),[3,4];case 3:return y=w.sent(),b=y.status||2,n.options.callback({status:b,fileInfo:{fileIndex:e}}),i(y),[3,4];case 4:return[2]}}))})))]}))}))()},e.reTryUpload=function(){var t=this;return ll((function(){var e;return ul(this,(function(n){switch(n.label){case 0:return e=t.files,[4,Promise.all(e.map((function(e,n){return t.uploadFile(e,n)})))];case 1:return[2,n.sent()]}}))}))()},e.getSts=function(){var t=this;return ll((function(){return ul(this,(function(e){return[2,new Promise(ll((function(e,n){var a,i,o;return ul(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),ft()&&(t.options.sseHost=hl),a=(t.options.sseHost||hl)+$t.uploadSts+"?tk="+$r(),[4,fetch(a,{mode:"cors",credentials:"include"})];case 1:return(i=r.sent()).ok||n({status:2}),[4,i.json()];case 2:return 0===(o=r.sent()).status?e(o.data):n({status:2}),[3,4];case 3:return r.sent(),n({status:2}),[3,4];case 4:return[2]}}))})))]}))}))()},e.upLoadConfirm=function(t){var e=this;return ll((function(){return ul(this,(function(n){return[2,new Promise(ll((function(n,a){var i,o,r,s,c;return ul(this,(function(l){switch(l.label){case 0:ft()&&(e.options.sseHost=hl),l.label=1;case 1:return l.trys.push([1,4,,5]),i=(e.options.sseHost||hl)+$t.upload+"?tk="+$r(),[4,fetch(i,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 2:return[4,l.sent().json()];case 3:return o=l.sent(),s=(r=o||{}).status,c=r.data,0===s?n(c):a(-1===s||-5===s?{status:3}:{status:2}),[3,5];case 4:return l.sent(),a({status:2}),[3,5];case 5:return[2]}}))})))]}))}))()},t}();function gl(t){var e=/https?:\/\/(?:www\.)?[a-zA-Z0-9\-._~:/?#[\]@!$&'()*+,;=%]+/g,n=(null==t?void 0:t.match(e))||[],a=(null==t?void 0:t.split(e))||[],i=[];return a.forEach((function(t,e){i.push({type:"text",content:t}),n[e]&&i.push({type:"pc"===rt()?"link":"text",content:n[e]})})),i}function ml(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function vl(){return vl=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},vl.apply(this,Array.from(arguments))}function yl(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var bl=St.connect(Je,{usableModel:"usableModel",usedModel:"usedModel"})(a.defineComponent({trimWhitespace:"all",template:'\n            <div class="model-select-wrapper">\n                \x3c!--模型切换面板--\x3e\n                <cos-popover open="{=open=}">\n                    <div class="input-capsules-model-list">\n                        <div s-for="item, index in modelList">\n                            <div\n                                s-if="{{index !== 0}}"\n                                class="cos-divider input-capsules-model-list-item-divider">\n                            </div>\n                            <div\n                                class="input-capsules-model-list-item\n                                    {{ item.disabled ? \'input-capsules-model-list-item-disabled\' : \'\' }}"\n                                on-click="handleModelChange($event, item)"\n                            >\n                                <div class="input-capsules-model-list-item-text">\n                                    <div class="input-capsules-model-list-item-title">{{ item.title }}</div>\n                                    <div class="input-capsules-model-list-item-desc">{{ item.desc }}</div>\n                                </div>\n                                <cos-icon\n                                    s-if="item.checked"\n                                    name="check-circle-fill"\n                                    class="input-capsules-model-list-item-icon"\n                                />\n                                <cos-icon\n                                    s-if="{{ loadingModel === item.name }}"\n                                    name="loading"\n                                    class="input-capsules-model-list-item-icon\n                                           input-capsules-model-list-item-icon-loading"\n                                />\n                            </div>\n                        </div>\n                    </div>\n                </cos-popover>\n                \x3c!--模型切换--\x3e\n                <cos-tooltip\n                    content="{{ guideTip }}"\n                    position="top-start"\n                    trigger="custom"\n                    open="{{showGuide && guideTip}}"\n                    bubbleClass="cs-input-model-guide-tip"\n                    getPopupContainer="{{getPopupContainer}}"\n                >\n                    <div class="cs-input-model" on-click="handleChangePopover">\n                        <div\n                            class="cs-input-model-button cs-input-model-button-active"\n                            data-show-ext="{{usableModelShowLog}}"\n                        >\n                            <img class="cs-input-model-icon" src="{{currentModel.modelIcon}}" />\n                            {{ currentModel.modelTitle }}\n                            <cos-icon\n                                name="{{open ? \'caret-down\' : \'caret-up\' }}"\n                                class="cs-input-model-icon-caret"\n                            />\n                        </div>\n                    </div>\n                </cos-tooltip>\n                \x3c!--联网按钮--\x3e\n                <div\n                    s-if="{{currentModel.internetShow}}"\n                    on-click="handleInternetChange"\n                    class="\n                        cs-input-model-button\n                        cos-space-ml-xxs\n                        {{\'cs-input-model-button-\' + (currentModel.internetCheck ? \'active\' : \'inactive\')}}\n                    "\n                >\n                    <cos-tooltip content="{{ currentModel.internetCheck ? \'已开启联网\' : \'开启联网\' }}"\n                                 position="{{open ? \'right\' : \'top\'}}">\n                        <div class="internet-search-icon" data-show-ext="{{internetSearchShowLog}}">\n                            <cos-icon\n                                name="original"\n                                class="\n                                    cs-input-model-icon\n                                "\n                            ></cos-icon>\n                            联网搜索\n                        </div>\n                    </cos-tooltip>\n                </div>\n                \x3c!--深度思考按钮--\x3e\n                <div\n                    s-if="{{currentModel.deepThinkShow}}"\n                    on-click="handleDeepThinkChange"\n                    class="\n                        cs-input-model-button\n                        cos-space-ml-xxs\n                        {{\'cs-input-model-button-\' + (currentModel.deepThinkCheck ? \'active\' : \'inactive\')}}\n                    "\n                >\n                    <cos-tooltip\n                        content="{{ currentModel.deepThinkCheck ? \'已开启深度思考\' : \'开启深度思考\' }}"\n                        position="{{open ? \'right\' : \'top\'}}"\n                    >\n                        <div class="internet-search-icon">\n                            <img\n                                class="cs-input-model-icon"\n                                src="{{currentModel.deepThinkCheck ?\n                                    iconMap[\'deepThink\'].active : iconMap[\'deepThink\'].inactive}}"\n                            />\n                            深度思考\n                        </div>\n                    </cos-tooltip>\n                </div>\n            </div>\n        ',components:{"cos-icon":e.Icon,"cos-popover":e.Popover,"cos-tooltip":e.Tooltip},initData:function(){return{iconMap:{deepThink:{active:"https://gips1.baidu.com/it/u=2131022959,2083152099&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f60_60",inactive:"https://gips2.baidu.com/it/u=3008689286,1786773582&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f48_48"}},popOpen:!1,loadingModel:"",showGuide:!1,modelAction:new $i(Je),getPopupContainer:function(){return document.querySelector(".chat-input-box-pc")},baseData:{a_lid:Je.getState("apagelid"),enter_type:Je.getState("pcEnterType")||"ai_tab_url"}}},attached:function(){var t=this;window.addEventListener("click",(function(){t.closeInputModelToolTip()}),{once:!0}),this.initToolTip()},computed:{usableModelShowLog:function(){var t=Je.getState("usedModel");return t?JSON.stringify(vl({},this.data.get("baseData"),{value:"ask_model_btn",current_model:t.modelName})):{}},internetSearchShowLog:function(){var t,e;return JSON.stringify(vl({},this.data.get("baseData"),{value:"online_btn",is_open:"1"===(null==(e=Je.getState("usedModel"))||null==(t=e.modelFunction)?void 0:t.internetSearch)?"1":"0"}))},modelList:function(){var t=this.data.get("usableModel"),e=this.data.get("usedModel");return t&&t.length&&e?t.map((function(t){var n;return{title:t.modelTitle,desc:null!=(n=t.modelSubTitle)?n:"",name:t.modelName,disabled:!t.hasModelPermissions&&!t.modelAvailable,checked:t.modelName===e.modelName}})):[]},currentModel:function(){var t,e,n=this.data.get("usedModel"),a=this.data.get("usableModel");if(!n||!a)return{};var i=a.find((function(t){return t.modelName===n.modelName}))||{};return vl({},n,{modelTitle:i.modelTitle,modelIcon:i.modelIcon,internetShow:(null==(t=i.modelFunction)?void 0:t.internetSearch)===ke.OPEN,internetCheck:(null==(e=n.modelFunction)?void 0:e.internetSearch)===ke.OPEN,deepThinkShow:!1,deepThinkCheck:!1})},guideTip:function(){return this.data.get("modelAction")?this.data.get("modelAction").getGuideTip():""}},initToolTip:function(){Kc.init({type:"input-model",localStorageKey:this.data.get("guideTip"),init:!0,open:function(){this.data.set("showGuide",!0)}.bind(this),close:function(){this.data.set("showGuide",!1)}.bind(this)})},handleClickInputModel:function(t){null==t||t.stopPropagation(),this.fire("handleBlur")},closeInputModelToolTip:function(){Kc.closeToolTip("input-model")},handleChangePopover:function(t){var e;(t&&this.handleClickInputModel(t),this.closeInputModelToolTip(),this.data.set("open",!this.data.get("open")),this.data.get("open"))&&Aa({type:"click",value:"ask_model_btn",ext:vl({},this.data.get("baseData"),{current_model:null==(e=Je.getState("usedModel"))?void 0:e.modelName})})},handleModelChange:function(t,e){return(n=function(){var n,a;return yl(this,(function(i){switch(i.label){case 0:return this.handleClickInputModel(t),(null==e?void 0:e.disabled)?[2]:!["ERINE-4.5","ERINE-X1"].includes(null==e?void 0:e.name)||gs()?[3,2]:[4,ws()];case 1:return i.sent(),[2];case 2:return n=Je.getState("usedModel"),(null==e?void 0:e.name)===n.modelName?[2]:(this.data.set("loadingModel",null==e?void 0:e.name),[4,this.data.get("modelAction").handleSelectModel(e)]);case 3:return i.sent(),this.data.set("loadingModel",""),this.handleChangePopover(),a=Je.getState("usedModel"),Aa({type:"click",value:"model_pop",ext:vl({},this.data.get("baseData"),{current_model:null==n?void 0:n.modelName,goal_model:null==e?void 0:e.name,status:(null==n?void 0:n.modelName)===(null==a?void 0:a.modelName)?0:1})}),[2]}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(a,i){var o=n.apply(t,e);function r(t){ml(o,a,i,r,s,"next",t)}function s(t){ml(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var n},handleInternetChange:function(t){this.handleClickInputModel(t);var e=this.data.get("usedModel"),n=e.modelFunction,a=e.modelName;Aa({type:"click",value:"online_btn",ext:vl({},this.data.get("baseData"),{is_open:n.internetSearch===ke.OPEN?ke.OPEN:ke.CLOSE})});var i={modelFunction:vl({},n,{internetSearch:n.internetSearch===ke.OPEN?ke.CLOSE:ke.OPEN})};this.data.get("modelAction").handleChangeUsedModelStatus(a,i),Aa({type:"show",value:"online_btn",ext:vl({},this.data.get("baseData"),{is_open:i.modelFunction.internetSearch})})},handleDeepThinkChange:function(t){this.handleClickInputModel(t);var e=this.data.get("usedModel"),n=e.modelFunction,a=e.modelName,i={modelFunction:vl({},n)};this.data.get("modelAction").handleChangeUsedModelStatus(a,i)}}));function wl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function _l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return wl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wl(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var kl="input-custom-item",Sl="input-custom-placeholder",xl="input-custom-no-width",Il="&nbsp;",Tl="deletion",Cl="chat-input-box",Ll="input-custom-need-clear-text";function Pl(){var t=document.createElement("div");return t.innerHTML='<span contentEditable="'+(ht()||ot.isQQBrowser?"true":"false")+'" \n        class="'+xl+'">'+Il+"</span>",t.childNodes[0]}function Dl(t){var e;return!!(null==t||null==(e=t.className)?void 0:e.includes(kl))}function Al(t){var e;return!!(null==t||null==(e=t.className)?void 0:e.includes(xl))}function El(t){if(t){var e=t.parentNode;if(e&&e.isContentEditable){var n=document.createRange();if(t.nodeType===Node.TEXT_NODE)n.setStart(t,t.length);else if(t.childNodes.length>0){var a=t.lastChild;a.nodeType===Node.TEXT_NODE?n.setStart(a,a.length):n.setStart(t,t.childNodes.length)}else n.setStart(t,0);n.collapse(!0);var i=window.getSelection();i.removeAllRanges(),i.addRange(n),e.focus()}}}function Ol(t){return document.createTextNode(t.content||t.value||"")}function Rl(t){var e=[];return t.forEach((function(t,n){"text"===t.type?e.push(Ol(t)):"input"===t.type&&(e.push(Pl()),e.push(function(t,e){var n=document.createElement("span");n.id="cs-custom-input-"+e,n.contentEditable="true",n.innerText=t.value||t.default||"",n.setAttribute("placeholder",t.placeHolder||"填写内容"),t.value||t.default||n.setAttribute(Tl,"1");var a=[kl];return t.value||t.default?a.push(Ll):a.push(Sl),n.className=a.join(" "),n.addEventListener("click",(function(t){ht()&&t.target&&!t.target.innerText&&El(t.target),t.target&&t.target.classList.contains(Ll)&&(t.target.innerText="",t.target.classList.remove(Ll),El(t.target),t.stopPropagation())})),n}(t,n)),e.push(Pl()))})),e}function Nl(t){var e;(null==t||null==(e=t.childNodes)?void 0:e.length)&&t.childNodes.forEach((function(t){var e,n;Dl(t)&&(t.innerText&&"\n"!==t.innerText?(null==(e=t.classList)||e.remove(Sl),function(t){(null==t?void 0:t.setAttribute)&&t.setAttribute(Tl,"0")}(t)):(t.innerText="",null==(n=t.classList)||n.add(Sl)));Al(t)&&(Dl(t.previousSibling)||Dl(t.nextSibling)||t.remove())}))}function ql(t){var e;if(t&&"Backspace"===t.key){var n,a,i={startContainer:(e=window.getSelection().getRangeAt(0)).startContainer,startOffset:e.startOffset,endOffset:e.endOffset},o=i.startContainer,r=i.startOffset,s=i.endOffset,c=null,l=null;if(o.nodeType===Node.TEXT_NODE?(c=o.parentElement,l=0===r?o.previousSibling:o):l=null==(c=o)?void 0:c.childNodes[r-1],function(t){return(null==t?void 0:t.id)===Cl}(c)&&Al(l)){t.preventDefault&&t.preventDefault();var d,u=null==l?void 0:l.previousSibling;if(Dl(u))if(null==u?void 0:u.innerText)u.innerText=null==u||null==(d=u.innerText)?void 0:d.slice(0,-1),El(u);else!function(t){if(Dl(t)){var e=null==t?void 0:t.nextSibling,n=null==t?void 0:t.previousSibling;Al(e)&&e.remove(),Al(n)&&n.remove(),t.remove()}}(u)}if(Dl(c))if(1===(null==c||null==(n=c.innerText)?void 0:n.length)||0===r&&(null==(a=c.innerText)?void 0:a.length)===s&&r!==s)t.preventDefault&&t.preventDefault(),c.innerText="",setTimeout((function(){El(c)}),0);else if(0===r&&0===s){var p;t.preventDefault&&t.preventDefault();var h,f=null==c||null==(p=c.previousSibling)?void 0:p.previousSibling;if((null==f?void 0:f.nodeType)===Node.TEXT_NODE)f.textContent=null==f||null==(h=f.textContent)?void 0:h.slice(0,-1),El(f);else Al(f)&&El(f)}}}function Ml(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function jl(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Bl(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){jl(o,a,i,r,s,"next",t)}function s(t){jl(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Hl(){return Hl=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Hl.apply(this,Array.from(arguments))}function $l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ml(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ml(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ul(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Fl=[],Gl=St.connect(Je,{topRank:"topRank",usableModel:"usableModel",usedModel:"usedModel"})(a.defineComponent({agentDom:null,richEditor:null,trimWhitespace:"all",template:'\n        <div class="cs-rich-input {{hasHomeIndicator ? \'has-home-indicator\' : \'\'}}">\n            \x3c!-- 输入框面板弹起时不展示 --\x3e\n            <sug s-ref="sug" />\n            <cs-input-panel\n                s-ref="inputPanel"\n            />\n            <div\n                on-click="onInputWrapClick"\n                class="\n                    input-wrap {{isSafariOrQQBrower ? \'safari-qq-spec\' : \'\'}}\n                    {{usableModel.length > 0 ? \'input-wrap-multi-line\' : \'input-wrap-single-line\'}}\n                "\n            >\n                \x3c!-- 文件和图片组件 --\x3e\n                <file\n                    s-if="fileList && fileList.length"\n                    class="input-file"\n                    file-list="{{fileList}}"\n                />\n                \x3c!-- 输入框 --\x3e\n                <div\n                    class="\n                        input-container\n                        {{usableModel.length > 0 ? \'input-container-multi-line\' : \'input-container-single-line\'}}\n                    "\n                >\n                    <div\n                        id="chat-input-box"\n                        s-ref="inputField"\n                        class="\n                            cs-pc-input-custom\n                            input-fields\n                            {{!textContent ? \'empty-input\' : \'no-empty-input\'}}\n                            {{usableModel.length > 0 ? \'empty-input-multi-line\' : \'\'}}\n                            {{showPlaceholderOnce ? \'show-placeholder-once\' : \'\'}}\n                            {{usableModel.length > 0 ? \'input-fields-multi-line\' : \'input-fields-single-line\'}}\n                        "\n                        contenteditable="{{contenteditable}}"\n                        enterkeyhint="send"\n                        placeholder="{{realPlaceholder}}"\n                        on-click="handleClick"\n                        on-focus="handleFocused"\n                        on-input="handleInput($event)"\n                        on-blur="handleBlur"\n                        on-keydown="handleKeyDown($event)"\n                        on-keyup="handleKeyUp($event)"\n                        on-touchmove="handleTouchMove($event)"\n                        on-compositionstart="handleCompositionStart"\n                        on-compositionend="handleCompositionEnd"\n                        on-paste="handlePaste($event)"\n                    >\n                    </div>\n                    \x3c!-- 功能按钮 --\x3e\n                    <div class="{{\n                            usableModel.length > 0 ? \'cs-input-function-wrapper\' : \'cs-input-function-wrapper-no-model\'\n                        }}"\n                    >\n                        \x3c!-- 接入模型按钮 --\x3e\n                        <cs-input-model />\n                        <div class="cs-input-function-btn">\n                            <div\n                                s-show="!inputPanelOpenType\n                                    && !agentInfo\n                                    && !(fileList && fileList.length)\n                                    && !isCustomInput\n                                "\n                                class="cs-input-upload"\n                                data-show-area\n                            >\n                                <cos-tooltip\n                                    s-for="btnItem, index in funcBtn"\n                                    trigger="hover"\n                                    content="{{btnItem.tooltipText}}"\n                                    style="width: 30px; height: 30px; display: inline-block;\n                                        {{index !== 0 ? \'margin-left: 4px;\' : \'\'}}\n                                        {{usableModel.length > 0 ? \'margin-top: -1px;\' : \'\'}}\n                                    "\n                                >\n                                    <div\n                                        class="cs-input-upload-btn"\n                                        on-click="handleUplaodBtnClick(btnItem.type)"\n                                        data-show-ext="{{btnItem.type | uploadBtnRealShowExt}}"\n                                        style="--cs-input-upload-btn: {{btnItem.icon}};"\n                                    >\n                                        <div class="cs-input-upload-icon"></div>\n                                    </div>\n                                </cos-tooltip>\n                                <div class="cos-divider-vertical-inverse cos-space-ml-xs" style="height: 18px"></div>\n                            </div>\n                            \x3c!-- pc场景发送按钮会在生成时展示为暂停按钮 --\x3e\n                            <cos-icon s-if="isPc && isShowPauseButton && !textContent && !fileReady" name="pause-dqa"\n                                class="pause-icon" on-click="native:handlePauseClick()"\n                            />\n                            <cos-icon s-else name="arrow-up-circle-fill"\n                                class="send-icon {{\n                                    (textContent || fileReady === 1) && fileReady < 2 ? \'active-send-icon\' : \'\'\n                                }}"\n                                on-click="native:handleIconInputClick()"\n                            />\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="tip">内容由AI生成，仅供参考</div>\n        </div>\n    ',components:{"cos-icon":e.Icon,sug:gc,"cs-input-panel":ol,file:rl,"cos-tooltip":e.Tooltip,"cs-input-model":bl},messages:{"sug-click":function(t){"common"===t.value.type?this.launchSearch({query:t.value.word},"sug"):(this.data.set("agentInfo",{agentName:t.value.source_name,agentSearchId:t.value.agent_search_id,agentId:t.value.agent_id}),this.data.set("currentAgentFirstSearch",!0),this.upperPcInput(t.value,"agent"),_c())},"ui:input-panel-change":function(t){this.handlePanelChange(t.value)},"ui:input-upload":function(t){this.handleUplaod(t.value)},"ui:input-file-click":function(t){this.handleFileClick(t.value)},"ui:input-delete-file":function(){this.data.set("fileList",[])},"ui:input-panel-button-click":function(t){this.handlePanelButtonClick(t.value)}},initData:function(){return{funcBtn:[{type:"file",icon:Sc,tooltipText:"上传文件：支持PDF/Word/Excel/PPT/txt等，最大50MB"},{type:"image",icon:xc,tooltipText:"上传图片：支持jpg/png/jpeg等，最大10MB"}],placeholder:"Shift+Enter换行",showPlaceholder:!0,inputContent:"",textContent:"",agentContent:"",maxLength:5e3,inputStatus:"blur",sendType:"text",hasAgent:!1,contenteditable:!0,needInvokeSug:!1,isCustomInput:!1,initFocusIndex:"",removeTargetIndex:"",customInputData:[],preContent:"",currentAgentFirstSearch:!1,isComposing:!1,lastInputPanelOpenType:"",inputPanelOpenType:"",isShowPauseButton:!1,isPc:"pc"===rt(),panelPlaceholder:"",filePlaceholder:"描述想要了解的内容",existCustomNode:!1,userHasInput:!1,defaultContent:"",showPlaceholderOnce:!1,updatedSa:"",agentSa:"",isExtension:ft(),usableModel:[],hasHomeIndicator:gt()}},filters:{uploadBtnRealShowExt:function(t){return JSON.stringify({value:"input_function",button:"image"===t?"pic":"file"})}},computed:{realPlaceholder:function(){if(this.data.get("isCustomInput"))return"";if(this.data.get("inputContent")&&this.data.get("inputContent")===this.data.get("agentContent")&&"blur"===this.data.get("inputStatus"))return" 继续问";var t=this.data.get("panelPlaceholder")||this.data.get("placeholder"),e=this.data.get("fileList");return(null==e?void 0:e.length)&&(t=this.data.get("filePlaceholder")),this.data.get("showPlaceholder")?t:""},sendType:function(){return this.data.get("hasAgent")&&this.data.get("agentInfo")?"agent":"text"},isSafariOrQQBrower:function(){var t=it();return t.isQQBrowser||t.isSafari},isFirefox:function(){return it().isFirefox},fileReady:function(){for(var t,e=this.data.get("fileList")||[],n=Number(!!e.length),a=$l(e);!(t=a()).done;){var i=t.value;if(-1===i.status||0===i.status){n=2;break}if(1!==i.status){n=3;break}}return n}},created:function(){},attached:function(){var t=this;this.richEditor=this.ref("inputField"),this.inputPanel=this.ref("inputPanel"),this.nextTick((function(){_c(),t.observer=new MutationObserver(t.handleInputChange.bind(t)),t.observer.observe(t.richEditor,{childList:!0,subtree:!0,characterData:!0})})),this.listener()},onInputWrapClick:function(){document.activeElement!==this.richEditor&&_c()},handleUplaodBtnClick:function(t){this.handleUplaod(t),"file"===t?this.data.set("updatedSa","searchbox_file"):"image"===t&&this.data.set("updatedSa","searchbox_pic"),Aa({ubcId:"17132",type:"click",value:"input_function",ext:{a_lid:Je.getState("apagelid"),setype:"csaitab",button:"image"===t?"pic":"file"}})},handleUplaod:function(t,n){return Bl((function(){var a,i,o,r,s,c;return Ul(this,(function(l){return a=this,i=+new Date,o=null,r=function(n){var r=n.status,s=n.fileInfo,c=n.progress,l=a.data.get("fileList")||[];if(-1===r){1<=Fl.length&&(Fl.shift(),a.data.shift("fileList"),l.shift());var d=!1;if(Fl.forEach((function(t){t.timeStamp===i&&(d=!0)})),!d){var u;Fl.push({uploadFileIns:o,timeStamp:i}),null==(u=a.inputPanel)||u.closePanel();var p=a.data.get("agentInfo"),h=a.data.get("userHasInput");!p&&h||a.clearInput(),_c()}!l.length&&s&&l.push({status:0,timeStamp:i,fileName:s.fileName,uploadType:t,fileType:Rc(s.fileName).toUpperCase(),fileSize:s.fileSize,progress:c,fileId:s.fileId})}else if(0===r)l.forEach((function(t,e){t.timeStamp===i&&(l[e].status=r,l[e].progress=c)}));else if(1===r)l.forEach((function(t,e){t.timeStamp===i&&(l[e].progress=c,l[e].status=r,l[e].url=null==s?void 0:s.fileUrl,l[e].fileId=null==s?void 0:s.fileId,l[e].filePath=null==s?void 0:s.filePath)}));else if(2===r)l.forEach((function(t,e){t.timeStamp===i&&(l[e].status=r)})),e.Toast.show({message:"网络错误，请重试"});else{if(3===r)return e.Toast.show({message:"当前文件暂不支持，换个文件试试吧"}),Fl.pop(),void a.data.shift("fileList");if(5===r)return e.Toast.show({message:"file"===t?"文件超过50M，请重新选择后上传":"图片超过10M，请重新选择后上传"}),Fl.pop(),void a.data.shift("fileList")}a.data.set("fileList",JSON.parse(JSON.stringify(l)))},s=Je.getState("chatParams"),c={type:t,maxSize:50,maxNum:1,sseHost:null==s?void 0:s.sse_host,callback:r},"image"===t&&(c.maxSize=10),o=new fl(c),n?o.uploadFile(n).catch((function(){})):o.getFile().catch((function(){})),[2]}))})).apply(this)},handleFileClick:function(t){2===t.status&&Fl.forEach((function(e){var n;e.timeStamp===t.timeStamp&&(null==(n=e.uploadFileIns)||n.reTryUpload())}))},handlePanelChange:function(t){var e=this,n=t.type,a=t.showPanelData;if("open"===n&&a){var i,o,r,s,c,l=Ki(a.type);if(this.data.set("panelPlaceholder",null==(o=a.jumpPanel)||null==(i=o.data[l])?void 0:i.placeHolder),this.data.set("inputPanelOpenType",l),this.data.get("lastInputPanelOpenType")!==l)!this.data.get("userHasInput")&&this.clearInput();var d=null==(s=a.jumpPanel)||null==(r=s.data[l])?void 0:r.defaultContent;if(!(null==(c=this.richEditor)?void 0:c.innerText)&&d){var u,p=Ol({content:d});this.data.set("defaultContent",d),null==(u=this.richEditor)||u.appendChild(p);var h=this.data.get("isSafariOrQQBrower");setTimeout((function(){e.data.set("showPlaceholder",!0),e.data.set("showPlaceholderOnce",!0)}),h?50:0)}this.nextTick((function(){_c()}))}else if("close"===n){this.data.set("panelPlaceholder",""),this.data.set("interactionType",0);var f=this.data.get("inputPanelOpenType");f&&this.data.set("lastInputPanelOpenType",f),this.data.set("inputPanelOpenType","");var g=this.data.get("defaultContent"),m=this.data.get("textContent");this.data.get("realPlaceholder")&&m&&g===m&&this.clearInput()}},handlePanelButtonClick:function(t){var e;"readPanel_tianjialianjie"===t.buttonId&&(this.data.set("interactionType",3),null==(e=this.inputPanel)||e.closePanel())},listenUpperSearchbox:null,listenShowPauseButton:null,listenOpenInputUpload:null,listenGetUpdatedSa:null,listener:function(){var t=this;this.listenUpperSearchbox=_n((function(e){var n,a,i;e.noClear||(t.clearTextInput(),t.clearFile()),(null==(n=e.agentInfo)?void 0:n.agentName)&&!t.data.get("isExtension")?(t.data.set("agentInfo",e.agentInfo),t.upperPcInput(e,"agent")):(null==(a=e.agentInfo)?void 0:a.agentName)||t.clearInput(),e.file&&t.upperPcInput(e,"file"),e.image&&t.upperPcInput(e,"image"),(null==(i=e.inputCustom)?void 0:i.length)?t.upperPcInput(e.inputCustom,"input-custom"):e.word&&t.upperPcInput(e,"text"),e.interactionType&&t.data.set("interactionType",e.interactionType),t.nextTick((function(){!function(t){for(var e,n=(null==t?void 0:t.childNodes)||[],a=-1,i=_l(n);!(e=i()).done;){var o,r=e.value;if((null==r||null==(o=r.className)?void 0:o.includes(kl))&&!(null==r?void 0:r.innerText)){a=Array.prototype.indexOf.call(n,r);break}}(null==n?void 0:n.length)&&-1!==a?El(n[a]):_c()}(t.richEditor)}))}),500),jn().on(this.listenUpperSearchbox),this.listenShowPauseButton=function(e){var n=e.isShowButton,a=void 0!==n&&n;t.data.set("isShowPauseButton",a)},sa().on(this.listenShowPauseButton),this.listenOpenInputUpload=function(e){t.handleUplaod(e)},_a().on(this.listenOpenInputUpload),this.listenGetUpdatedSa=function(e){var n=e.sa;e.isAgent?t.data.set("agentSa",n):t.data.set("updatedSa",n)},xa().on(this.listenGetUpdatedSa)},clearFile:function(){this.data.set("fileList",[]),Fl=[]},clearCustomInput:function(){this.data.set("isCustomInput",!1),this.data.set("customInputdata",[]),function(t){if(null==t?void 0:t.childNodes){var e=[];t.childNodes.forEach((function(t){var n,a;((null==t||null==(n=t.className)?void 0:n.includes(xl))||(null==t||null==(a=t.className)?void 0:a.includes(kl)))&&e.push(t)})),e.forEach((function(t){t.remove()}))}}(this.richEditor)},clearInput:function(){this.clearCustomInput(),this.richEditor.innerText="",this.recoveryStatus(),this.data.set("userHasInput",!1),this.data.set("interactionType",0)},clearTextInput:function(){this.clearCustomInput();for(var t=this.richEditor.childNodes,e=t.length-1;e>=0;e--)3!==t[e].nodeType&&"FONT"!==t[e].nodeName&&"BR"!==t[e].nodeName||t[e].remove();this.data.set("userHasInput",!1),this.data.set("interactionType",0)},clearAgentStatus:function(){this.data.set("hasAgent",!1),this.agentDom=null,Xa().emit({name:"delete-agent",params:{agentInfo:this.data.get("agentInfo")}}),this.data.set("agentInfo",null)},recoveryStatus:function(){this.data.get("hasAgent")&&this.clearAgentStatus()},launchSearch:function(t,n){return void 0===t&&(t={}),void 0===n&&(n="notSug"),Bl((function(){var a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b;return Ul(this,(function(w){switch(w.label){case 0:if(!((null==(o=this.data.get("agentInfo")||{})?void 0:o.agentName)||Je.getState("rank")>=xs()||this.data.get("isExtension")))return[3,5];r=null,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,ws()];case 2:return r=w.sent(),[3,4];case 3:return w.sent(),this.data.get("isExtension")?(On().component.login.emit(),[2,Promise.resolve()]):[3,4];case 4:if(!r)return[2,Promise.resolve()];w.label=5;case 5:if(Je.dispatch("update",{pcInputTime:Date.now()-Je.getState("pcInputFocusTime")}),s=t.query||this.data.get("textContent"),c=s.trim(),(l=this.data.get("isCustomInput"))&&(c=c.replace(/\s+/g,"")),this.data.get("currentAgentFirstSearch")&&(c=c||"你好",this.data.set("currentAgentFirstSearch",!1)),d=this.data.get("fileReady"),u="",2===d?u="文件上传中":d>2?u="请重新上传文件":c||1===d||(u="请输入你的问题"),u)return e.Toast.show({message:u}),[2,Promise.resolve()];if(o.agentName&&(o.startIndex=0,o.endIndex=o.agentName.length,o.forceUpperBox=!0,o.isUpperBox=!0),p=this.data.get("fileList")||[],h=[],4!==(f=this.data.get("interactionType"))||gs())return[3,10];w.label=6;case 6:return w.trys.push([6,8,,9]),[4,ws()];case 7:return w.sent(),[3,9];case 8:return w.sent(),Bn().emit({text:"登录失败，请稍后再试"}),[3,9];case 9:return[2,Promise.resolve()];case 10:return p.length>0&&(h=function(t,e){var n=[];return t&&n.push({type:"TEXT",data:{text:{query:t,text_type:""}}}),e.forEach((function(t){"image"===t.uploadType?n.push({type:"IMAGE",data:{image:{image_url:t.url,image_id:t.fileId}}}):"file"===t.uploadType&&n.push({type:"FILE",data:{file:{file_id:t.fileId,file_name:t.fileName,file_path:t.filePath,file_size:t.fileSize,file_type:t.fileType,file_url:t.url}}})})),n}(c,p),"file"===(null==(g=p[0])?void 0:g.uploadType)?f=1:"image"===(null==(m=p[0])?void 0:m.uploadType)&&(f=2)),v=this.data.get("updatedSa"),y=this.updateSa(n,c,v),b=this.data.get("agentSa"),Ya().emit({name:"search",params:Hl({query:h.length?h:c,sa:y,agentInfo:o},b?{agentSa:b}:{},f?{interactionType:f}:{})}),l&&this.data.set("isCustomInput",!1),this.clearTextInput(),null==(a=this.ref("sug"))||a.closeSug(),_c(),this.data.set("fileList",[]),this.data.set("interactionType",0),null==(i=this.inputPanel)||i.closePanel(),this.data.set("agentSa",""),this.data.set("updatedSa",""),this.data.set("sa",""),[2,Promise.resolve()]}}))})).apply(this)},updateSa:function(t,e,n){var a;void 0===n&&(n="");var i=this.data.get("isCustomInput"),o="",r="sug"!==t?"bkb":"bks",s=this.data.get("userHasInput"),c="link"===(null==(a=(gl(e)||[])[1])?void 0:a.type),l=this.data.get("fileReady");return o=c?"searchbox_link":o,n&&(i||l)?o=s?r+"_"+n:n:o&&(l||c)?s&&(o=r+"_"+o):o=o||r,o},upperPcInput:function(t,e){var n=this;if(this.data.set("needInvokeSug",!1),"text"===e){var a=document.createTextNode(t.word),i=this.richEditor;"query"===t.type?i.appendChild(a):i.insertBefore(a,i.firstChild)}else if("agent"===e){if(!this.richEditor.querySelector(".cs-pc-input-agent")){this.agentDom=document.createElement("span"),this.agentDom.className="cs-pc-input-agent",this.agentDom.setAttribute("contenteditable",!1),this.richEditor.appendChild(document.createElement("span")),this.data.get("isCustomInput")?this.richEditor.insertBefore(this.agentDom,this.richEditor.firstChild):this.richEditor.appendChild(this.agentDom);var o=it();(o.isFirefox||o.isQQBrowser)&&setTimeout((function(){var t,e=document.createElement("span");e.innerHTML="&#xFEFF;",null==(t=n.agentDom)||t.insertAdjacentElement("afterend",e)}),0)}this.agentDom.innerText="@"+this.data.get("agentInfo.agentName"),this.data.get("hasAgent")||this.removeUserInputSugText(),this.data.set("hasAgent",!0)}else if("input-custom"===e){this.data.set("isCustomInput",!0);var r=function(t){return t.map((function(t){return wc({},t,{realValue:t.value||t.default})}))}(t);this.data.set("customInputData",r,{force:!0}),Rl(r).forEach((function(t){n.richEditor.appendChild(t)}))}else if("file"===e){this.data.get("agentInfo")&&this.clearInput(),t.file&&this.data.set("fileList",[{status:1,timeStamp:+new Date,fileName:t.file.fileName,uploadType:"file",fileType:Rc(t.file.fileName).toUpperCase(),fileSize:t.file.fileSize,fileId:t.file.fileId,url:t.file.fileUrl,filePath:t.file.filePath}])}else if("image"===e){this.data.get("agentInfo")&&this.clearInput(),t.image&&this.data.set("fileList",[{status:1,timeStamp:+new Date,uploadType:"image",fileType:"PNG",fileId:t.image.image_id||t.image.imageId,url:t.image.image_url||t.image.imageUrl}])}},removeUserInputSugText:function(){var t,e=this,n=null!=(t=this.richEditor.childNodes)?t:[],a=Array.from(n).findIndex((function(t){return t===e.agentDom}));if(!(a<=0))for(var i=a-1;i>=0;i--)if(n[i]&&n[i].nodeType===Node.TEXT_NODE){var o=n[i].textContent.lastIndexOf("@");if(-1!==o){n[i].textContent=n[i].textContent.substring(0,o);break}n[i].textContent=""}},updatedSug:function(t,e){var n,a,i,o;if(!this.data.get("existCustomNode")){var r=this.data.get("fileList");if("agent"!==e||!(null==r?void 0:r.length)){var s=null==(n=this.inputPanel)?void 0:n.data.get("showPanel");"common"===e&&s||(null==(a=this.inputPanel)||a.closePanel(),null==(i=this.ref("sug"))||i.getSugList(t,e),this.data.get("needInvokeSug")&&(null==(o=this.ref("sug"))||o.openSug(e)))}}},handleInputChange:function(){var t=this;Nl(this.richEditor),this.nextTick((function(){var e,n,a,i=t.richEditor,o=i.innerText||"",r=function(t){if(!(null==t?void 0:t.childNodes))return!1;for(var e,n=_l(t.childNodes);!(e=n()).done;){var a,i=e.value;if(null==i||null==(a=i.className)?void 0:a.includes(kl))return!0}return!1}(i);(t.data.set("existCustomNode",r),t.data.set("showPlaceholderOnce",!1),t.data.get("hasAgent"))?(t.data.set("agentContent",null==(e=t.agentDom)?void 0:e.innerText),t.data.set("textContent",o.replace(null==(n=t.agentDom)?void 0:n.innerText,""))):t.data.set("textContent",o);if(t.data.get("breakRowStatus")||"\n"!==o&&0!==o.length)if(t.data.set("showPlaceholder",!1),t.data.get("hasAgent")){var s=t.el.querySelector(".cs-pc-input-agent");s&&s.innerText||t.clearAgentStatus();var c=t.data.get("isComposing");s&&!(null==s?void 0:s.nextSibling)&&c&&_c(),t.updatedSug(t.data.get("textContent"),"common")}else if(o.includes("@")&&!t.data.get("isExtension")){var l=o.substring(o.lastIndexOf("@")+1);t.updatedSug(l,"agent")}else t.updatedSug(o,"common");else t.clearInput(),t.data.set("showPlaceholder",!0),null==(a=t.ref("sug"))||a.closeSug();t.data.set("inputContent",o)}))},handleClick:function(){if("focus"===this.data.get("inputStatus")){this.data.set("needInvokeSug",!0);var t=this.data.get("inputContent");if(this.data.get("hasAgent"))this.updatedSug(this.data.get("textContent"),"common");else if(-1===this.data.get("inputContent").indexOf("@")||this.data.get("isExtension"))this.updatedSug(t,"common");else{var e=t.substring(t.lastIndexOf("@")+1);this.updatedSug(e,"agent")}}},handleFocused:function(){var t=it(),e=this.el.querySelector(".cs-pc-input-agent");t.isSafari&&e&&!(null==e?void 0:e.nextSibling)&&setTimeout((function(){_c()}),0),Je.dispatch("update",{pcInputFocusTime:Date.now()}),this.data.set("inputStatus","focus")},isElementInViewport:function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},handleInput:function(){this.data.set("needInvokeSug",!0),this.data.set("userHasInput",!0)},handleBlur:function(){var t=this;this.data.set("inputStatus","blur"),setTimeout((function(){var e;null==(e=t.ref("sug"))||e.closeSug()}),200)},handleKeyUp:function(t){var e=this;this.nextTick((function(){var n=e.data.get("inputContent").trim();if("@"!==t.key||e.data.get("hasAgent")||e.data.get("isExtension")){if(n.includes("@")&&!e.data.get("hasAgent")&&!e.data.get("isExtension")){var a=n.substring(n.lastIndexOf("@")+1);e.updatedSug(a,"agent")}}else e.updatedSug("","agent");"Shift"!==t.key&&"Meta"!==t.key&&"Control"!==t.key||setTimeout((function(){e.data.set("breakRowStatus",!1)}),100)}))},handleKeyDown:function(t){var e=this;if(ql(t),"Enter"===t.key){if(t.preventDefault(),this.data.get("breakRowStatus")||t.shiftKey||t.metaKey||t.ctrlKey){var n,a=this.richEditor.scrollHeight;this.insertAtRange(document.createElement("br")),setTimeout((function(){e.richEditor.scrollHeight<=a&&e.insertAtRange(document.createElement("br"))}),50),null==(n=this.ref("sug"))||n.closeSug()}else if(!this.data.get("isComposing")){var i=this.data.get("inputContent").trim();if(!this.data.get("isCustomInput")&&this.data.get("breakRowStatus"))return;if(this.sendInputLog("input"),this.data.get("hasAgent")){var o=this.data.get("agentInfo");this.launchSearch({query:this.data.get("textContent"),extParams:{agentInfo:o}})}else this.launchSearch({query:i})}}else"Shift"===t.key||"Meta"===t.key||"Control"===t.key?this.data.set("breakRowStatus",!0):this.data.set("breakRowStatus",!1)},handleTouchMove:function(t){t.stopPropagation&&t.stopPropagation()},handleCompositionStart:function(){this.data.set("isComposing",!0)},handleCompositionEnd:function(){var t=this;this.nextTick((function(){t.data.set("isComposing",!1)}))},handleIconInputClick:function(){this.sendInputLog("ask"),this.launchSearch()},handlePauseClick:function(){Fn().emit(),this.data.set("isShowPauseButton",!1)},handlePaste:function(t){var n=this;t.preventDefault();var a=t.clipboardData||window.clipboardData;if(a){for(var i,o,r,s={},c="",l=$l(a.items||[]);!(i=l()).done;){var d=i.value;if("file"===d.kind){s=d.getAsFile();var u=(o=s.name,r=void 0,(r=Oc.exec(o))?r[0]:"");le.includes(u)?c="file":ce.includes(u)&&(c="image")}}c&&this.handleUplaod(c,s);var p="";t.clipboardData?p=t.clipboardData.getData("text/plain"):window.clipboardData&&(p=window.clipboardData.getData("Text")),p.length&&this.handleInput();var h=this.richEditor,f=this.data.get("maxLength");h.innerText.length+p.length>f&&(p=p.slice(0,f-h.innerText.length),e.Toast.show({message:"最多发送5000字符内容"}));var g=p.split("\n");g.forEach((function(t,e){var a=document.createTextNode(t);n.insertAtRange(a),e!==g.length-1&&n.insertAtRange(document.createElement("br"))})),this.isCursorAtEnd()&&(this.richEditor.scrollTop=this.richEditor.scrollHeight)}},insertAtRange:function(t){var e=document.getSelection();if(e.rangeCount){var n=e.getRangeAt(0);n.deleteContents(),n.insertNode(t),n.setStartAfter(t),n.setEndAfter(t),e.removeAllRanges(),e.addRange(n)}},isCursorAtEnd:function(){var t=window.getSelection().getRangeAt(0),e=t.cloneRange();return e.selectNodeContents(this.richEditor),e.setStart(t.endContainer,t.endOffset),0===e.toString().length},sendInputLog:function(t){Aa({ubcId:"17132",type:"click",value:"nonala_cpt",ext:{re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid"),lid:Je.getState("lid"),ori_lid:Je.getState("oriLid"),setype:"csaitab",action:t,valueInfo:[{component_name:"input"}]}})},disposed:function(){this.listenUpperSearchbox&&jn().off(this.listenUpperSearchbox),this.listenShowPauseButton&&sa().off(this.listenShowPauseButton),this.listenOpenInputUpload&&_a().off(this.listenOpenInputUpload),this.listenGetUpdatedSa&&xa().off(this.listenGetUpdatedSa),this.listenUpperSearchbox=null,this.listenShowPauseButton=null,this.listenOpenInputUpload=null,this.listenGetUpdatedSa=null}}));function Wl(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function zl(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Ql=St.connect(Je,{topRank:"topRank",rank:"rank",userInfo:"user"})(a.defineComponent({agentDom:null,richEditor:null,trimWhitespace:"all",screenHeight:window.innerHeight,template:'\n        <div class="cs-rich-input {{inputStatus === \'focus\' ? \'input-wrap-focus\' : \'input-wrap-blur\'}}">\n            \x3c!-- 联网搜索按钮 --\x3e\n            <div\n                s-if="showOnlineBtn && !isHarmony"\n                class="\n                    cs-input-model-button\n                    {{ internetChecked ? \'cs-input-model-button-active\' : \'cs-input-model-button-inactive\' }}\n                "\n                on-click="handleInternetSearch()"\n            >\n                <div>\n                    <cos-icon\n                        name="original"\n                        class="cs-input-model-icon"\n                    />\n                    {{onlineText}}\n                </div>\n            </div>\n            <div s-if="inputStatus !== \'focus\'" class="cs-input-go-back-wrap" on-click="back">\n                <cos-icon name="left" />\n            </div>\n            <div\n                s-ref="inputWrap"\n                class="\n                    input-wrap\n                    {{inputStatus === \'focus\' ? \'input-wrap-focus\' : \'\'}}\n                "\n            >\n                \x3c!-- 未登录mask --\x3e\n                <div s-if="!userInfo.isUserLogin" class="input-wrap-unlogin-mask" on-click="handleUnLoginClick($event)">\n                </div>\n                \x3c!-- 输入框 --\x3e\n                <div class="input-container input-container-single-line" >\n                    <textarea\n                        id="chat-input-box"\n                        s-ref="inputField"\n                        class="cs-pc-input-custom input-fields {{!textContent ? \'empty-input\' : \'no-empty-input\'}}\n                            {{inputStatus !== \'focus\' ? \'input-fields-blur\' : \'input-fields-focus\'}}\n                        "\n                        enterkeyhint="send"\n                        rows="{{rows}}"\n                        on-click="handleClick"\n                        on-focus="handleFocused"\n                        on-input="handleInput($event)"\n                        on-blur="handleBlur"\n                        on-keydown="handleKeyDown($event)"\n                        on-keyup="handleKeyUp($event)"\n                        on-touchmove="handleTouchMove($event)"\n                        on-paste="handlePaste($event)"\n                    ></textarea>\n                    <div s-if="!textContent" class="input-fields-placeholder">\n                        {{isHarmony ? harmonyPlaceHolder : placeholder}}\n                    </div>\n                    <div s-ref="hideContent" class="input-hide-content">{{textContent}}</div>\n\n                    <div class="cs-input-ds-btn-wrap {{inputStatus === \'focus\' ? \'cs-input-ds-hide-btn-wrap\' : \'\'}}">\n                        <div s-if="showCloseBtn" class="cs-input-ds-close-btn" on-click="native:handleCloseClick()">\n                            <cos-icon name="close-circle-fill">\n                        </div>\n                        <div\n                            s-if="showSendBtn"\n                            class="cs-input-ds-send-btn cs-input-function-btn {{!textContent ? \'empty-input-btn\' : \'\'}}"\n                            on-click="native:handleIconInputClick($event)"\n                        >发送</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',components:{"cos-icon":e.Icon},initData:function(){return{placeholder:"可以问我任何问题",showPlaceholder:!0,textContent:"",maxLength:2e3,inputStatus:"blur",initFocusIndex:"",removeTargetIndex:"",currentAgentFirstSearch:!1,isComposing:!1,userHasInput:!1,defaultContent:"",updatedSa:"",rows:1,internetChecked:!1,onlineText:"联网搜索",showOnlineBtn:!1,rank:0,isHarmony:dt()}},computed:{showSendBtn:function(){var t=this.data.get("textContent");return this.data.get("isHarmony")?!!t:"focus"===this.data.get("inputStatus")||t},showCloseBtn:function(){return this.data.get("isHarmony")&&"focus"===this.data.get("inputStatus")&&this.data.get("textContent")},harmonyPlaceHolder:function(){return this.data.get("userInfo.isUserLogin")?"可以问我任何问题...":"点击登录即可高效解答"}},created:function(){var t=this,e=Je.getState("chatParams"),n=Je.getState("chatParams").sse_host+"/aichat/api/aitabserver?action=shortcuts&ctl=deepseek&t="+(e.sge_lid||(new Date).getTime())+"&tk="+$r();!this.data.get("isHarmony")&&ja(n,{credentials:"include"},2e3).then((function(e){if(0===e.status&&e.data){var n,a,i,o=(null==(n=e.data.blocks)?void 0:n[0])||{},r=(null==(i=o.data)||null==(a=i.items)?void 0:a[0])||{};if("shortcuts"===o.component&&"deepseek_online"===r.type){var s;r.text&&t.data.set("onlineText",r.text),t.data.set("showOnlineBtn",!0);var c={};try{var l=JSON.parse(localStorage.getItem(he))||{};"DeepSeek-R1"===l.modelName&&(c=l)}catch(t){c=Je.getState("usedModel")||{}}t.data.set("internetChecked","1"===(null==c||null==(s=c.modelFunction)?void 0:s.internetSearch))}}})).catch((function(){Je.dispatch("update",{usedModel:{modelName:"DeepSeek-R1"}}),localStorage.setItem(he,'{"modelName":"DeepSeek-R1"}')}))},attached:function(){var t=this;this.richEditor=this.ref("inputField"),this.listener(),this.dsInputBlur=this.dsInputBlur.bind(this),this.watch("rank",(function(e){e&&t.data.set("placeholder","你可以继续问")}))},listenUpperSearchbox:null,listenShowPauseButton:null,listenGetUpdatedSa:null,listener:function(){var t=this;this.listenUpperSearchbox=_n((function(e){e.noClear||t.clearTextInput(),t.clearInput(),t.upperPcInput(e,"text")}),500),jn().on(this.listenUpperSearchbox),this.listenShowPauseButton=function(e){var n=e.isShowButton,a=void 0!==n&&n;t.data.set("isShowPauseButton",a)},sa().on(this.listenShowPauseButton),this.listenGetUpdatedSa=function(e){var n=e.sa;e.isAgent?t.data.set("agentSa",n):t.data.set("updatedSa",n)},xa().on(this.listenGetUpdatedSa),window.visualViewport.addEventListener("resize",this.resizeHandler)},resizeHandler:function(){var t=this;setTimeout((function(){window.innerHeight===t.screenHeight&&t.dsInputBlur()}),300)},disposed:function(){this.listenUpperSearchbox&&(jn().off(this.listenUpperSearchbox),this.listenUpperSearchbox=null),this.listenShowPauseButton&&(sa().off(this.listenShowPauseButton),this.listenShowPauseButton=null),this.listenGetUpdatedSa&&(xa().off(this.listenGetUpdatedSa),this.listenGetUpdatedSa=null),window.visualViewport.removeEventListener("resize",this.resizeHandler)},clearInput:function(){this.richEditor.innerText="",this.data.set("userHasInput",!1)},clearTextInput:function(){var t=this.richEditor;t.value="",this.data.set("textContent",""),this.data.set("rows",1);for(var e=t.childNodes,n=e.length-1;n>=0;n--)3!==e[n].nodeType&&"FONT"!==e[n].nodeName||e[n].remove();this.data.set("userHasInput",!1)},handleCloseClick:function(){this.richEditor.focus(),this.richEditor.value="",this.data.set("textContent",""),this.data.set("rows",1)},handleUnLoginClick:function(t){t.stopPropagation(),t.preventDefault(),ws()},launchSearch:function(t,n){return void 0===t&&(t={}),void 0===n&&(n="notSug"),(a=function(){var a,i,o,r,s,c;return zl(this,(function(l){switch(l.label){case 0:if(!(Je.getState("rank")>=xs()))return[3,5];a=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,ws()];case 2:return a=l.sent(),[3,4];case 3:return i=l.sent(),console.error(i),[3,4];case 4:if(!a)return[2];l.label=5;case 5:return Je.dispatch("update",{pcInputTime:Date.now()-Je.getState("pcInputFocusTime")}),o=t.query||this.data.get("textContent"),(r=o.trim())?(s=this.data.get("updatedSa"),c=this.updateSa(n,r,s),(this.data.get("isHarmony")?Za:Ya)().emit({name:"search",params:{query:r,sa:c}}),this.clearTextInput(),this.richEditor.blur(),this.data.set("agentSa",""),this.data.set("updatedSa",""),this.data.set("sa",""),[2]):(e.Toast.show({message:"请输入你的问题"}),[2])}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(n,i){var o=a.apply(t,e);function r(t){Wl(o,n,i,r,s,"next",t)}function s(t){Wl(o,n,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var a},updateSa:function(t,e){var n,a="",i="sug"!==t?"bkb":"bks",o=this.data.get("userHasInput"),r="link"===(null==(n=(gl(e)||[])[1])?void 0:n.type);return(a=r?"searchbox_link":a)&&r?o&&(a=i+"_"+a):a=a||i,a},upperPcInput:function(t){var e=document.createTextNode(t.word),n=this.richEditor;"query"===t.type?n.appendChild(e):n.insertBefore(e,n.firstChild)},handleFocused:function(){var t=this;this.updateRowNum(),Je.dispatch("update",{pcInputFocusTime:Date.now()}),this.nextTick((function(){t.data.set("inputStatus","focus"),t.dispatch("toggle-input-mask",{showMask:!0})})),setTimeout((function(){!t.data.get("isHarmony")&&window.scroll({top:document.body.scrollHeight,left:0,behavior:"smooth"}),window.addEventListener("touchmove",t.dsInputBlur)}),500),La().emit({focus:!0,height:this.data.get("showOnlineBtn")&&!this.data.get("isHarmony")?141:99})},isElementInViewport:function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},handleInput:function(t){var e,n,a=this.richEditor.value||"";this.data.set("textContent",a),this.updateRowNum(),"\n"===a||0===a.length?(this.clearInput(),this.data.set("showPlaceholder",!0)):this.data.set("showPlaceholder",!1),this.data.set("needInvokeSug",!0),this.data.set("userHasInput",!0);var i=window.getSelection().getRangeAt(0).startOffset,o=null==t||null==(e=t.target)?void 0:e.innerText;if(o){var r=o.replace(/[\r\n]+/g," ");(null==t?void 0:t.target)&&(t.target.innerText=r);var s=document.createRange(),c=window.getSelection();s.setStart((null==t||null==(n=t.target)?void 0:n.firstChild)||(null==t?void 0:t.target),i),s.collapse(!0),c.removeAllRanges(),c.addRange(s)}},handleBlur:function(){var t=this;this.data.set("rows",1),this.richEditor.scrollTop=0,this.nextTick((function(){t.data.set("inputStatus","blur"),t.dispatch("toggle-input-mask",{showMask:!1})})),window.removeEventListener("touchmove",this.dsInputBlur),La().emit({focus:!1,height:this.data.get("showOnlineBtn")&&!this.data.get("isHarmony")?119:77})},handleKeyUp:function(t){var e=this;this.nextTick((function(){var n=e.data.get("textContent").trim();"Enter"!==t.key||e.data.get("isComposing")||(e.sendInputLog("input"),e.launchSearch({query:n}))}))},handleKeyDown:function(t){"Enter"===t.key&&t.preventDefault()},handleTouchMove:function(t){t.stopPropagation&&t.stopPropagation()},handleIconInputClick:function(t){t.stopPropagation(),this.sendInputLog("ask"),this.launchSearch()},handlePaste:function(){this.updateRowNum()},handleInternetSearch:function(){"focus"===this.data.get("inputStatus")&&this.richEditor.focus();var t=!this.data.get("internetChecked"),e={modelName:"DeepSeek-R1",modelFunction:{internetSearch:t?"1":"0"}};this.data.set("internetChecked",t),Je.dispatch("update",{usedModel:e}),localStorage.setItem(he,JSON.stringify(e)),Aa({type:"click",value:"online_btn",ext:{is_open:t?"1":"0",enter_type:Je.getState("enterType"),a_lid:Je.getState("apagelid")}})},insertAtRange:function(t){var e=document.getSelection();if(e.rangeCount){var n=e.getRangeAt(0);n.deleteContents(),n.insertNode(t),n.setStartAfter(t),n.setEndAfter(t),e.removeAllRanges(),e.addRange(n)}},isCursorAtEnd:function(){var t=window.getSelection().getRangeAt(0),e=t.cloneRange();return e.selectNodeContents(this.richEditor),e.setStart(t.endContainer,t.endOffset),0===e.toString().length},sendInputLog:function(t){Aa({ubcId:"17132",type:"click",value:"nonala_cpt",ext:{re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid"),lid:Je.getState("lid"),ori_lid:Je.getState("oriLid"),setype:"csaitab",action:t,valueInfo:[{component_name:"input"}]}})},updateRowNum:function(){var t=this;this.nextTick((function(){var e=t.ref("hideContent"),n=parseInt(getComputedStyle(e).lineHeight||"20",10),a=Math.ceil(e.offsetHeight/n);t.data.set("rows",a>4?4:a<1?1:a)}))},dsInputBlur:function(){"focus"===this.data.get("inputStatus")&&this.richEditor.blur()},back:function(){this.data.get("isHarmony")?On().conversation.goBack.emit():history.back()}})),Jl=St.connect(Je,{inputBox:"manifest.inputBox"})(a.defineComponent({template:'\n        \x3c!--输入框默认结构 语音 + 文本--\x3e\n        <div class="chat-input-box-pc">\n            <ds-input s-if="isDeepSeekPage || isHarmony" />\n            <text-input s-else />\n        </div>\n    ',components:{"text-input":Gl,"ds-input":Ql},initData:function(){return{isDeepSeekPage:ct(),isHarmony:dt()}}}));function Vl(t){return"font-size-"+(t<1?"0":1===t?"1":t>1&&t<1.1?"2":"3")}function Kl(){return Kl=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Kl.apply(this,Array.from(arguments))}function Xl(t){var e,n,a="baiduboxapp://searchframe/transportDurationParams?params=",i={};Object.keys(t).forEach((function(e){t[e]&&(i[e]=t[e])})),a+=encodeURIComponent(JSON.stringify({extClickParams:i})),e=a,(n=document.createElement("iframe")).style.display="none",n.src=e,document.body.appendChild(n),setTimeout((function(){document.body.removeChild(n),n=null}),200)}function Yl(t,e){var n=t,a=function(t){var e=document.body,n=t.closest("a");if(n&&n.getAttribute("href"))return n;var a=null,i=t;for(;i&&i!==e;){var o=i.hasAttribute("rl-node"),r=i.getAttribute("rl-type"),s=i.getAttribute("rl-link-href");if("stop"===r||"button"===r)break;if(o&&s){a=i;break}i=i.parentNode}return a}(t);if(!a||!a.classList.contains("WA_LOG_XCX")){var i={t:Date.now(),vd_cyc:"0"},o=function(t,e,n){e=e||document.documentElement;var a=[];for(;t&&t!==e;){var i=Zl(t),o=t.getAttribute("data-module");a.push(t.nodeName.toLowerCase()+(i>0?i+1:"")+(o?"("+o+")":"")),t=t.parentNode}return a.reverse().join("-").slice(0,n)}(t,n,150);o&&-1!==o.indexOf("vd-cyc")&&(i.vd_cyc="1"),Xl(Kl({},function(t){var e={};for(;t&&t!==document.body;){var n=t.getAttribute("data-time-log");if(n)try{e=Object.assign(JSON.parse(n),e)}catch(t){console.error(t)}t=t.parentNode}return e}(t),i,e||{}))}}function Zl(t){for(var e=0,n=t.previousSibling;n;)n.tagName===t.tagName&&e++,n=n.previousSibling;return e}function td(){return td=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},td.apply(this,Array.from(arguments))}var ed={},nd=!1,ad="https://m.baidu.com/tc?";function id(t){if("pc"===rt()){var e=t.ubcId,n=t.page,a=t.type,i=t.source,o=t.value,r=t.ubcExt;Aa(td({ubcId:e||"17132",page:n||"resultpage",type:a||"click"},i?{source:i}:{},{value:o,ext:td({setype:"csaitab",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid")},r)}))}else{delete t.ubcExt;var s=t.clk_info||{};od(t.clk_info)&&(t.clk_info=t.clk_info||{},t.clk_info.t=Date.now(),t.clk_info=JSON.stringify(t.clk_info)),od(t.extra)&&(t.extra=JSON.stringify(t.extra)),s.tplname&&t.order&&(t.ala_clk=[s.tplname,t.order,0,10,"o"].join("_"));var c=[];Object.keys(t).forEach((function(e){c.push(e+"="+encodeURIComponent(t[e]))}));var l=c.join("&"),d=new Image;d.onload=d.onerror=d.onabort=function(){d.onload=d.onerror=d.onabort=null,d=null},d.src=ad+l}}function od(t){return"[object Object]"===Object.prototype.toString.call(t)}function rd(t,e){var n={};n=od(t.clk_info)&&od(e.clk_info)?Object.assign({},t.clk_info,e.clk_info):t.clk_info||e.clk_info;var a={};a=od(t.extra)&&od(e.extra)?Object.assign({},t.extra,e.extra):t.extra||e.extra;var i={};return i=od(t.ubcExt)&&od(e.ubcExt)?Object.assign({},t.ubcExt,e.ubcExt):t.ubcExt||e.ubcExt,Object.assign(t,e,{extra:a,clk_info:n,ubcExt:i})}function sd(t,e){if(!t)return!1;for(var n={},a="",i=e,o=[],r=0;t&&t!==document.body;){if("1"===t.getAttribute("data-nolog"))return!1;var s=t.getAttribute("data-click-log");if(s)try{n=rd(JSON.parse(s),n)}catch(t){console.error(t)}t.href&&(a=t.href),t.hasAttribute("need-click-log")&&(i=!0);var c=1;if(t.previousSibling){var l=t.previousSibling;do{1===l.nodeType&&l.tagName===t.tagName&&c++,l=l.previousSibling}while(l)}var d=t.getAttribute("data-module");d=d?"("+d+")":"",o[r++]=t.tagName+(c>1?c:"")+d,t=t.parentNode}if(!i)return!1;"a"===t.tagName.toLowerCase()&&(a=t.href||a);var u=o.reverse().join("-").toLowerCase();return n.clk_info=n.clk_info||{},n.clk_info.xpath=u,n}function cd(t){var e,n=sd(t.target,!1);!1!==n&&(rd(n,ed),"pc"===rt()||!t.target||1==+n.tcreq4log&&1!=+(null==(e=n.clk_info)?void 0:e.cyc)||Yl(t.target,{}),id(n))}function ld(t,e,n){t=function(t,e){var n={};return t&&(n.clk_info=t,n.extra=t.extra,n.ubcExt=t.ubcExt),void 0!==(null==e?void 0:e.tplname)&&(n.clk_info.tplname=e.tplname),void 0!==(null==e?void 0:e.srcid)&&(n.clk_info.srcid=e.srcid),void 0!==(null==e?void 0:e.order)&&(n.order=e.order),void 0!==(null==t?void 0:t.cyc)&&(n.cyc=t.cyc),n.clk_info.extra&&delete n.clk_info.extra,n.clk_info.cyc&&delete n.clk_info.cyc,"pc"===rt()&&t&&t.value&&(n.value=t.value),n}(t||{},e);var a={};n&&(a=sd(n,!0)),rd(a,rd(t,ed)),"pc"===rt()||!n||1==+a.tcreq4log&&1!=+a.cyc||Yl(n,{srcid:e.srcid,tplname:e.tplname,order:e.order,lid:e.lid}),id(a)}var dd="aitab_tool_tip_shown",ud=a.defineComponent({trimWhitespace:"all",computed:{ubcShowLog:function(){var t;return JSON.stringify(((t={value:"questionClosely_toast",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}).ori_lid=Je.getState("oriLid"),t.re_rank=String(+Je.getState("rank")),t.setype="csaitab",t))}},initData:function(){return{visible:!1,text:"",position:{x:0,y:0},autoHideTimer:null}},attached:function(){this.checkShouldShow(),this.documentClickHandler=this.handleDocumentClick.bind(this),document.addEventListener("click",this.documentClickHandler)},disposed:function(){document.removeEventListener("click",this.documentClickHandler);var t=this.data.get("autoHideTimer");t&&clearTimeout(t)},checkShouldShow:function(){var t=localStorage.getItem(dd);Boolean(t)||(this.show(),localStorage.setItem(dd,"true"))},show:function(){var t=this;this.data.set("visible",!0);var e=setTimeout((function(){t.hide()}),3e3);this.data.set("autoHideTimer",e)},hide:function(){this.data.set("visible",!1)},handleDocumentClick:function(t){var e=this.el;e&&e.contains(t.target)?(this.hide(),this.fire("tooltip-click")):this.hide()}}),pd={};pd=Object.assign(pd,{tooltip:"tooltip_a2aa3_1",tooltipContent:"tooltip-content_a2aa3_6","tooltip-content":"tooltip-content_a2aa3_6",tooltipArrow:"tooltip-arrow_a2aa3_19","tooltip-arrow":"tooltip-arrow_a2aa3_19"}),ud.template='\n    <div\n        s-if="visible"\n        data-show-area\n        data-show-ext="{{ubcShowLog}}"\n        class="{{$style[\'tooltip\']}}"\n        style="left: {{position.x}}px; top: {{position.y}}px"\n    >\n        <div class="{{$style[\'tooltip-content\']}}">\n            {{text}}\n            <div class="{{$style[\'tooltip-arrow\']}}"></div>\n        </div>\n    </div>\n';var hd="function"==typeof ud?ud.prototype.initData||fd:ud.initData||fd;function fd(){return{$style:pd}}function gd(){return Object.assign({},hd.call(this),{$style:pd})}function md(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function vd(){return vd=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},vd.apply(this,Array.from(arguments))}function yd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return md(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?md(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}"function"==typeof ud?ud.prototype.initData=gd:ud.initData=gd;var bd="h5",wd="aiSearch",_d="chatSearch",kd="multiSearch",Sd=a.defineComponent({trimWhitespace:"all",computed:{ubcClickLog:function(){var t,e=this.data.get("componentArea")||((null==(t=Je.getState("agentInfo"))?void 0:t.agentName)?"agent_answer":"answer");return JSON.stringify({type:"click",value:"nonala_cpt",ubcExt:{valueInfo:[{component_name:"questionClosely",component_type:"long",component_area:e}]}})},multiRecommendWord:function(){var t=this.data.get("recommendWord")||[],e=t.length,n=Math.floor(e/2);if(!e)return[];t.forEach((function(t,a){t.index=a,a===n-1&&(t.rowLastItem=!0),a===e-1&&(t.rowLastItem=!0)}));var a=[t.slice(0,n),t.slice(n)];return a[0].rowIndex=1,a}},components:{"cos-avatar":e.Avatar,"cos-icon":e.Icon,"cos-image":e.Image,"tool-tip":ud},initData:function(){var t,e;return{url:"",recommendWord:[],stk:"",sa:"re_dl_prob",word:"",context:{},isSingleCol:"1",isShort:"0",logExt:{},jumpTypes:[_d,wd],urlParams:null,componentArea:"",isPc:"pc"===rt(),logExtParams:{},aiTabWeatherExperiment:!1,hideTopAgentList:Je.getState("hideTopAgentList"),dataShowExt:"",deepThinkData:"",startShowLog:"false",isRight:"1"===(null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.AI_TAB_RIGHT),isExtension:ft(),tipPosition:{x:25,y:-50},prefix:""}},attached:function(){this.checkLineWrapping()},checkLineWrapping:function(){var t=this,e=this.data,n=[];e.get("recommendWord").forEach((function(a,i){var o,r,s="item"+i,c=t.ref(s);if(c&&("agentRec"===a.type?(o=c.querySelector(".cs-question-closely-agent-content"),r=25):(o=c.querySelector(".cs-question-closely-agent-text"),r=23),o)){var l=o.offsetHeight>r;e.set("recommendWord["+i+"].isWrapped",l),l&&n.push(String(i+1))}})),this.data.set("qFoldPos",n),this.updateShowExt()},updateShowExt:function(){var t,e=this.data.get("recommendWord"),n=e[e.length-1],a=(null==n?void 0:n.agentInfo)||Je.getState("agentInfo")||{},i=a.agentSearchId,o=a.agentName,r=this.data.get("logExt")||{},s=this.data.get("logExtParams")||{},c=[],l=[],d=!1;e.forEach((function(t){if("agentRec"===t.type){d=!0;var e=t.agentInfo;e&&c.push(e.agentName+e.label)}else c.push(t.text);l.push(String(t.modelType))}));var u=this.data.get("componentArea")||((null==(t=Je.getState("agentInfo"))?void 0:t.agentName)?"agent_answer":"answer"),p="";if(this.data.get("hideTopAgentList")&&(p="weather"),this.data.set("dataShowExt",JSON.stringify(vd({component_content:{component_name:"questionClosely",component_area:p||u,component_type:this.data.get("recommendWord").length?"1"===this.data.get("isShort")?"short":"long":"text",component_strategy:l},agent_id:i,agent_name:o,guide_word_type:d?"agent":"common",scene:r.scene||s.scene,scene_1st:r.scene_1st||s.scene_1st,scene_2nd:r.scene_2nd||s.scene_2nd,rec_strategy:r.rec_strategy,value:"nonala_cpt",photoQuestions:this.data.get("photoQuestions"),text:c,q_fold_pos:this.data.get("qFoldPos"),mingliInfo:s.mingliInfo},s.current_model?{current_model:s.current_model}:{}))),e.length&&e[0].usedModel){var h=e[0].usedModel.modelName||"";this.data.set("deepThinkData",JSON.stringify({value:"deep_think",satisfy_model:h,enter_type:Je.getState("pcEnterType")}))}this.data.set("startShowLog","true"),this.nextTick((function(){po()}))},handleClick:function(t,e,n){this.data.get("urlParams")||(e.stopPropagation(),e.preventDefault());var a=(null==t?void 0:t.url)||this.data.get("url")||"",i=(null==t?void 0:t.jumpType)||"",r="linkText"===(null==t?void 0:t.theme),s=r?"":(null==t?void 0:t.text)||"",c=this.data.get("word")||"",l=(this.data.get("context")||{}).scene||"",d=this.data.get("sa")||"",u=this.data.get("stk")||"",p=(null==t?void 0:t.urlQuery)||"",h=(null==t?void 0:t.value)||"",f=this.data.get("recommendWord["+n+"].isWrapped"),g=t.diyUrl||"",m={ubcExt:{q_fold_pos:f?String(n+1):void 0}},v=this.data.get("prefix"),y={asyncApi:null==t?void 0:t.asyncApi,url:a,text:h||s,word:c,index:n,sa:d,stk:u,component:"questionClosely"};if(h&&(y.showText=s),g)o.canIUse("search.open")?o.search.open({url:g,notShowLandingTopBar:0,isContainer:"1",statusBarStyle:2,config:'{"immersed":1,"hideBack":1,"background":"#09090A"}'}):window.open(g,"_blank");else{p&&(y.urlQuery=p),v&&(y.prefix=v),(null==t?void 0:t.agentInfo)&&(y.agentInfo=t.agentInfo,m.ubcExt={agent_name:t.agentInfo.agentName,agent_id:t.agentInfo.agentSearchId});var b,w=vd({},(null==t?void 0:t.scene)&&{scene:t.scene},(null==t?void 0:t.extData)&&{extData:t.extData},(null==t?void 0:t.interaction_type)&&{extData:{searchInfo:{interaction_type:t.interaction_type}}});if(Object.assign(y,w),null==t?void 0:t.usedModel)y.usedModel=t.usedModel,m.ubcExt={query:y.text,satisfy_model:null==(b=t.usedModel)?void 0:b.modelName,enter_type:Je.getState("pcEnterType")};"pc"===rt()?ld(m,{},e.target):t?this.handleLog("na",r?"hat":"bub",{index:n,text:s,agentInfo:t.agentInfo,scene:t.scene,q_fold_pos:f?String(n+1):void 0}):this.handleLog("na","ask");var _,k=this.data.get("jumpTypes")||[],S=((_={})[wd]="aiSearch.open",_[_d]="search.chatSearchOpen",_);if("a-page"===l||"chat-search"===l){if(S[i]&&o.canIUse(S[i])||i===kd||i===bd)return void this.dispatch("ai-question-closely:click",{data:y,type:i});for(var x,I=yd(k);!(x=I()).done;){var T=x.value;if(S[T]&&o.canIUse(S[T])||T===kd||T===bd){this.dispatch("ai-question-closely:click",{data:y,type:T});break}}}}},handleLog:function(t,e,n){var a=n||{},i=a.index,o=a.text,r=a.agentInfo,s=a.scene,c=a.q_fold_pos,l=r||Je.getState("agentInfo")||{},d=this.data.get("logExt")||{},u=this.data.get("logExtParams")||{},p=this.data.get("componentArea"),h=this.data.get("recommendWord")[i].modelType,f=vd({action:e,agent_id:l.agentSearchId,agent_name:l.agentName,guide_word_type:(null==r?void 0:r.agentName)?"agent":"common",scene:d.scene||u.scene,scene_1st:d.scene_1st||u.scene_1st,scene_2nd:d.scene_2nd||u.scene_2nd,rec_strategy:d.rec_strategy,q_fold_pos:c},u.current_model?{current_model:u.current_model}:{});d.groupStyle&&(f.groupStyle=d.groupStyle);var g=this.data.get("recommendWord").length?"1"===this.data.get("isShort")?"short":"long":"text";"na"===t&&(f.bub_pos="bub"===e?i:"",f.zhuiwen_content="bub"===e?o:"",f.bot_pos="bub"===e?"bubble":"hat"===e?"hat":"",this.data.get("hideTopAgentList")?(f.component_content={component_name:"questionClosely",component_area:"weather",component_type:g},f.area="weather"):f.component_type=g),this.fire("action-log-event",{component:"questionClosely",strategy:String(h),type:g,componentType:"",componentArea:u.componentArea||p,actionType:t,ext:f,scene:s})},ubcClickLog:function(t){var e,n,a=this.data.get("componentArea")||((null==(e=Je.getState("agentInfo"))?void 0:e.agentName)?"agent_answer":"answer"),i=this.data.get("logExtParams")||{},o=this.data.get("recommendWord")[t].modelType,r=this.data.get("recommendWord");return 0===t&&r.length&&(null==(n=r[0])?void 0:n.usedModel)?JSON.stringify({type:"click",value:"deep_think",ubcExt:{}}):JSON.stringify({type:"click",value:"nonala_cpt",ubcExt:vd({bub_pos:t,valueInfo:[{component_name:"questionClosely",component_type:"long",component_area:a,component_strategy:String(o)}]},i)})}}),xd={};xd=Object.assign(xd,{closelyMultiContainer:"closely-multi-container_phe18_1","closely-multi-container":"closely-multi-container_phe18_1",firstRowContainer:"first-row-container_phe18_4","first-row-container":"first-row-container_phe18_4",rowContainer:"row-container_phe18_7","row-container":"row-container_phe18_7",guideWord:"guide-word_phe18_10","guide-word":"guide-word_phe18_10",multiCloselyWordItem:"multi-closely-word-item_phe18_15","multi-closely-word-item":"multi-closely-word-item_phe18_15",imgBox:"img-box_phe18_24","img-box":"img-box_phe18_24",img:"img_phe18_24",text:"text_phe18_33",rowLastItemStyle:"row-last-item-style_phe18_38","row-last-item-style":"row-last-item-style_phe18_38",closelyMultiStyle:"closely-multi-style_phe18_41","closely-multi-style":"closely-multi-style_phe18_41",csQuestionCloselyAgentContent:"cs-question-closely-agent-content_phe18_97","cs-question-closely-agent-content":"cs-question-closely-agent-content_phe18_97",aiIndexAgentLine:"ai-index-agent-line_phe18_106","ai-index-agent-line":"ai-index-agent-line_phe18_106",agentInfo:"agent-info_phe18_115","agent-info":"agent-info_phe18_115",modelImg:"model-img_phe18_133","model-img":"model-img_phe18_133",csQuestionCloselyAnimation0:"cs-question-closely-animation-0_phe18_175","cs-question-closely-animation-0":"cs-question-closely-animation-0_phe18_175",questionCloselyShow1:"questionCloselyShow1_phe18_1",csQuestionCloselyAnimation1:"cs-question-closely-animation-1_phe18_179","cs-question-closely-animation-1":"cs-question-closely-animation-1_phe18_179",questionCloselyShow2:"questionCloselyShow2_phe18_1",csQuestionCloselyAnimation2:"cs-question-closely-animation-2_phe18_182","cs-question-closely-animation-2":"cs-question-closely-animation-2_phe18_182",questionCloselyShow3:"questionCloselyShow3_phe18_1",followQuestionRight:"follow-question-right_phe18_185","follow-question-right":"follow-question-right_phe18_185",agentAvatarWrapper:"agent-avatar-wrapper_phe18_189","agent-avatar-wrapper":"agent-avatar-wrapper_phe18_189",agentAvatarWrapperImg:"agent-avatar-wrapper-img_phe18_194","agent-avatar-wrapper-img":"agent-avatar-wrapper-img_phe18_194"}),Sd.template='\n    <div\n        data-module="ai_questionClosely"\n        data-show-area\n        need-show-log="{{startShowLog}}"\n        data-show-ext="{{aiTabWeatherExperiment && hideTopAgentList ? \'\' : dataShowExt}}"\n        class="cs-question-closely-container cs-question-closely-wrapper"\n    >\n        <div s-if="{{isSingleCol ===\'1\' && !aiTabWeatherExperiment}}">\n            <div\n                s-for="item, index in recommendWord"\n                class="\n                    {{$style[\'cs-question-closely-animation-\' + index]}}\n                    {{isRight ? $style[\'follow-question-right\'] : \'\'}}\n                "\n                data-click-log="{{ubcClickLog(index)}}"\n                s-ref="{{\'item\' + index}}"\n            >\n                <tool-tip\n                    s-if="{{item.tipText}}"\n                    text="{{item.tipText}}"\n                    position="{{tipPosition}}"\n                />\n                <div\n                    s-if="{{item.type === \'agentRec\'}}"\n                    class="\n                        cs-question-closely-agent\n                        cs-question-closely-single-bub\n                    "\n                    on-click="handleClick(item, $event, index)"\n                >\n                    \x3c!-- 此dom里面只能使用 inline 元素，不然会导致2行溢出截断失效 --\x3e\n                    <span class="cs-question-closely-agent-content cos-line-clamp-2">\n                        <span\n                            class="{{$style[\'agent-avatar-wrapper\']}}"\n                        >\n                            <img class="{{$style[\'agent-avatar-wrapper-img\']}}" src="{{item.agentInfo.logo}}" />\n                        </span>\n                        {{item.agentInfo.agentName}}\n                        <span class="{{$style[\'ai-index-agent-line\']}}"></span>\n                        {{item.agentInfo.label}}\n                    </span>\n                </div>\n                <div\n                    s-else\n                    class="cs-question-closely-single-bub"\n                    style="{{item.color ?\n                    \'color:\' + item.color + \';\'\n                    + \'--common-color-border:\' + recommendWord[0].color + \';\' :\n                    \'\'}}"\n                    data-show-ext="{{item.usedModel ? deepThinkData : \'\'}}"\n                    on-click="handleClick(item, $event, index)"\n                >\n                    <div s-if="item.img || item.icon" class="cos-space-mr-xxs">\n                        <cos-image\n                            s-if="item.img"\n                            src="{{item.img}}"\n                            class="\n                                cos-image-fit-cover\n                                cos-image-position-center\n                                cos-image-1-1\n                                cs-question-closely-single-bub-img\n                                {{item.usedModel ? $style[\'model-img\'] : \'\'}}\n                            "\n                        />\n                        <cos-icon class="cs-question-closely-bub-icon" s-if="{{item.icon}}" name="{{item.icon}}"/>\n                    </div>\n                    <span class="cs-question-closely-agent-text cos-line-clamp-{{isExtension ? \'1\' : \'2\'}}">{{item.text}}</span>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- AI助手首页天气入口实验: 追问区域 --\x3e\n        <div\n            s-else-if="{{aiTabWeatherExperiment && hideTopAgentList && multiRecommendWord.length}}"\n            class="{{$style[\'closely-multi-container\']}}"\n        >\n            <div class="{{$style[\'guide-word\']}}">\n                <p class="cos-line-clamp-2 cos-text-body-lg cos-color-text cos-space-mt-none cos-space-mb-none"\n                >{{guideWord}}</p>\n            </div>\n            <div class="ai-question-closely-multi {{$style[\'closely-multi-style\']}}">\n                <div\n                    s-for="dataListItem in multiRecommendWord"\n                    class="\n                        ai-question-closely-multi-row\n                        {{dataListItem.rowIndex === 1 ? $style[\'first-row-container\'] : \'\'}}\n                        {{$style[\'row-container\']}}\n                    "\n                >\n                    <div\n                        data-show-ext="{{dataShowExt}}"\n                        s-for="item in dataListItem"\n                        on-click="handleClick(item, $event, item.index)"\n                        class="{{$style[\'multi-closely-word-item\']}} {{item.rowLastItem ? $style[\'row-last-item-style\'] : \'\'}}"\n                    >\n                        <div class="{{$style[\'img-box\']}}">\n                            <img src="{{item.img}}" class="{{$style[\'img\']}}"/>\n                        </div>\n                        <div class="{{$style[\'text\']}}">\n                            {{item.text}}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n';var Id="function"==typeof Sd?Sd.prototype.initData||Td:Sd.initData||Td;function Td(){return{$style:xd}}function Cd(){return Object.assign({},Id.call(this),{$style:xd})}function Ld(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Pd(){return Pd=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pd.apply(this,Array.from(arguments))}function Dd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ld(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ld(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ad(t){var e=document.createElement("iframe");e.style.display="none",e.src=t;var n=document.body||document.getElementsByTagName("body")[0];n.appendChild(e),setTimeout((function(){n.removeChild(e),e=null}),0)}function Ed(t){var e=function(t){return t.replace(/^[\u200C]/,"").replace(/(\r?\n)[\u200C]/g,"$1")}(t);return new Promise((function(t,n){var a=document.createElement("textarea");a.style.background="transparent",a.setAttribute("readonly","readonly"),a.value=e,document.body.appendChild(a),a.select(),a.setSelectionRange(0,e.length);try{document.execCommand("copy",!1)?t("复制成功"):n(new Error("复制失败"))}catch(t){n(t)}finally{document.body.removeChild(a)}}))}function Od(t,e,n){for(var a,i=Dd(t.querySelectorAll(e));!(a=i()).done;){var o=a.value;n||o.parentNode.removeChild(o),o.innerHTML=n}return t}"function"==typeof Sd?Sd.prototype.initData=Cd:Sd.initData=Cd;var Rd=function(t,e,n){if(void 0===e&&(e=""),void 0===n&&(n=-1),!t)return"";if(t.children&&t.children.length&&t.children[0].tagName){if("IMG"===t.children[0].tagName)return"下面是一张图片。";if("IFRAME"===t.children[0].tagName)return"下面是一张卡片。"}var a=t.cloneNode(!0);-1!==n&&(a.innerHTML=a.innerHTML.substring(0,n));a.innerHTML=a.innerHTML.replace(/<style(.*?)<\/style>/g,"");var i,o=Od(a,"[out-audio]",""),r=Od(o,"[disable-tts],[disable-audio]",""),s=Od(r,"pre code","下面是一段代码。"),c=Od(s,"table","下面是一个表格。"),l=Od(c,"svg","下面是一个图表。"),d=Od(l,"sup",""),u=(i=null==d?void 0:d.innerText.trim(),/。|？|\?|!|！|;|；|\t|\r|\v|\n/.test(i[i.length-1])?i.substring(0,i.length-1):i);return e&&e===u.slice(0,e.length)&&(u=u.slice(e.length)),u};function Nd(t,e,n,a){void 0===e&&(e=0),void 0===n&&(n="1"),void 0===a&&(a=2),t&&(t.startsWith("baiduboxapp:")?Ad(t):o.canIUse("search.open")?o.search.open({url:t,notShowLandingTopBar:e,isContainer:n,statusBarStyle:a,config:'{"immersed":1,"hideBack":1}'}):window.open(t,"_blank"))}function qd(t,e,n,a){if(void 0===n&&(n={}),e&&(null==t?void 0:t.component)&&(null==t?void 0:t.actionType)){var i=["na","sf","xcx","mip","l"].indexOf(t.actionType)>-1,o={component_content:Pd({component_name:t.component,component_strategy:t.strategy,component_type:t.type},t.componentType?{component_type:t.componentType}:{},t.componentArea?{component_area:t.componentArea}:{})},r=Pd({type:t.actionType},i?{cyc:1}:{},i&&n.launchMultiSearch?{ol_rec:1}:{});if(t.ext){n.action&&i?r.action=n.action:t.ext.action&&(r.action=t.ext.action);var s=t.ext;delete s.action,Object.assign(o,s)}"markdown"===t.component&&"reference"===t.componentType&&"na"===t.actionType&&(r.action="sup"),r.extra=o,ld(r,e,a)}}function Md(){return Md=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Md.apply(this,Array.from(arguments))}var jd=a.defineComponent({recordHeight:0,computed:{componentType:function(){switch(this.data.get("askComponentData").component){case"askBack":return"sc-ask-back";case"questionClosely":return"ai-question-closely";case"input":return"sc-ai-input"}return"div"},agentInfo:function(){var t;return null==(t=this.data.get("askComponentData"))?void 0:t.agentInfo}},components:{"ai-question-closely":Sd,"sc-ask-back":n.AIAskBack},messages:{"ai-ask-back:input-send":function(t){this.launchSearch(t.value.targetStr,"re_dl_reply")},"ai-ask-back:input-change":function(){this.prefetchAiTab("re_dl_reply")},"ai-ask-back:change":function(t){if(this.prefetchAiTab("re_dl_reply"),this.data.get("chatSearchAiTabInfo").isAiTab){var e=t.value;On().conversation.updataTag.emit(Md({cardId:this.data.get("tplInfo.lid"),categoryName:e.categoryName,categoryId:e.categoryId,tagList:e.tagList},e.extra))}else{var n="select"===t.value.selectionStatus,a=this.data.get("askBackSelectCount");this.data.set("askBackSelectCount",n?a+1:a-1)}},"ai-question-closely:click":function(t){this.dispatch("ai-question-closely:click",t.value);var e,n,a=t.value.data.text,i=t.value.data,o=i.agentInfo,r=i.index,s=i.asyncApi,c=i.url,l=i.scene,d=i.extData,u=i.usedModel,p=i.prefix,h=void 0===p?"":p;if("numerologyForm"===l&&(Je.dispatch("update",{truncQueryIndexRange:[h.length,h.length+a.length]}),a=h+a),o)return"jumpLink"===o.actionType&&(null==(e=o.jump_url)?void 0:e.zbios)?void Ad(o.jump_url.zbios):(es(Md({},o,{startIndex:0,endIndex:null==(n=o.agentName)?void 0:n.length}),"prob_agent"),void as(o,Je.getState("query")));if(s&&c)On().conversation.asyncBubClick.emit({asyncApi:s,url:c,rank:this.data.get("rank")});else{if("photoQuestion"===l)ea().emit();else{var f=r+1,g=this.data.get("sa")?this.data.get("sa")+"_"+f:"re_dl_prob";this.launchSearch(a,g,u,d)}this.prefetchAiTab("re_dl_prob")}},"ai-input:input-send":function(t){this.launchSearch(t.value.data.text,"re_dl_input"),this.fire("ai-input-send")},"ai-input:input-change":function(){this.prefetchAiTab("re_dl_input")}},initData:function(){return{sa:"",askComponentData:[],tplInfo:{},canLaunchMultiSearch:!0,isSingleCard:!1,askBackSelectCount:0,theme:null,tabName:"",initRank:1,chatSearchAiTabInfo:{isChatSearchAiTabExperiment:!1,isAiTab:!1},hasPreScrollLogic:!1,chatParams:{},curAgentInfo:null}},listenTag:null,attached:function(){this.data.get("chatSearchAiTabInfo").isAiTab&&(this.listenTag=this.askTagEventHandle.bind(this),On().container.deleteTag.on(this.listenTag),On().container.submitTag.on(this.listenTag)),this.data.get("hasPreScrollLogic")&&this.observeAskBack()},disposed:function(){this.listenTag&&(On().container.deleteTag.off(this.listenTag),On().container.submitTag.off(this.listenTag),this.listenTag=null)},observeAskBack:function(){var t=this,e=this.ref("askComponent").ref("inputField").el;if(e){new MutationObserver((function(){var n=e.clientHeight;0!==n&&n!==t.recordHeight&&(t.dispatch("update-swiper-height"),t.recordHeight=n)})).observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}},askTagEventHandle:function(t){this.fire("tag-event",{data:t,el:this.ref("askComponent")})},launchSearch:function(t,e,n,a){void 0===n&&(n={}),void 0===a&&(a=null);var i=this.data.get("askComponentData.data"),o=i.jumpType,r=i.baseUrl,s=i.xcxParams;if(o&&r)this.openPage(o,{baseUrl:r,xcxParams:s},t);else{var c=this.data.get("chatSearchAiTabInfo"),l=c.isChatSearchAiTabExperiment,d=c.isAiTab;l&&(d?this.launchMultiRoundSearch(t,e,n,a):this.jumpToAiTab(t,e)),t&&this.data.get("canLaunchMultiSearch")&&this.launchMultiRoundSearch(t,e,n,a)}},launchMultiRoundSearch:function(t,n,a,i){var o,r,s=this;void 0===a&&(a={}),void 0===i&&(i=null),this.data.get("tabName")&&(window.sgeSpringTab=this.data.get("tabName")),this.data.set("askComponentData.data.showLoading",!0);this.data.get("isSingleCard");var c=this.data.get("tplInfo");c.order,this.data.get("askBackSelectCount"),this.data.get("theme");var l,d=this.data.get("agentInfo"),u=null==(o=this.data.get("askComponentData"))?void 0:o.actionLid,p=this.data.get("curAgentInfo");p&&this.fire("update-agent-info",{agentInfo:Md({},p,{startIndex:0,endIndex:null==(l=p.agentName)?void 0:l.length})});(null==d||null==(r=d.agent_id)?void 0:r[0])&&this.fire("update-agent-info",{agentInfo:{agentSearchId:d.agent_id[0],agentParams:u?{actionLid:u}:{}}});var h={sa:c.srcid?n+"_"+c.srcid:n,usedModel:a,searchInfo:null==i?void 0:i.searchInfo};a.modelName&&(h.sa="deepthink"),i&&(h.csextdata=i),Ar({query:t,extParams:h}).then((function(){s.data.set("askComponentData.data.showLoading",!1)})).catch((function(t){if(s.data.set("askComponentData.data.showLoading",!1),!t||"string"!=typeof t)throw t;e.Toast.show({message:t})}))},beforeScrollUnderSGE:function(){var t=this;return new Promise((function(e){t.dispatch("update-swiper-height"),setTimeout((function(){e()}),400)}))},jumpToAiTab:function(t,n){var a=this;this.data.set("askComponentData.data.showLoading",!0);var i=this.data.get("tplInfo");this.chatSearch.jumpAiTab({appendQuery:t,sa:n+"_"+i.srcid}).then((function(){a.data.set("askComponentData.data.showLoading",!1)})).catch((function(t){a.data.set("askComponentData.data.showLoading",!1),t&&e.Toast.show({message:t})}))},prefetchAiTab:function(t){var e=this.data.get("chatSearchAiTabInfo"),n=e.isChatSearchAiTabExperiment,a=e.isAiTab;n&&!a&&this.chatSearch.aiTabPrefetch({sa:"no_pv_"+t+"_"+this.data.get("tplInfo").srcid})},handleUbcLog:function(t){var e=this.data.get("agentInfo"),n=e.agentSearchId,a=e.agentName,i=t.ext,o=i.bub_pos,r=i.zhuiwen_content;Aa({rank:Je.getState("rank"),type:"click",value:"agent_guide",ext:{agent_id:n,agent_name:a,guide_info:r,guide_pos:o+1}})},handleActionLogEvent:function(t){var e;if("pc"!==rt()&&this.data.get("isAgentGreeting"))this.handleUbcLog(t);else{var n=this.data.get("canLaunchMultiSearch"),a=this.data.get("chatSearchAiTabInfo").isChatSearchAiTabExperiment,i="";n&&"askBack"===t.component?i="invokesge":a&&"askBack"===t.component&&(i="invokecsaitab"),this.data.get("askComponentData.data.jumpType")&&(t.actionType=this.data.get("askComponentData.data.jumpType")),t.ext||(t.ext={});var o=0;"photoQuestion"===t.scene&&(o=1),t.ext.is_photo_questions=o,t.ext.photo_questions=this.data.get("askComponentData.data.photoQuestions"),this.data.get("askComponentData.data.action")&&(i=this.data.get("askComponentData.data.action"));var r=this.data.get("askComponentData.data"),s=r.jumpType,c=r.baseUrl;qd(t,this.data.get("tplInfo"),{action:i,launchMultiSearch:!s||!c},null==(e=this.ref("askComponent"))?void 0:e.el)}}}),Bd={aiQuestionCloselySingleBubIcon:"ai-question-closely-single-bub-icon_bfwq8_1","ai-question-closely-single-bub-icon":"ai-question-closely-single-bub-icon_bfwq8_1"},Hd={};jd.template='\n    <component\n        s-ref="askComponent"\n        s-if="{{askComponentData.data}}"\n        s-is="{{componentType}}"\n        styles="{{$sAskBack}}"\n        s-bind="{{askComponentData.data}}"\n        log-ext-params="{{askComponentData.logExt}}"\n        on-action-log-event="handleActionLogEvent"\n    />\n';var $d="function"==typeof jd?jd.prototype.initData||Ud:jd.initData||Ud;function Ud(){return{$style:Hd,$sAskBack:Bd}}function Fd(){return Object.assign({},$d.call(this),{$style:Hd,$sAskBack:Bd})}function Gd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Wd(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function zd(){return zd=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zd.apply(this,Array.from(arguments))}function Qd(t,e){return Qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Qd(t,e)}function Jd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Gd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gd(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vd(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof jd?jd.prototype.initData=Fd:jd.initData=Fd;var Kd=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).cancelTargetClickSign=!1,e.tempCloseListFunc=null,e.tempCloseTipFunc=null,e.tempScrollFunc=null,e.listenCheckoutChatModel=null,e.listenModelFuncData=null,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qd(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{haveDocumentListener:null,capsuleData:[],modelFuncData:[],modelList:[],useInnerUploader:!0,isModelListOpen:!1,logExtParams:{},isShowModelTooltip:!1,shouldModelListEnter:!1,modelQuotaTips:me,loadingModelId:"",modelTip:"",hideCapsule:!1,selectedModelId:"",isModelInNA:ut()&&Fi(Ui(),"15.7")>=0}},n.inited=function(){var t=He.getModelTip();t&&(this.data.set("modelTip",t),this.data.set("isShowModelTooltip",!0)),this.useModelAction=new Qi(Je)},n.attached=function(){var t=this;this.fire("rendered"),this.tempCloseListFunc=this.handleCloseModelList.bind(this),this.tempCloseTipFunc=this.handleCloseModelTip.bind(this),this.tempScrollFunc=_n(this.handleCloseModelList,1e3,{trailing:!1,leading:!0}).bind(this),Va().on(this.handleCloseModelList.bind(this)),Ka().on(this.handleCloseModelList.bind(this)),ni().on(this.handleCloseModelList.bind(this)),La().on(this.handleInputFocus.bind(this)),this.data.get("isShowModelTooltip")&&(this.fire("model-tooltip-show"),setTimeout((function(){t.data.set("isShowModelTooltip",!1)}),5e3)),this.globalClickHandler=function(e){var n;(null==(n=e.target)?void 0:n.closest(".capsules-model-list"))||t.tempCloseListFunc()},this.watch("isModelListOpen",(function(e){e?(document.addEventListener("click",t.globalClickHandler,!0),t.fire("model-list-show")):(document.removeEventListener("click",t.globalClickHandler,!0),t.cancelTargetClickSign=!0,t.nextTick((function(){t.cancelTargetClickSign=!1})))})),document.addEventListener("touchmove",this.tempScrollFunc),document.addEventListener("click",this.tempCloseTipFunc,!0),this.listenModelFuncData=function(e){t.data.set("modelFuncData",e.modelFuncData)},On().component.showModelFunData.on(this.listenModelFuncData),this.data.get("isModelInNA")&&(this.listenCheckoutChatModel=function(e){var n,a=null==(n=e.params)?void 0:n.selectedId;t.data.set("selectedModelId",a);for(var i,o=Jd(t.data.get("modelList"));!(i=o()).done;){var r=i.value;if(r.checked=r.id===a,r.id===a){t.useModelAction.handleSelectModel(r),t.data.set("modelFuncData",r.modelFuncData);break}}},On().container.checkoutChatModel.on(this.listenCheckoutChatModel))},n.detached=function(){document.removeEventListener("click",this.tempCloseListFunc,!0),document.removeEventListener("click",this.tempCloseTipFunc,!0),document.removeEventListener("touchmove",this.tempScrollFunc)},n.disposed=function(){this.listenCheckoutChatModel&&(On().container.checkoutChatModel.off(this.listenCheckoutChatModel),this.listenCheckoutChatModel=null),this.listenModelFuncData&&(On().component.showModelFunData.off(this.listenModelFuncData),this.listenModelFuncData=null)},n.handleCloseModelList=function(){var t=this;this.data.set("shouldModelListEnter",!1),setTimeout((function(){t.data.set("isModelListOpen",!1)}),150)},n.handleCloseModelTip=function(){this.data.get("isShowModelTooltip")&&this.data.set("isShowModelTooltip",!1)},n.realShowExt=function(t,e){return JSON.stringify(zd({component_content:{component_name:"shortcuts"},value:"capsule_bub",capsule_content:[{agent_id:null==t?void 0:t.agentId,agent_name:null==t?void 0:t.text,agent_pos:e+""}]},this.data.get("logExtParams")))},n.handleCapsuleClick=function(t,e){this.fire("click",zd({},t,{itemIndex:e}))},n.handleInternetSearch=function(){var t=this.data.get("internetChecked");this.useModelAction.toggleInternetSearch(),this.fire("internet-search",!t)},n.handleDeepThink=function(){var t=this.data.get("deepThinkChecked");this.useModelAction.toggleDeepThink(),this.fire("deep-think",!t)},n.handleModelFuncDataClick=function(t,e){"deep_think"===t.type?this.handleDeepThink():"internet_search"===t.type?this.handleInternetSearch():this.fire("click",zd({},t,{itemIndex:e}))},n.handleOpenModelList=function(){var t=this;this.data.get("isModelListOpen")||this.cancelTargetClickSign||(this.data.set("isModelListOpen",!0),setTimeout((function(){t.data.set("shouldModelListEnter",!0)}),50))},n.handleSelectModel=function(t,e){var n,a=this;return(n=function(){var n,i;return Vd(this,(function(o){switch(o.label){case 0:return(null==t?void 0:t.checked)||!(null==t?void 0:t.enable)?[2]:(a.data.set("loadingModelId",t.id),n=a.data.get("curModel"),[4,a.useModelAction.handleSelectModel(t)]);case 1:return i=o.sent(),a.data.set("modelFuncData",t.modelFuncData),a.data.set("loadingModelId",""),a.handleCloseModelTip(),a.handleCloseModelList(),i&&a.fire("select-model",{model:t,oldModel:n,curIndex:e}),[2]}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(a,i){var o=n.apply(t,e);function r(t){Wd(o,a,i,r,s,"next",t)}function s(t){Wd(o,a,i,r,s,"throw",t)}r(void 0)}))})()},n.handleCapsuleMouseenter=function(t,e){this.fire("mouseenter",{event:t,data:e})},n.handleCapsuleMouseleave=function(t,e){this.fire("mouseleave",{event:t,data:e})},n.handleUploadSuccess=function(t){this.fire("img-upload-success",t)},n.handleInputFocus=function(t){this.data.set("hideCapsule",t.focus)},n.capsuleBackground=function(t){if(!(null==t?void 0:t.background))return"";var e=null==t?void 0:t.background.split("-")[0];return"background: \n            radial-gradient(96.47% 101.09% at 1.47% 1.52%,"+e+" 0%, "+((null==t?void 0:t.background.split("-")[1])||e)+" 100%);"},n.getDarkURL=function(t){if(!(null==t?void 0:t.icon))return"";var e=window.matchMedia("(prefers-color-scheme: dark)"),n=t.icon;return e.matches?n=t.iconNight||n:ot.isDarkMode&&(n=t.iconDark||n),n},n.iconUrl=function(t){return"background-image: url("+this.getDarkURL(t)+")"},n.modelIconUrl=function(t){return this.getDarkURL(t)},e}(a.Component);function Xd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Yd(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Zd(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Yd(o,a,i,r,s,"next",t)}function s(t){Yd(o,a,i,r,s,"throw",t)}r(void 0)}))}}function tu(){return tu=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},tu.apply(this,Array.from(arguments))}function eu(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Xd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xd(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nu(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Kd.template='\n        <div s-if="{{!hideCapsule}}" class="capsules-box">\n            <slot name="prefix" />\n            <div\n                s-if="{{isShowModelList}}"\n                class="\n                    capsules-model-list\n                    {{ shouldModelListEnter ? \'capsules-model-list-enter\' : \'\'}}\n                "\n            >\n                <div\n                    s-for="item, index in modelList"\n                    class="{{item.enable || item.hasPermission ? \'\' : \'capsules-model-list-item-disabled\'}}"\n                >\n                    <div s-if="{{index !== 0}}" class="cos-divider capsules-model-list-item-divider"></div>\n                    <div\n                        class="capsules-model-list-item"\n                        on-click="handleSelectModel(item, index)"\n                    >\n                        <div class="capsules-model-list-item-text">\n                            <div class="capsules-model-list-item-title">{{item.name}}</div>\n                            <div class="capsules-model-list-item-desc">\n                                {{item.enable || item.hasPermission ? item.desc : (item.failText || modelQuotaTips)}}\n                            </div>\n                        </div>\n                        <cos-icon s-if="item.checked" name="check-circle-fill" class="capsules-model-list-item-icon" />\n                        <span s-if="loadingModelId === item.id" class="capsules-model-list-item-icon-loading"></span>\n                    </div>\n                </div>\n            </div>\n            <cos-swiper class="capsules-container">\n                <cos-swiper-item s-if="{{showModelCapsules}}">\n                    <cos-tooltip\n                        trigger="custom"\n                        open="{{isShowModelTooltip}}"\n                        content="{{modelTip}}"\n                        bubbleClass="capsules-model-tip"\n                    >\n                        <div\n                            class="capsules-item-tag-model cos-font-medium"\n                            on-click="handleOpenModelList"\n                            data-show-ext="{{modelSelectShowLog}}"\n                        >\n                            <img class="capsules-item-tag-model-icon" src="{{curModel.icon}}"/>\n                            <div class="capsules-item-tag-model-title">{{curModel.title}}</div>\n                            <cos-icon\n                                class="\n                                    capsules-item-tag-model-arrow\n                                    {{shouldModelListEnter ? \'\' : \'capsules-item-tag-model-arrow-rotated\'}}\n                                "\n                                name="caret-down"\n                            />\n                        </div>\n                    </cos-tooltip>\n                </cos-swiper-item>\n                <fragment s-if="modelFuncData.length > 0">\n                    <cos-swiper-item\n                        s-for="item, index in modelFuncData"\n                        class="capsules-item"\n                    >\n                        <div\n                            s-if="!item.iconSelected\n                            && (!item.type || (item.type !== \'deep_think\' && item.type !== \'internet_search\'))"\n                            class="{{item.icon ? \'\' : \'capsules-item-text\'}} capsules-item-tag cos-font-medium"\n                            on-click="handleModelFuncDataClick(item, index)"\n                        >\n                            <i\n                                style="{{iconUrl(item)}}"\n                                class="{{item.type === \'link\' ? \'capsules-link-icon\' : \'capsules-model-icon\'}}"\n                            ></i>\n                            {{item.text}}\n                        </div>\n                        <div\n                            s-elif="item.type === \'deep_think\' || item.type === \'internet_search\'"\n                            class="{{item.icon ? \'\' : \'capsules-item-text\'}} cos-font-medium"\n                            on-click="handleModelFuncDataClick(item, index)"\n                            data-show-area\n                            data-show-ext="{{item.type === \'deep_think\' ? deepThinkShowLog : \'\'}}"\n                        >\n                            <div\n                                class="capsules-model-button\n                                    {{ (item.type === \'deep_think\' && deepThinkChecked) || \n                                    (item.type === \'internet_search\' && internetChecked)\n                                    ? \'capsules-model-button-active\' \n                                    : \'capsules-model-button-inactive\' }}"\n                            >\n                                <img\n                                    src="{{ \n                                        (item.type === \'deep_think\' && deepThinkChecked) || \n                                        (item.type === \'internet_search\' && internetChecked) \n                                        ? item.iconSelected \n                                        : modelIconUrl(item)\n                                    }}"\n                                    class="capsules-model-img"\n                                />\n                                {{item.text}}\n                            </div>\n                        </div>\n                        <div s-elif="{{(item.type === \'uploadImage\' || item.type === \'imageUpload\')\n                            && useInnerUploader}}"\n                        >\n                            <cos-image-uploader\n                                max-count="{{item.options && item.options.maxCount || \'1\'}}"\n                                max-compressed-dimension="1000"\n                                on-success="handleUploadSuccess"\n                            >\n                                <div\n                                    on-click="handleCapsuleClick(item, index)"\n                                    class="{{item.icon ? \'\' : \'capsules-item-text\'}} capsules-item-tag cos-font-medium"\n                                >\n                                    <i s-if="item.icon" style="{{iconUrl(item)}}"></i>\n                                    {{ item.text }}\n                                </div>\n                            </cos-image-uploader>\n                        </div>\n                    </cos-swiper-item>\n                </fragment>\n            </cos-swiper>\n        </div>\n    ',Kd.components={"cos-tooltip":e.Tooltip,"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"cos-image-uploader":e.ImageUploader,"cos-icon":e.Icon},Kd.computed={deepThinkShowLog:function(){var t=this.data.get("curModel")||{};return JSON.stringify({type:"show",value:"ds_btn",current_model:t.id,is_open:this.data.get("deepThinkChecked")?1:0})},selectedModelId:function(){var t=this.data.get("modelList"),e="";return t.forEach((function(t){t.checked&&(e=t.id)})),e},isShowModelList:function(){if(this.data.get("isModelInNA"))return!1;var t=this.data.get("modelList"),e=this.data.get("isModelListOpen");return Array.isArray(t)&&0!==t.length&&e},showModelCapsules:function(){return!this.data.get("isModelInNA")&&!!(this.data.get("curModel")||{}).id},curModel:function(){var t=this.data.get("modelList"),e=this.data.get("selectedModelId");return null==t?void 0:t.find((function(t){return t.id===e}))},internetChecked:function(){var t,e=this.data.get("modelList"),n=this.data.get("selectedModelId"),a=null==e?void 0:e.find((function(t){return t.id===n}));return"1"===(null==a||null==(t=a.modelFunction)?void 0:t.internetSearch)},deepThinkChecked:function(){var t,e=this.data.get("modelList"),n=this.data.get("selectedModelId"),a=null==e?void 0:e.find((function(t){return t.id===n}));return"1"===(null==a||null==(t=a.modelFunction)?void 0:t.deepThink)},modelSelectShowLog:function(){var t=this.data.get("selectedModelId");return JSON.stringify({value:"ask_model_btn",current_model:t})}};var au,iu,ou=1048576,ru="/aichat/api/pic_upload",su="upload failed",cu=function(){function t(){this.queryPromiseResolve=null,this.queryPromiseReject=null,this.index=0,this.SparkMD5=null}var e=t.prototype;return e.handleImageUpload=function(t){var e=this;return Zd((function(){var n;return nu(this,(function(a){switch(a.label){case 0:return t&&Array.isArray(t)?"pc"!==rt()?[3,2]:(e.showB64Image(t),[4,e.uploadBase64(t)]):[2];case 1:return n=a.sent(),e.updateImage(n),[3,3];case 2:t[0].src?setTimeout((function(){e.updateImage(t)}),50):e.showB64Image(t),a.label=3;case 3:return[2]}}))}))()},e.updateImage=function(t){var e=this.queryPromiseResolve,n=this.queryPromiseReject;if(e&&n){var a=this.index;if(!t||!Array.isArray(t)||!t.length)return n(),pa().emit({action:"abort",index:a}),this.queryPromiseResolve=null,void(this.queryPromiseReject=null);var i=[],o=[];t.forEach((function(t){var e=t.src,n=t.height,a=t.width,r="success";e||(r="error"),o.push({imageUrl:e,width:a,height:n,status:r}),i.push({type:"IMAGE",data:{image:{image_url:e,width:a,height:n}}})})),pa().emit({query:o,index:a}),e({asyncPromptContent:i}),this.queryPromiseResolve=null,this.queryPromiseReject=null}},e.showB64Image=function(t){var e=this,n=this.index+1,a=[];t.forEach((function(t){var e=t.base64,i=t.height,o=t.width;a.push({type:"IMAGE",data:{image:{image_b64:e,width:o,height:i,status:"loading",index:n}}})})),Je.dispatch("update",{sa:"image"});var i=this.queryPromiseReject;i&&(i(),pa().emit({action:"abort",index:n-1}));var o=new Promise((function(t,n){e.queryPromiseResolve=t,e.queryPromiseReject=n}));Ar({query:a,extParams:{queryPromise:o}},!1,"SSE"),this.index=n},e.uploadBase64=function(t){var e=this;return Zd((function(){var n,a,i,o,r,s;return nu(this,(function(c){switch(c.label){case 0:if(!t||!Array.isArray(t))return[2];n=[],a=!1,i=eu(t),c.label=1;case 1:return(o=i()).done?[3,4]:(r=o.value,[4,e.uploadImage(r.base64)]);case 2:(s=c.sent())&&(a=!0),n.push(tu({},r,{src:s,status:s?"success":"error"})),c.label=3;case 3:return[3,1];case 4:return a?[2,n]:[2,null]}}))}))()},e.getRandomFileName=function(){var t=new Date,e=Math.floor(t.getTime()/1e3),n=1e3*t.getMilliseconds();return((2147483648|1e5*e+Math.floor(n/10)&2147483647)>>>0)+""+(Math.floor(9e4*Math.random())+1e4)},e.uploadImage=function(t){var e=this;return Zd((function(){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m;return nu(this,(function(v){switch(v.label){case 0:return n=e.getRandomFileName(),1!==(a=Math.ceil(t.length/ou))?[3,2]:[4,e.uploadPicToBos(t)];case 1:return[2,v.sent()];case 2:for(i=[],o=0;o<a;o++)r=o*ou,s=Math.min((o+1)*ou,t.length),c=t.slice(r,s),i.push(e.uploadSingleSlice(c,n,o));d=new Promise((function(t){l=setTimeout((function(){t(!1)}),3e4)})),v.label=3;case 3:return v.trys.push([3,7,,8]),u=Promise.all(i),[4,Promise.race([u,d])];case 4:return v.sent()||console.error("upload timeout"),clearTimeout(l),p=Date.now(),(h=new URLSearchParams).append("filename",n),h.append("isfin","1"),h.append("ischunk","1"),h.append("scene","pic_edit"),h.append("timestamp",p.toString()),f=h.append,g=["token"],[4,e.getToken(t,p)];case 5:return f.apply(h,g.concat([v.sent()])),[4,fetch(ru,{method:"POST",body:h}).then((function(t){return t.json()})).then((function(t){var e;if(!(null==t||null==(e=t.data)?void 0:e.url))throw new Error(su);if(0===t.status)return t.data.url;throw new Error(su)}))];case 6:return[2,v.sent()];case 7:return m=v.sent(),console.error(m),[3,8];case 8:return[2]}}))}))()},e.uploadSingleSlice=function(t,e,n){return Zd((function(){var a,i,o;return nu(this,(function(r){switch(r.label){case 0:(a=new URLSearchParams).append("picInfo",t),a.append("filename",e),a.append("chunknum",n.toString()),a.append("ischunk","1"),a.append("scene","pic_edit"),a.append("isfin","0"),a.append("timestamp",Date.now().toString()),i=3,o=0,r.label=1;case 1:if(!(o<i+1))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,fetch(ru,{method:"POST",body:a}).then((function(t){return t.json()}))];case 3:return 0===r.sent().status?[2,!0]:[3,5];case 4:return r.sent(),[3,5];case 5:return++o,[3,1];case 6:throw new Error(su)}}))}))()},e.uploadPicToBos=function(t){var e=this;return Zd((function(){var n,a,i,o,r,s;return nu(this,(function(c){switch(c.label){case 0:n=!1,a=setTimeout((function(){n=!0}),3e4),c.label=1;case 1:return c.trys.push([1,4,,5]),i=new URLSearchParams,o=Date.now(),r=i.append,s=["token"],[4,e.getToken(t,o)];case 2:return r.apply(i,s.concat([c.sent()])),i.append("scene","pic_edit"),i.append("picInfo",t),i.append("timestamp",o.toString()),i.append("ischunk","0"),[4,fetch(ru,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()}).then((function(t){return t.json()})).then((function(t){return n?"":(clearTimeout(a),0===t.status?t.data.url:"")})).catch((function(){return""}))];case 3:return[2,c.sent()];case 4:return c.sent(),n?[2,""]:(clearTimeout(a),[2,""]);case 5:return[2]}}))}))()},e.getToken=function(t,e){var n=this;return Zd((function(){var a,i;return nu(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),n.SparkMD5?[3,2]:[4,Promise.resolve().then((function(){return Yu}))];case 1:n.SparkMD5=o.sent(),o.label=2;case 2:return a=n.SparkMD5.hash(t),[2,n.SparkMD5.hash(a+"pic_edit"+e.toString()).slice(0,5)];case 3:return i=o.sent(),console.error(i),[2,""];case 4:return[2]}}))}))()},t}(),lu=new cu;function du(){return du=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},du.apply(this,Array.from(arguments))}!function(t){t.H5="h5",t.CONVERSATION="conversation",t.UPLOAD_IMAGE="uploadImage",t.IMAGE_UPLOAD="imageUpload",t.Drawer="drawer",t.link="link",t.AGENT="agent",t.PANEL="panel",t.CAMERA="camera",t.CAMERA_QUESTION="cameraQuestion"}(au||(au={}));var uu=((iu={}).camera="CAMERA",iu.cameraQuestion="QUESTION",iu),pu=St.connect(Je,{modelList:"modelList",usedModel:"usedModel"})(a.defineComponent({capsuleElement:null,components:{"cos-capsules":Kd},listenInputStart:null,listenInputCancel:null,listenUpdateCapsule:null,attached:function(){var t=this;this.nextTick((function(){t.capsuleElement=t.el;var e=t.data.get("showHelloIndex");"number"==typeof e&&t.handleCapsuleClick(Object.assign(t.data.get("capsuleData["+e+"]"),{itemIndex:e}))})),this.setBottomPadding(!0),this.handleCapsuleClick=_n(this.handleCapsuleClick,300,{trailing:!1,leading:!0}),document.addEventListener("visibilitychange",(function(){document.hidden||t.data.set("capsuleData",t.data.get("capsuleData"))})),this.listenInputStart=function(){t.capsuleElement&&(t.capsuleElement.style.visibility="hidden",t.setBottomPadding(!1))},Va().on(this.listenInputStart),this.listenInputCancel=function(){t.capsuleElement&&(t.capsuleElement.style.visibility="visible",t.setBottomPadding(!0))};var e=1;Ka().on((function(){t.listenInputStart&&t.listenInputCancel&&(1!==e?t.listenInputStart():t.listenInputCancel())})),this.listenUpdateCapsule=function(n){var a;1===(null==n||null==(a=n.params)?void 0:a.display)?(e=1,t.listenInputCancel()):(e=0,t.listenInputStart())},ni().on(this.listenUpdateCapsule),ut()&&Fi(Ui(),"13.79")>=0&&(ei().emit({hide:1}),this.data.set("showTopBorder",!0));var n=Je.getState("searchBoxPanel"),a=this.data.get("capsuleData");n&&(a&&a.length?this.invokeDefaultCapsule(a,n):this.watch("capsuleData",(function(e){e&&e.length&&t.invokeDefaultCapsule(e,n)})))},invokeDefaultCapsule:function(t,e){var n=this,a=t.find((function(t){var n="";return e===Zt.WRITE?n="AI写作":e===Zt.PAINT&&(n="AI画图"),"panel"===t.type&&t.text===n}));this.nextTick((function(){a&&n.handleCapsuleClick(a),Je.dispatch("update",{searchBoxPanel:""})}))},disposed:function(){this.listenInputStart&&(Va().off(this.listenInputStart),this.listenInputStart=null),this.listenInputCancel&&(Ka().off(this.listenInputCancel),this.listenInputCancel=null),this.listenUpdateCapsule&&(ni().off(this.listenUpdateCapsule),this.listenUpdateCapsule=null)},detached:function(){this.setBottomPadding(!1)},sendCapsulesLog:function(t,e,n){var a,i,o=this.data.get("tplInfo"),r=o.lid,s=o.tplname,c=o.srcid;Aa({ubcId:"17132",page:"resultpage",type:"click"===t?t:"show",value:"capsule_bub",ext:{agent_id:null==(a=Je.getState("agentInfo"))?void 0:a.agentSearchId,agent_name:null==(i=Je.getState("agentInfo"))?void 0:i.agentName,capsule_content:"click"===t?e:this.data.get("capsuleData").map((function(t){return t.text})),action_type:"click"===t?n:this.data.get("capsuleData").map((function(t){return t.type})),lid:r,tplname:s,srcid:c,ori_lid:Je.getState("oriLid"),re_rank:Je.getState("rank"),valueInfo:[{component_name:"shortcuts"}],is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType")}})},initData:function(){return{label:"",capsuleData:[],tplInfo:{},baseData:{},queryPromise:null,showHelloIndex:"",showTopBorder:!1,imageNotInInput:!1,modelFuncData:[]}},computed:{enterType:function(){return"pc"===rt()?Je.getState("pcEnterType")||"ai_tab_url":Je.getState("enterType")},isQuery:function(){return Je.getState("isShowHello")&&0===Je.getState("rank")?"0":"1"},logExtParams:function(){var t,e;return{agent_id:null==(t=Je.getState("agentInfo"))?void 0:t.agentSearchId,agent_name:null==(e=Je.getState("agentInfo"))?void 0:e.agentName,is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType")}}},handleCapsuleClick:function(t){var e=t.type,n=t.text,a=t.agentId,i=t.agentParams,o=void 0===i?{}:i,r=t.options,s=t.itemIndex,c=r||t,l=c.sendText,d=c.url,u=void 0===d?"":d,p=c.title,h=void 0===p?"":p,f=c.link,g=void 0===f?"":f,m=c.percent,v=c.isDeepSeek,y=void 0===v?"":v,b="agent"!==e?n:[{agent_id:a,agent_name:n,agent_pos:s+""}];switch(this.sendCapsulesLog("click",b,e),this.fire("click"),e){case"conversation":a&&Je.dispatch("update",{agentInfo:{agentSearchId:a,agentParams:du({actionLid:this.data.get("baseData").lid},o)}}),Ar({query:l||n});break;case"h5":Nd(u);break;case"link":var w=g;"1"===y&&(st()&&tn.sendCount({group:"deepseek_btn_click",info:{show:1}}),w=this.deepSeekUrlProcess(g)),Nd(w);break;case"drawer":u&&this.dispatch("open-half-screen",{url:u,title:h,halfScreenPercent:m,board_from:"capsule"});break;case"uploadImage":break;case"agent":var _=du({actionType:"launchConversation",agentId:a,agentSearchId:a,agentName:n,logo:t.icon,startIndex:0,endIndex:n.length},o),k=Je.getState("agentQuery")||Je.getState("query");k||0!==Je.getState("rank")||(Gn().emit(),Or({type:"agentGreeting",data:{sa:"capsule_agent_"+(s+1),agentInfo:_}})),es(_,"capsule_agent_"+(s+1)),as(_,k||"");break;case"panel":var S=t.options,x="";"AI写作"===t.text?x=Zt.WRITE:"AI画图"===t.text&&(x=Zt.PAINT),S.callback={panelId:"",type:x};for(var I=0;I<S.items.length;I++)for(var T=0;T<S.items[I].data.length;T++){var C=S.items[I].data[T];C.callback={id:T,isSelect:C.isSelect,name:C.name}}On().conversation.openExtendPanel.emit(S);break;case"camera":case"cameraQuestion":ea().emit({type:uu[t.type]})}},handleUploadSuccess:function(t){t&&Array.isArray(t)&&(t.some((function(t){return t.hasOwnProperty("dataType")}))?lu.handleImageUpload(t):this.handleSingalUploadSuccess(t))},handleSingalUploadSuccess:function(t){var e=t[0],n=e.base64,a=e.src,i=e.height,o=e.width;Je.dispatch("update",{sa:"image"}),Ar({query:[{type:"IMAGE",data:{image:{image_b64:n,image_url:a,width:o,height:i}}}]},!1,"SSE")},setBottomPadding:function(t){void 0===t&&(t=!0);var e="pc"===rt()?document.querySelector("[class*='chat-container-main-stream']"):document.querySelector("[class*='index_scroll-content']"),n=getComputedStyle(e),a="pc"===rt()?31:dt()?48:42,i=t?a:-1*a;e.style.paddingBottom=parseFloat(n.paddingBottom)+i+"px"},deepSeekUrlProcess:function(t){var e=Mt.parse(t),n=yt(Je.getState("query")),a=Je.getState("curRankInfo.rank"),i=qt(decodeURIComponent(e.query.url),n&&a>0?{word:n,enterType:"deepseek_capsule"}:{word:"百度AI助手",isShowHello:1,enterType:"deepseek_capsule"});return o.canIUse("search.open")&&(i=qt(""+e.protocol+e.pathname,du({},e.query,{url:i}))),i},handleModelListShow:function(){var t=Je.getState("usedModel");Aa({type:"click",value:"ask_model_btn",ext:{current_model:t.modelName}}),Aa({type:"show",value:"model_pop",ext:{current_model:t.modelName}})},handleModelSelect:function(t){var e=t.model,n=t.oldModel;Aa({type:"click",value:"model_pop",ext:{goal_model:e.id,current_model:n.id}}),On().conversation.checkoutAiModel.emit({selectedId:e.id,fullFeature:e.fullFeature})},handleInternetSearch:function(t){Aa({type:"click",value:"online_btn",ext:{is_open:t?"1":"0",enter_type:Je.getState("enterType"),a_lid:Je.getState("apagelid")}})},handleDeepThink:function(t){Aa({type:"click",value:"ds_btn",ext:{is_open:t?"1":"0",enter_type:Je.getState("enterType"),a_lid:Je.getState("apagelid"),current_model:this.data.get("usedModel").modelName}})},handleModelTooltipShow:function(){Aa({type:"show",value:"new_func_guide"})}})),hu={};hu=Object.assign(hu,{capsulesWrapper:"capsules-wrapper_m01b5_1","capsules-wrapper":"capsules-wrapper_m01b5_1",capsulesLabel:"capsules-label_m01b5_22","capsules-label":"capsules-label_m01b5_22",capsulesWrapperBorder:"capsules-wrapper-border_m01b5_32","capsules-wrapper-border":"capsules-wrapper-border_m01b5_32",capsulesWrapperLabel:"capsules-wrapper-label_m01b5_35","capsules-wrapper-label":"capsules-wrapper-label_m01b5_35",capsulesItemTagModelWrapper:"capsules-item-tag-model-wrapper_m01b5_73","capsules-item-tag-model-wrapper":"capsules-item-tag-model-wrapper_m01b5_73"}),pu.template='\n    <cos-capsules\n        s-ref="capsules"\n        class="\n            {{$style[\'capsules-wrapper\']}}\n            {{label ? $style[\'capsules-wrapper-label\'] : \'\'}}\n            {{showTopBorder ? $style[\'capsules-wrapper-border\'] : \'\'}}\n            cs-capsules\n        "\n        capsuleData="{{capsuleData}}"\n        modelFuncData="{{modelFuncData}}"\n        modelList="{{modelList}}"\n        log-ext-params="{{logExtParams}}"\n        attr-data-show-area\n        on-rendered="sendCapsulesLog"\n        on-click="handleCapsuleClick"\n        on-select-model="handleModelSelect"\n        on-model-list-show="handleModelListShow"\n        on-internet-search="handleInternetSearch"\n        on-deep-think="handleDeepThink"\n        on-img-upload-success="handleUploadSuccess"\n        on-model-tooltip-show="handleModelTooltipShow"\n    >\n        <span\n            s-if="label" slot="prefix"\n            class="{{$style[\'capsules-label\']}}"\n        >{{ label }}</span>\n    </cos-capsules>\n';var fu="function"==typeof pu?pu.prototype.initData||gu:pu.initData||gu;function gu(){return{$style:hu}}function mu(){return Object.assign({},fu.call(this),{$style:hu})}function vu(t,e){return vu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vu(t,e)}"function"==typeof pu?pu.prototype.initData=mu:pu.initData=mu;var yu=function(t){function e(){return t.apply(this,Array.from(arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vu(t,e)}(e,t),e}(a.Component),bu={};bu=Object.assign(bu,{}),yu.template="\n\n\t<div></div>\n";var wu="function"==typeof yu?yu.prototype.initData||_u:yu.initData||_u;function _u(){return{$style:bu}}function ku(){return Object.assign({},wu.call(this),{$style:bu})}function Su(t,e){return Su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Su(t,e)}"function"==typeof yu?yu.prototype.initData=ku:yu.initData=ku;var xu=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Su(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{multiRecommendWord:{}}},n.attached=function(){this.onRecommendWordClick=_n(this.handleRecommendWordClick.bind(this),1e3,{leading:!0,trailing:!1})},n.singleShowLog=function(t,e,n){return JSON.stringify({type:"show",value:"new_guide_single",valueInfo:{component_name:"multiRecommendWord",component_content:[t.text]},pos:String(5*e+n+1),enter_type:Je.getState("enterType")})},n.handleRecommendWordClick=function(t,e,n){Aa({type:"click",value:"new_guide",ext:{valueInfo:[{component_name:"multiRecommendWord",component_content:[t.text]}],pos:String(5*e+n+1),enter_type:Je.getState("enterType")}}),Ar({query:t.text,extParams:{sa:"new_guide"}})},e}(a.Component);function Iu(t,e){return Iu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Iu(t,e)}xu.template='\n        <div class="cs-multi-recommend-word">\n            <div\n                s-if="titleText"\n                class="cs-multi-recommend-word-title cos-font-medium"\n            >\n                <span>{{titleEmoji}}</span>\n                <span class="cs-multi-recommend-word-title-text">{{titleText}}</span>\n            </div>\n            <div\n                s-if="desc"\n                class="cs-multi-recommend-word-desc"\n            >\n                {{desc}}\n            </div>\n            <div\n                class="cs-multi-recommend-word-list-wrapper"\n                data-show-ext="{{realShowData}}"\n            >\n                <div class="cs-multi-recommend-word-list-scroll">\n                    <div\n                        s-for="list, listIndex in recommendList"\n                        class="cs-multi-recommend-word-list"\n                    >\n                        <div\n                            s-for="recommendItem, index in list"\n                            class="cs-multi-recommend-word-list-item"\n                            on-click="onRecommendWordClick(recommendItem, listIndex, index)"\n                        >\n                            <div\n                                data-show-ext="{{singleShowLog(recommendItem, listIndex, index)}}"\n                                data-show-area\n                                class="cs-multi-recommend-word-list-text cos-font-medium"\n                            >\n                                {{recommendItem.content}}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',xu.computed={titleEmoji:function(){var t;return(null==(t=this.data.get("multiRecommendWord"))?void 0:t.guideTitleEmoji)||""},titleText:function(){var t;return(null==(t=this.data.get("multiRecommendWord"))?void 0:t.guideTitleText)||""},desc:function(){var t;return(null==(t=this.data.get("multiRecommendWord"))?void 0:t.guideWord)||""},recommendList:function(){var t,e=(null==(t=this.data.get("multiRecommendWord"))?void 0:t.recommendWord)||[],n=[];return e.forEach((function(t,e){e%1==0&&n.push([]),t.content=(t.emoji?t.emoji+" ":"")+t.text,n[n.length-1].push(t)})),n.slice(0,3)},realShowData:function(){var t,e=((null==(t=this.data.get("multiRecommendWord"))?void 0:t.recommendWord)||[]).map((function(t){return t.text}));return JSON.stringify({value:"new_guide",valueInfo:{component_name:"multiRecommendWord",component_content:e},enter_type:Je.getState("enterType")})}};var Tu=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).onRecommendWordClick=_n((function(t,e,n){Aa({type:"click",value:"recom_content",ext:{valueInfo:[{title:e.classify,content:e.text,pos:String(n+1)}],sa:Je.getState("oriSa"),a_lid:Je.getState("apagelid")}}),Ar({query:e.text,extParams:{sa:""}})}),1e3,{leading:!0,trailing:!1}),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Iu(t,e)}(e,t),e.prototype.initData=function(){return{value:[]}},e}(a.Component);function Cu(t,e){return Cu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Cu(t,e)}Tu.template='\n        <div\n            class="cs-prompt-recommend"\n            data-show-ext="{{showLogExtData}}"\n        >\n            <div\n                class="cos-text-headline cs-prompt-recommend-title"\n            >\n                Hi，欢迎回来，一起探索吧！\n            </div>\n            <div\n                class="cs-prompt-recommend-wrapper cos-row cos-row-col-12 cos-flex-wrap cos-gutter"\n            >\n                <div\n                    s-for="item, index in value"\n                    class="cos-col-4 cos-space-mt-xxs cos-space-mb-xxs"\n                >\n                    <div\n                        class="cs-prompt-recommend-box"\n                        on-click="onRecommendWordClick($event, item, index)"\n                    >\n                        <div class="cs-prompt-recommend-box-title">\n                            <div class="cs-prompt-recommend-box-icon">{{item.icon}}</div>\n                            <div class="cs-prompt-recommend-box-classify cos-line-clamp-1">\n                                {{item.classify}}\n                            </div>\n                        </div>\n                        <div class="cs-prompt-recommend-box-text cos-line-clamp-1 cos-font-medium">\n                            {{item.text}}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',Tu.computed={showLogExtData:function(){var t=this.data.get("value");return JSON.stringify({value:"recom_content",valueInfo:t.map((function(t,e){return{title:t.classify,content:t.text,pos:String(e+1)}})),sa:Je.getState("oriSa")})}};var Lu=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).unitDistance=49,e.lastTime=0,e.movedDistance=0,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cu(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{scrollSpeed:15}},n.attached=function(){this.swiperSlides=this.ref("swiperSlides"),this.startPlay()},n.handleScroll=function(t){var e=t.target;if(e){var n=e.scrollTop,a=e.scrollHeight;n+e.clientHeight>=a&&(e.scrollTop=0)}},n.startPlay=function(){var t=this;if(!this.autoplayTimer){this.lastTime=0;var e=function(n){if(!t.lastTime)return t.lastTime=n,void(t.autoplayTimer=requestAnimationFrame(e));var a=(n-t.lastTime)/1e3*t.data.get("scrollSpeed");t.movedDistance-=a,t.swiperSlides.style.transform="translate(0, "+t.movedDistance+"px)",t.lastTime=n,t.movedDistance<-t.unitDistance&&t.moveChildToLast(),t.autoplayTimer=requestAnimationFrame(e)};this.autoplayTimer=requestAnimationFrame(e)}},n.stopPlay=function(){this.autoplayTimer&&(cancelAnimationFrame(this.autoplayTimer),this.autoplayTimer=null)},n.moveChildToLast=function(){var t=this.swiperSlides.children[0];this.swiperSlides.appendChild(t),this.movedDistance=0,this.swiperSlides.style.transform="translate(0, 0)"},n.destroyed=function(){this.stopPlay()},e}(a.Component);function Pu(){return Pu=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pu.apply(this,Array.from(arguments))}function Du(t,e){return Du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Du(t,e)}Lu.trimWhitespace="all",Lu.template='\n        <div \n          class="swiper-wrapper"\n          on-scroll="handleScroll"\n          on-mouseenter="stopPlay"\n          on-mouseleave="startPlay"\n        >\n            <div\n                class="swiper-slide"\n            >\n                <div\n                    s-ref="swiperSlides"\n                    class="swiper-slide-frame"\n                >\n                    <slot></slot>\n                </div>\n            </div>\n        </div>\n    ';var Au=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Du(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{funcArea:{},isWindows:ot.isWindows,isExtension:ft(),clsMap:{aiRead:"ai-read",photoEditing:"photo-editing",officeCreate:"office-create"}}},n.handleFuncTitle=function(t,e){var n;t.stopPropagation(),"featureShowcase"!==e&&("agent_rec"===(e=null==e||null==(n=e.replace(/([a-z])([A-Z])/g,"$1_$2"))?void 0:n.toLowerCase())?Sa().emit(!0):ba().emit({type:e,triggerType:"guide"}),this.funcTitleLog())},n.funcTitleLog=function(){Aa({page:"resultpage",type:"click",value:"guide_function_blank",ext:{enter_type:Je.getState("pcEnterType"),setype:"csaitab"}})},n.handleFuncButton=function(t,e,n){var a,i,o,r=e.function,s={},c="",l=(null==r||null==(a=r.data)?void 0:a.input)||{},d=null==l?void 0:l.interactionType;switch((null==l?void 0:l.agentInfo)&&Object.keys(null==l?void 0:l.agentInfo).length&&(s=Pu({startIndex:0,endIndex:r.data.input.agentInfo.agentName.length},l.agentInfo)),t){case"officeCreate":c="funcguide_office_"+(n+1);break;case"photoEditing":c="funcguide_pic_"+(n+1);break;case"aiRead":c="funcguide_read_"+(n+1);break;case"agentRec":c="funcguide_agent_"+(n+1);break;case"featureShowcase":c="funcguide_hintask_"+(n+1)}if(xa().emit({sa:c,isAgent:"agentRec"===t}),"ask"===r.type){var u=r.data.ask,p=u.usedModel,h=Je.getState("usedModel"),f=new $i(Je);return null==f||f.handleChangeUsedModelStatus(null==h?void 0:h.modelName,p),void Ar({query:u.query,extParams:{sa:c}})}if(jn().emit(Pu({agentInfo:s,inputCustom:null==l?void 0:l.inputCustom},d?{interactionType:d}:{})),"aiRead"===t&&"upload"===r.type){var g="上传文档"===(null==e?void 0:e.text)?"file":"image";_a().emit(g)}"link"===r.type&&window.open(null==(o=r.data)||null==(i=o.link)?void 0:i.url)},n.getFuncButtonLog=function(t,e,n){var a,i,o,r,s,c,l,d,u,p,h="",f="";switch(t){case"officeCreate":h="text",f="text";break;case"photoEditing":var g;h="pic",f="link"===(null==e||null==(g=e.function)?void 0:g.type)?"click":"text";break;case"aiRead":var m;h="read",f="input"===(null==e||null==(m=e.function)?void 0:m.type)?"text":"upload";break;case"agentRec":h="agent",f="";break;case"featureShowcase":h="hintask",f="ask"}return{valueItem:{function_name:e.buttonId||"",function_pos:""+(n+1),function_click_type:f,agent_id:(null==e||null==(a=e.agentInfo)?void 0:a.agentId)||(null==e||null==(s=e.function)||null==(r=s.data)||null==(o=r.input)||null==(i=o.agentInfo)?void 0:i.agentId)||"",agent_name:(null==e||null==(c=e.agentInfo)?void 0:c.agentName)||(null==e||null==(p=e.function)||null==(u=p.data)||null==(d=u.input)||null==(l=d.agentInfo)?void 0:l.agentName)||""},function_type:h}},n.funcButtonShowLog=function(t,e){var n,a=this,i=[],o="";return null==e||null==(n=e.list)||n.forEach((function(e,n){var r=a.getFuncButtonLog(t,e,n),s=r.valueItem,c=r.function_type;i.push(s),o=c||""})),JSON.stringify({page:"resultpage",type:"show",value:"guide_function",enter_type:Je.getState("pcEnterType"),setype:"csaitab",function_type:o,valueInfo:i})},n.funcButtonLog=function(t,e,n,a){var i=this.getFuncButtonLog(t,e,n),o=i.valueItem,r=i.function_type;return JSON.stringify({page:"resultpage",type:a,value:"guide_function",ubcExt:{enter_type:Je.getState("pcEnterType"),setype:"csaitab",function_type:r,valueInfo:[o]}})},e}(a.Component);function Eu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Ou(){return Ou=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ou.apply(this,Array.from(arguments))}function Ru(t,e){return Ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ru(t,e)}function Nu(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Eu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eu(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Au.trimWhitespace="all",Au.components={"cos-icon":e.Icon,"cos-avatar":e.Avatar,"circular-swiper":Lu},Au.template='\n        <div data-show-area class="chat-home-page">\n            \x3c!--bca-disable-next-line--\x3e\n            <div class="welcome-text">{{welcomeTextWithEmoji | raw}}</div>\n            <div class="plugin-func">\n                <div\n                    s-if="{{isExtension}}"\n                    class="plugin-func-wrap {{\'func-\' + clsMap[func[0]]}}"\n                    s-for="func, index in funcAreaEntries"\n                >\n                    <div class="plugin-func-title">\n                        <span>{{func[1].title[0].data.text.value || func[1].title}}</span>\n                    </div>\n                    <div class="plugin-func-content" data-show-ext="{{funcButtonShowLog(func[0],func[1])}}">\n                        <div\n                            class="plugin-func-item-area"\n                            s-for="item,index in func[1].list"\n                            on-click="handleFuncButton(func[0], item, index)"\n                            need-click-log\n                            data-click-log="{{funcButtonLog(func[0], item, index, \'click\')}}"\n                        >\n                            <img s-if="{{item.icon || item.avatar}}" src="{{item.icon || item.avatar}}"/>\n                            <div class="cos-line-clamp-1">{{item.text}}</div>\n                        </div>\n                    </div>\n                </div>\n                <div\n                    s-else\n                    class="cos-row cos-flex-wrap cos-row-col-12 cos-gutter chat-function-box"\n                    style="--cos-grid-gutter: 12px"\n                >\n                    <div class="cos-col-6 func-area-entry" s-for="func, index in funcAreaEntries">\n                        <div class="function-box">\n                            \x3c!-- 功能标题 --\x3e\n                            <div\n                                class="\n                                    function-title\n                                    {{func[1].titleClickable ? \'hover-func-title\' : \'\'}}\n                                "\n                                style="font-size: {{isWindows ? \'15px\' : \'\'}}"\n                                on-click="handleFuncTitle($event, func[0])"\n                            >\n                                <span>{{func[1].title[0].data.text.value || func[1].title}}</span>\n                                <cos-icon\n                                    s-if="{{func[1].titleClickable}}"\n                                    class="right-icon"\n                                    name="right"\n                                />\n                            </div>\n                            \x3c!-- 功能内容 --\x3e\n                            \x3c!-- 轮播布局 --\x3e\n                            <div\n                                s-if="{{func[0] === \'featureShowcase\'}}"\n                                data-show-ext="{{funcButtonShowLog(func[0],func[1])}}"\n                                class="function-swiper-content"\n                            >\n                                <circular-swiper>\n                                    <div\n                                        s-for="item, index in func[1].list"\n                                        class="item"\n                                        need-click-log\n                                        data-click-log="{{funcButtonLog(func[0], item, index, \'click\')}}"\n                                        on-click="handleFuncButton(func[0], item, index)"\n                                    >\n                                        <span\n                                            class="item-tag"\n                                        >\n                                            {{item.tag}}\n                                        </span>\n                                        <span class="item-content">{{item.text}}</span>\n                                    </div>\n                                </circular-swiper>\n                            </div>\n                            \x3c!-- 功能按钮布局 --\x3e\n                            <div\n                                s-else\n                                class="cos-row cos-flex-wrap cos-row-col-12 cos-gutter cos-justify-between\n                                function-content\n                                {{func[0] === \'agentRec\' || func[0] === \'aiRead\' ? \'function-column-box\' : \'\'}}"\n                                style="--cos-grid-gutter: 9px"\n                                data-show-ext="{{funcButtonShowLog(func[0],func[1])}}"\n                            >\n                                <div class="cos-col-4"\n                                    s-for="item,index in func[1].list"\n                                    on-click="handleFuncButton(func[0], item, index)"\n                                    need-click-log\n                                    data-click-log="{{funcButtonLog(func[0], item, index, \'click\')}}"\n                                >\n                                    <div class="function-item-area {{func[0] === \'aiRead\' ? \'airead-item-area\' : \'\'}}">\n                                        <img s-if="{{item.icon && func[0] === \'aiRead\'}}" src="{{item.icon}}"\n                                            class="file-icon"\n                                            style="margin-bottom: var(--cos-space-xs, 9px)"\n                                        />\n                                        <cos-avatar\n                                            s-if="{{item.agentInfo.logo}}"\n                                            src="{{item.agentInfo.logo}}"\n                                            size="sm"\n                                            class="agent-icon"\n                                            style="margin-bottom: var(--cos-space-xs, 9px)"\n                                        />\n                                        <div\n                                            class="cos-line-clamp-1\n                                                {{item.function.type === \'link\' ? \'hover-link-text\' : \'\'}}"\n                                        >\n                                            {{item.text || item.agentInfo.agentName}}\n                                        </div>\n                                        <cos-icon\n                                            s-if="{{item.function.type === \'link\'}}"\n                                            name="arrow-right" class="hover-arrow"\n                                        />\n                                        <div s-if="{{(item.desc || item.agentInfo.count)}}"\n                                            class="item-desc cos-line-clamp-1"\n                                            style="height: {{func[0] === \'aiRead\' ? \'13px\' : \'\'}}"\n                                        >\n                                            {{item.desc || (item.agentInfo.count)}}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',Au.computed={funcAreaEntries:function(){var t,e=this.data.get("funcArea");if(!e||"object"!=(void 0===e?"undefined":(t=e)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t))return e||[];var n=Object.keys(e).map((function(t){return[t,Pu({titleClickable:"featureShowcase"!==t},e[t])]}));return this.data.get("isExtension")&&(n[3]&&"agentRec"===n[3][1].title&&n.splice(3,1),n.forEach((function(t,e){"agentRec"===t[0]&&n.splice(e,1),t[1]&&t[1].list&&t[1].list.length>3&&t[1].list.splice(3)}))),n},welcomeTextWithEmoji:function(){var t,e,n;return((null==(n=this.data.get("welcome")[0])||null==(e=n.data)||null==(t=e.text)?void 0:t.value)||this.data.get("welcome").text).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]|[\u2600-\u26FF]/g,'<span class="emoji">$&</span>')}};var qu=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).listenShowGuide=null,e.listenHandleNewConversation=null,e.listenCapsuleShow=null,e.listenShowGuideBlankBox=null,e.listenDeleAgent=null,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ru(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{isDeepSeekPage:ct(),guideWord:"",agentList:[],showHelloIndex:"",recommendData:{},helloTipComponent:{},hitGuideRerverse:!1,hitGuideDown:!1,triggerType:Yt.CONVERSATION,isPc:"pc"===rt(),chatSearchAiTabInfo:{isChatSearchAiTabExperiment:!0,isAiTab:!0},showAskEntrance:!vt(Je.getState("query"))||"pc"!==rt()&&Je.getState("isShowHello"),hideTopAgentList:Je.getState("hideTopAgentList"),showInAnswerAsk:!1,waitData:!1,id:"",rank:Je.getState("rank"),oriLid:Je.getState("oriLid"),showShortcut:!0,shortcutsData:{},recFunctionalList:[],multiRecommendWord:{},promptRecommend:null,homeRec:{},blankHeight:0,isShowBlankBox:!0}},n.created=function(){},n.attached=function(){this.data.get("waitData")?this.waitForData():this.handleData()},n.waitForData=function(){var t=this;this.listenShowGuide=function(e){for(var n,a=Nu(Object.keys(e));!(n=a()).done;){var i=n.value;t.data.set(i,e[i])}t.data.set("waitData",!1),t.handleData()},fa().on(this.listenShowGuide,{when:function(e){var n=t.data.get("id");return e.id===n}})},n.handleData=function(){var t,e,n=this,a=this.data.get("agentList"),i=this.data.get("isPc"),o=this.data.get("homeRec");if(i){var r=a.map((function(t){return Ou({},t,{span:6.5})}));this.data.set("agentList",r||[])}var s=a.map((function(t,e){return{agent_id:t.agentSearchId,agent_name:t.agentName,agent_pos:e+1}}));((null==(t=this.data.get("recFunctionalList"))?void 0:t.length)&&this.data.get("guideWord")||(null==(e=this.data.get("multiRecommendWord"))?void 0:e.recommendWord))&&Je.dispatch("update",{query:""}),this.listenInit(),a.length&&Aa({rank:String(+Je.getState("rank")),type:"show",value:"agent_greet",page:"resultpage",ext:{agent_content:s,greet_info:this.data.get("guideWord"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),a_lid:Je.getState("apagelid"),is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType"),component_area:this.data.get("showInAnswerAsk")?"weather":""}}),this.handleClickAgent=_n(this.handleClickAgent,1e3,{leading:!0,trailing:!1}),this.handlerecFunctionalListClick=_n(this.handlerecFunctionalListClick,300,{leading:!0,trailing:!1});var c=this.data.get("shortcutsData"),l=null==c?void 0:c.showHelloIndex;if(l>-1){var d=a[l]||(null==c?void 0:c.capsuleData[l].agentParams);d&&(this.data.set("isShowBlankBox",!1),this.handleClickAgent(d,l))}this.listenHandleNewConversation=function(){return n.handleNewConversation()},Hn().on(this.listenHandleNewConversation),Fn().on(this.listenHandleNewConversation),Qn().on(this.listenHandleNewConversation),i&&Object.keys(o).length>0&&this.handleScrollToTop()},n.listenInit=function(){var t=this;this.listenCapsuleShow=function(e){if(t.data.get("isPermanentlyCapsules")){var n=e.data;if(n){var a={label:null==n?void 0:n.label,capsuleData:(null==n?void 0:n.value)||(null==n?void 0:n.items)};t.data.set("shortcutsData",a)}}else t.data.set("showShortcut",!1)},ua().on(this.listenCapsuleShow),this.listenShowGuideBlankBox=function(){t.data.set("isShowBlankBox",!1)},ka().on(this.listenShowGuideBlankBox),this.listenDeleAgent=function(t){var e,n,a=Je.getState("agentInfo")||{},i=((null==(e=t.params)?void 0:e.agentInfo)||{}).agentSearchId||(null==(n=t.params)?void 0:n.agentSearchId)||"";a.agentSearchId===i&&Je.dispatch("update",{agentInfo:{}})},Xa().on(this.listenDeleAgent)},n.disposed=function(){this.listenShowGuide&&(fa().off(this.listenShowGuide),this.listenShowGuide=null),this.listenHandleNewConversation&&(Hn().off(this.listenHandleNewConversation),Fn().off(this.listenHandleNewConversation),Qn().off(this.listenHandleNewConversation),this.listenHandleNewConversation=null),this.listenCapsuleShow&&(ua().off(this.listenCapsuleShow),this.listenCapsuleShow=null),this.listenShowGuideBlankBox&&(ka().off(this.listenShowGuideBlankBox),this.listenShowGuideBlankBox=null),this.listenDeleAgent&&(Xa().off(this.listenDeleAgent),this.listenDeleAgent=null)},n.handleNewConversation=function(){this.data.set("showAskEntrance",!1)},n.handleScroll=function(t){var e=this.data.get("isPc"),n=t.type||"";e&&"more"===n&&Aa({type:"click",value:"agent_greet_more",page:"resultpage",ext:{ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),a_lid:Je.getState("apagelid"),setype:"csaitab",is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType")}})},n.agentLog=function(t,e){return JSON.stringify({value:"agent_greet_real",agent_id:t.agentSearchId,agent_name:t.agentName,agent_pos:String(e+1),is_query:this.data.get("isQuery"),component_area:this.data.get("showInAnswerAsk")?"weather":"",enter_type:this.data.get("enterType")})},n.functionalClickLog=function(t,e){return JSON.stringify({type:"click",value:"wel_function",ubcExt:{button_text:t.text,button_order:e}})},n.handleScrollToTop=function(){var t=this;this.nextTick((function(){var e,n,a=null==(e=document.getElementById("conversation-flow-container"))?void 0:e.offsetHeight,i=null==(n=document.querySelector("[class='chat-home-page']"))?void 0:n.clientHeight;t.data.set("blankHeight",a-i-44+"px")}))},n.recFunctionalShow=function(t){return JSON.stringify({value:"wel_function",button_text:t.text})},n.handleClickAgent=function(t,e){this.weatherExpOnlyGreet();var n=t.agentSearchId,a=t.agentName,i={rank:String(+Je.getState("rank")),type:"click",value:"agent_greet",ext:{agent_id:n,agent_name:a,agent_pos:String(e+1),greet_info:this.data.get("guideWord"),jump_type:"ask",component_area:this.data.get("showInAnswerAsk")?"weather":"",is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType")}};if(this.data.get("triggerType")===Yt.SHOW_AGENT_GREETING)return Fn().emit(),Or({type:"agentGreeting",data:{agentInfo:t,sa:"greet_agent",scrollTop:!0}}),i.ext.jump_type="no_ask",void Aa(i);if(Aa({rank:String(+Je.getState("rank")),type:"click",value:"agent_greet",page:"resultpage",ext:{agent_id:n,agent_name:a,agent_pos:String(e+1),greet_info:this.data.get("guideWord"),setype:"csaitab",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),a_lid:Je.getState("apagelid"),is_query:this.data.get("isQuery"),enter_type:this.data.get("enterType"),component_area:this.data.get("showInAnswerAsk")?"weather":""}}),"pc"===rt()&&Je.getState("isShowHello")||"pc"!==rt()&&Je.getState("isShowHello")&&0===Je.getState("rank"))this.data.set("showAskEntrance",!1),Gn().emit(),Or({type:"agentGreeting",data:{sa:"re_dl_greet_agent",agentInfo:t}}),es(t,"greet_agent_"+(e+1)),as(t,"");else{var o;if("jumpLink"===t.actionType&&(null==(o=t.jump_url)?void 0:o.zbios))return void Ad(t.jump_url.zbios);es(t,"greet_agent_"+(e+1)),as(t,Je.getState("agentQuery")||Je.getState("query"))}},n.weatherExpOnlyGreet=function(){Je.getState("hideTopAgentList")&&this.data.set("triggerType",Yt.SHOW_AGENT_GREETING)},n.handlerecFunctionalListClick=function(t){Ar({query:t.text,extParams:{word:t.text,sa:"wel_function"}}).catch((function(){}))},e}(a.Component);function Mu(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ju(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Mu(o,a,i,r,s,"next",t)}function s(t){Mu(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Bu(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function Hu(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}qu.components={"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"ai-markdown":e.Markdown,"ai-ask-entrance":jd,capsules:pu,"cs-multi-recommend-word":xu,"cs-prompt-recommend":Tu,"cs-chat-home-page":Au,scribe:yu},qu.template='\n    <div\n        data-show-area\n        s-if="!waitData"\n    >\n        <cs-chat-home-page\n            s-if="isPc && isShowHomePage"\n            s-bind="chatHomePageData"\n        />\n        <cs-multi-recommend-word\n            s-if="multiRecommendWord && multiRecommendWord.recommendWord"\n            multi-recommend-word="{{multiRecommendWord}}"\n        />\n        \x3c!-- pc新推荐 pc only --\x3e\n        <cs-prompt-recommend\n            s-if="{{promptRecommend}}"\n            s-bind="{{promptRecommend}}"\n            class="chat-guide-container"\n        >\n        </cs-prompt-recommend>\n        <div\n            s-else-if="{{!isPc && ((guideWord || agentList.length) && !hideTopAgentList || showInAnswerAsk)}}"\n            class="chat-guide-container {{showInAnswerAsk ? \'weather-exp-container-style\' : \'\'}}"\n            style="margin: {{hitGuideDown ? \'0 .12rem .12rem\' : \'\'}}"\n        >\n            <div\n                s-if="guideWord"\n                s-ref=\'guideTpl\'\n                class=\'cs-guide {{isShowRecFunctionalList ? "cs-guide-shortcuts" : ""}}\'\n            >\n                <div class=\'cs-guide-word\'>\n                    <span>{{guideWord}}</span>\n                </div>\n                <div\n                    s-if="isShowRecFunctionalList"\n                    style="--cos-grid-gutter: 8px"\n                    class=\'cs-guide-recommend cos-row cos-flex-wrap cos-row-col-12 cos-gutter\'\n                >\n                    <div\n                        s-for="item, index in recFunctionalList"\n                        class=\'cos-col-6\' on-click="handlerecFunctionalListClick(item)"\n                    >\n                        <div\n                            class=\'cs-guide-recommend-item\'\n                            need-click-log="{{true}}"\n                            data-show-ext="{{recFunctionalShow(item)}}"\n                            data-click-log="{{functionalClickLog(item, index)}}"\n                        >\n                            <div class=\'cs-guide-recommend-item-title\'>\n                                <img src="{{item.icon}}" class=\'cs-guide-recommend-item-icon\'/>\n                                <span class="cs-guide-recommend-item-name">{{item.name}}</span>\n                            </div>\n                            <div class="cs-guide-recommend-item-text cos-line-clamp-1">{{item.text}}</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div s-if="{{showInAnswerAsk && agentList.length}}" class="ai-tab-weather-exp-guide-world">\n                <p class="cos-line-clamp-2 cos-text-body-lg cos-color-text cos-space-mt-none cos-space-mb-none">\n                    {{guideWord}}\n                </p>\n            </div>\n            <cos-swiper\n                s-if="{{agentList.length && !guideWord}}"\n                class="agent-list-container"\n                on-change="handleScroll"\n            >\n                <cos-swiper-item\n                    s-for="item, index in agentList"\n                    width="{{isPc ? \'42.5%\' : \'68%\'}}"\n                    on-click="native:handleClickAgent(item, index)"\n                    class="scroll-item-container"\n                >\n                    <div\n                        class="scroll-item"\n                        data-show-ext="{{agentLog(item, index)}}"\n                    >\n                        <div class="agent-item-avatar-container">\n                            <img\n                                class="agent-item-avatar"\n                                src="{{item.logo}}"\n                                size="md"\n                            />\n                        </div>\n                        <div class="agent-item-right">\n                            <div class="agent-item-top">\n                                <div class="agent-item-name c-fwb cos-line-clamp-1">\n                                    <div class="c-line-clamp1 cos-line-clamp-1">\n                                        {{item.agentName}}\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="agent-item-description c-line-clamp1 cos-line-clamp-1">\n                                {{item.description}}\n                            </div>\n                        </div>\n                    </div>\n                </cos-swiper-item>\n            </cos-swiper>\n        </div>\n        <div\n            s-if="helloTipComponentName !== \'div\'"\n            class="hello-tip-container"\n        >\n            <div\n                s-is="helloTipComponentName"\n                s-bind="helloTipComponent.data"\n            />\n        </div>\n        <div\n            s-if="showAskEntrance && recommendData && recommendData.data"\n            s-ref="ask-entrance"\n            class="cs-guide-agent-welcome"\n            data-show-area\n        >\n            <ai-ask-entrance\n                can-launch-multi-search="{{false}}"\n                ask-component-data="{{recommendData}}"\n                is-single-card="{{true}}"\n                chat-search-ai-tab-info="{{chatSearchAiTabInfo}}"\n            />\n        </div>\n        <capsules\n            s-if="isShowCapsules"\n            s-bind="{{shortcutsData}}"\n            tplInfo="{{tplInfo}}"\n            on-click="handleNewConversation"\n        />\n        <div s-if="isShowBlankBox" style="height:{{blankHeight}}"></div>\n        <scribe />\n    </div>\n    ',qu.computed={isPermanentlyCapsules:function(){var t=Je.getState("modelList")||[];return Array.isArray(t)&&t.length>0},isShowShortCuts:function(){var t=this.data.get("showShortcut"),e=this.data.get("shortcutsData"),n=this.data.get("isPermanentlyCapsules");return t&&(null==e?void 0:e.capsuleData)||n},isShowCapsules:function(){var t=this.data.get("isShowShortCuts"),e=this.data.get("isPc"),n=this.data.get("isDeepSeekPage");return!e&&!n&&t},isShowRecFunctionalList:function(){var t=this.data.get("recFunctionalList");return t&&t.length>0},helloTipComponentName:function(){var t=this.data.get("helloTipComponent")||{};return t.component?"ai-"+t.component:"div"},enterType:function(){return this.data.get("isPc")?Je.getState("pcEnterType")||"ai_tab_url":Je.getState("enterType")},isQuery:function(){return Je.getState("isShowHello")?"0":"1"},isShowHomePage:function(){var t=this.data.get("homeRec");return t&&Object.keys(t).length>0},chatHomePageData:function(){return Vi(this.data.get("homeRec"))},tplInfo:function(){return{srcid:"52567",order:-1,lid:Je.getState("lid"),tplname:"nonala_chat",query:Je.getState("query")}}};var $u;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAIL=1]="FAIL"}($u||($u={}));var Uu={SUCCESS:{status:0,message:"卡片资源加载成功"},FAIL:{status:1,message:"卡片资源加载失败"}},Fu=null;var Gu=!1;function Wu(t,e){return void 0===e&&(e=document.body),new Promise((function(n){if(Bu(t,HTMLScriptElement)&&(null==t?void 0:t.src))return function(t,e){return new Promise((function(n){var a=document.createElement("script"),i={};a.type="text/javascript",a.defer=!0,i.charset&&(a.charset=i.charset),i.id&&(a.id=i.id),a.readyState?a.onreadystatechange=function(){"loaded"!==a.readyState&&"complete"!==a.readyState||(a.onreadystatechange=null,e&&e(a),n(a))}:a.onload=function(){e&&e(a),n(a)},a.src=t,document.body.appendChild(a)}))}(t.src,n);if(Bu(t,HTMLStyleElement)||Bu(t,HTMLLinkElement)){var a=Fu||(Fu=document.head.firstElementChild),i=document.querySelectorAll("link"),o=/css\/bootstrap(\.[a-f0-9]+)?\.pc\.css/,r=Array.from(i).filter((function(t){return o.test(t.href)}));r.length>0&&(null==t?void 0:t.hasAttribute("data-vue-ssr-id"))?r[r.length-1].insertAdjacentElement("afterend",t):a?document.head.insertBefore(t,a):document.head.prepend(t)}else t&&e.appendChild(t);n(t)}))}function zu(t){return document.createRange().createContextualFragment(t)}var Qu=function(){function t(){this.resourceFetchQueue=[],this.cardResourceLoaded=!1,this.request=window.fetch.bind(window)}var e=t.prototype;return e.preloadCardStaticResource=function(){var t=this;return ju((function(){return Hu(this,(function(e){switch(e.label){case 0:return t.cardResourceLoaded?[2,Promise.resolve({status:0,message:"卡片资源预加载成功"})]:(t.cardHost||(t.cardHost=Je.getState("chatParams").card_host),[4,t.loadStaticResource(t.cardHost)]);case 1:return 0===e.sent().status?[2,Promise.resolve({status:0,message:"卡片资源预加载成功"})]:[2,Promise.reject({status:1,message:"卡片资源预加载失败"})]}}))}))()},e.render=function(t,e,n){var a=this;return ju((function(){var i,o,r,s;return Hu(this,(function(c){switch(c.label){case 0:return a.cardHost||(a.cardHost=Je.getState("chatParams").card_host),"card"!==t?[3,7]:(i={},o={},a.cardResourceLoaded?[4,a.cardRender(e,n)]:[3,2]);case 1:case 4:return o=c.sent(),[3,6];case 2:return[4,a.loadStaticResource(a.cardHost)];case 3:return 0!==(i=c.sent()).status?[3,5]:[4,a.cardRender(e,n)];case 5:return[2,Promise.reject(i)];case 6:return 0===o.status?("ins"===(null==(s=window.bds)||null==(r=s.comm)?void 0:r.tn)&&delete window.bds.comm.tn,[2,Promise.resolve(o)]):[2,Promise.reject(o)];case 7:return[2]}}))}))()},e.setCardResourceState=function(t){this.cardResourceLoaded=t,this.resourceFetchLoading=!1},e.processContextualFragment=function(t,e){var n,a,i,o=this,r="https://pss.bdstatic.com";if(null==(i=window)||null==(a=i.bds)||null==(n=a.comm)?void 0:n.staticUrl){var s,c,l,d=Mt.parse(null==(l=window)||null==(c=l.bds)||null==(s=c.comm)?void 0:s.staticUrl),u=d.protocol,p=d.host;r=u+"//"+p}t.querySelectorAll("[src], [href]").forEach((function(t){var e=t.getAttribute("src");e&&/^\/[\d\w-]/i.test(e)&&t.setAttribute("src",""+r+e);var n=t.getAttribute("href");n&&/^\/[\d\w-]/i.test(n)&&(Bu(t,HTMLAnchorElement)?o.setAnchorHref(t,n):t.setAttribute("href",""+r+n))}));var h=Array.from(t.querySelectorAll(Gu?"style[data-vue-ssr-id]":"style"));return hn(dn("style:not([data-vue-ssr-id]),link",t)),h.forEach((function(t){return Wu(t,e)})),new Promise((function(n){Array.from(t.children).reduce((function(t,n){return t.then((function(){return Wu(n,e)}))}),Promise.resolve()).then(n)}))},e.loadStaticResource=function(t){var e=this;return ju((function(){var n,a,i,o;return Hu(this,(function(r){switch(r.label){case 0:if(e.resourceFetchLoading)return[2,new Promise((function(t,n){e.resourceFetchQueue.push({resolve:t,reject:n})}))];n={},a=Nt(t+"/s",Mt.params({sa:"chat_ala",data_type:"json",chat_ala_range:1,tn:"ins",source_type:"pc_resources",word:"百度股价"})),r.label=1;case 1:return r.trys.push([1,6,,7]),e.resourceFetchLoading=!0,[4,e.request(a,{mode:"cors",credentials:"include"})];case 2:return 200!==(n=r.sent()).status?[3,5]:[4,n.text()];case 3:return i=r.sent(),o=zu(i),[4,e.processContextualFragment(o)];case 4:for(r.sent(),e.setCardResourceState(!0);e.resourceFetchQueue.length;)(0,e.resourceFetchQueue.shift().resolve)(Uu.SUCCESS);return[2,Uu.SUCCESS];case 5:return[2,Uu.FAIL];case 6:for(r.sent();e.resourceFetchQueue.length;)(0,e.resourceFetchQueue.shift().reject)(Uu.FAIL);return[2,Uu.FAIL];case 7:return[2]}}))}))()},e.cardRender=function(t,e){var n=this;return ju((function(){var a,i,o,r,s,c;return Hu(this,(function(l){switch(l.label){case 0:if(a=t.value,i=t.url,o="",!i)return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,n.request(i,{mode:"cors",credentials:"include"})];case 2:return[4,l.sent().text()];case 3:return o=l.sent(),[3,5];case 4:return l.sent(),[2,{status:1,message:"卡片模板请求失败"}];case 5:return[3,7];case 6:o=a,l.label=7;case 7:return r={status:1,message:"卡片渲染失败"},s={status:0,message:"卡片渲染成功",singCardContent:o},o?(c=zu(o),[4,n.processContextualFragment(c,e)]):[3,10];case 8:return l.sent(),n.checkCommonStyle(),[4,(d=100,new Promise((function(t){return setTimeout(t,d)})))];case 9:return l.sent(),[2,e.getBoundingClientRect().height?s:r];case 10:return[2,r]}var d}))}))()},e.checkCommonStyle=function(){Gu||un('style[data-mirror="1"]')&&(Gu=!0)},e.setAnchorHref=function(t,e){var n="https://www.baidu.com"+e.replace(/([?&])tn=[^&]*(&|$)/,(function(t,e,n){return("?"===e?e:"")+(n?"&":"")}));t.setAttribute("href",n)},t}(),Ju=new Qu,Vu={exports:{}};!function(t){t.exports=function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],a=t[1],i=t[2],o=t[3];a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&i|~a&o)+e[0]-680876936|0)<<7|n>>>25)+a|0)&a|~n&i)+e[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&a)+e[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+e[3]-1044525330|0)<<22|a>>>10)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&i|~a&o)+e[4]-176418897|0)<<7|n>>>25)+a|0)&a|~n&i)+e[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&a)+e[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+e[7]-45705983|0)<<22|a>>>10)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&i|~a&o)+e[8]+1770035416|0)<<7|n>>>25)+a|0)&a|~n&i)+e[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&a)+e[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+e[11]-1990404162|0)<<22|a>>>10)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&i|~a&o)+e[12]+1804603682|0)<<7|n>>>25)+a|0)&a|~n&i)+e[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&a)+e[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+e[15]+1236535329|0)<<22|a>>>10)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&o|i&~o)+e[1]-165796510|0)<<5|n>>>27)+a|0)&i|a&~i)+e[6]-1069501632|0)<<9|o>>>23)+n|0)&a|n&~a)+e[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+e[0]-373897302|0)<<20|a>>>12)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&o|i&~o)+e[5]-701558691|0)<<5|n>>>27)+a|0)&i|a&~i)+e[10]+38016083|0)<<9|o>>>23)+n|0)&a|n&~a)+e[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+e[4]-405537848|0)<<20|a>>>12)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&o|i&~o)+e[9]+568446438|0)<<5|n>>>27)+a|0)&i|a&~i)+e[14]-1019803690|0)<<9|o>>>23)+n|0)&a|n&~a)+e[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+e[8]+1163531501|0)<<20|a>>>12)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a&o|i&~o)+e[13]-1444681467|0)<<5|n>>>27)+a|0)&i|a&~i)+e[2]-51403784|0)<<9|o>>>23)+n|0)&a|n&~a)+e[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+e[12]-1926607734|0)<<20|a>>>12)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a^i^o)+e[5]-378558|0)<<4|n>>>28)+a|0)^a^i)+e[8]-2022574463|0)<<11|o>>>21)+n|0)^n^a)+e[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+e[14]-35309556|0)<<23|a>>>9)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a^i^o)+e[1]-1530992060|0)<<4|n>>>28)+a|0)^a^i)+e[4]+1272893353|0)<<11|o>>>21)+n|0)^n^a)+e[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+e[10]-1094730640|0)<<23|a>>>9)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a^i^o)+e[13]+681279174|0)<<4|n>>>28)+a|0)^a^i)+e[0]-358537222|0)<<11|o>>>21)+n|0)^n^a)+e[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+e[6]+76029189|0)<<23|a>>>9)+i|0,a=((a+=((i=((i+=((o=((o+=((n=((n+=(a^i^o)+e[9]-640364487|0)<<4|n>>>28)+a|0)^a^i)+e[12]-421815835|0)<<11|o>>>21)+n|0)^n^a)+e[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+e[2]-995338651|0)<<23|a>>>9)+i|0,a=((a+=((o=((o+=(a^((n=((n+=(i^(a|~o))+e[0]-198630844|0)<<6|n>>>26)+a|0)|~i))+e[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~a))+e[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+e[5]-57434055|0)<<21|a>>>11)+i|0,a=((a+=((o=((o+=(a^((n=((n+=(i^(a|~o))+e[12]+1700485571|0)<<6|n>>>26)+a|0)|~i))+e[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~a))+e[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+e[1]-2054922799|0)<<21|a>>>11)+i|0,a=((a+=((o=((o+=(a^((n=((n+=(i^(a|~o))+e[8]+1873313359|0)<<6|n>>>26)+a|0)|~i))+e[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~a))+e[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+e[13]+1309151649|0)<<21|a>>>11)+i|0,a=((a+=((o=((o+=(a^((n=((n+=(i^(a|~o))+e[4]-145523070|0)<<6|n>>>26)+a|0)|~i))+e[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~a))+e[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+e[9]-343485551|0)<<21|a>>>11)+i|0,t[0]=n+t[0]|0,t[1]=a+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0}function a(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function i(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function o(t){var e,i,o,r,s,c,l=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)n(d,a(t.substring(e-64,e)));for(i=(t=t.substring(e-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)o[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(n(d,o),e=0;e<16;e+=1)o[e]=0;return r=(r=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),c=parseInt(r[1],16)||0,o[14]=s,o[15]=c,n(d,o),d}function r(t){var e,a,o,r,s,c,l=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)n(d,i(t.subarray(e-64,e)));for(a=(t=e-64<l?t.subarray(e-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<a;e+=1)o[e>>2]|=t[e]<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(n(d,o),e=0;e<16;e+=1)o[e]=0;return r=(r=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),c=parseInt(r[1],16)||0,o[14]=s,o[15]=c,n(d,o),d}function s(t){var n,a="";for(n=0;n<4;n+=1)a+=e[t>>8*n+4&15]+e[t>>8*n&15];return a}function c(t){var e;for(e=0;e<t.length;e+=1)t[e]=s(t[e]);return t.join("")}function l(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function d(t,e){var n,a=t.length,i=new ArrayBuffer(a),o=new Uint8Array(i);for(n=0;n<a;n+=1)o[n]=t.charCodeAt(n);return e?o:i}function u(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function p(t,e,n){var a=new Uint8Array(t.byteLength+e.byteLength);return a.set(new Uint8Array(t)),a.set(new Uint8Array(e),t.byteLength),a}function h(t){var e,n=[],a=t.length;for(e=0;e<a-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function f(){this.reset()}return c(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,a){var i,o,r,s,c=this.byteLength,l=e(n,c),d=c;return a!==t&&(d=e(a,c)),l>d?new ArrayBuffer(0):(i=d-l,o=new ArrayBuffer(i),r=new Uint8Array(o),s=new Uint8Array(this,l,i),r.set(s),o)}}(),f.prototype.append=function(t){return this.appendBinary(l(t)),this},f.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,i=this._buff.length;for(e=64;e<=i;e+=64)n(this._hash,a(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},f.prototype.end=function(t){var e,n,a=this._buff,i=a.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=a.charCodeAt(e)<<(e%4<<3);return this._finish(o,i),n=c(this._hash),t&&(n=h(n)),this.reset(),n},f.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},f.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},f.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},f.prototype._finish=function(t,e){var a,i,o,r=e;if(t[r>>2]|=128<<(r%4<<3),r>55)for(n(this._hash,t),r=0;r<16;r+=1)t[r]=0;a=(a=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(a[2],16),o=parseInt(a[1],16)||0,t[14]=i,t[15]=o,n(this._hash,t)},f.hash=function(t,e){return f.hashBinary(l(t),e)},f.hashBinary=function(t,e){var n=c(o(t));return e?h(n):n},f.ArrayBuffer=function(){this.reset()},f.ArrayBuffer.prototype.append=function(t){var e,a=p(this._buff.buffer,t),o=a.length;for(this._length+=t.byteLength,e=64;e<=o;e+=64)n(this._hash,i(a.subarray(e-64,e)));return this._buff=e-64<o?new Uint8Array(a.buffer.slice(e-64)):new Uint8Array(0),this},f.ArrayBuffer.prototype.end=function(t){var e,n,a=this._buff,i=a.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=a[e]<<(e%4<<3);return this._finish(o,i),n=c(this._hash),t&&(n=h(n)),this.reset(),n},f.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.ArrayBuffer.prototype.getState=function(){var t=f.prototype.getState.call(this);return t.buff=u(t.buff),t},f.ArrayBuffer.prototype.setState=function(t){return t.buff=d(t.buff,!0),f.prototype.setState.call(this,t)},f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=function(t,e){var n=c(r(new Uint8Array(t)));return e?h(n):n},f}()}(Vu);var Ku,Xu=Vu.exports,Yu=u({__proto__:null,default:n.getDefaultExportFromCjs(Xu)},[Xu]);function Zu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function tp(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ep(){return ep=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ep.apply(this,Array.from(arguments))}function np(t,e){return np=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},np(t,e)}function ap(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Zu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zu(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ip(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var op,rp,sp={template:'\n        <div class="capsules-box">\n            <slot name="prefix" />\n            <cos-swiper class="capsules-container">\n                <cos-swiper-item\n                    s-for="item, index in capsuleData"\n                    class="capsules-item"\n                >\n                    <div data-show-ext="{{item.type === \'agent\' ? realShowExt(item,index) : \'\'}}">\n                        <div\n                            class="capsules-item-background"\n                            style="{{capsuleBackground(item)}}"\n                        >\n                        </div>\n                        <cos-image-uploader\n                            s-if="{{(item.type === \'uploadImage\' || item.type === \'imageUpload\') && useInnerUploader}}"\n                            max-count="{{item.options && item.options.maxCount || \'1\'}}"\n                            max-compressed-dimension="1000"\n                            on-success="handleUploadSuccess"\n                        >\n                            <div\n                                on-click="handleCapsuleClick(item, index)"\n                                class="{{item.icon ? \'\' : \'capsules-item-text\'}} capsules-item-tag cos-font-medium"\n                            >\n                                <i s-if="item.icon" style="{{iconUrl(item)}}"></i>\n                                {{ item.text }}\n                            </div>\n                        </cos-image-uploader>\n                        <div\n                            s-else\n                            class="{{item.icon ? \'\' : \'capsules-item-text\'}} capsules-item-tag cos-font-medium"\n                            on-click="handleCapsuleClick(item, index)"\n                            on-mouseenter="handleCapsuleMouseenter($event, item)"\n                            on-mouseleave="handleCapsuleMouseleave($event, item)"\n                        >\n                            <i s-if="item.icon" style="{{iconUrl(item)}}" class="capsules-item-tag-icon-{{item.type}}"></i>\n                            {{ item.text }}\n                        </div>\n                    </div>\n                </cos-swiper-item>\n            </cos-swiper>\n        </div>\n    ',initData:function(){return{capsuleData:[],useInnerUploader:!0,logExtParams:{}}},attached:function(){this.fire("rendered")},realShowExt:function(t,e){return JSON.stringify(ep({component_content:{component_name:"shortcuts"},value:"capsule_bub",capsule_content:[{agent_id:t.agentId,agent_name:t.text,agent_pos:e+""}]},this.data.get("logExtParams")))},handleCapsuleClick:function(t,e){this.fire("click",ep({},t,{itemIndex:e}))},handleCapsuleMouseenter:function(t,e){this.fire("mouseenter",{event:t,data:e})},handleCapsuleMouseleave:function(t,e){this.fire("mouseleave",{event:t,data:e})},handleUploadSuccess:function(t){this.fire("img-upload-success",t)},capsuleBackground:function(t){if(t.background){var e=null==t?void 0:t.background.split("-")[0];return"background: radial-gradient(96.47% 101.09% at 1.47% 1.52%, "+e+" 0%, "+((null==t?void 0:t.background.split("-")[1])||e)+" 100%);"}},iconUrl:function(t){if(t.icon)return"background-image: url("+t.icon+")"}},cp=a.defineComponent(ep({},sp,{components:{"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"cos-image-uploader":e.ImageUploader}})),lp=a.defineComponent(ep({},sp,{components:{"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"cos-image-uploader":e.ImageUploader}}));(rp=op||(op={})).LOADING="loading",rp.SUCCESS="success",rp.ERROR="error";var dp=function(){return!/swandevtools|Mobile|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)},up=a.defineComponent({template:'\n        <div class="image-item-container" style="{{class === \'auto\' ? (_width > _height ? \'width: 265.5px\' : \'width: 177px\') : \'\'}} ">\n            <cos-image\n                src="{{src}}"\n                placeholder=""\n                class="cos-image-fit-cover cos-image-position-center {{class === \'default\' || _width === _height ? \'cos-image-1-1\' : (_width > _height ? \'cos-image-3-2\' : \'cos-image-3-4\')}}"\n            >\n                \x3c!-- 图片资源上传中的状态展示 --\x3e\n                <div\n                    s-if="{{status === \'loading\'}}"\n                    class="loading-block"\n                >\n                    <cos-loading text="" />\n                </div>\n\n                \x3c!-- 图片资源上传失败的状态展示 --\x3e\n                <div\n                    s-if="{{status === \'error\'}}"\n                    class="error-block"\n                >\n                    <cos-icon name="info-circle-fill" class="icon" />\n                </div>\n            </cos-image>\n        </div>\n    ',components:{"cos-image":(dp(),e.Image),"cos-loading":(dp(),e.Loading),"cos-icon":(dp(),e.Icon)},initData:function(){return{path:"",src:"",status:op.SUCCESS,class:"default",_width:0,_height:0}},attached:function(){var t=this;if("auto"===this.data.get("class")){var e=this.data.get("src");e&&this.autoFitImage(e),this.watch("src",(function(e){t.autoFitImage(e)}))}},autoFitImage:function(t){var e=this,n=new Image;n.src=t,n.onload=function(){e.data.set("_width",(null==n?void 0:n.width)||0),e.data.set("_height",(null==n?void 0:n.height)||0)}}});function pp(t,e){for(var n=[],a=0;a<t.length;a+=e)n.push(t.slice(a,a+e));return n}var hp=a.defineComponent({template:'\n        <div class="image-group-container">\n            <div class="image-group-block">\n                <div s-if="_singleImage" class="image-group-single-item" on-click="handlePreview(_singleImage, 0, imageGroup)">\n                    <image-item class="auto" s-bind="{{_singleImage}}" />\n                </div>\n                <fragment s-for="rowItem, rowIndex in _imageRowGroup">\n                    <div class="cos-row cos-row-col-12 cos-justify-end cos-gutter {{rowIndex < _imageRowGroup.length - 1 ? \'image-group-row\' : \'\'}}" style="--cos-grid-gutter: 8px">\n                        <fragment s-for="item, itemIndex in rowItem">\n                            <div class="cos-col-4" on-click="handlePreview(item, _imageRowGroup[0].length * rowIndex + itemIndex, imageGroup)">\n                                <image-item s-bind="{{item}}" />\n                            </div>\n                        </fragment>\n                    </div>\n                </fragment>\n            <div>\n        </div>\n    ',components:{"image-item":up},initData:function(){return{imageGroup:[],_singleImage:void 0,_imageRowGroup:[]}},computed:{_singleImage:function(){var t=this.data.get("imageGroup");if(t&&1===t.length)return ep({class:"auto"},t[0])},_imageRowGroup:function(){var t=this.data.get("imageGroup");return t&&t.length>1?4===t.length?pp(t,2):pp(t,3):[]}},handlePreview:function(t,e,n){t.status===op.SUCCESS&&this.fire("preview-image",{urls:n.map((function(t){return t.src})),current:""+e})}}),fp=a.defineComponent({template:'\n        <div class="drawer">\n            <div\n                s-show="{{maskShow}}"\n                class="drawer-mask"\n                style="{{maskStyle}}"\n                on-click="onMaskClick"\n            ></div>\n            <div\n                s-ref="drawerContentRef"\n                class="drawer-content drawer-content-{{show ? \'show\' : \'hide\'}}"\n                style="height: {{height}}; {{translateYStyle}}"\n                on-touchstart="onContentTouchStart"\n                on-touchmove="onContentTouchMove"\n                on-touchend="onContentTouchEnd"\n            >\n                <div\n                    class="drawer-content-close"\n                    on-click="onButtonClick"\n                ></div>\n                <div class="drawer-content-header">\n                    <div class="drawer-content-header-title">{{title}}</div>\n                </div>\n                <div class="drawer-content-main">\n                    <iframe\n                        class="drawer-content-iframe"\n                        src="{{url}}"\n                        frameborder="none"\n                    >\n                    </iframe>\n                </div>\n            </div>\n        </div>\n    ',initData:function(){return{show:!1,maskShow:!1,url:"",title:"",heightPercent:.75,_drag:{isDragging:!1,startY:0,endY:0},_thresholdY:0,_translateY:"100%"}},computed:{height:function(){return 100*Math.min(.9,Math.max(.25,this.data.get("heightPercent")))+"vh"},showDuration:function(){return this.data.get("heightPercent")<.5?240:320},hideDuration:function(){return this.data.get("heightPercent")<.5?180:240},maskStyle:function(){var t=this.data.get("show");return"transition: background-color "+(t?this.data.get("showDuration"):this.data.get("hideDuration"))+"ms ease-in-out;background-color: rgba(0, 0, 0, "+(t?".5":"0")+");"},translateYStyle:function(){var t=this.data.get("_translateY"),e="number"==typeof t?t+"px":t,n=this.data.get("_drag"),a=this.data.get("show")?this.data.get("showDuration"):this.data.get("hideDuration");return"transform: translateY("+e+") translateZ(0);-webkit-transform: translateY("+e+") translateZ(0); animation-duration: "+(n.isDragging?160:a)+"ms"}},created:function(){this.calThresholdY(),this.listenOpen()},attached:function(){var t=this,e=this.ref("drawerContentRef");null==e||e.addEventListener("animationend",(function(e){"drawerSlideOut"===e.animationName&&t.data.set("_translateY",0)})),this.watch("show",(function(e){e?t.data.set("maskShow",!0):setTimeout((function(){t.data.set("maskShow",!1),t.data.set("drag.isDragging",!1)}),t.data.get("hideDuration"))}))},calThresholdY:function(){var t=window.innerHeight,e=this.data.get("heightPercent");this.data.set("_thresholdY",.25*e*t)},listenOpen:function(){var t=this;this.watch("show",(function(e){e&&t.fire("open")}))},close:function(t){this.data.set("show",!1),this.fire("close",{type:t})},onMaskClick:function(){this.close("mask")},onButtonClick:function(){this.close("button")},onContentTouchStart:function(t){var e,n=this.data.get("_drag");n.isDragging=!1,n.startY=(null==(e=t.changedTouches[0])?void 0:e.clientY)||0,this.data.set("_drag",n)},onContentTouchMove:function(t){var e;t.preventDefault();var n=this.data.get("_drag");n.isDragging=!0,this.data.set("_drag",n);var a=((null==(e=t.changedTouches[0])?void 0:e.clientY)||0)-n.startY;this.data.set("_translateY",Math.max(a,0))},onContentTouchEnd:function(t){var e,n=this.data.get("_drag"),a=this.data.get("_thresholdY");n.endY=(null==(e=t.changedTouches[0])?void 0:e.clientY)||0,this.data.set("_drag",n),n.endY-n.startY>a?this.close("slide"):this.data.set("_translateY",0)}}),gp={},mp={};var vp=new(function(){function t(){this.components=[]}var e=t.prototype;return e.register=function(t){this.components.push(t)},e.triggerEvent=function(t,e){var n,a=this;return(n=function(){var n,i,o;return ip(this,(function(r){switch(r.label){case 0:n=ap(a.components),r.label=1;case 1:return(i=n()).done?[3,5]:"function"==typeof(o=i.value).chatEvents[t]?[4,o.chatEvents[t](e)]:[3,3];case 2:r.sent(),r.label=3;case 3:r.label=4;case 4:return[3,1];case 5:return[2]}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(a,i){var o=n.apply(t,e);function r(t){tp(o,a,i,r,s,"next",t)}function s(t){tp(o,a,i,r,s,"throw",t)}r(void 0)}))})()},t}());function yp(t){function e(e){t.call(this,e),function(t){for(var e,n=ap(Object.keys(t));!(e=n()).done;){var a=e.value,i=t[a];if("string"==typeof i){if(!mp[i])throw new Error("组件"+i+"还未被注入");t[a]=mp[i]}}}(t.prototype.constructor.components||{});for(var n,a=ap(t.prototype.constructor.dependencies||[]);!(n=a()).done;){var i=n.value;this[i]=gp[i]}this.chatEvents&&vp.register(this)}return e.prototype=Object.create(t.prototype),e}function bp(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function wp(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}!function(t){Object.assign(mp,t)}({UploaderDemo:yp((Ku=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).chatEvents={onQuestionStart:function(t){},onMessage:function(t){},onTypingFinished:function(t){},onAnwserEnd:function(t){}},e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&np(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{}},n.attached=function(){},n.handleClick=function(){this.api.getUserInfo()},e}(a.Component),Ku.template='\n        <button on-click="handleClick">上传按钮</button>\n    ',Ku.dependencies=["api"],Ku)),Drawer:fp,CapsulePC:cp,CapsuleWise:lp}),function(t){Object.assign(gp,t)}({api:new(function(){function t(){}var e=t.prototype;return e.getLatestRoundInfo=function(){return{round_index:Je.getState("rank"),lid:Je.getState("lid")}},e.getAgentInfo=function(){return Je.getState("agentInfo")},e.setAgentInfo=function(t){Je.dispatch("update",{agentInfo:t})},e.isLogin=function(){return Je.getState("user.isUserLogin")},e.getUserInfo=function(){return Je.getState("user")},e.launchConversation=function(t){return Ar(t)},e.showToast=function(t){Bn().emit(t)},t}())});var _p,kp,Sp="aitab_feedback_form_time";function xp(t){return Ip.apply(this,Array.from(arguments))}function Ip(){var t;return t=function(t){var e,n,a,i,o,r;return wp(this,(function(s){switch(s.label){case 0:n=null==(e=Je.getState("agentInfo"))?void 0:e.agentId,a=Je.getState("chatParams").sse_host+"/aichat/api/feedback?action="+t,n&&(a+="&agentId="+n),i={credentials:"include"},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,ja(a,i,2e3)];case 2:return 0===(o=s.sent()).status&&o.data?[2,o.data]:[3,4];case 3:return r=s.sent(),console.error(r),[3,4];case 4:return[2]}}))},Ip=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){bp(o,a,i,r,s,"next",t)}function s(t){bp(o,a,i,r,s,"throw",t)}r(void 0)}))},Ip.apply(this,Array.from(arguments))}function Tp(t){var e,n=t.product,a=t.actionName,i=t.rank,o=t.baseData,r=t.recommendWordList,s=[];(null==r?void 0:r.length)&&(s=r.map((function(t){var e,n;return{agentId:"agentRec"===t.type?null==(e=t.agentInfo)?void 0:e.agentId:"",text:"agentRec"===t.type?null==(n=t.agentInfo)?void 0:n.label:t.text}})));var c=o.query,l={ext_show188:n.intentionType,ext_show193:a,ext_show194:(null==(e=Je.getState("agentInfo"))?void 0:e.agentId)||0,ext_show196:i,ext_show197:o.sa||"",desc20:(null==c?void 0:c.length)>1e3?c.substring(0,1e3):c,desc27:Je.getState("oriLid"),desc28:o.lid||"0",desc29:JSON.stringify(s[0]),desc30:JSON.stringify(s[1]),desc218:JSON.stringify(s[2]),desc219:n.triggerType};return{scoreKey:11,multiKey:9,timeKey:190,data:{cuid:o.cuid,bw:o.baiduid,uid:n.uid,appid:n.appId,feedback_type:n.feedbackType,extend_url:location.href,extrastring:l}}}function Cp(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Lp(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Pp(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Cp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cp(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Dp(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Ap(){var t;return t=function(t,e){var n,a,i;return Dp(this,(function(o){switch(o.label){case 0:return e.data.get("baseData.chatHitKunlun")===yr?[2]:(n=Sr("prerenderConfirmPromise"))?[4,n]:[3,2];case 1:o.sent(),o.label=2;case 2:return e.data.set("cardSection.data",t),(a=document.createElement("div")).innerHTML=t,e.currentPageRootDom=a,i=a.querySelector("#NATab"),1===e.data.get("currentRank")&&to(pn(i,"src")||""),hn(i),e.existCard()&&(e.data.set("chatGenerate",e.data.get("baseData.chatGenerate")),e.data.set("queryIsDanger",e.data.get("baseData.queryIsDanger"))),e.data.get("baseData.chatGenerate")||e.data.set("cardSection.show",!0),[2]}}))},Ap=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Lp(o,a,i,r,s,"next",t)}function s(t){Lp(o,a,i,r,s,"throw",t)}r(void 0)}))},Ap.apply(this,Array.from(arguments))}!function(t){t.INIT="init",t.TITLE_GENERATING="title-generating",t.TITLE_COMPLETED="title-completed",t.COMPLETED="completed",t.NO_MIND_MAP="no-mind-map"}(_p||(_p={})),function(t){t.SSE_STOP="sse-stop",t.SET_DATA="set-data"}(kp||(kp={}));var Ep=!1,Op=[];function Rp(){return Je.getState("resourceLoaded")||document.querySelector('script[name="globalTJS"]')?Promise.resolve():new Promise(Ep?function(t,e){Op.push({resolve:t,reject:e})}:function(t,e){Ep=!0,fetch("https://m.baidu.com/searchframe?sa=chat_ala&data_type=json&source_type=list&req_source=chat_search_card",{mode:"cors",credentials:"include"}).then((function(e){e.json().then((function(e){var n,a;(n=e.styles||[],a=e.scripts||[],Promise.all([qp(n,"style"),qp(a,"script")])).then((function(){for(t(),Je.dispatch("update",{resourceLoaded:!0});Op.length;){var e,n=null==(e=Op.shift())?void 0:e.resolve;n&&n()}})).catch((function(){return t()}))}))})).catch((function(){return e()}))})}function Np(t,e){for(var n,a=Pp(Object.keys(e||{}));!(n=a()).done;){var i=n.value,o=e[i];t.setAttribute(i,o)}}function qp(t,e){var n=Promise.resolve();return t.forEach((function(t){n=n.then((function(){return function(t,e,n){return new Promise((function(a,i){if("style"===e){var o=document.createElement(t.tag||"external"===t.type?"link":e);Np(o,t.attr),t.name&&o.setAttribute("name",t.name),o.innerHTML=t.code||"";var r=jp(),s=document.querySelectorAll('[name="cosmicStyle"]');s.length>0&&o.hasAttribute("data-vue-ssr-id")?s[s.length-1].insertAdjacentElement("afterend",o):r?document.head.insertBefore(o,r):document.head.prepend(o),a()}else{var c=document.createElement("script");Np(c,t.attr),t.name&&c.setAttribute("name",t.name),c.innerHTML=t.code||"","external"!==t.type&&a(),c.async=!0,c.onload=function(){return a()},c.onerror=function(){return i(new Error("Failed to load script: "+t.name))},n.appendChild(c)}}))}(t,e,"head"===t.position||"style"===e?document.head:document.body)}))})),n}var Mp=null;function jp(){return Mp||(Mp=document.head.firstElementChild)}function Bp(){return Bp=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Bp.apply(this,Array.from(arguments))}var Hp=a.defineComponent({components:{"ai-markdown":e.Markdown,"cosd-site-vcard":e.SiteVcard},initData:function(){return{agentRecommendList:[],blocks:[],generateAnswer:[],recommendText:"",allContent:"",typing:{speed:30,cursor:!0,mode:"all"},typingFinished:!1,cacheContentList:[]}},attached:function(){var t,e=this;this.dispatch("component-show",{name:"agentRecommend"}),this.handleChatClick=_n(this.handleChatClick,1e3,{leading:!0,trailing:!1}),null==(t=this.data.get("generateAnswer")[0])||t.data.forEach((function(t){var n,a;if(t.content&&(null==t||null==(n=t.content)?void 0:n.generator)){var i,o,r=null==(a=t.content.generator)?void 0:a.component;if("agentRecommend"===r||"ai-agent-recommend"===r)e.data.push("cacheContentList",null==(o=t.content.generator)||null==(i=o.data)?void 0:i.value)}}))},computed:{allContent:function(){return this.data.get("isHistory")?this.data.get("historyContent")||"":this.data.get("cacheContentList").join("")}},handleChatClick:function(t,e){var n,a,i,o,r,s,c=this.data.get(),l=c.question,d=c.isHistory,u=(null==(i=l[0])||null==(a=i.data)||null==(n=a.question)?void 0:n.question)||"";null==(s=l[0])||null==(r=s.data)||null==(o=r.agentInfo)||o.agentName;var p=d?u:Je.getState("query");t.agentInfo&&(es(t.agentInfo,"contact_agent"),as(t.agentInfo,p||"你好"))},typingFinishedHandle:function(){this.ref("recommend-markdown")&&this.ref("recommend-markdown").stop(),this.data.set("typingFinished",!0)},logParams:function(t,e,n){var a=t.agentInfo,i={value:"agent_recommand"},o={agent_id:a.agentId,agent_name:a.agentName,agent_pos:e+1},r=Bp({},i,{valueInfo:{component_name:"agentRecommand"},agent_content:[Bp({},o)]}),s=Bp({},i,{order:-1,cyc:1,clk_info:{type:"na",action:"invokecsaitab"},extra:Bp({},o,{component_content:{component_name:"agentRecommand"},ori_lid:Je.getState("oriLid")})});return JSON.stringify("click"===n?s:r)}}),$p={};$p=Object.assign($p,{answerRecommendCard:"answer-recommend-card_8tdaz_1","answer-recommend-card":"answer-recommend-card_8tdaz_1",divider:"divider_8tdaz_30"}),Hp.template='\n\n    <div\n        s-if="{{typingEnd || isHistory && agentRecommendList && agentRecommendList.length}}"\n        class="cos-dqa {{$style[\'answer-recommend-card\']}}"\n        data-no-na-dialog\n    >\n        \x3c!--推荐文案--\x3e\n        <div s-if="{{!isHistory}}">\n            <ai-markdown\n                s-ref="recommend-markdown"\n                typing="{{typing}}"\n                content="{{allContent}}"\n                on-typing-finished="typingFinishedHandle"\n            />\n        </div>\n        <div s-else>\n            <ai-markdown\n                s-ref="recommend-markdown"\n                content="{{allContent}}"\n            />\n        </div>\n        \x3c!--挂载卡list--\x3e\n        <div\n            s-if="{{(!isHistory && agentRecommendList && typingFinished) || isHistory}}"\n            s-for="agent,index in agentRecommendList"\n        >\n            <div\n                data-module="agent_recommand"\n                on-click="handleChatClick(agent,index)"\n            >\n                <cosd-site-vcard\n                    title="{{agent.title}}"\n                    caption="{{agent.caption}}"\n                    action-text="{{agent.actionText}}"\n                    logo="{{agent.logo}}"\n                    visits="{{agent.visits}}"\n                    appearance="card"\n                    attr-data-show-area\n                    attr-data-show-ext="{{logParams(agent, index, \'show\')}}"\n                    attr-need-click-log\n                    attr-data-click-log="{{logParams(agent, index, \'click\')}}"\n                />\n            </div>\n            \x3c!-- 分隔线 --\x3e\n            <div s-if="{{index !== agentRecommendList.length - 1}}" class="cos-divider {{$style[\'divider\']}}"></div>\n        </div>\n    </div>\n';var Up,Fp,Gp="function"==typeof Hp?Hp.prototype.initData||Wp:Hp.initData||Wp;function Wp(){return{$style:$p}}function zp(){return Object.assign({},Gp.call(this),{$style:$p})}"function"==typeof Hp?Hp.prototype.initData=zp:Hp.initData=zp;var Qp=0xb0184ac3b751,Jp="aitab_complete_answer_count",Vp="1"===(null==(Fp=Je.getState("sample"))||null==(Up=Fp.variables)?void 0:Up.WIDGET_COLOR_STYLE),Kp=Vp?{ios:"https://activity.baidu.com/mbox/preview/4a89a99c64/home",android:"https://activity.baidu.com/mbox/preview/4a86a09e63/home"}:{ios:"https://activity.baidu.com/mbox/4a86a89a62/home",android:"https://activity.baidu.com/mbox/4a86a89a63/home"},Xp=Vp?{dark:"https://psstatic.cdn.bcebos.com/basics/aichat/桌面小窗视频-dark_1743074019000.mp4",light:"https://psstatic.cdn.bcebos.com/basics/aichat/桌面小窗视频-light_1743074063000.mp4"}:{dark:"https://psstatic.cdn.bcebos.com/basics/aichat/桌面小窗视频-Dark_1737638346000.mp4",light:"https://psstatic.cdn.bcebos.com/basics/aichat/桌面小窗视频-日间_1737638324000.mp4"},Yp=Vp?{dark:"https://psstatic.cdn.bcebos.com/basics/aichat/半层面板视频-dark_1743074087000.mp4",light:"https://psstatic.cdn.bcebos.com/basics/aichat/半层面板视频-light_1743074105000.mp4"}:{dark:"https://psstatic.cdn.bcebos.com/basics/aichat/半层面板视频-Dark_1737638300000.mp4",light:"https://psstatic.cdn.bcebos.com/basics/aichat/半层面板视频-日间_1737638231000.mp4"};function Zp(t){Bn().emit({text:t,timer:1e3})}function th(t){o.canIUse("aiSearch.open")&&o.aiSearch.open({animation:"fadeEnter",degradedCmd:"baiduboxapp://v1/browser/open?&url="+encodeURIComponent(t),url:t})}function eh(){return new Promise((function(t){o.canIUse("search.hasOpenWidget")?o.search.hasOpenWidget({openWidgetId:Qp,ignoreConfig:!0,success:function(e){var n=function(){var n,a=e.status,i=e.data;n=i,0!==Object.keys(n).length&&t(!(0===a&&!i.unsupported&&!i.installed))};Wa?setTimeout(n,200):n()},fail:function(){return t(!1)}}):t(!1)}))}function nh(){return new Promise((function(t,e){var n="ai_chat",a=Qa(),i=Ga?Kp.android:Kp.ios,r=Wa&&Fi(Ui(),"13.26")>0;o.canIUse("search.addOpenWidget")?o.search.addOpenWidget({openWidgetId:Qp,from:n,success:function(){Zp("添加成功"),t(!0)},fail:function(e){!function(t,e){if(t){var n=t.status;n&&[1006,1005].includes(n)?Zp("添加失败，请重试"):1003!==n&&th(e)}}(e,i),t(!1)}}):o.canIUse("search.invokeWidgetGuide")&&r?o.search.invokeWidgetGuide({from:n,source:"openwidget_aichat",pipVideoUrl:a?Xp.dark:Xp.light,guideList:[{title:"视频教程",detailInfo:"点击“去安装”可以一边观看一边安装",isVideo:1,videoUrl:a?Yp.dark:Yp.light}],success:function(){t(!1)},fail:function(){th(i),t(!1)}}):(th(i),e(new Error("Widget addition not supported.")))}))}function ah(){return new Promise((function(t){return ct()||dt()||!ut()||!gs()||Fi(Ui(),"13.74")<0?t(!1):function(){if(localStorage.getItem(Jp)){var t=parseInt(localStorage.getItem(Jp),10);if(2==++t)return localStorage.setItem(Jp,t.toString()),!0}else localStorage.setItem(Jp,"1");return!1}()?void eh().then((function(e){t(!e)})):t(!1)}))}function ih(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function oh(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var rh=!1,sh=a.defineComponent({computed:{ubcShowLog:function(){var t=this.data.get("type");if("modelGuide"===t){var e=Je.getState("usedModel");return JSON.stringify({value:"model_intro",setype:"csaitab",current_model:e.modelName})}return JSON.stringify({value:"ai_chat_"+t+"_guide",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),setype:"csaitab"})},questionCloselyData:function(){var t=this.data.get("recommendWord");return t?{askComponentData:{component:"questionClosely",data:{recommendWord:t,type:"primary",emptyDisabled:!0,isSingleCol:"1",jumpTypes:["multiSearch"],hideAskItem:!0,context:{app:"bdbox",scene:"chat-search"},toChatSearch:!0,componentArea:"model_guide"},logExt:{current_model:Je.getState("usedModel").modelName},sa:this.data.get("sa")}}:null}},messages:{"ai-question-closely:click":function(t){this.handleQuestionCloselyClick(t)}},components:{"ai-ask-entrance":jd},initData:function(){return{type:"",rank:void 0,latestRank:void 0,showStatus:0,leftTitle:"",leftText:"",leftBtn:"",rightImg:"",rightImgDark:"",showCallBack:"",isNewConversationLaunched:!1,tplInfo:{tplname:"nonala_cpt",srcid:"60259",lid:"",order:-1}}},listenHide:null,listenCardTypingComplete:null,attached:function(){var t=this,e=this.data.get("type");this.listenHide=function(){"modelGuide"!==e?t.data.set("showStatus",2):t.data.set("isNewConversationLaunched",!0)},Hn().on(this.listenHide),Fn().on(this.listenHide),Gn().on(this.listenHide),Qn().on(this.listenHide),"modelGuide"!==e&&(this.listenCardTypingComplete=function(e){t.listener()},Nn().on(this.listenCardTypingComplete,{when:function(e){void 0===e&&(e={});var n=t.data.get("latestRank"),a=t.data.get("rank");return e.rank===a&&a===n}}))},listener:function(){var t=this,e=!1;if(ga().on((function(n){e=!0;var a=n.tipsData,i=n.disabled,o=t.data.get("showStatus");i||2===o?t.data.set("showStatus",2):t.handleData(a)}),{when:function(e){void 0===e&&(e={});var n=t.data.get("latestRank"),a=t.data.get("rank");return e.rank===a&&a===n}}),!e){this.handleData({type:"widget",leftTitle:"将我添加至桌面",leftText:"可以更快速找到我为你解决问题",leftBtn:"放到桌面",rightImg:"https://gips0.baidu.com/it/u=1108611378,3575234106&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f471_345",rightImgDark:"https://gips0.baidu.com/it/u=2836489570,2659260543&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f471_345"})}},disposed:function(){this.listenHide&&(Hn().off(this.listenHide),Fn().off(this.listenHide),Gn().off(this.listenHide),Qn().off(this.listenHide),this.listenHide=null),this.listenCardTypingComplete&&(Nn().off(this.listenCardTypingComplete),this.listenCardTypingComplete=null)},handleData:function(t){return(e=function(){var e,n,a;return oh(this,(function(i){switch(i.label){case 0:return e=this,rh?[2]:(this.data.assign(t),"widget"!==(n=this.data.get("type"))?[3,2]:[4,ah()]);case 1:return i.sent()?(document.addEventListener("visibilitychange",(function(){document.hidden||e.setWidgetGuideStatus()})),[3,3]):[2];case 2:"message"==n&&(a=this.data.get("showCallBack"))&&fetch(a,{method:"get",mode:"cors",credentials:"include"}),i.label=3;case 3:return this.data.set("showStatus",1),rh=!0,[2]}}))},function(){var t=this,n=Array.from(arguments);return new Promise((function(a,i){var o=e.apply(t,n);function r(t){ih(o,a,i,r,s,"next",t)}function s(t){ih(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var e},handleBtnClick:function(){var t=this;this.handleClickLog();var e=this.data.get("type");if("widget"===e)eh().then((function(e){e||nh().then((function(e){e&&t.data.set("leftBtn","已添加")}))}));else if("modelGuide"===e){Aa({type:"click",value:"model_intro",ext:{current_model:Je.getState("usedModel").modelName}});var n=this.data.get("btnLink");n&&window.open(n,"_blank")}},setWidgetGuideStatus:function(){var t=this;eh().then((function(e){t.data.set("leftBtn",e?"已添加":"放到桌面")})).catch((function(){}))},handleClickLog:function(){Aa({page:"resultpage",type:"click",value:"ai_chat_widget_guide",ext:{ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),setype:"csaitab"}})},handleQuestionCloselyClick:function(){Je.getState("usedModel")}}),ch={};ch=Object.assign(ch,{guideWrapper:"guide-wrapper_1278t_1","guide-wrapper":"guide-wrapper_1278t_1",guideLeft:"guide-left_1278t_10","guide-left":"guide-left_1278t_10",guideTitle:"guide-title_1278t_20","guide-title":"guide-title_1278t_20",guideText:"guide-text_1278t_33","guide-text":"guide-text_1278t_33",guideBtn:"guide-btn_1278t_46","guide-btn":"guide-btn_1278t_46",guideRight:"guide-right_1278t_59","guide-right":"guide-right_1278t_59",guideRightImg:"guide-right-img_1278t_64","guide-right-img":"guide-right-img_1278t_64",guideRightLight:"guide-right-light_1278t_67","guide-right-light":"guide-right-light_1278t_67",guideRightDark:"guide-right-dark_1278t_70","guide-right-dark":"guide-right-dark_1278t_70",guideAskEntrance:"guide-ask-entrance_1278t_73","guide-ask-entrance":"guide-ask-entrance_1278t_73",guideWrapperModelGuide:"guide-wrapper-model-guide_1278t_93","guide-wrapper-model-guide":"guide-wrapper-model-guide_1278t_93"}),sh.template='\n    <div>\n        <div\n            s-if="showStatus === 1"\n            class="{{$style[\'guide-wrapper\']}} {{type === \'modelGuide\' ? $style[\'guide-wrapper-model-guide\'] : \'\'}}"\n            data-show-ext="{{ubcShowLog}}"\n            data-show-area\n        >\n            <div class="{{$style[\'guide-left\']}}">\n                <div class="{{$style[\'guide-title\']}}">{{leftTitle}}</div>\n                <div class="{{$style[\'guide-text\']}}">{{leftText}}</div>\n                <div\n                    s-if="leftBtn"\n                    class="{{$style[\'guide-btn\']}}"\n                    on-click="handleBtnClick"\n                >{{leftBtn}}</div>\n            </div>\n            <div class="{{$style[\'guide-right\']}} {{$style[\'guide-right-light\']}}">\n                <img class="{{$style[\'guide-right-img\']}}" src="{{rightImg}}" />\n            </div>\n            <div class="{{$style[\'guide-right\']}} {{$style[\'guide-right-dark\']}}">\n                <img class="{{$style[\'guide-right-img\']}}" src="{{rightImgDark || rightImg}}" />\n            </div>\n        </div>\n        <div\n            s-if="!isNewConversationLaunched && questionCloselyData"\n            class="{{$style[\'guide-ask-entrance\']}}"\n        >\n            <ai-ask-entrance\n                s-ref="askComponent"\n                s-bind="{{questionCloselyData}}"\n                tpl-info="{{tplInfo}}"\n                sa="{{sa}}"\n            />\n        </div>\n    </div>\n';var lh="function"==typeof sh?sh.prototype.initData||dh:sh.initData||dh;function dh(){return{$style:ch}}function uh(){return Object.assign({},lh.call(this),{$style:ch})}"function"==typeof sh?sh.prototype.initData=uh:sh.initData=uh;var ph=function(){function t(){this.callBacks=[]}var e=t.prototype;return e.listen=function(t){if("function"!=typeof t)throw new Error(t+" must be a function");this.callBacks.push(t)},e.remove=function(t){this.callBacks=this.callBacks.filter((function(e){return e!==t}))},e.emit=function(t){this.callBacks.forEach((function(e){e(t)}))},t}(),hh=function(){function t(){this.list=[]}var e=t.prototype;return e.push=function(t){this.list.push(t)},e.resolveAll=function(t){this.list.forEach((function(e){e(t)})),this.list=[]},t}(),fh=new ph,gh=new hh;var mh,vh,yh,bh=a.defineComponent({trimWhitespace:"all",template:'\n    <div class="cs-noresult">\n        <span>😩对不起，我还没有学会这个问题，可以换个话题再问问我，我将尽力为你回答~</span>\n    </div>\n    ',initData:function(){return{}}});function wh(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=""),t&&o.canIUse("album.image.preview")){var a="string"==typeof t?[t]:t;o.album.image.preview({current:a[e],urls:a,img_items:a.map((function(t){return{url:t}})),href:window.location.href,id:"",title:"",index:e.toString(),type:"0",position:{},from:n,ext:n,only_suppert_wifi:!1,isShowPageIndex:1,rootIn:"ai_image"===n?"search-component":n,source:n,slog:n,swipeCallback:"",closeCallback:"",hasMore:0})}}!function(t){t[t.IDLE=0]="IDLE",t[t.WAITING=1]="WAITING",t[t.GENERATING=2]="GENERATING",t[t.COMPLETE=3]="COMPLETE",t[t.ABORT=4]="ABORT"}(mh||(mh={})),function(t){t.IDLE="IDLE",t.WAITING="WAITING",t.GENERATING="GENERATING",t.COMPLETE="COMPLETE",t.ABORT="ABORT"}(vh||(vh={})),function(t){t.AUDIO="ml-audio",t.VIDEO="ml-video",t.CITATION_TEXT="ml-citation-text"}(yh||(yh={}));var _h=a.defineComponent({components:{"cos-image":e.Image,"cos-icon":e.Icon},computed:{imgSrc:function(){return this.data.get("src")||this.data.get("originUrl")},iconName:function(){var t=(this.data.get("centerProps")||{}).icon;return"video_play3"===t?"play":t}},initData:function(){return{src:"",originUrl:"",useImagePreview:!0,jumpUrl:"",centerProps:null,rbProps:null,imgTitle:""}},attached:function(){},onFinish:function(){this.fire("render-finished")},handleImgClick:function(){var t=this.data.get(),e=t.useImagePreview,n=t.jumpUrl,a=t.originUrl,i=t.src;e||!n?wh(a||i,0,"cos-image"):n.startsWith("baiduboxapp:")?Ad(n):window.open(n,"_blank")}}),kh={};kh=Object.assign(kh,{coverImageTitle:"cover-image-title_o5kac_1","cover-image-title":"cover-image-title_o5kac_1",coverImageCenter:"cover-image-center_o5kac_8","cover-image-center":"cover-image-center_o5kac_8",coverImageCenterIcon:"cover-image-center-icon_o5kac_14","cover-image-center-icon":"cover-image-center-icon_o5kac_14",coverImageRb:"cover-image-rb_o5kac_18","cover-image-rb":"cover-image-rb_o5kac_18",coverImageRbText:"cover-image-rb-text_o5kac_23","cover-image-rb-text":"cover-image-rb-text_o5kac_23"}),_h.template='\n    <div class="{{$style[\'cover-image-wrapper\']}}">\n        <div s-if="imgTitle" class="{{$style[\'cover-image-title\']}}">{{imgTitle}}</div>\n        <cos-image\n            src="{{imgSrc}}"\n            on-click="native:handleImgClick"\n            on-load="onFinish"\n            on-error="onFinish"\n        >\n            <div s-if="centerProps" class="{{$style[\'cover-image-center\']}}">\n                <cos-icon\n                    s-if="centerProps.icon"\n                    class="{{$style[\'cover-image-center-icon\']}}"\n                    name="{{iconName}}"\n                />\n            </div>\n            <div s-if="rbProps" class="{{$style[\'cover-image-rb\']}}">\n                <span s-if="rbProps.text" class="{{$style[\'cover-image-rb-text\']}}">{{rbProps.text}}</span>\n            </div>\n        </cos-image>\n    </div>\n';var Sh="function"==typeof _h?_h.prototype.initData||xh:_h.initData||xh;function xh(){return{$style:kh}}function Ih(){return Object.assign({},Sh.call(this),{$style:kh})}"function"==typeof _h?_h.prototype.initData=Ih:_h.initData=Ih;var Th=a.defineComponent({components:{"ai-image-group":e.ImageGroup},initData:function(){return{bindData:{},realShowExt:'{"value":"pic_cpt","component_content":{"component_name":"imageGroup"}}'}},attached:function(){var t=this;this.nextTick((function(){t.fire("render-finished")}))},handleScroll:function(){this.fire("ubc-log-event",{type:"click",value:"pic_cpt_scroll",extra:{valueInfo:[{component_name:"imageGroup"}]}})},handleImgClick:function(t){var e=t.index;this.fire("ubc-log-event",{type:"click",value:"pic_cpt_clk",extra:{valueInfo:[{component_name:"imageGroup"}]}}),wh(this.data.get("list").map((function(t){return t.src})),e,"image_group")}}),Ch={};Ch=Object.assign(Ch,{imageGroupWrapper:"image-group-wrapper_1pmzp_1","image-group-wrapper":"image-group-wrapper_1pmzp_1"}),Th.template='\n    <div\n        data-show-ext="{{realShowExt}}"\n        data-show-area\n        class="{{$style[\'image-group-wrapper\']}}"\n    >\n        <ai-image-group\n            s-bind="{{bindData}}"\n            on-render-finished="handleRenderFinished"\n            on-click="handleImgClick"\n            on-scroll="handleScroll"\n        >\n        </ai-image-group>\n    </div>\n';var Lh="function"==typeof Th?Th.prototype.initData||Ph:Th.initData||Ph;function Ph(){return{$style:Ch}}function Dh(){return Object.assign({},Lh.call(this),{$style:Ch})}function Ah(){return Ah=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ah.apply(this,Array.from(arguments))}"function"==typeof Th?Th.prototype.initData=Dh:Th.initData=Dh;var Eh=a.defineComponent({components:{"ai-image-scroll":e.ImageScroll},initData:function(){return{bindData:{},appearance:"full",indicator:"",snapAlign:"start",snapStop:"always",spaceBetween:0,imageScrollData:[],baseData:{ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank"))}}},attached:function(){var t=this;this.handleImageData(),this.nextTick((function(){t.fire("render-finished")}))},computed:{realShowExt:function(){return JSON.stringify({value:"pic_cpt",valueInfo:{component_name:"imageScroll"}})}},handleImageData:function(){var t=this.data.get("bindData").items,e=[];t.forEach((function(t,n){e.push({src:t.originUrl,span:n%3==0?8:4})})),this.data.set("imageScrollData",e)},handleImgClick:function(t){Aa({type:"click",value:"pic_cpt_clk",ext:Ah({},this.data.get("baseData"),{valueInfo:[{component_name:"imageScroll"}]})}),wh(this.data.get("imageScrollData").map((function(t){return t.src})),t.index,"image_group")},handleChange:function(){Aa({type:"click",value:"pic_cpt_scroll",ext:Ah({},this.data.get("baseData"),{valueInfo:[{component_name:"imageScroll"}]})})}});Eh.template='\n    <div\n        data-show-area\n        data-show-ext="{{realShowExt}}"\n        class="{{$style[\'image-group-wrapper\']}}"\n    >\n        <ai-image-scroll\n            items="{{imageScrollData}}"\n            appearance="{{appearance}}"\n            indicator="{{indicator}}"\n            snap-align="{{snapAlign}}"\n            snap-stop="{{snapStop}}"\n            space-between="{{spaceBetween}}"\n            on-click="handleImgClick"\n            on-change="handleChange"\n        />\n    </div>\n';var Oh=a.defineComponent({components:{"cos-video-scroll":e.VideoScroll},computed:{videoData:function(){var t,e=this.data.get("bindData")||{},n=e.videoData,a=(void 0===n?{}:n).video,i=e.url;return a&&{poster:a.poster,src:a.src,duration:a.duration,autoplay:a.playType,vid:null==(t=a.options)?void 0:t.vid,fullscreenLinkInfo:{href:i}}},realShowExt:function(){return JSON.stringify({value:"nonala_cpt",valueInfo:{component_name:"videoScroll"}})}},initData:function(){return{bindData:{items:[]},playerDurationRecords:[],playRatio:0,addNewPlayingDuration:!0,touchStartTime:0}},created:function(){Rp()},attached:function(){var t=(this.data.get("bindData.items")||[]).map((function(t){return t.linkInfo&&(t.fullscreenLinkInfo=t.linkInfo),t}));this.data.merge("bindData",{items:$a(t)}),this.fire("render-finished")},handleClick:function(){this.dispatch("send-log",{cyc:"1",clk_info:{srcid:"52567",tplname:"nonala_cpt",pd:"csaitab",action:"generalVideo_jump",type:"na"},extra:{component_content:{component_name:"videoScroll"}}})},handlePlayerInstanceCreate:function(t){var e,n=this;this.data.set("vid",null==(e=this.data.get("videoData"))?void 0:e.vid),this.data.set("instance",t),t&&(t.on("playing",(function(){n.handlePlayerPlaying(!0)})),t.on("pause",(function(){n.handlePlayerPlaying(!1)})),t.on("destroy",(function(){n.handlePlayerPlaying(!1)})),t.on("voiceBtnClicked",(function(t){var e={clk_info:{srcid:"52567",tplname:"nonala_cpt",pd:"csaitab",action:"generalVideo_clk",type:"b",xpath:t.muted?"%silence%":"%sound%"},extra:{component_content:{component_name:"videoScroll"}}};n.dispatch("send-log",e)})))},handlePlayerPlaying:function(t){t?(this.data.set("playingTime",Date.now()),this.data.set("addNewPlayingDuration",!0)):this.data.set("pauseTime",Date.now())}}),Rh={};Rh=Object.assign(Rh,{videoScrollWrapper:"video-scroll-wrapper_1czxz_1","video-scroll-wrapper":"video-scroll-wrapper_1czxz_1"}),Oh.template='\n    <div>\n        <cos-video-scroll\n            s-ref="player"\n            span="{{bindData.span}}"\n            items="{{bindData.items}}"\n            attr-data-show-area\n            attr-data-show-ext="{{realShowExt}}"\n            on-click="native:handleClick"\n            on-created="handlePlayerInstanceCreate"\n            class="{{$style[\'video-scroll-wrapper\']}}"\n        />\n    </div>\n';var Nh="function"==typeof Oh?Oh.prototype.initData||qh:Oh.initData||qh;function qh(){return{$style:Rh}}function Mh(){return Object.assign({},Nh.call(this),{$style:Rh})}"function"==typeof Oh?Oh.prototype.initData=Mh:Oh.initData=Mh;var jh={citationOld:/\^(\d+)\^/g,citationAllOld:/\^(\^|\d|\s)+\^/g,shortAnswer:/==\*\*(.*?)\*\*==\{(?:.*?)(?:\.cos-text-headline)(?:([^}]*))\}/g,coreAnswer:/==\*\*(.*?)\*\*==\{(.*?)\.dqa-(.([^}]*))\}/g,contentShortCut:/\n(.*?){(?:.*?).cos-line-clmap-(\d+)(?:([^}]*))}\n/g,searchLink:/\[([^\]]*?)\]\(\)(\{["|']+sa["|']+:(?:([^}]*))})?/g,bdPrefix:/:bd-(tts|copy)\{([^}]*)\}/g,audio:/<audio\s+(?:[^>]*?\s+)?(?:src=["']([^"']*?)["']|title=["']([^"']*?)["'])\s*(?:[^>]*?\s+)?(?:src=["']([^"']*?)["']|title=["']([^"']*?)["'])\s*.*?><\/audio>/gi,video:/<video\s+(?:[^>]*?\s+)?src=["']([^"']*?)["'].*?>(.*?)<\/video>/gi,yiyanCoreAnswer:/(?=^|[^=])(\*\*(.*?\*\*))(?=[^=]|$)/g,yiyanCitation:/\^\[(\d+)(\]\[(\d+))*\]\^/g,yiyanImage:/<img\s+src="([^"]+)"\s*(?:\/>|><\/img>)/gi};function Bh(t){return t.value.replace(jh.citationAllOld,(function(t){var e,n=(null==(e=t.match(jh.citationOld))?void 0:e.filter((function(t,e){return e<2})))||[];return'‌:ml-citation{ref="'+n.map((function(t){return t.slice(1,t.length-1)})).join(",")+'" data="citationList"}'}))}function Hh(t){return t.value.replace(jh.searchLink,(function(t,e){return"‌:ml-search["+e+"]"}))}function $h(t){return t.value.replace(jh.yiyanCitation,(function(t){var e,n=(null==(e=t.match(/\d+/g))?void 0:e.filter((function(t,e){return e<2})))||[];return':ml-citation{ref="'+n.join(",")+'" data="citationList"}'}))}function Uh(t){var e="";return e=(e=t.value.replace(jh.audio,(function(t,e,n,a,i){return'\n::ml-audio{title="'+(n||i)+'" src="'+(e||a)+'"}\n'}))).replace(jh.video,(function(t,e){return'\n::ml-video{src="'+e+'"}\n'})),e}function Fh(t){return t.value.replace(/\\\[([\s\S]+?)\\\]/g,(function(t,e){return/^\s*\n/.test(e)?"$$"+e+"$$":"$"+e+"$"})).replace(/\\\(([\s\S]+?)\\\)/g,(function(t,e){return"$"+e+"$"}))}function Gh(t,e){var n=t;return n=Hh({value:n}),e||(n={value:n}.value.replace(jh.yiyanCoreAnswer,(function(t,e){return"=="+e+"=="}))),n=function(t){return t.value.replace(jh.yiyanImage,(function(t,e){return"![]("+e+")"}))}({value:n}),n=Fh({value:n=Uh({value:n=Bh({value:n=$h({value:n})})})})}function Wh(t){var e=t;return e=Bh({value:e=$h({value:e=Hh({value:e})})}),e=function(t){return t.value.replace(jh.contentShortCut,(function(t,e,n){return"\n:::ml-paragraph{line-clamp="+n+"}\n            "+e+"\n        :::\n"}))}({value:e=function(t){return t.value.replace(jh.shortAnswer,(function(t,e){return"## =="+e+"=="}))}({value:e={value:e}.value.replace(jh.coreAnswer,(function(t,e,n,a,i){return/\.cos-text=headline/.test(n)||/\.cos-text-headline/.test(i)?"==**"+e+"**=={"+n+".dqa-"+a+i+"}":"==**"+e+"**=="}))})}),e=function(t){return t.value.replace(jh.bdPrefix,(function(t,e,n){return":ml-"+e+"{"+n+"}"}))}({value:e}),e=Fh({value:e=Uh({value:e})})}var zh={components:{"ai-markdown":e.Markdown},initData:function(){return{content:"",typing:null,isTypingEnd:!1,normalizeContent:Wh}},stopTyping:function(){var t;this.data.get("isTypingEnd")&&(null==(t=this.ref("markdown-content"))||t.stop())},appendContent:function(t){this.ref("markdown-content").appendContent(t)},typingFinished:function(){this.data.set("isTypingEnd",!0),this.fire("typing-finished")}},Qh={};Qh=Object.assign(Qh,{dsContent:"ds-content_fv7dn_1","ds-content":"ds-content_fv7dn_1"}),zh.template='\n    <div class="{{$style[\'ds-content\']}}">\n        <ai-markdown\n            s-ref="markdown-content"\n            typing="{{typing}}"\n            content="{{content}}"\n            normalizeContent="{{normalizeContent}}"\n            on-typing-finished="typingFinished"\n        />\n    </div>\n';var Jh="function"==typeof zh?zh.prototype.initData||Vh:zh.initData||Vh;function Vh(){return{$style:Qh}}function Kh(){return Object.assign({},Jh.call(this),{$style:Qh})}"function"==typeof zh?zh.prototype.initData=Kh:zh.initData=Kh;var Xh=a.defineComponent({components:{"cos-icon":e.Icon},initData:function(){return{isExpanded:!0,imgSrc:"https://gips2.baidu.com/it/u=1024110589,3770674247&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f48_37",isThinkingDoneSrc:"https://gips2.baidu.com/it/u=48799040,3038285185&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f48_48",isThinkingDone:!1,isStopThinking:!1,path:"https://psstatic.cdn.bcebos.com/basics/aichat/data_1739260489000.json",options:{loop:!0,autoplay:!0,renderer:"svg"},lottieInstance:null,modelName:"",thinkingStatusText:"思考完成"}},attached:function(){var e=this;new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){var n=t.default,a=e.data.get(),i=a.path,o=a.options;if(i){var r=e.ref("lottieWrapper"),s=n.loadAnimation({path:i,loop:(null==o?void 0:o.loop)||!1,autoplay:(null==o?void 0:o.autoplay)||!1,renderer:(null==o?void 0:o.renderer)||"svg",container:r});e.data.set("lottieInstance",s),e.fire("ready",s)}}))},toggle:function(){var t=this;this.data.get().isThinkingDone&&(this.sendLog("click"),this.fire("ds-click"),this.nextTick((function(){t.sendLog("show")})))},sendLog:function(t){var e=this.data.get("isExpanded");this.dispatch("send-ubclog",{type:t,value:"ds_think",extra:{is_open:e?"1":"0",enter_type:Je.getState("pcEnterType")||"ai_tab_url"}})},detached:function(){this.data.get("lottieInstance")&&this.data.get("lottieInstance").destroy()}}),Yh={};Yh=Object.assign(Yh,{dsHeader:"ds-header_1465t_1","ds-header":"ds-header_1465t_1",dsHeaderBottom:"ds-header-bottom_1465t_31","ds-header-bottom":"ds-header-bottom_1465t_31",dsFoldBottom:"ds-fold-bottom_1465t_34","ds-fold-bottom":"ds-fold-bottom_1465t_34",dsThinkingText:"ds-thinking-text_1465t_40","ds-thinking-text":"ds-thinking-text_1465t_40",dsLoading:"ds-loading_1465t_47","ds-loading":"ds-loading_1465t_47",dsImg:"ds-img_1465t_52","ds-img":"ds-img_1465t_52",isThinkingImg:"is-thinking-img_1465t_64","is-thinking-img":"is-thinking-img_1465t_64",rotate:"rotate_1465t_1",dsTitle:"ds-title_1465t_67","ds-title":"ds-title_1465t_67",dsToggleIcon:"ds-toggle-icon_1465t_72","ds-toggle-icon":"ds-toggle-icon_1465t_72"}),Xh.template="\n    <div\n        class=\"\n            {{$style['ds-header']}}\n            {{isExpanded ? $style['ds-header-bottom'] : $style['ds-fold-bottom']}}\n        \"\n        disable-tts\n        on-click=\"toggle\"\n    >\n        <img\n            class=\"{{$style['ds-img']}} {{isThinkingDone ? '' : $style['is-thinking-img']}}\"\n            src=\"{{isThinkingDoneSrc}}\"\n        />\n        <span class=\"{{$style['ds-title']}}\">{{ modelName }}</span>\n        <span class=\"{{$style['ds-thinking-text']}}\">\n            {{ isStopThinking ? '思考已停止' : (isThinkingDone ? '深度思考完成' : '深度思考中') }}\n        </span>\n        <fragment s-if=\"isPc\">\n            <div\n                s-ref=\"lottieWrapper\"\n                s-show=\"!isThinkingDone\"\n                class=\"{{$style['ds-loading']}}\"\n            ></div>\n        </fragment>\n        <cos-icon\n            s-show=\"{{isThinkingDone || !isPc}}\"\n            class=\"{{$style['ds-toggle-icon']}}\"\n            name=\"{{isExpanded ? 'up' : 'down'}}\"\n        />\n    </div>\n";var Zh="function"==typeof Xh?Xh.prototype.initData||tf:Xh.initData||tf;function tf(){return{$style:Yh}}function ef(){return Object.assign({},Zh.call(this),{$style:Yh})}"function"==typeof Xh?Xh.prototype.initData=ef:Xh.initData=ef;var nf={initData:function(){return{isThinkingDone:!1,path:"https://psstatic.cdn.bcebos.com/basics/chat/loading_point_1740135136000.json",options:{loop:!0,autoplay:!0,renderer:"svg"},lottieInstance:null}},attached:function(){var t=this.data.get(),e=t.path,n=t.options;if(e){var a=this.ref("lottieWrapper"),o=i.loadAnimation({path:e,loop:(null==n?void 0:n.loop)||!1,autoplay:(null==n?void 0:n.autoplay)||!1,renderer:(null==n?void 0:n.renderer)||"svg",container:a});this.data.set("lottieInstance",o),this.fire("ready",o)}},detached:function(){this.data.get("lottieInstance")&&this.data.get("lottieInstance").destroy()}},af={};af=Object.assign(af,{dsLoading:"ds-loading_48k4o_1","ds-loading":"ds-loading_48k4o_1"}),nf.template='\n    <div\n        class="{{$style[\'ds-tail\']}}"\n        disable-tts\n    >\n        <div\n            s-show="!isThinkingDone"\n            class="{{$style[\'ds-loading\']}}"\n            s-ref="lottieWrapper"\n        ></div>\n    </div>\n';var of="function"==typeof nf?nf.prototype.initData||rf:nf.initData||rf;function rf(){return{$style:af}}function sf(){return Object.assign({},of.call(this),{$style:af})}"function"==typeof nf?nf.prototype.initData=sf:nf.initData=sf;var cf=a.defineComponent({components:{"ds-context":zh,"ds-header":Xh,"ds-thiking-tail":nf},initData:function(){return{isExpanded:!0,isThinkingDone:!1,dsContent:"",typing:null,isStopThinking:!1,modelName:"",isPc:"pc"===rt()}},listenStopDsMarkdown:null,attached:function(){var t,e=this,n=this.data.get(),a=n.value,i=n.typing,o=null==(t=Je.getState("dsUsedModel"))?void 0:t.modelName;if(this.data.set("modelName",o),this.observerEmptyPlace(),null===i){var r,s=null==(r=this.data.get("usedModel"))?void 0:r.modelName;this.data.set("modelName",s),this.data.set("dsContent",a),this.data.set("isThinkingDone",!0)}this.listenStopDsMarkdown=function(t){var n;t&&(e.data.set("isThinkingDone",null==t?void 0:t.isThinkingDone),null==(n=e.ref("ds-context"))||n.stopTyping())},Ta().on(this.listenStopDsMarkdown)},disposed:function(){this.listenStopDsMarkdown&&(Ta().off(this.listenStopDsMarkdown),this.listenStopDsMarkdown=null)},observerEmptyPlace:function(){var t,e=this,n=null==(t=this.ref("ds-header"))?void 0:t.el;if(n){var a=new IntersectionObserver((function(t){var n;t[0].isIntersecting&&(null==(n=e.ref("ds-header"))||n.sendLog("show"))}),{root:null,rootMargin:"0px",threshold:.6});a.observe(n)}},toggleContent:function(){this.data.set("isExpanded",!this.data.get("isExpanded"))},appendContent:function(t){var e;null==(e=this.ref("ds-context"))||e.appendContent(t)},stop:function(){var t;this.data.set("isThinkingDone",!0),this.data.set("isStopThinking",!0),null==(t=this.ref("ds-context"))||t.stopTyping()},typingFinished:function(){this.fire("typing-finished")}}),lf={};lf=Object.assign(lf,{dsContainer:"ds-container_husv5_1","ds-container":"ds-container_husv5_1"}),cf.template='\n    <div\n        class="{{$style[\'ds-container\']}}"\n    >\n        \x3c!--ds思考态--\x3e\n        <ds-header\n            s-ref="ds-header"\n            is-pc="{{isPc}}"\n            is-expanded="{{isExpanded}}"\n            is-thinking-done="{{isThinkingDone}}"\n            is-stop-thinking="{{isStopThinking}}"\n            on-ds-click="toggleContent"\n        ></ds-header>\n        \x3c!--思考内容--\x3e\n        <ds-context\n            s-show="isExpanded"\n            s-ref="ds-context"\n            content="{{dsContent}}"\n            typing="{{typing}}"\n            on-typing-finished="typingFinished"\n        />\n        <ds-thiking-tail\n            s-if="!isPc"\n            is-thinking-done="{{isThinkingDone}}"\n        ></ds-thiking-tail>\n    </div>\n';var df="function"==typeof cf?cf.prototype.initData||uf:cf.initData||uf;function uf(){return{$style:lf}}function pf(){return Object.assign({},df.call(this),{$style:lf})}function hf(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ff(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){hf(o,a,i,r,s,"next",t)}function s(t){hf(o,a,i,r,s,"throw",t)}r(void 0)}))}}function gf(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof cf?cf.prototype.initData=pf:cf.initData=pf;var mf=a.defineComponent({Lottie:null,initData:function(){return{picProcess:0,picLoadingDesc:"AI作图中",showPicLoading:!1,picLoadingExtend:!1,interval:null,picLoadingHeight:"auto",isPc:"pc"===rt()}},computed:{loadingDomStyle:function(){return{"padding-top":this.data.get("picLoadingHeight"),width:this.data.get("picLoadingHeight")}}},customNextTick:function(){return ff((function(){var t;return gf(this,(function(e){return t=this,[2,new Promise((function(e){t.nextTick((function(){e()}))}))]}))})).apply(this)},attached:function(){var e=this;new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){e.Lottie=t.default;var n={container:e.ref("brushDom"),renderer:"svg",loop:!0,autoplay:!0,path:"https://psstatic.cdn.bcebos.com/basics/chat/brush_1741693509000.json"};e.Lottie.loadAnimation(n)})),this.updateData({content:this.data.get("bindData")})},updateData:function(t){var e=this.el;if(t.clearLoading)this.clearPicLoading();else{var n=t.content;if(n){n.description&&this.data.set("picLoadingDesc",n.description);var a=n.ratio||"1-1";this.renderLottie(a);var i=this;setTimeout(ff((function(){var t,o,r;return gf(this,(function(s){switch(s.label){case 0:return i.data.set("showPicLoading",!0),[4,i.customNextTick()];case 1:return s.sent(),o=a.split("-"),r=i.data.get("isPc")?"456px":(+o[1]||1)/(+o[0]||1)*(null==(t=i.el)?void 0:t.clientWidth)+"px",i.data.set("picLoadingHeight",r),i.nextTick((function(){i.data.set("picLoadingExtend",!0),setTimeout((function(){i.incrementNumber(33)}),1e3),i.dispatch("pic-loading:set-height",null==e?void 0:e.clientHeight)})),+n.progress>i.data.get("picProcess")&&i.incrementNumber(+n.progress),i.fire("typing-finished","pic-loading"),[2]}}))})),this.data.get("showPicLoading")?0:500)}}},incrementNumber:function(t){var e=this;if(!(t<=this.data.get("picProcess"))){clearTimeout(this.data.get("interval"));var n=function(){e.data.set("picProcess",e.data.get("picProcess")+1),e.data.get("picProcess")<t&&e.data.set("interval",setTimeout(n,10))};this.data.set("interval",setTimeout(n,10))}},clearPicLoading:function(){this.data.set("showPicLoading",!1),this.data.set("picProcess",0),clearTimeout(this.data.get("interval"))},renderLottie:function(e){var n=this;if(!this.data.get("showPicLoading")){var a={container:this.ref("loadingDom"),renderer:"svg",loop:!0,autoplay:!0,path:ge.get(e)};this.Lottie?this.Lottie.loadAnimation(a):new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){n.Lottie=t.default,n.Lottie.loadAnimation(a)}))}},detached:function(){this.clearPicLoading()}}),vf={};vf=Object.assign(vf,{picLoading:"pic-loading_12rbp_1","pic-loading":"pic-loading_12rbp_1",picLoadingBrush:"pic-loading-brush_12rbp_9","pic-loading-brush":"pic-loading-brush_12rbp_9",picLoadingDesc:"pic-loading-desc_12rbp_17","pic-loading-desc":"pic-loading-desc_12rbp_17",answerBoxBorder:"answer-box-border_12rbp_27","answer-box-border":"answer-box-border_12rbp_27",picLoadingExtend:"pic-loading-extend_12rbp_33","pic-loading-extend":"pic-loading-extend_12rbp_33"}),mf.template='\n    <div\n        style="{{\'height:\' + picLoadingHeight + \';\'}}"\n        class="{{showPicLoading ? $style[\'answer-box-border\'] : \'\'}}"\n    >\n        <div\n            s-show="showPicLoading"\n            s-ref="loadingDom"\n            style="{{loadingDomStyle}}"\n            class="{{$style[\'pic-loading\']}} {{picLoadingExtend ? $style[\'pic-loading-extend\'] : \'\'}}"\n        >\n        </div>\n        <span s-if="showPicLoading" class="{{$style[\'pic-loading-desc\']}}">{{picProcess}}%</span>\n        <div\n            s-show="showPicLoading"\n            s-ref="brushDom"\n            class="{{$style[\'pic-loading-brush\']}}"\n        ></div>\n    </div>\n';var yf="function"==typeof mf?mf.prototype.initData||bf:mf.initData||bf;function bf(){return{$style:vf}}function wf(){return Object.assign({},yf.call(this),{$style:vf})}"function"==typeof mf?mf.prototype.initData=wf:mf.initData=wf;var _f={components:{"ai-markdown":e.Markdown},initData:function(){return{content:"",typing:null,isTypingEnd:!1,isTypingFinished:!1,normalizeContent:Wh,foldStatus:"fold",askUsedModel:{},usedModel:{}}},computed:{contentShowUbcLog:function(){var t,e;return JSON.stringify({valueInfo:[{component_name:"thinkingSteps"}],value:"answer_think",type:"show",enter_type:Je.getState("pcEnterType")||"ai_tab_url",ask_model:(null==(t=this.data.get("askUsedModel"))?void 0:t.modelName)||"hisUnknow",satisfy_model:(null==(e=this.data.get("usedModel"))?void 0:e.modelName)||""})}},stopTyping:function(){var t;this.data.get("isTypingEnd")&&(null==(t=this.ref("markdown"))||t.stop()),this.data.set("isTypingFinished",!0)},appendContent:function(t){this.ref("markdown").appendContent(t)},typingFinished:function(){this.data.set("isTypingEnd",!0),this.fire("typing-finished")}},kf={};kf=Object.assign(kf,{markdownContent:"markdown-content_1oju3_1","markdown-content":"markdown-content_1oju3_1",expand:"expand_1oju3_8",typingFinished:"typing-finished_1oju3_15","typing-finished":"typing-finished_1oju3_15"}),_f.template='\n    <div\n        class="\n            {{$style[\'markdown-content\']}}\n            {{foldStatus === \'fold\' ? \'\' : $style[\'expand\']}}\n            {{isTypingFinished ? $style[\'typing-finished\'] : \'\'}}\n        "\n        data-show-area\n        data-show-ext="{{contentShowUbcLog}}"\n    >\n        <ai-markdown\n            s-ref="markdown"\n            typing="{{typing}}"\n            content="{{content}}"\n            normalizeContent="{{normalizeContent}}"\n            on-typing-finished="typingFinished"\n        />\n    </div>\n';var Sf="function"==typeof _f?_f.prototype.initData||xf:_f.initData||xf;function xf(){return{$style:kf}}function If(){return Object.assign({},Sf.call(this),{$style:kf})}"function"==typeof _f?_f.prototype.initData=If:_f.initData=If;var Tf={components:{"cs-avatar":e.Avatar},initData:function(){return{referenceList:[],askUsedModel:{},usedModel:{}}},computed:{referenceListShowLogData:function(){var t,e;return JSON.stringify({type:"show",total_num:this.data.get("referenceList").length,page:"resultpage",value:"answer_origin",enter_type:Je.getState("pcEnterType")||"ai_tab_url",valueInfo:[{component_name:"thinkingSteps"}],ask_model:(null==(t=this.data.get("askUsedModel"))?void 0:t.modelName)||"hisUnknow",satisfy_model:(null==(e=this.data.get("usedModel"))?void 0:e.modelName)||""})}},handleReferenceClick:function(t,e,n){var a,i;this.dispatch("send-ubclog",{type:"click",page:"resultpage",value:"answer_origin",extra:{pos:e+1,content:n,url:t,enter_type:Je.getState("pcEnterType")||"ai_tab_url",valueInfo:[{component_name:"thinkingSteps"}],ask_model:(null==(a=this.data.get("askUsedModel"))?void 0:a.modelName)||"hisUnknow",satisfy_model:(null==(i=this.data.get("usedModel"))?void 0:i.modelName)||""}}),window.open(t,"_blank")}},Cf={};Cf=Object.assign(Cf,{referenceItem:"reference-item_1ztmo_1","reference-item":"reference-item_1ztmo_1",expand:"expand_1ztmo_7",title:"title_1ztmo_18",text:"text_1ztmo_26",delimiter:"delimiter_1ztmo_29",source:"source_1ztmo_32"}),Tf.template='\n    <div\n        data-show-area\n        data-show-ext="{{referenceListShowLogData}}"\n    >\n        <div\n            s-for="refItem, idx in referenceList"\n            class="{{$style[\'reference-item\']}} {{foldStatus === \'fold\' ? \'\' : $style[\'expand\']}}"\n        >\n            <cs-avatar src="{{refItem.icon}}" size="xs"></cs-avatar>\n            <div\n                on-click="handleReferenceClick(refItem.url, idx, refItem.text)"\n                class="{{$style[\'title\']}}"\n            >\n                <div class="{{$style[\'text\']}}">{{refItem.text}}</div>\n                <template s-if="{{refItem.source}}">\n                    <div class="{{$style[\'delimiter\']}}">-</div>\n                    <div class="{{$style[\'source\']}}">{{refItem.source}}</div>\n                </template>\n            </div>\n        </div>\n    </div>\n';var Lf="function"==typeof Tf?Tf.prototype.initData||Pf:Tf.initData||Pf;function Pf(){return{$style:Cf}}function Df(){return Object.assign({},Lf.call(this),{$style:Cf})}"function"==typeof Tf?Tf.prototype.initData=Df:Tf.initData=Df;var Af=a.defineComponent({initData:function(){return{status:"fold",hasSummary:!1}}}),Ef={};Ef=Object.assign(Ef,{thinkingStepsFold:"thinking-steps-fold_1d5jl_1","thinking-steps-fold":"thinking-steps-fold_1d5jl_1",thinkingStepsFoldContainer:"thinking-steps-fold-container_1d5jl_7","thinking-steps-fold-container":"thinking-steps-fold-container_1d5jl_7",thinkingStepsFoldFold:"thinking-steps-fold-fold_1d5jl_11","thinking-steps-fold-fold":"thinking-steps-fold-fold_1d5jl_11",showMask:"show-mask_1d5jl_19","show-mask":"show-mask_1d5jl_19"}),Af.template="\n    <div\n        class=\"{{$style['thinking-steps-fold']}}\n            {{status === 'fold' ? $style['thinking-steps-fold-fold'] : ''}}\n            {{status === 'fold' ? $style['show-mask'] : ''}}\n        \"\n    >\n        <div class=\"{{$style['thinking-steps-fold-container']}}\">\n            <slot />\n        </div>\n    </div>\n";var Of="function"==typeof Af?Af.prototype.initData||Rf:Af.initData||Rf;function Rf(){return{$style:Ef}}function Nf(){return Object.assign({},Of.call(this),{$style:Ef})}function qf(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Mf(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){qf(o,a,i,r,s,"next",t)}function s(t){qf(o,a,i,r,s,"throw",t)}r(void 0)}))}}function jf(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Af?Af.prototype.initData=Nf:Af.initData=Nf;var Bf=a.defineComponent({components:{"cs-fold":Af,"reasoning-context":_f,"reference-list":Tf,"cos-icon":e.Icon},initData:function(){return{showThinking:!1,title:"",titleIcon:"",couldExpand:!1,steps:[],referenceList:[],summary:"",curStep:"",foldStatus:"pc"===rt()?"fold":"unfold",typing:null,inThinking:!1,historyContent:"",reasoningContent:"",isTypingEnd:!1,askUsedModel:{},usedModel:{},finished:!1}},computed:{hasSummary:function(){return this.data.get("couldExpand")&&"fold"===this.data.get("foldStatus")&&(this.data.get("summary")||this.data.get("curStep"))},headerShowExt:function(){var t,e;return JSON.stringify({value:"answer_title",enter_type:Je.getState("pcEnterType")||"ai_tab_url",valueInfo:[{component_name:"thinkingSteps"}],ask_model:(null==(t=this.data.get("askUsedModel"))?void 0:t.modelName)||"hisUnknow",satisfy_model:(null==(e=this.data.get("usedModel"))?void 0:e.modelName)||""})}},toggleFold:function(){var t,e;if(this.data.get("couldExpand")){var n=this.data.get("foldStatus");this.data.set("foldStatus","fold"===n?"unfold":"fold");var a,i,o=this.data.get("title")||"";if(this.dispatch("send-ubclog",{type:"click",value:"fold"===n?"answer_title_open":"answer_title_close",extra:{enter_type:Je.getState("pcEnterType")||"ai_tab_url",valueInfo:[{component_name:"thinkingSteps"}],title:o,ask_model:(null==(t=this.data.get("askUsedModel"))?void 0:t.modelName)||"hisUnknow",satisfy_model:(null==(e=this.data.get("usedModel"))?void 0:e.modelName)||""}}),"fold"===n)this.dispatch("send-ubclog",{type:"show",value:"answer_content",extra:{enter_type:Je.getState("pcEnterType")||"ai_tab_url",valueInfo:[{component_name:"thinkingSteps"}],ask_model:(null==(a=this.data.get("askUsedModel"))?void 0:a.modelName)||"hisUnknow",satisfy_model:(null==(i=this.data.get("usedModel"))?void 0:i.modelName)||""}})}},typingFinished:function(){this.fire("typing-finished")},customNextTick:function(){return Mf((function(){var t;return jf(this,(function(e){return t=this,[2,new Promise((function(e){t.nextTick(e)}))]}))})).apply(this)},updateData:function(t,e){return void 0===e&&(e=!1),Mf((function(){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_;return jf(this,(function(k){switch(k.label){case 0:return n=t.title,a=void 0===n?"":n,i=t.titleIcon,o=void 0===i?"":i,r=t.couldExpand,s=void 0!==r&&r,c=t.steps,l=void 0===c?[]:c,d=t.referenceList,u=void 0===d?[]:d,p=t.reasoningContent,h=void 0===p?"":p,f=t.summary,g=void 0===f?"":f,m=t.status,this.data.set("showThinking",!0),a&&this.data.set("title",a),o&&this.data.set("titleIcon",o),s&&this.data.set("couldExpand",s),u.length&&(this.data.set("referenceList",u),this.fire("update-reference",u)),l.length?(this.data.set("steps",l),v=l[l.length-1].title,"referenceList"===l[l.length-1].component&&(y=this.data.get("referenceList"),b=y[y.length-1]||{},w=b.icon,_=b.text,v="<div style='flex-shrink: 0'>"+v+"</div><img style='border-radius: 50%' src=\""+w+"\" /><div style='white-space: nowrap; text-overflow: ellipsis; overflow: hidden'>"+_+"</div>"),this.data.set("curStep",v),[4,this.customNextTick()]):[3,2];case 1:k.sent(),k.label=2;case 2:return h&&(e?this.data.set("historyContent",h):(this.ref("markdown-content")&&this.ref("markdown-content").appendContent(h),this.data.get("inThinking")||this.data.set("inThinking",!0))),g&&(this.data.set("inThinking",!1),this.data.set("isTypingEnd",!0),this.data.set("summary",g),this.stop()),h&&!g||this.fire("typing-finished"),"finished"!==m&&"closed"!==m||this.finish(),[2]}}))})).apply(this)},appendReference:function(t){this.ref("markdown-content")&&this.ref("markdown-content").appendContent(t)},finish:function(){this.data.set("finished",!0)},stop:function(){this.ref("markdown-content")&&this.ref("markdown-content").stopTyping()},forceStop:function(t){var e="hint"===t?"回答已完成":"回答已暂停";this.data.set("title",e),this.stop(),this.finish()},attached:function(){var t=this.data.get();this.updateData(t,!t.typing)}}),Hf={};Hf=Object.assign(Hf,{thinkingSteps:"thinking-steps_1dozz_1","thinking-steps":"thinking-steps_1dozz_1",large:"large_1dozz_14",expand:"expand_1dozz_17",titleContainer:"title-container_1dozz_26","title-container":"title-container_1dozz_26",title:"title_1dozz_26",summary:"summary_1dozz_41",foldIcon:"fold-icon_1dozz_54","fold-icon":"fold-icon_1dozz_54",finished:"finished_1dozz_68",rotate:"rotate_1dozz_1",main:"main_1dozz_71",step:"step_1dozz_75",component:"component_1dozz_95",withExpand:"with-expand_1dozz_98","with-expand":"with-expand_1dozz_98",summaryTitle:"summary-title_1dozz_101","summary-title":"summary-title_1dozz_101"}),Bf.template='\n    <div\n        s-if="showThinking"\n        class="\n            {{$style[\'thinking-steps\']}}\n            {{couldExpand ? $style[\'large\'] : $style[\'tiny\']}}\n            {{foldStatus === \'fold\' ? \'\' : $style[\'expand\']}}\n            {{finished ? $style[\'finished\'] : \'\'}}\n        "\n        disable-copy\n    >\n        <header\n            data-show-area\n            data-show-ext="{{headerShowExt}}"\n            on-click="toggleFold()"\n        >\n            <div class="{{$style[\'title-container\']}}">\n                <img src="{{titleIcon}}" />\n                <div class="{{$style[\'title\']}}">{{ title }}</div>\n            </div>\n            <div s-if="{{hasSummary && !inThinking}}" class="{{$style[\'summary\']}}">\n                \x3c!-- bca-disable-next-line --\x3e\n                {{(summary || curStep) | raw}}\n            </div>\n            <div\n                s-if="couldExpand"\n                class="{{$style[\'fold-icon\']}}"\n            >\n                <cos-icon name="{{foldStatus === \'fold\' ? \'down\' : \'up\'}}"/>\n            </div>\n        </header>\n        <cs-fold\n            s-if="{{couldExpand && steps.length}}"\n            s-show="{{foldStatus === \'unfold\' || inThinking}}"\n            status="{{foldStatus}}"\n            has-summary="{{hasSummary}}"\n            class="{{$style[\'main\']}}"\n        >\n            <div s-for="step in steps" class="{{$style[\'step\']}}">\n                <div s-if="{{foldStatus === \'unfold\'}}" class="{{$style[\'title\']}}">\n                    {{ step.title }}\n                </div>\n                <template s-if="step.component">\n                    <reference-list\n                        s-if="{{step.component === \'referenceList\' && foldStatus === \'unfold\'}}"\n                        class="{{$style[\'component\']}}"\n                        reference-list="{{referenceList}}"\n                        fold-status="{{foldStatus}}"\n                        ask-used-model="{{askUsedModel}}"\n                        used-model="{{usedModel}}"\n                    />\n                    <reasoning-context\n                        s-if="step.component === \'reasoningContent\'"\n                        s-ref="markdown-content"\n                        class="{{$style[\'component\']}}"\n                        typing="{{typing}}"\n                        content="{{historyContent}}"\n                        fold-status="{{foldStatus}}"\n                        on-typing-finished="typingFinished"\n                        is-typing-end="{{isTypingEnd}}"\n                        ask-used-model="{{askUsedModel}}"\n                        used-model="{{usedModel}}"\n                    />\n                </template>\n            </div>\n        </cs-fold>\n    </div>\n';var $f="function"==typeof Bf?Bf.prototype.initData||Uf:Bf.initData||Uf;function Uf(){return{$style:Hf}}function Ff(){return Object.assign({},$f.call(this),{$style:Hf})}function Gf(){return Gf=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Gf.apply(this,Array.from(arguments))}"function"==typeof Bf?Bf.prototype.initData=Ff:Bf.initData=Ff;var Wf=a.defineComponent({components:{"cos-video-player":e.RichVideoPlayer},computed:{videoData:function(){var t,e=this.data.get("bindData")||{},n=e.videoData,a=(void 0===n?{}:n).video,i=e.url;return a&&{poster:a.poster,src:a.src,duration:a.duration,autoplay:a.playType,vid:null==(t=a.options)?void 0:t.vid,fullscreenLinkInfo:{href:i}}},realShowExt:function(){return JSON.stringify({value:"nonala_cpt",component_content:{component_name:"generalVideo"}})}},initData:function(){return{bindData:{},playerDurationRecords:[],playRatio:0,addNewPlayingDuration:!0,touchStartTime:0}},created:function(){Rp()},attached:function(){this.fire("render-finished")},handleTouchstart:function(){this.data.set("touchStartTime",Date.now())},handleTouchend:function(t){var e=this.data.get("touchStartTime");Date.now()-e>500&&(t.preventDefault(),t.stopPropagation())},handleActionLogEvent:function(t){var e,n;t.component?this.fire("action-log-event",t):"only-csr"===(null==(n=this.data.get("bindData"))||null==(e=n.context)?void 0:e.renderMode)&&this.fire("action-log-event",{component:"generalVideo",actionType:"na"})},handlePlayerInstanceCreate:function(t){var e,n=this;this.data.set("vid",null==(e=this.data.get("videoData"))?void 0:e.vid),this.data.set("instance",t),t&&(t.on("timeupdate",(function(){n.handlePlayerTimeUpdate()})),t.on("playing",(function(){n.handlePlayerPlaying(!0)})),t.on("pause",(function(){n.handlePlayerPlaying(!1)})),t.on("destroy",(function(){n.handlePlayerPlaying(!1)})),t.on("voiceBtnClicked",(function(t){var e=t.muted?"Off":"Open";n.handleActionLogEvent({component:"generalVideo",actionType:"b",ext:{action:"voice_"+e}})})))},handlePlayerTimeUpdate:function(){var t=this.data.get("instance"),e=this.data.get("vid"),n=(null==t?void 0:t.duration)||1/0,a=(null==t?void 0:t.currentTime)||0;if(this.data.get("addNewPlayingDuration"))this.data.push("playerDurationRecords",[a,a]),this.data.set("addNewPlayingDuration",!1);else{var i=this.data.get("playerDurationRecords")||[[0,0]];this.data.set("playerDurationRecords."+(i.length-1)+".1",a)}var o=this.calcPlayerDuaration(),r="",s=Math.floor(o/n*100),c=this.data.get("playRatio")||0;c<30&&30===s?(this.data.set("playRatio",30),r="generalVideo30"):c<50&&50===s?(this.data.set("playRatio",50),r="generalVideo50"):c<80&&80===s&&(this.data.set("playRatio",80),r="generalVideo80"),r&&this.fire("ubc-log-event",{type:"show",value:r,page:"resultpage",extra:{valueInfo:[{component_name:"generalVideo"}],nid:e}})},calcPlayerDuaration:function(){var t=(this.data.get("playerDurationRecords")||[[0,0]]).slice();t.sort((function(t,e){return t[0]-e[0]}));for(var e=0,n=t[0],a=1;a<t.length;a++){var i=t[a];n[1]>=i[0]?n[1]=Math.max(n[1],i[1]):(e+=n[1]-n[0],n=i)}return e+=n[1]-n[0]},handlePlayerDraggingEnd:function(t){var e,n,a=(null==(e=this.data.get("videoData"))?void 0:e.duration)*t/100||0;this.data.push("playerDurationRecords",[a,a]),qd({component:"generalVideo",actionType:"scroll",ext:{action:"generalVideo_slide",nid:this.data.get("vid")}},Gf({},this.data.get("tplInfo"),{tplname:"nonala_cpt"}),{},null==(n=this.ref("player"))?void 0:n.el)},handlePlayerPlaying:function(t){var e=this.data.get("instance");if(null==e||e.currentTime,t)this.data.set("playingTime",Date.now()),this.data.set("addNewPlayingDuration",!0);else{this.data.set("pauseTime",Date.now());var n=this.data.get("playingTime"),a=this.data.get("pauseTime");this.fire("ubc-log-event",{ubcId:"17630",value:"generalVideo_play",page:"resultpage",extra:{nid:this.data.get("vid"),starttime:n,endtime:a,duration:a-n}})}}});function zf(t){if(t){var e=t.closest("[data-click-log]");if(e){var n={};try{var a;n=(null==(a=JSON.parse(e.getAttribute("data-click-log")))?void 0:a.extra)||{}}catch(t){console.error(t)}return n}}}function Qf(t,e){return t}function Jf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Vf(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Kf(){return Kf=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Kf.apply(this,Array.from(arguments))}function Xf(t,e){return Xf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xf(t,e)}function Yf(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Jf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jf(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zf(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Wf.template='\n    <div\n        s-if="bindData"\n        s-is="{{bindData.url ? \'a\' : \'div\'}}"\n        href="{{bindData.url}}"\n        class="cos-block"\n    >\n        <cos-video-player\n            s-ref="player"\n            attr-data-show-area\n            attr-data-show-ext="{{realShowExt}}"\n            s-bind="{{videoData}}"\n            on-created="handlePlayerInstanceCreate"\n            on-seeked="handlePlayerDraggingEnd"\n            on-click="native:handleActionLogEvent"\n            on-touchstart ="native:handleTouchstart"\n            on-touchend ="native:handleTouchend"\n        ></cos-video-player>\n    </div>\n';var tg=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).listenOpenHalfScreenByUiJson=null,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xf(t,e)}(e,t);var n=e.prototype;return n.updateData=function(t){var e=this;try{var n=this.data.get("uiInstance");if(!n)return;if(t&&t.isEmptyPack||!Object.keys(t).length)return void this.fire("render-finished");n.updateData(function(t){return Qf(t)}(t),(function(){e.renderFinished()})),this.data.set("show",!0)}catch(t){console.error(t),en(t,{group:"uijson-error"}),this.fire("render-finished")}},n.lastUiJsonDone=function(){this.data.get("uiInstance").setStatus("finished")},n.initData=function(){return{show:!1,index:-1,history:!1,uijsonHidden:!1}},n.handleUiMeta=function(){var t,e=this;return(t=function(){var t,n,a,i,o,r,c;return Zf(this,(function(l){return n={type:"chat-view",platform:"pc"===rt()?"pc":"wise"},a={apis:xo(),env:n},So(a),s.sdk.init({env:n,showProgress:!0,apis:xo()}),i=e.data.get("historyUiData"),o=!!i,i&&e.data.set("history",o),(r=Qf(e.data.get("")))&&r.component?(c=s.sdk.renderMessage(e.ref("content"),{uiMeta:r,onRenderCompleted:e.renderFinished.bind(e),onAttach:e.handleHistoryData.bind(e),history:o,markdownOptions:{typingMode:"all"},disposeAfterSubmitClueForm:!0,useRichVideoPlayer:!0,renderContext:{renderContextId:e.data.get("rank"),query:null==(t=e.data.get("tplInfo"))?void 0:t.query},events:{"agent-ui-prompt":function(t){var n,a=(null==(n=t.arg)?void 0:n.data)||{},i=a.msg,o=a.extData;o&&e.dispatch("update-agent-info",o),i&&Ar({query:i})},"agent-ui-open-drawer":function(t){var n,a,i=null==t||null==(n=t.arg)?void 0:n.data,o=i.percent,r=i.title,s=i.url;e.dispatch("open-half-screen",{halfScreenPercent:o,title:r,url:s,board_from:null==t||null==(a=t.arg)?void 0:a.type})},"agent-ui-preview-image":function(t){var n,a=null==t?void 0:t.arg,i=a.data,o=a.type,r=null==i||null==(n=i.$event)?void 0:n.src;if(r){var s=function(t){if(t){var e=t.closest(".chat-search-answer-generate")||t.closest(".history-answer-box"),n=e&&e.querySelectorAll("img.agent-ui-image-item");return n&&Array.from(n).filter((function(t){return t.closest(".agent-ui-image")})).map((function(t){return t.src}))}return null}(e.el),c=Array.isArray(s)&&0!==s.length&&s||[i.$event.src];wh(c,c.indexOf(r),o||"ai_image")}},"agent-ui-log":function(t){var n=t.arg.data.$event||{},a=t.arg.type,i=t.arg.show,o=n.ext||{},r=n.cs_value||n.value,s=o.cs_action_type||o.action_type,c=o.cs_component_name||o.component_name;if("goods-card"!==a&&"site-vcard"!==a&&"more-link"!==a&&"base-clue-form"!==a&&"shop-card"!==a||"display"!==i&&"recall"!==n.type){var l;if("site-vcard"===a&&"click"===n.type)return void e.dispatch("send-log",{cyc:1,extra:Kf({},o,{action_type:s,component_name:c}),target:null==(l=t.arg.data.$data)?void 0:l.target,type:"l"});if("exposure"!==i)e.dispatch("send-ubclog",{type:n.type,value:r,extra:Kf({},o,{action_type:s,component_name:c})});else{var d=e.data.get("baseLogData");d||(d=zf(e.el),e.data.set("baseLogData",d));var u=[o.component_content||{}],p=o.agent_id||(null==d?void 0:d.agent_id),h=o.agent_name||(null==d?void 0:d.agent_name);Aa({type:n.type,value:r,ext:Kf({},o,{action_type:s},d,{valueInfo:u,agentId:p,agentName:h,value:r,component_name:c})})}}}}}),e.data.set("uiInstance",c),[2]):(e.data.set("uijsonHidden",!0),e.fire("render-finished"),[2])}))},function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Vf(o,a,i,r,s,"next",t)}function s(t){Vf(o,a,i,r,s,"throw",t)}r(void 0)}))})()},n.handleHistoryData=function(){var t=this.data.get("historyUiData");if(Array.isArray(t))for(var e,n=Yf(t);!(e=n()).done;){var a=e.value;this.updateData(a)}},n.renderFinished=function(){this.fire("render-finished")},n.attached=function(){var t=this;try{this.handleUiMeta(),this.listenOpenHalfScreenByUiJson=function(e){var n=e.rank,a=e.halfScreenData;if(n===t.data.get("rank")){var i=a.percent,o=a.title,r=a.url,s=a.type;t.dispatch("open-half-screen",{halfScreenPercent:i,title:o,url:r,board_from:s})}},va().on(this.listenOpenHalfScreenByUiJson)}catch(t){console.error(t),en(t,{group:"uijson-error"}),this.fire("render-finished")}},n.disposed=function(){this.listenOpenHalfScreenByUiJson&&(va().off(this.listenOpenHalfScreenByUiJson),this.listenOpenHalfScreenByUiJson=null)},e}(a.Component);tg.template='\n        <div\n            enableHotspot\n            on-click="handleClick"\n            data-module="ai_uijson"\n            data-show="component"\n            data-show-ext="{{realShowExt}}"\n            data-show-area\n            class="{{index === 0 && !show ? \'first-cmpt-none\' : \'\'}} {{uijsonHidden ? \'uijson-hidden\' : \'\'}}"\n        >\n            <div class="eb-plugin-ui" s-ref="content"></div>\n        </div>\n    ',tg.computed={realShowExt:function(){return JSON.stringify({component_content:{component_name:"uijson"}})}};var eg,ng,ag,ig,og,rg,sg,cg,lg,dg,ug,pg=function(){return pg=Object.assign||function(t){for(var e,n=1,a=Array.from(arguments).length;n<a;n++)for(var i in e=Array.from(arguments)[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},pg.apply(this,Array.from(arguments))};function hg(t){return{lower:t.toLowerCase().split("").map((function(t){return t.charCodeAt(0)})),upper:t.toUpperCase().split("").map((function(t){return t.charCodeAt(0)})),length:t.length}}"function"==typeof SuppressedError&&SuppressedError,function(t){t.Text="Text",t.Tag="Tag"}(eg||(eg={}));var fg=hg("!doctype"),gg=hg("style"),mg=hg("script");function vg(){return 32===cg||10===cg||9===cg||9===cg||13===cg||12===cg}function yg(t){ng=0,ag=t,ig=t.length,og=0,rg=0,sg=[],lg=!1,dg=!1,ug=0}function bg(t,e,n){void 0===e&&(e=ng),void 0===n&&(n=rg);var a=ag.substring(og,n);1!==t&&3!==t||(a=a.toLowerCase()),1===t&&("script"===a?lg=!0:"style"===a&&(dg=!0)),3===t&&(lg=dg=!1),(0!==t&&4!==t||n!==og)&&sg.push({type:t,start:og,end:n,value:a}),2===t||3===t?(og=n+1,ng=0):(og=n,ng=e)}function wg(){60===cg&&bg(0,1)}function _g(){lg||dg?47===cg?(ng=14,og=rg+1):ng=0:cg>=97&&cg<=122||cg>=65&&cg<=90?(ng=2,og=rg):47===cg?(ng=14,og=rg+1):60===cg?bg(0):33===cg?(ng=8,og=rg):63===cg?(og=rg,bg(1,12)):ng=0}function kg(){vg()?bg(1,3):62===cg?(bg(1),bg(2)):47===cg&&bg(1,7)}function Sg(){62===cg?(bg(4),bg(2)):47===cg?bg(4,7):61===cg?(bg(4),bg(5,void 0,rg+1)):39===cg?bg(4,5):34===cg?bg(4,6):vg()||bg(4,4)}function xg(){62===cg?(bg(6),bg(2)):47===cg?bg(6,7):61===cg?(bg(6),bg(5,3,rg+1)):vg()&&bg(6,3)}function Ig(){39===cg&&bg(7,3,rg+1)}function Tg(){34===cg&&bg(8,3,rg+1)}function Cg(){62===cg?bg(2):(bg(6,3),Sg())}function Lg(){switch(cg){case 45:ng=10;break;case 100:case 68:ng=9;break;default:bg(1,12)}}function Pg(){(ug=rg-og)===fg.length?vg()?bg(1,3):Ng():62===cg?(bg(1,void 0,og+1),bg(0),bg(2)):fg.lower[ug]!==cg&&fg.upper[ug]!==cg&&bg(1,12,og+1)}function Dg(){45===cg?bg(1,11,rg+1):bg(1,12,og+1)}function Ag(){45===cg&&bg(0,13)}function Eg(){62===cg&&(bg(0),bg(2))}function Og(){2===(ug=rg-og)?62===cg?bg(2):45===cg?bg(0,void 0,og+1):ng=11:45!==cg&&(ng=11)}function Rg(){ug=rg-og,dg?60===cg?(og-=2,bg(0,1)):ug<gg.length?gg.lower[ug]!==cg&&gg.upper[ug]!==cg&&(og-=2,ng=0):62===cg?bg(3):vg()||(og-=2,ng=0):lg?60===cg?(og-=2,bg(0,1)):ug<mg.length?mg.lower[ug]!==cg&&mg.upper[ug]!==cg&&(og-=2,ng=0):62===cg?bg(3):vg()||(og-=2,ng=0):62===cg&&bg(3)}function Ng(){throw new SyntaxError('Unexpected token "'+ag.charAt(rg)+'" at '+rg+" when parse "+ng)}function qg(t,e){return t.split(",").reduce((function(t,n){return t[n]=e,t}),Object.create(null))}var Mg,jg,Bg,Hg,$g,Ug,Fg,Gg,Wg,zg,Qg=qg("area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr,!doctype,,!,!--",!0),Jg=qg("li,option,select,textarea",!0);function Vg(t,e,n,a){if(a.enter&&a.enter(t,e,n),t.type===eg.Tag&&Array.isArray(t.body))for(var i=0;i<t.body.length;i++)Vg(t.body[i],t,i,a);a.leave&&a.leave(t,e,n)}function Kg(t,e){void 0===t?(jg=0,Bg.length=0,Gg=""):(Bg=function(t){for(yg(t);rg<ig;){switch(cg=ag.charCodeAt(rg),ng){case 0:wg();break;case 1:_g();break;case 2:kg();break;case 3:Sg();break;case 4:xg();break;case 5:Ig();break;case 6:Tg();break;case 7:Cg();break;case 8:Lg();break;case 9:Pg();break;case 10:Dg();break;case 11:Ag();break;case 12:Eg();break;case 13:Og();break;case 14:Rg();break;default:Ng()}rg++}switch(ng){case 0:case 1:case 4:case 5:case 6:case 7:case 11:case 12:case 13:bg(0);break;case 2:bg(1);break;case 3:break;case 8:bg(1,12);break;case 9:rg-og===fg.length?bg(1):(bg(1,void 0,og+1),bg(0));break;case 10:rg-og==2?bg(1):(bg(1,void 0,og+1),bg(0));break;case 14:bg(3)}var e=sg;return yg(""),e}(t),jg=Bg.length,Gg=t),Mg=0,Hg=void 0,$g=[],Ug=void 0,Fg=void 0,Wg=void 0,zg=e}function Xg(t){Hg?t.type===eg.Tag&&t.name===Hg.tag.name&&Jg[t.name]?(Hg=Hg.parent,Xg(t)):Hg.tag.body&&(Hg.tag.end=t.end,Hg.tag.body.push(t)):$g.push(t)}function Yg(t){Hg={parent:Hg,tag:t},Fg=void 0}function Zg(t,e,n){return void 0===t&&(t=Ug.start),void 0===e&&(e=Ug.end),void 0===n&&(n=Ug.value),{start:t,end:e,value:n,type:eg.Text}}function tm(){return{start:Ug.start,end:Ug.end,name:Zg(),value:void 0}}function em(t){void 0===t&&(t=Fg),t.value+=Ug.value,t.end=Ug.end}function nm(){void 0===Wg&&(Wg=Gg.split("\n").reduce((function(t,e){return t.push(e.length+1+t[t.length-1]),t}),[0]));var t=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var a,i,o=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=o.next()).done;)r.push(a.value)}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}(function(t,e){for(var n=NaN,a=NaN,i=1;i<t.length;i++)if(t[i]>e){n=i,a=e-t[i-1]+1;break}return[n,a]}(Wg,Ug.start),2),e=t[0],n=t[1];throw new Error('Unexpected token "'+Ug.value+"("+Ug.type+')" at ['+e+","+n+"]"+(Hg?" when parsing tag: "+JSON.stringify(Hg.tag.name)+".":""))}function am(t){var e,n;t.attributeMap={};try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],a=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t.attributes),i=a.next();!i.done;i=a.next()){var o=i.value;t.attributeMap[o.name.value]=o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}function im(){var t=0,e=void 0,n={start:Ug.start-1,end:Ug.end,type:eg.Tag,open:Zg(Ug.start-1),name:Ug.value,rawName:Gg.substring(Ug.start,Ug.end),attributes:[],attributeMap:void 0,body:null,close:null};if(Xg(n),""===n.name||"!"===n.name||"!--"===n.name){if(n.open.value="<"+n.open.value,Mg===jg)return;if(2!==(Ug=Bg[++Mg]).type)for(Fg=Zg(),n.body=[Fg];++Mg<jg;){if(2===(Ug=Bg[Mg]).type){Fg=void 0;break}em()}return n.close=Zg(Ug.start,Ug.end+1,Ug.value+">"),void(n.end=n.close.end)}for(;++Mg<jg;){if(2===(Ug=Bg[Mg]).type){n.end=n.open.end=Ug.end+1,n.open.value=Gg.substring(n.open.start,n.open.end),""!==Ug.value||Qg[n.name]?n.body=void 0:(n.body=[],Yg(n));break}0===t?4!==Ug.type&&(e=tm(),t=1,n.attributes.push(e)):1===t?4===Ug.type?t=2:5===Ug.type?t=3:em(e.name):2===t?4!==Ug.type&&(5===Ug.type?t=3:(e=tm(),t=1,n.attributes.push(e))):3===t?4!==Ug.type&&(e.value={start:Ug.start,end:Ug.end,value:6===Ug.type?Ug.value:Ug.value.substr(1,Ug.value.length-2),quote:6===Ug.type?void 0:7===Ug.type?"'":'"'},6===Ug.type?t=4:(e.end=e.value.end,t=0)):4===Ug.type?(e.end=e.value.end,t=0):em(e.value)}}function om(){for(var t=Hg;t&&Ug.value.trim()!==t.tag.name;)t=t.parent;t&&(t.tag.close=Zg(Ug.start-2,Ug.end+1,Gg.substring(Ug.start-2,Ug.end+1)),t.tag.end=t.tag.close.end,t=t.parent,Hg=t)}function rm(t,e){for(Kg(t,pg({setAttributeMap:!1},e));Mg<jg;){switch((Ug=Bg[Mg]).type){case 0:Fg?em(Fg):Xg(Fg=Zg());break;case 1:Fg=void 0,im();break;case 3:Fg=void 0,om();break;default:nm()}Mg++}var n=$g;return(null==zg?void 0:zg.setAttributeMap)&&function(t,e){for(var n=0;n<t.length;n++)Vg(t[n],void 0,n,e)}(n,{enter:function(t){t.type===eg.Tag&&am(t)}}),Kg(),n}var sm={allowedTags:["a","abbr","address","area","article","aside","b","bdi","bdo","big","blockquote","br","button","caption","cite","code","col","colgroup","data","dd","del","dfn","div","dl","dt","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","ins","kbd","label","li","main","map","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","small","span","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","u","ul","var","wbr"],allowedAttrs:["style"],tagAllowedAttrs:{a:["href","target"],img:["src"],td:["rowspan","colspan"],th:["rowspan","colspan"],time:["datetime"],colgroup:["span"],col:["span"]},allowedUrl:/^(?:mailto|tel|https?|ftp|[^:]*[^a-z0-9.+-][^:]*):|^[^:]*$/i};function cm(t,e){void 0===e&&(e={});var n=pg(pg(pg({},sm),e),{tagAllowedAttrs:pg(pg({},sm.tagAllowedAttrs),e.tagAllowedAttrs)});return lm(rm(t),n,t)}function lm(t,e,n){return t.map((function(t){if(t.type===eg.Text)return t.value;if(-1===e.allowedTags.indexOf(t.name))return"";if(Qg[t.name]){if(void 0!==t.body)throw new Error('self closed tag "'+t.name+'" should not have body')}else if(!t.body||!t.close)throw new Error('tag "'+t.name+'" should have body and close');var a=t.attributes.filter((function(n){var a;return(e.allowedAttrs.indexOf(n.name.value)>-1||(null===(a=e.tagAllowedAttrs[t.name])||void 0===a?void 0:a.indexOf(n.name.value))>-1)&&(!n.value||("src"!==n.name.value&&"href"!==n.name.value||!!e.allowedUrl.test(n.value.value)))})).map((function(t){return n.substring(t.start,t.end)})).join(" "),i="<"+t.rawName+(a?" "+a:"")+">";return t.body?i+lm(t.body,e,n)+"</"+t.rawName+">":i})).join("")}var dm={allowedTags:["a","abbr","address","area","article","aside","b","bdi","bdo","big","blockquote","br","button","caption","cite","code","col","colgroup","data","dd","del","dfn","div","dl","dt","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","ins","kbd","label","li","main","map","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","small","span","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","u","ul","var","wbr"],allowedAttrs:["class","style"],tagAllowedAttrs:{a:["target"],img:["src"],td:["rowspan","colspan"],th:["rowspan","colspan"],time:["datetime"],colgroup:["span"],col:["span"]},allowedUrl:/^(?:mailto|tel|https?|ftp|[^:]*[^a-z0-9.+-][^:]*):|^[^:]*$/i};function um(t,e){return cm(t,e?Object.assign({},dm,e):dm)}function pm(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function hm(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var fm=a.defineComponent({trimWhitespace:"all",initData:function(){return{content:[]}},attached:function(){var t=this,e=this.data.get("content");e&&e.forEach((function(e){var n,a,i=e.value;if(i&&um)try{e.value=um(i)}catch(o){n=o,(null!=(a=Error)&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?a[Symbol.hasInstance](n):n instanceof a)&&(e.value=t.handleSafeHtmlError(o,i))}})),this.handleMathJax(),this.fire("render-finished")},handleSafeHtmlError:function(t,e){if(t.message.indexOf("should have body and close")>-1)return e.replace(/<\/?[^>]+>/g,"")},loadJs:function(t){return new Promise((function(e,n){if(document.getElementById("math-jax-script"))e();else{var a=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src=t,i.async=!0,i.id="math-jax-script",a.parentNode.insertBefore(i,a),i.onload=function(){e(i=null)},i.onerror=function(t){i=null,n(t)}}}))},handleMathJax:function(){return(t=function(){var t,e;return hm(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.loadJs("//yy-s.zuoyebang.cc/static/mathjax_274_for-test/MathJax.js?config=update190725-1")];case 1:return n.sent(),e=this.el,null==(t=window.MathJax)||t.Hub.Queue(["Typeset",window.MathJax.Hub,e]),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))},function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){pm(o,a,i,r,s,"next",t)}function s(t){pm(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var t}}),gm={};gm=Object.assign(gm,{examQa:"exam-qa_1ip7j_1","exam-qa":"exam-qa_1ip7j_1",examQaItem:"exam-qa-item_1ip7j_15","exam-qa-item":"exam-qa-item_1ip7j_15",examQaItemTitle:"exam-qa-item-title_1ip7j_22","exam-qa-item-title":"exam-qa-item-title_1ip7j_22"}),fm.template='\n    <div class="{{$style[\'exam-qa\']}}">\n        <div\n            s-for="item in content"\n            class="{{$style[\'exam-qa-item\']}}"\n        >\n            <div class="{{$style[\'exam-qa-item-title\']}}">{{item.title}}</div>\n            \x3c!--bca-disable-next-line--\x3e\n            <div class="{{$style[\'exam-qa-item-value\']}}">{{item.value | raw}}</div>\n        </div>\n    </div>\n';var mm="function"==typeof fm?fm.prototype.initData||vm:fm.initData||vm;function vm(){return{$style:gm}}function ym(){return Object.assign({},mm.call(this),{$style:gm})}function bm(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function wm(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){bm(o,a,i,r,s,"next",t)}function s(t){bm(o,a,i,r,s,"throw",t)}r(void 0)}))}}function _m(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof fm?fm.prototype.initData=ym:fm.initData=ym;var km=function(){return!dt()&&Fi(Ui(),"13.76")>=0},Sm=wm((function(t){var e,n,a,i,o,r,s,c,l,d,u,p;return _m(this,(function(h){switch(h.label){case 0:return e=t.content,n=t.title,a=t.lid,i={method:"POST",cors:!0,withCredentials:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({lid:a+"",data:JSON.stringify({content:e,title:n}),scene:"baidu_edu"})},[4,fetch("https://easylearn.baidu.com/edu-web-go/aichat/cache",i)];case 1:return[4,h.sent().json()];case 2:if(o=h.sent(),s=(r=o||{}).errno,c=r.errmsg,l=r.data,d=(void 0===l?{}:l).cacheKey,u=void 0===d?"":d,0!==s||!u)throw new Error(c||"缓存作文数据失败");return p="https://easylearn.baidu.com/edu-page/composition/editor?cacheKey="+u+"&logid="+a,On().conversation.openCompositionEditor.emit({url:p}),[2]}}))})),xm=a.defineComponent({editor:null,editorTool:{},controlKeys:["Backspace","Delete","Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],components:{"ai-markdown":e.Markdown,"cos-icon":e.Icon},initData:function(){return{title:"",content:"",isEnd:!1,typing:{speed:30},typingFinished:!1,suffix:"",markdownTotalWord:0,totalWord:0,referenceList:[],titleMaxLength:12,type:"text",markdownValue:"",checked:!1}},listenTextChange:null,attached:function(){var e=this,n=this.data.get("typing");!n&&this.data.set("typingFinished",!0),!n&&this.data.set("isEnd",!0),this.fire("typing-finished"),this.data.set("markdownValue",this.data.get("content")),this.data.set("titleValue",this.data.get("title")),new Promise((function(e,n){t(["./qeditor.pc.BpWzuvbh"],e,n)})).then((function(t){return t.index_umd})).then((function(t){var n=t.Quill,a=t.toDelta,i=t.fromDelta;e.editor=new n(e.ref("edit-container"),{placeholder:"输入一些内容吧～"}),e.editorTool={toDelta:a,fromDelta:i},e.listenTextChange=function(t,n,a){var i,o=(null==(i=e.editor)?void 0:i.getLength())-1;e.data.set("totalWord",o+e.data.get("titleValue").length)},e.editor.on("text-change",e.listenTextChange)})),this.editorTouchHandle=this.touchStartHandler.bind(this),window.addEventListener("click",this.editorTouchHandle,!0),this.watch("titleValue",(function(t){var n;(void 0===t&&(t=""),"editor"===e.data.get("type"))&&e.data.set("totalWord",t.length+(null==(n=e.editor)?void 0:n.getLength())-1)})),this.nextTick((function(){e.updateTotalWord()}))},disposed:function(){window.removeEventListener("click",this.editorTouchHandle,!0),this.listenTextChange&&(this.editor.off("text-change",this.listenTextChange),this.listenTextChange=null)},typingFinishedHandle:function(){this.updateTotalWord(),this.data.set("typingFinished",!0),this.fire("typing-finished")},updateTotalWord:function(){var t,e=this.data.get("title")||"",n=this.ref("markdown").el,a=(null==n||null==(t=n.querySelector(".cosd-markdown-content"))?void 0:t.textContent)||"",i=e.replace(/[\r\n\t]+/g,"").trim(),o=a.replace(/[\r\n\t]+/g,"").trim(),r=/[\u4e00-\u9fa5]/.test(o)?o.replace(/\s+/g,"").length+i.replace(/\s+/g,"").length:o.split(/\s+/).length+i.split(/\s+/).length;this.data.set("totalWord",r),this.data.set("markdownTotalWord",r)},appendContent:function(t,e){void 0===t&&(t="");var n=e.isEnd,a=void 0!==n&&n;this.data.set("isEnd",a);var i=this.ref("markdown");(null==i?void 0:i.appendContent)&&i.appendContent(t),this.data.set("typingFinished",!1);var o=this.data.get("markdownValue");this.data.set("markdownValue",o+t)},stop:function(){var t=this.ref("markdown");(null==t?void 0:t.stop)&&t.stop()},textToEditor:function(){var t,e,n=null==(t=this.editorTool)?void 0:t.toDelta(this.data.get("markdownValue"));null==(e=this.editor)||e.setContents(n),this.data.set("titleValue",this.data.get("title"))},handleTitleKeyDown:function(t){if(null==t?void 0:t.key){var n=this.data.get("titleMaxLength");!this.controlKeys.includes(t.key)&&this.data.get("titleValue").length>=n&&e.Toast.show({message:"标题最多输入"+n+"字哦～"})}},handleCancleEdit:function(t,e){var n;void 0===e&&(e=!1),e||this.fire("action-log-event",{component:"writing",actionType:"b",ext:{target:null==t?void 0:t.target}});var a=null==(n=localStorage)?void 0:n.getItem("writingEditQuitNoTips");if(e||"1"===a)return this.data.set("type","text"),this.data.set("totalWord",this.data.get("markdownTotalWord")),void this.dispatch("writing:cancel-edit");this.dispatch("writing:cancel-edit",{showDialog:!0})},handleCopy:function(t){var e;if(this.data.get("totalWord")){var n=this.data.get("titleValue"),a=(n?n+"\n":"")+(null==(e=this.editor)?void 0:e.getText());this.dispatch("writing:copy",{text:a}),this.fire("action-log-event",{component:"writing",actionType:"b",ext:{target:null==t?void 0:t.target}})}},touchStartHandler:function(t){var e,n=null==t||null==(e=t.target)?void 0:e.closest('[data-module^="edit"]'),a=null==n?void 0:n.getAttribute("data-cid"),i=this.data.get("type"),o=this.data.get("cid");if("editor"===i&&a&&a!==o)this.handleCancleEdit(t,!0);else{if("text"!==i||!a||!o||a!==o)return;var r,s;if(km())return void Sm({title:this.data.get("title"),content:this.data.get("markdownValue"),lid:o});this.textToEditor(),this.data.set("type","editor");var c=(null==(r=this.editor)?void 0:r.getLength())||0;null==(s=this.editor)||s.setSelection(c,0),this.scrollToView(t)}},scrollToView:function(t){var e,n=this,a=null==t||null==(e=t.target)?void 0:e.closest(".cos-swiper-content");if(a){var i=a.style.overflow;a.style.overflow="visible",setTimeout((function(){var t=n.ref("editorBtn");null==t||t.scrollIntoView({behavior:"smooth",block:"start"}),a.style.overflow=i}),300)}},changeEditStatus:function(t){var e=t||{},n=e.cid,a=e.status;n===this.data.get("cid")&&"ok"===a&&(this.data.set("totalWord",this.data.get("markdownTotalWord")),this.data.set("type","text"))}}),Im={};Im=Object.assign(Im,{writing:"writing_22lty_1",writingTitle:"writing-title_22lty_4","writing-title":"writing-title_22lty_4",writingContentEditorOcupy:"writing-content-editor-ocupy_22lty_9","writing-content-editor-ocupy":"writing-content-editor-ocupy_22lty_9",writingContentEditor:"writing-content-editor_22lty_9","writing-content-editor":"writing-content-editor_22lty_9",writingContent:"writing-content_22lty_9","writing-content":"writing-content_22lty_9",writingContentHide:"writing-content-hide_22lty_295","writing-content-hide":"writing-content-hide_22lty_295",writingTotalWord:"writing-total-word_22lty_299","writing-total-word":"writing-total-word_22lty_299",writingButtons:"writing-buttons_22lty_302","writing-buttons":"writing-buttons_22lty_302",buttonsHudong:"buttons-hudong_22lty_309","buttons-hudong":"buttons-hudong_22lty_309",buttonIconClose:"button-icon-close_22lty_318","button-icon-close":"button-icon-close_22lty_318",buttonIcon:"button-icon_22lty_318","button-icon":"button-icon_22lty_318",buttonDisabled:"button-disabled_22lty_325","button-disabled":"button-disabled_22lty_325"}),xm.template='\n    <div class="{{$style[\'writing\']}}">\n        \x3c!-- 标题 --\x3e\n        <div\n            s-if="title && type === \'text\'"\n            class="\n                {{$style[\'writing-title\']}}\n                cos-space-mb-md\n                cos-line-clamp-1\n                cos-color-text\n                cos-text-headline-sm\n            "\n        >{{title}}</div>\n        \x3c!-- 正文 --\x3e\n        <div s-ref="textDom">\n            <ai-markdown\n                s-show="{{type === \'text\'}}"\n                s-ref="markdown"\n                class="{{$style[\'writing-content\']}} cos-space-mb-md"\n                content="{{content}}"\n                type="yiyan"\n                normalizeContent="{{normalizeContent}}"\n                on-typing-finished="typingFinishedHandle"\n                typing="{{typing}}"\n            />\n        </div>\n        <div\n            class="{{type === \'text\' ? $style[\'writing-content-hide\'] : \'\'}}"\n        >\n            <input\n                s-ref="titleInput"\n                value="{=titleValue=}"\n                placeholder="标题（选填）"\n                maxlength="{{titleMaxLength}}"\n                on-keydown="handleTitleKeyDown"\n                class="\n                    {{$style[\'writing-title\']}}\n                    cos-space-mb-md\n                    cos-line-clamp-1\n                    cos-color-text\n                    cos-text-headline-sm\n                "\n            />\n            <div style="position: relative;">\n                <div class="{{$style[\'writing-content-editor-ocupy\']}}"></div>\n                <div\n                    class="{{$style[\'writing-content-editor\']}}"\n                    s-ref="edit-container"\n                >\n                </div>\n                \n            </div>\n        </div>\n        \x3c!-- 字数展示 --\x3e\n        <div\n            s-if="typingFinished && isEnd"\n            class="\n                {{$style[\'writing-total-word\']}}\n                cos-text-body-lg\n                cos-color-text-minor\n                cos-space-mt-xs\n            "\n            disable-copy\n        >共{{totalWord}}字</div>\n        <div\n            s-show="{{type === \'editor\'}}"\n            s-ref="editorBtn"\n            class="{{$style[\'writing-buttons\']}}"\n        >\n            <div class="{{$style[\'buttons-hudong\']}}" on-click="handleCancleEdit($event, false)" data-module="edit_cancel">\n                <cos-icon name="close" class="{{$style[\'button-icon-close\']}}"></cos-icon>\n                <span class="{{$style.text}} cos-font-medium cos-space-ml-3xs">取消编辑</span>\n            </div>\n            <div\n                class="{{$style[\'buttons-hudong\']}} {{!totalWord ? $style[\'button-disabled\'] : \'\'}}"\n                data-module="copy_edit"\n                on-click="handleCopy"\n            >\n                <cos-icon name="copy" class="{{$style[\'button-icon\']}}"/>\n                <span class="{{$style.text}} cos-font-medium cos-space-ml-xxs">复制</span>\n            </div>\n        </div>\n    </div>\n';var Tm="function"==typeof xm?xm.prototype.initData||Cm:xm.initData||Cm;function Cm(){return{$style:Im}}function Lm(){return Object.assign({},Tm.call(this),{$style:Im})}"function"==typeof xm?xm.prototype.initData=Lm:xm.initData=Lm;var Pm=a.defineComponent({components:{"ai-markdown":e.Markdown},initData:function(){return{title:"",content:"",isEnd:!1,isPc:!1,typing:{speed:30,cursor:!0,mode:"all"},typingFinished:!1,markdownTotalWord:0,markdownValue:"",waitingValue:""}},attached:function(){this.fire("load-ready"),this.data.set("loadReady",!0),!this.data.get("typing")&&this.data.set("typingFinished",!0),this.fire("typing-finished"),this.data.set("markdownValue",this.data.get("content")),this.data.set("titleValue",this.data.get("title"))},typingFinishedHandle:function(){this.updateTotalWord(),this.data.set("typingFinished",!0),this.fire("typing-finished")},handleMarkdownClick:function(t){this.fire("click",t)},handleMarkdownToggle:function(t){this.fire("toggle",t)},updateTotalWord:function(){var t,e=this.data.get("title")||"",n=this.ref("markdown").el,a=(null==n||null==(t=n.querySelector(".markdownsdk-wrapper-box"))?void 0:t.textContent)||"",i=e.replace(/[\r\n\t]+/g,"").trim(),o=a.replace(/[\r\n\t]+/g,"").trim(),r=/[\u4e00-\u9fa5]/.test(o)?o.replace(/\s+/g,"").length+i.replace(/\s+/g,"").length:o.split(/\s+/).length+i.split(/\s+/).length;this.data.set("totalWord",r),this.data.set("markdownTotalWord",r)},appendContent:function(t,e){void 0===t&&(t="");var n=e.isEnd,a=void 0!==n&&n;this.data.set("isEnd",a);var i=this.ref("markdown");if(this.data.get("loadReady")){var o=this.data.get("waitingValue"),r="";o?(r=o+t,this.data.set("waitingValue","")):r=t,(null==i?void 0:i.appendContent)&&i.appendContent(r),this.data.set("typingFinished",!1);var s=this.data.get("markdownValue");this.data.set("markdownValue",s+r)}else{var c=this.data.get("waitingValue");this.data.set("waitingValue",c+t)}},stop:function(){var t=this.ref("markdown");(null==t?void 0:t.stop)&&t.stop()},handleCopy:function(t){var e;if(this.data.get("totalWord")){var n=this.data.get("titleValue"),a=(n?n+"\n":"")+(null==(e=this.editor)?void 0:e.getText());this.dispatch("writing:copy",{text:a}),this.fire("action-log-event",{component:"writing",actionType:"b",ext:{target:null==t?void 0:t.target}})}}}),Dm={};Dm=Object.assign(Dm,{officeWritingTitle:"office-writing-title_16x6v_1","office-writing-title":"office-writing-title_16x6v_1",officeWritingContent:"office-writing-content_16x6v_6","office-writing-content":"office-writing-content_16x6v_6"}),Pm.template='\n    <div class="{{$style[\'office-writing\']}}">\n        \x3c!-- 标题 --\x3e\n        <div\n            s-if="title"\n            class="\n                {{$style[\'office-writing-title\']}}\n                cos-space-mb-md\n                cos-line-clamp-1\n                cos-color-text\n                cos-text-headline-sm\n            "\n        >{{title}}</div>\n        \x3c!-- 正文 --\x3e\n        <div>\n            <ai-markdown\n                s-ref="markdown"\n                class="{{$style[\'office-writing-content\']}} cos-space-mb-md"\n                styles="{{$aiMarkdown}}"\n                content="{{content}}"\n                typing="{{typing}}"\n                on-typing-finished="typingFinishedHandle"\n                on-click="handleMarkdownClick"\n                on-toggle="handleMarkdownToggle($event)"\n                normalizeContent="{{normalizeContent}}"\n            />\n        </div>\n    </div>\n';var Am="function"==typeof Pm?Pm.prototype.initData||Em:Pm.initData||Em;function Em(){return{$style:Dm}}function Om(){return Object.assign({},Am.call(this),{$style:Dm})}function Rm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Nm(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Rm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rm(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qm(t,e,n){void 0===e&&(e=yh.AUDIO),void 0===n&&(n=!1),n||e!==yh.AUDIO||(null==l?void 0:l.currentVideoInstance)&&l.currentVideoInstance.pause();var a=[],i=t;n?(a=document.querySelectorAll("audio, video"),i=e===yh.AUDIO?t:null==t?void 0:t.querySelector("video")):a=document.querySelectorAll("audio");for(var o,r=Nm(a);!(o=r()).done;){var s=o.value;s!==i&&(null==s||s.pause())}}function Mm(){for(var t=Array.from(arguments).length,e=new Array(t),n=0;n<t;n++)e[n]=Array.from(arguments)[n]}function jm(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Bm(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){jm(o,a,i,r,s,"next",t)}function s(t){jm(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Hm(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function $m(){return $m=Bm((function(t){var e,n,a;return Hm(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,fetch(t,{method:"get",mode:"cors",credentials:"include",headers:{"Cache-Control":"no-cache"}})];case 1:return[4,i.sent().blob()];case 2:return e=i.sent(),a=new ClipboardItem(((n={})[e.type]=e,n)),[4,navigator.clipboard.write([a])];case 3:return i.sent(),Bn().emit({text:"复制成功",type:"success"}),[3,5];case 4:return i.sent(),Bn().emit({text:"复制失败，请稍后重试",type:"info"}),[3,5];case 5:return[2]}}))})),$m.apply(this,Array.from(arguments))}function Um(){return Um=Bm((function(t){var e,n,a;return Hm(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,fetch(t,{method:"get",mode:"cors",credentials:"include",headers:{"Cache-Control":"no-cache"}})];case 1:return[4,i.sent().blob()];case 2:return e=i.sent(),n=URL.createObjectURL(e),(a=document.createElement("a")).href=n,a.download="downloaded-image.jpg",document.body.appendChild(a),a.click(),URL.revokeObjectURL(n),document.body.removeChild(a),[3,4];case 3:return i.sent(),Bn().emit({text:"下载失败，请稍后重试",type:"info"}),[3,4];case 4:return[2]}}))})),Um.apply(this,Array.from(arguments))}function Fm(t,e,n){var a=null==t?void 0:t.querySelectorAll(".cosd-markdown .marklang .marklang-img"),i="";null==n||n.forEach((function(t){var e,n=t.data;"text"===((null==t?void 0:t.type)||"").toLowerCase()&&(i+=(null==n||null==(e=n.question)?void 0:e.question)||"")})),null==a||a.forEach((function(t){if(!t.parentNode.classList.contains("image-container")){var n=document.createElement("div");n.className="image-container",t.parentNode.insertBefore(n,t),n.appendChild(t),t.onload=function(){var a,o=document.createElement("button");o.className="copy";var r=JSON.stringify({value:"create_pic",button:"copy",query:i});o.setAttribute("data-show-ext",r),o.setAttribute("data-show-area",""),o.setAttribute("disable-copy",""),o.innerHTML='\n                <img src="https://gips1.baidu.com/it/u=2375320919,4209118494&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f42_42" alt="复制图标">\n                <span class="copy-text">复制</span>\n            ';var s=null==(a=t.src)?void 0:a.replace("http://","https://");o.onclick=function(){e("copy"),function(t){$m.apply(this,Array.from(arguments))}(s)},n.appendChild(o);var c=document.createElement("button");c.className="download";var l=JSON.stringify({value:"create_pic",button:"download",query:i});c.setAttribute("data-show-ext",l),c.setAttribute("data-show-area",""),c.innerHTML='\n                <img src="https://gips1.baidu.com/it/u=2542160073,1007292717&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f42_42" alt="下载图标">\n                ',c.onclick=function(){e("download"),function(t){Um.apply(this,Array.from(arguments))}(s)},n.appendChild(c)}}}))}function Gm(){return Gm=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Gm.apply(this,Array.from(arguments))}"function"==typeof Pm?Pm.prototype.initData=Om:Pm.initData=Om;var Wm={"ai-markdown":function(t,e){return Gm({},e,{data:Gm({},e.data,{content:t.data.content+e.data.content})})},"ai-reasoning-content":function(t,e){return Gm({},e,{data:Gm({},e.data,{value:t.data.value+e.data.value})})},"ai-thinking-steps":function(t,e){var n=(t.data.reasoningContent||"")+(e.data.reasoningContent||"");return Gm({},e,{data:Gm({},t.data,e.data,n?{reasoningContent:n}:{})})}},zm=Object.keys(Wm);function Qm(t){if(t.length<=1)return t;for(var e=[t[0]],n=1;n<=t.length-1;n++){var a=t[n],i=e[e.length-1];if(zm.includes(a.component)&&i.component===a.component){var o=Wm[a.component];e[e.length-1]=o(i,a)}else e.push(a)}return e}var Jm=a.defineComponent({components:{"cos-icon":e.Icon},computed:{showValue:function(){var t=this.data.get("isReadOnly"),e=this.data.get("defaultValue"),n=this.data.get("placeholder"),a=this.data.get("selectedValue");return t?a||e:a||n}},attached:function(){var t=this;this.watch("hasData",(function(e){e||(t.data.get("placeholder"),t.data.set("selectedValue",""))}))},initData:function(){return{key:"",selectedValue:"",label:"",placeholder:"",hasData:!0,isLast:!1,isReadOnly:!1,defaultValue:"未知"}},handleClick:function(){var t=this.data.get("isReadOnly"),e=this.data.get("key");t||(this.fire("send-click-log",{type:"click",value:"chatForm_cpt_"+e}),this.fire("click"))}}),Vm={};Vm=Object.assign(Vm,{selectPanel:"select-panel_5by9a_1","select-panel":"select-panel_5by9a_1",labelText:"label-text_5by9a_18","label-text":"label-text_5by9a_18",selectArea:"select-area_5by9a_25","select-area":"select-area_5by9a_25",selectValue:"select-value_5by9a_31","select-value":"select-value_5by9a_31",readOnly:"read-only_5by9a_46","read-only":"read-only_5by9a_46",lastPanel:"last-panel_5by9a_64","last-panel":"last-panel_5by9a_64"}),Jm.template="\n    <div\n        class=\"\n            {{$style['select-panel']}}\n            {{isReadOnly ? $style['read-only'] : ''}}\n            {{isLast ? $style['last-panel'] : ''}}\n        \"\n        on-click=\"handleClick\"\n    >\n        <div class=\"{{$style['label-text']}}\">{{label}}</div>\n        <div class=\"{{$style['select-area']}}\">\n            <div class=\"{{$style['select-value']}}\">{{showValue}}</div>\n            <cos-icon s-if=\"{{!isReadOnly}}\" name=\"down\"/>\n        </div>\n    </div>\n";var Km="function"==typeof Jm?Jm.prototype.initData||Xm:Jm.initData||Xm;function Xm(){return{$style:Vm}}function Ym(){return Object.assign({},Km.call(this),{$style:Vm})}"function"==typeof Jm?Jm.prototype.initData=Ym:Jm.initData=Ym;var Zm=a.defineComponent({components:{"cos-date-time-picker":e.index,"select-panel":Jm},computed:{timeValue:function(){var t=this.data.get("value"),e=this.data.get("defaultValue");return t?new Date(t):new Date(e)}},initData:function(){return{key:"",value:"",label:"",format:"YYYY-MM-DD-HH-mm",placeholder:"请选择日期时间",formattedDate:"",hasData:!0,isReadOnly:!1,isLast:!1,logParams:{},popupContainer:function(){return document.body},defaultValue:"Mon Jan 01 1990 00:00:00 GMT+0800 (中国标准时间)"}},attached:function(){var t=this,e=this.data.get("value");this.formatTimeValue(e),this.watch("hasData",(function(e){e||t.data.set("formattedDate","")}))},handleChange:function(){var t=this.data.get("key");this.fire("send-log",{type:"click",value:"chatForm_cpt_scroll",ext:{layerName:t}})},handleConfirm:function(t){var e,n,a=this.data.get("key");this.fire("send-log",{type:"click",value:"chatForm_cpt_confirm",ext:{layerName:a,isLunar:"0"}}),this.formatTimeValue(null==t||null==(e=t.value)?void 0:e.toString()),this.fire("update-form",{key:a,value:null==t||null==(n=t.value)?void 0:n.toString()})},handleOpen:function(){e.Toast.show({message:"若出生时间不详可选择0时0分",duration:1e3})},handleClose:function(){e.Toast.hide()},formatTimeValue:function(t){if("string"==typeof t){var e=new Date(t);if(isNaN(e.getTime()))this.data.set("formattedDate","");else{var n=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),o=e.getHours(),r=e.getMinutes(),s=n+"年"+a+"月"+i+"日";t.includes(":")&&(s+=o+"时"),t.includes(":")&&t.split(":").length>1&&(s+=r+"分"),this.data.set("formattedDate",s)}}else this.data.set("formattedDate","")},handleSendClickLog:function(t){this.fire("send-log",t)}}),tv={};tv=Object.assign(tv,{timePanel:"time-panel_h1bm3_1","time-panel":"time-panel_h1bm3_1"}),Zm.template='\n    <div>\n        <cos-date-time-picker\n            s-if="{{!isReadOnly}}"\n            format="{{format}}"\n            value="{{timeValue}}"\n            title="{{label}}"\n            class="{{$style[\'form-time-picker\']}}"\n            getPopupContainer="{{popupContainer}}"\n            drawerClass="form-drawer"\n            on-change="handleChange"\n            on-confirm="handleConfirm"\n            on-open="handleOpen"\n            on-close="handleClose"\n        >\n            <select-panel\n                slot="entry"\n                label="{{label}}"\n                selected-value="{{formattedDate || placeholder}}"\n                has-data="{{hasData}}"\n                key="{{key}}"\n                placeholder="{{placeholder}}"\n                on-send-click-log="handleSendClickLog"\n            />\n        </cos-date-time-picker>\n        <select-panel\n            s-else\n            label="{{label}}"\n            selected-value="{{formattedDate}}"\n            has-data="{{hasData}}"\n            is-read-only="{{isReadOnly}}"\n            is-last="{{isLast}}"\n            placeholder="{{placeholder}}"\n        />\n    </div>\n';var ev="function"==typeof Zm?Zm.prototype.initData||nv:Zm.initData||nv;function nv(){return{$style:tv}}function av(){return Object.assign({},ev.call(this),{$style:tv})}function iv(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ov(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){iv(o,a,i,r,s,"next",t)}function s(t){iv(o,a,i,r,s,"throw",t)}r(void 0)}))}}function rv(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Zm?Zm.prototype.initData=av:Zm.initData=av;var sv=a.defineComponent({components:{"cos-city-selector":e.CitySelector,"select-panel":Jm},computed:{formattedLocation:function(){var t=this.data.get("selectedCities");if(t.length<=0)return"";var e=t[0],n=e.country,a=void 0===n?"":n,i=e.province,o=void 0===i?"":i,r=e.city,s=void 0===r?"":r,c=e.county,l=void 0===c?"":c;if(a){var d=[];return s&&d.push(s),o&&d.push(o),a&&d.push(a),d.join(" ")}var u=[];return o&&u.push(o),s&&u.push(s),l&&u.push(l),u.join(" ")}},initData:function(){return{key:"",open:!1,selectedCities:[],nativeCities:[],foreignCities:[],placeholder:"",label:"",location:{city:"广州",code:440100,level:"1"},hasData:!0,isReadOnly:!1,isLast:!1,citiesDataUrl:"",popupContainer:function(){return document.body}}},attached:function(){this.getCityList()},handleClick:function(){this.data.get("isReadOnly")||this.data.set("open",!0)},handleRelocate:function(){var t=this.data.get("key");this.fire("send-log",{type:"click",value:"chatForm_cpt_location",ext:{layerName:t}})},handleChange:function(t){var e=this.data.get("key"),n=this.processObject(t.city),a=this.data.get("formattedLocation");this.data.set("open",!1),this.fire("update-form",{key:e,value:n});var i={layerName:e};"birthPlace"===e&&(i.birthPlace=a),"livingPlace"===e&&(i.livingPlace=a),this.fire("send-log",{type:"click",value:"chatForm_cpt_confirm",ext:i})},handleClose:function(){this.data.set("open",!1)},fetchCityList:function(t){return fetch(t,{method:"get"}).then(ov((function(t){return rv(this,(function(e){switch(e.label){case 0:return[4,t.json()];case 1:return[2,[e.sent(),null]]}}))}))).catch((function(t){return[null,t]}))},getCityList:function(){var t=this,e=this.data.get("citiesDataUrl");this.fetchCityList(e).then((function(e){var n=e[0];t.data.set("nativeCities",n.cityList.list||[]),t.data.set("foreignCities",n.foreignCityList.list||[])}))},processObject:function(t){var e={};return Object.keys(t).forEach((function(n){n.startsWith("_")||(e[n]=t[n])})),[e]},handleSendClickLog:function(t){this.fire("send-log",t)}}),cv={};cv=Object.assign(cv,{}),sv.template='\n    <div>\n        <select-panel\n            placeholder="{{placeholder}}"\n            label="{{label}}"\n            selected-value="{{formattedLocation}}"\n            has-data="{{hasData}}"\n            key="{{key}}"\n            is-read-only="{{isReadOnly}}"\n            is-last="{{isLast}}"\n            on-click="handleClick"\n            on-send-click-log="handleSendClickLog"\n        />\n        <cos-city-selector\n            open="{=open=}"\n            nativeCities="{{nativeCities}}"\n            foreignCities="{{foreignCities}}"\n            selectedCities="{=selectedCities=}"\n            location="{{true}}"\n            title="{{label}}"\n            class="form-city-picker"\n            on-change="handleChange"\n            on-close="handleClose"\n            on-relocate="handleRelocate"\n            getPopupContainer="{{popupContainer}}"\n        />\n    </div>\n';var lv="function"==typeof sv?sv.prototype.initData||dv:sv.initData||dv;function dv(){return{$style:cv}}function uv(){return Object.assign({},lv.call(this),{$style:cv})}"function"==typeof sv?sv.prototype.initData=uv:sv.initData=uv;var pv=a.defineComponent({components:{"cos-radio":e.Radio,"cos-radio-group":e.RadioGroup,"select-panel":Jm},computed:{checkedValue:function(){var t;return null==(t=this.data.get("options").find((function(t){return t.checked})))?void 0:t.value}},initData:function(){return{key:"",label:"",options:[],checkedValue:"",hasData:!0,isReadOnly:!1,isLast:!1}},attached:function(){var t=this;this.watch("hasData",(function(e){if(!e){var n=t.data.get("options");t.data.set("checkedValue",""),n.forEach((function(t){t.checked=!1})),t.data.set("options",n)}}))},changeValue:function(t){var e=this.data.get("key");this.handleUbcLog(t),this.data.set("checkedValue",t.value),this.fire("update-form",{key:e,value:t.value})},handleUbcLog:function(t){var e="女生"===t.value?"female":"male";this.fire("send-log",{type:"click",value:"chatForm_cpt_gender_"+e})}}),hv={};hv=Object.assign(hv,{radioGroup:"radio-group_zmn4r_1","radio-group":"radio-group_zmn4r_1",radioItem:"radio-item_zmn4r_21","radio-item":"radio-item_zmn4r_21",radioImg:"radio-img_zmn4r_25","radio-img":"radio-img_zmn4r_25"}),pv.template='\n    <div class="{{$style[\'radio-group\']}}">\n        <cos-radio-group\n            s-if="{{!isReadOnly}}"\n            on-change="changeValue" \n            value="{{checkedValue}}" \n            disabled="{=disabled=}"\n        >\n            <cos-radio \n                s-for="item, index in options"\n                value="{{item.value}}" \n                appearance="tag"\n                checked="{{item.value === checkedValue}}"\n            >\n                <div class="{{$style[\'radio-item\']}}">\n                    <img src="{{item.icon}}" class="{{$style[\'radio-img\']}}"></img>\n                    <div class="{{$style[\'radio-text\']}}">{{item.value}}</div>\n                </div>\n            </cos-radio>\n        </cos-radio-group>\n        <select-panel\n            s-else\n            label="{{label}}"\n            selected-value="{{checkedValue}}"\n            is-read-only="{{isReadOnly}}"\n            is-last="{{isLast}}"\n        >\n        </select-panel>\n    </div>\n';var fv="function"==typeof pv?pv.prototype.initData||gv:pv.initData||gv;function gv(){return{$style:hv}}function mv(){return Object.assign({},fv.call(this),{$style:hv})}function vv(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function yv(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){vv(o,a,i,r,s,"next",t)}function s(t){vv(o,a,i,r,s,"throw",t)}r(void 0)}))}}function bv(){return bv=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},bv.apply(this,Array.from(arguments))}function wv(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof pv?pv.prototype.initData=mv:pv.initData=mv;var _v=a.defineComponent({components:{"date-time-picker":Zm,"city-picker":sv,"radio-group":pv,"cos-button":e.Button,"cos-checkbox":e.Checkbox},initData:function(){return{formId:"",formConfig:{title:"",subtitle:"",theme:{},fields:[],actions:[],agreement:{text:""}},isReadOnly:!1,userData:{remeber:!1,gender:"",birthDate:"",birthPlace:[],livingPlace:[]},hasData:!1,isTransitioning:!1,fadeIn:!1,fadeOut:!1,logExt:{},updateApi:"",isHistory:!1,remembered:!1}},attached:function(){var t=this;this.data.get("isHistory")?this.data.set("isReadOnly",!0):(this.extractUserData(),this.renderFinished(),this.listenNewConversation=function(){t.handleNewConversation()},Hn().on(this.listenNewConversation),Fn().on(this.listenNewConversation),Gn().on(this.listenNewConversation),Qn().on(this.listenNewConversation))},disposed:function(){this.listenNewConversation&&(Hn().off(this.listenNewConversation),Fn().off(this.listenNewConversation),Gn().off(this.listenNewConversation),Qn().off(this.listenNewConversation),this.listenNewConversation=null)},computed:{bgImage:function(){var t,e,n,a,i=this.data.get("formConfig");return Qa()?null==i||null==(e=i.theme)||null==(t=e.background)?void 0:t.dark:null==i||null==(a=i.theme)||null==(n=a.background)?void 0:n.light},commonLogParams:function(){var t=this.data.get("logExt");return bv({ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),setype:"csaitab"},t)},ubcShowLog:function(){var t=this.data.get("commonLogParams");return JSON.stringify(bv({value:"chatForm_cpt"},t))},clearShowLog:function(){var t=this.data.get("commonLogParams");return JSON.stringify(bv({value:"chatForm_cpt_clear"},t))}},handleNewConversation:function(){return yv((function(){return wv(this,(function(t){switch(t.label){case 0:return[4,this.switchToReadOnly()];case 1:return t.sent(),[2]}}))})).apply(this)},handleAction:function(t){var e=t.key,n=t.query,a=t.extData,i=this.data.get("userData").remember;this.handleUbcLog({type:"click",value:"chatForm_cpt_"+e,ext:{infoRemind:i?"1":"0"}}),"clear"===e?this.clearForm():this.submitForm(n,a)},clearForm:function(){return yv((function(){var t;return wv(this,(function(e){return this.data.get("hasData")?(t={remeber:this.data.get("userData").remember,gender:"",birthDate:"",birthPlace:[],livingPlace:[]},this.data.set("userData",t),this.data.set("hasData",!1),this.postUpdateForm(t),[2]):[2]}))})).apply(this)},submitForm:function(t,e){return yv((function(){var n;return wv(this,(function(a){return n={},e&&(n.csextdata=e),Ar({query:t,extParams:n}),[2]}))}))()},handleRememberMe:function(){return yv((function(){var t;return wv(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ws()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2];case 3:return t=this.data.get("remembered"),this.data.set("remembered",!t),this.handleUbcLog({type:"click",value:"chatForm_cpt_remind"+(t?"":"_cancel"),ext:{}}),this.handleUpdateForm({key:"remember",value:!t}),[2]}}))})).apply(this)},handleUpdateForm:function(t){return yv((function(){var e,n;return wv(this,(function(a){return e=t.key,n=t.value,this.updateUserData(e,n),[2]}))})).apply(this)},extractUserData:function(){return yv((function(){var t,e,n,a;return wv(this,(function(i){return t=this,e=this.data.get("formConfig"),n=e.fields,a={},n.forEach((function(t){var e=t.key,n=t.value,i=t.selectedCities;if("gender"===e){var o=t.options.find((function(t){return t.checked}));a.gender=o?o.value:""}else"birthDate"===e?a.birthDate=n||"":a[e]="birthPlace"===e||"livingPlace"===e?i||[]:n||""})),a.remember=e.agreement.checked,this.data.set("remembered",e.agreement.checked),e.actions.forEach((function(e){"clear"===e.key&&(e.disabled||t.data.set("hasData",!0))})),this.data.set("userData",a),a.remember||this.postUpdateForm(a),[2]}))})).apply(this)},updateUserData:function(t,e){"remember"!==t&&this.data.set("hasData",!0);var n=this.data.get("userData");n[t]=e,this.data.set("userData",n),this.postUpdateForm(n)},postUpdateForm:function(t){var e=this,n=this.data.get("updateApi"),a=this.data.get("formId")||"",i=n+"?product=numerology";return t.sessionId=Je.getState("oriLid"),t.msgId=Je.getState("lid"),t.id=a||"",new Promise((function(n,a){fetch(i,{method:"post",mode:"cors",credentials:"include",body:JSON.stringify(t)}).then((function(t){return t.json()})).then((function(t){0===t.status&&e.data.set("formId",t.data.id),n(t)})).catch((function(t){a(t)}))}))},switchToReadOnly:function(){return yv((function(){return wv(this,(function(t){switch(t.label){case 0:return this.data.get("isTransitioning")?[2]:(this.data.set("isTransitioning",!0),this.data.set("fadeOut",!0),[4,new Promise((function(t){return setTimeout(t,80)}))]);case 1:return t.sent(),this.data.set("isReadOnly",!0),this.data.set("fadeIn",!0),[4,new Promise((function(t){return setTimeout(t,240)}))];case 2:return t.sent(),this.data.set("fadeOut",!1),this.data.set("fadeIn",!1),this.data.set("isTransitioning",!1),[2]}}))})).apply(this)},renderFinished:function(){this.fire("render-finished")},handleUbcLog:function(t){var e=this.data.get("commonLogParams"),n=t.type;Aa({type:void 0===n?"show":n,value:t.value,ext:bv({},e,t.ext)})}}),kv={};kv=Object.assign(kv,{profileForm:"profile-form_1oe68_1","profile-form":"profile-form_1oe68_1",historyForm:"history-form_1oe68_9","history-form":"history-form_1oe68_9",formTitle:"form-title_1oe68_12","form-title":"form-title_1oe68_12",mainTitle:"main-title_1oe68_19","main-title":"main-title_1oe68_19",subTitle:"sub-title_1oe68_27","sub-title":"sub-title_1oe68_27",formContent:"form-content_1oe68_36","form-content":"form-content_1oe68_36",formContentItem:"form-content-item_1oe68_40","form-content-item":"form-content-item_1oe68_40",formAction:"form-action_1oe68_43","form-action":"form-action_1oe68_43",formActionBtn:"form-action-btn_1oe68_53","form-action-btn":"form-action-btn_1oe68_53",clear:"clear_1oe68_64",submit:"submit_1oe68_68",formRemeber:"form-remeber_1oe68_71","form-remeber":"form-remeber_1oe68_71",checkboxIcon:"checkbox-icon_1oe68_80","checkbox-icon":"checkbox-icon_1oe68_80",checkboxIconInner:"checkbox-icon-inner_1oe68_92","checkbox-icon-inner":"checkbox-icon-inner_1oe68_92",checkboxLabel:"checkbox-label_1oe68_100","checkbox-label":"checkbox-label_1oe68_100",rememberChecked:"remember-checked_1oe68_110","remember-checked":"remember-checked_1oe68_110",readOnly:"read-only_1oe68_131","read-only":"read-only_1oe68_131",fadeOut:"fade-out_1oe68_147","fade-out":"fade-out_1oe68_147",fadeIn:"fadeIn_1oe68_1","fade-in":"fade-in_1oe68_150"}),_v.template='\n    <div\n        data-show-ext="{{ubcShowLog}}"\n        data-show-area\n        class="\n            {{$style[\'profile-form\']}}\n            {{fadeIn ? $style[\'fade-in\'] : \'\'}}\n            {{fadeOut ? $style[\'fade-out\'] : \'\'}}\n            {{isReadOnly ? $style[\'read-only\'] : \'\'}}\n            {{isHistory ? $style[\'history-form\'] : \'\'}}\n        "\n        style="{{{\n            \'background-image\': \'url(\' + bgImage + \')\'\n        }}}"\n    >\n        \x3c!-- 标题区 --\x3e\n        <div class="{{$style[\'form-title\']}}">\n            <div class="{{$style[\'main-title\']}}">{{formConfig.title}}</div>\n            <div\n                s-if="{{!isReadOnly}}"\n                class="{{$style[\'sub-title\']}}"\n            >{{formConfig.subTitle}}</div>\n        </div>\n\n        \x3c!-- 内容区 --\x3e\n        <div class="{{$style[\'form-content\']}}">\n            <component\n                s-for="field, index in formConfig.fields"\n                s-is="{{field.component}}"\n                class="{{$style[\'form-content-item\']}}"\n                label="{{field.label}}"\n                key="{{field.key}}"\n                value="{{field.value}}"\n                selected-cities="{{field.selectedCities}}"\n                placeholder="{{field.placeholder}}"\n                options="{{field.options}}"\n                cities-data-url="{{field.citiesDataUrl}}"\n                has-data="{{hasData}}"\n                is-read-only="{{isReadOnly}}"\n                is-last="{{index === formConfig.fields.length - 1}}"\n                on-update-form="handleUpdateForm"\n                on-send-log="handleUbcLog"\n            />\n        </div>\n\n        \x3c!-- 操作按钮 --\x3e\n        <div\n            s-if="!isReadOnly"\n            data-show-ext="{{clearShowLog}}"\n            data-show-area\n            class="{{$style[\'form-action\']}}"\n        >\n            <cos-button\n                s-for="item, index in formConfig.actions"\n                disabled="{{item.key === \'clear\' && !hasData}}"\n                class="\n                    {{$style[\'form-action-btn\']}}\n                    {{item.key === \'clear\' ? $style[\'clear\'] : \'\'}}\n                    {{item.key === \'generate\' || item.key === \'regenerate\' ? $style[\'submit\'] : \'\'}}\n                    {{hasData ? $style[\'form-action-active\'] : \'\'}}\n                "\n                on-click="handleAction(item)"\n            >{{item.label}}</cos-button>\n        </div>\n\n        \x3c!-- 记住我 --\x3e\n        <div\n            s-if="{{formConfig.agreement.text && !isReadOnly}}"\n            class="\n                {{$style[\'form-remeber\']}}\n                {{remembered ? $style[\'remember-checked\'] : \'\'}}\n            "\n            on-click="handleRememberMe"\n        >\n            <span class="{{$style[\'checkbox-icon\']}}">\n                <span class="{{$style[\'checkbox-icon-inner\']}}"></span>\n            </span>\n            <span class="{{$style[\'checkbox-label\']}}">\n                {{formConfig.agreement.text}}\n            </span>\n        </div>\n    </div>\n';var Sv="function"==typeof _v?_v.prototype.initData||xv:_v.initData||xv;function xv(){return{$style:kv}}function Iv(){return Object.assign({},Sv.call(this),{$style:kv})}"function"==typeof _v?_v.prototype.initData=Iv:_v.initData=Iv;var Tv=a.defineComponent({trimWhitespace:"all",initData:function(){return{value:""}},attached:function(){this.fire("render-finished")}}),Cv={};Cv=Object.assign(Cv,{bottomTip:"bottom-tip_c99a0_1","bottom-tip":"bottom-tip_c99a0_1"}),Tv.template="\n    <div class=\"{{$style['bottom-tip']}}\">\n        {{value}}\n    </div>\n";var Lv="function"==typeof Tv?Tv.prototype.initData||Pv:Tv.initData||Pv;function Pv(){return{$style:Cv}}function Dv(){return Object.assign({},Lv.call(this),{$style:Cv})}function Av(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Ev(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Av(o,a,i,r,s,"next",t)}function s(t){Av(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Ov(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Tv?Tv.prototype.initData=Dv:Tv.initData=Dv;var Rv="data-has-loop-loading",Nv=a.defineComponent({computed:{isShowLoopLoading:function(){var t=this.data.get("appearance"),e=this.data.get("showPicLoading"),n=this.data.get("generationPrompt");return"steps"===t&&!e&&!n}},initData:function(){return{sseStatus:3,generationPrompt:"",appearance:"skeleton",picProcess:0,picLoadingDesc:"AI作图中",showPicLoading:!1,picLoadingExtend:!1,isPc:"pc"===rt(),interval:null,slideWordsInterval:null,slideWords:"",overviewType:"",loadingWidth:0,loadingUpdated:!1,picLoadingHeight:"auto"}},listenSendLoadingData:null,Lottie:null,customNextTick:function(){return Ev((function(){var t;return Ov(this,(function(e){return t=this,[2,new Promise((function(e){t.nextTick((function(){e()}))}))]}))})).apply(this)},attached:function(){var e=this;new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){e.Lottie=t.default;var n={container:e.ref("brushDom"),renderer:"svg",loop:!0,autoplay:!0,path:"https://psstatic.cdn.bcebos.com/basics/chat/brush_1741693509000.json"};!e.data.get("isPc")&&e.Lottie.loadAnimation(n)}));var n=this.el,a=this.data.get("overviewType");this.listenSendLoadingData=function(t){if(void 0===t&&(t={}),!e.data.get("isPc"))if(t.clearLoading)e.clearPicLoading();else{var i=t.content;if(i){i.description&&e.data.set("picLoadingDesc",i.description);var o=i.ratio||"1-1";e.renderLottie(o);var r=e;setTimeout(Ev((function(){var t,e,s,c;return Ov(this,(function(l){switch(l.label){case 0:return r.data.set("showPicLoading",!0),[4,r.customNextTick()];case 1:return l.sent(),e=o.split("-"),r.data.set("picLoadingHeight",(+e[1]||1)/(+e[0]||1)*(null==(t=r.el)?void 0:t.clientWidth)+"px"),"2"!==a&&"3"!==a||!n||null==(c=fn(n,"."+Wt))||null==(s=c.classList)||s.remove(Wt),r.nextTick((function(){r.data.set("picLoadingExtend",!0),setTimeout((function(){r.incrementNumber(33)}),1e3),r.dispatch("pic-loading:set-height",null==n?void 0:n.clientHeight)})),+i.progress>r.data.get("picProcess")&&r.incrementNumber(+i.progress),[2]}}))})),e.data.get("showPicLoading")?0:500)}}},ya().on(this.listenSendLoadingData),this.listenLoopLoadingShow()},answerBoxDom:null,setLoopLoadingData:function(){this.answerBoxDom&&pn(this.answerBoxDom,Rv,"true")},removeLoopLoadingData:function(){this.answerBoxDom&&pn(this.answerBoxDom,Rv,null)},listenLoopLoadingShow:function(){var t=this;this.answerBoxDom=fn(this.el,Qt,null),this.data.get("isShowLoopLoading")&&this.setLoopLoadingData(),this.watch("isShowLoopLoading",(function(e){e?t.setLoopLoadingData():t.removeLoopLoadingData()}))},disposed:function(){this.removeLoopLoadingData(),this.answerBoxDom=null,this.listenSendLoadingData&&(ya().off(this.listenSendLoadingData),this.listenSendLoadingData=null)},incrementNumber:function(t){var e=this;if(!(t<=this.data.get("picProcess"))){clearTimeout(this.data.get("interval"));var n=function(){e.data.set("picProcess",e.data.get("picProcess")+1),e.data.get("picProcess")<t&&e.data.set("interval",setTimeout(n,10))};this.data.set("interval",setTimeout(n,10))}},clearPicLoading:function(){this.data.set("showPicLoading",!1),this.data.set("picProcess",0),clearTimeout(this.data.get("interval"))},updateLoading:function(t){var e,n=null==t||null==(e=t.steps)?void 0:e[1];n&&!this.data.get("loadingUpdated")&&this.data.get("overviewType")&&"搜索全网"===n.title&&(this.data.set("generationPrompt","搜索全网"),this.setSlideWords(n.words),this.data.set("loadingUpdated",!0))},setSlideWords:function(t){var e=this;if(t&&t.length&&Array.isArray(t)){var n=0;this.data.set("slideWordsInterval",setInterval((function(){e.data.set("slideWords",t[n]),n=(n+1)%t.length,e.nextTick((function(){var t,n=null==(t=e.ref("slideWords"))?void 0:t.offsetWidth;n&&e.data.set("loadingWidth",n)}))}),400))}},renderLottie:function(e){var n=this;if(!this.data.get("showPicLoading")){var a={container:this.ref("loadingDom"),renderer:"svg",loop:!0,autoplay:!0,path:ge.get(e)};this.Lottie?!this.data.get("isPc")&&this.Lottie.loadAnimation(a):new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){n.Lottie=t.default,!n.data.get("isPc")&&n.Lottie.loadAnimation(a)}))}},detached:function(){this.data.get("showPicLoading")&&this.dispatch("pic-loading:listen-pic-load",""),this.clearPicLoading(),clearInterval(this.data.get("slideWordsInterval"))}}),qv={};qv=Object.assign(qv,{chatSearchAnswerStatusStep:"chat-search-answer-status-step_oc7hj_31","chat-search-answer-status-step":"chat-search-answer-status-step_oc7hj_31",icon:"icon_oc7hj_36",cosdSearchingStepsIconProcessBreath:"cosd-searching-steps-icon-process-breath_oc7hj_1","cosd-searching-steps-icon-process-breath":"cosd-searching-steps-icon-process-breath_oc7hj_1",label:"label_oc7hj_45",singleLineStatusStep:"single-line-status-step_oc7hj_52","single-line-status-step":"single-line-status-step_oc7hj_52",box:"box_oc7hj_56",box1Container:"box-1-container_oc7hj_73","box-1-container":"box-1-container_oc7hj_73",loadingBar:"loading-bar_oc7hj_76","loading-bar":"loading-bar_oc7hj_76",borealisBar:"borealisBar_oc7hj_1",box1:"box-1_oc7hj_73","box-1":"box-1_oc7hj_73",box2:"box-2_oc7hj_94","box-2":"box-2_oc7hj_94",picLoadingExtend:"pic-loading-extend_oc7hj_137","pic-loading-extend":"pic-loading-extend_oc7hj_137",picLoading:"pic-loading_oc7hj_137","pic-loading":"pic-loading_oc7hj_137",picLoadingBrush:"pic-loading-brush_oc7hj_156","pic-loading-brush":"pic-loading-brush_oc7hj_156",picLoadingDesc:"pic-loading-desc_oc7hj_164","pic-loading-desc":"pic-loading-desc_oc7hj_164",answerBoxBorder:"answer-box-border_oc7hj_174","answer-box-border":"answer-box-border_oc7hj_174",slideAnimation:"slide-animation_oc7hj_188","slide-animation":"slide-animation_oc7hj_188",dotsContainer:"dots-container_oc7hj_191","dots-container":"dots-container_oc7hj_191",dot:"dot_oc7hj_191",breathe:"breathe_oc7hj_1",loopLoading:"loop-loading_oc7hj_220","loop-loading":"loop-loading_oc7hj_220",loopLoadingItem:"loop-loading-item_oc7hj_236","loop-loading-item":"loop-loading-item_oc7hj_236",loopLoadingItem1:"loop-loading-item-1_oc7hj_244","loop-loading-item-1":"loop-loading-item-1_oc7hj_244",loopLoadingItem2:"loop-loading-item-2_oc7hj_247","loop-loading-item-2":"loop-loading-item-2_oc7hj_247",loopLoadingItem3:"loop-loading-item-3_oc7hj_250","loop-loading-item-3":"loop-loading-item-3_oc7hj_250"}),Nv.template="\n    <div\n        style=\"{{'height:' + picLoadingHeight + ';'}}\"\n        class=\"chat-search-answer-status {{showPicLoading ? $style['answer-box-border'] : ''}}\"\n    >\n        \x3c!-- 等待响应或者生成响应时显示，等待响应时有动画效果 --\x3e\n        <span\n            s-if=\"appearance === 'skeleton' && !showPicLoading\"\n            class=\"chat-search-answer-status-generating\"\n        >\n            <span class=\"{{$style['box-1-container']}}\">\n                <span class=\"text\">{{ generationPrompt }}</span>\n                <span class=\"{{$style['box']}} {{$style['box-1']}}\">\n                    <span class=\"{{$style['loading-bar']}}\"></span>\n                </span>\n            </span>\n            <span class=\"{{$style['box']}} {{$style['box-2']}}\">\n                <span class=\"{{$style['loading-bar']}}\"></span>\n            </span>\n        </span>\n        <div\n            s-if=\"appearance === 'steps' && !showPicLoading\"\n            class=\"{{$style['chat-search-answer-status-step']}} {{overviewType === '2' ? $style['single-line-status-step'] : ''}} cos-dqa cos-line-clamp-1\"\n        >\n            \x3c!-- 三点循环loading动画，独立使用 --\x3e\n            <div s-if=\"!generationPrompt\" class=\"{{$style['loop-loading']}}\">\n                <fragment s-for=\"item in [1, 2, 3]\">\n                    <div class=\"{{$style['loop-loading-item']}} {{$style['loop-loading-item-' + item]}}\"></div>\n                </fragment>\n            </div>\n            \x3c!-- 单点循环loading动画，思考态使用 --\x3e\n            <span s-elif=\"overviewType !== '2'\" class=\"{{$style['icon']}}\"></span>\n            <span s-if=\"generationPrompt\" class=\"{{$style['label']}}\">{{ generationPrompt }}</span>\n            <span\n                s-if=\"overviewType && slideWords\"\n                s-ref=\"loading\"\n                class=\"\n                    {{$style['label']}}\n                    {{overviewType !== '1' ? $style['slide-animation'] : ''}}\n                    {{overviewType === '2' ? 'cos-space-pl-xxs' : ''}}\n                    cos-line-clamp-1\n                \"\n                style=\"{{overviewType !== '1' ? 'max-width:'+ loadingWidth +'px;' : ''}}\"\n            >\n                <span s-ref=\"slideWords\">{{ slideWords }}</span>\n            </span>\n            <div s-if=\"overviewType === '2'\" class=\"cos-space-ml-3xs {{$style['dots-container']}}\">\n                <div class=\"{{$style['dot']}}\"></div>\n                <div class=\"{{$style['dot']}}\"></div>\n                <div class=\"{{$style['dot']}}\"></div>\n            </div>\n        </div>\n        <div\n            s-show=\"showPicLoading\"\n            s-ref=\"loadingDom\"\n            style=\"{{'padding-top:' + picLoadingHeight + ';'}}\"\n            class=\"{{$style['pic-loading']}} {{picLoadingExtend ? $style['pic-loading-extend'] : ''}}\"\n        >\n        </div>\n        <span s-if=\"showPicLoading\" class=\"{{$style['pic-loading-desc']}}\">{{picProcess}}%</span>\n        <div\n            s-show=\"showPicLoading\"\n            s-ref=\"brushDom\"\n            class=\"{{$style['pic-loading-brush']}}\"\n        ></div>\n    </div>\n";var Mv="function"==typeof Nv?Nv.prototype.initData||jv:Nv.initData||jv;function jv(){return{$style:qv}}function Bv(){return Object.assign({},Mv.call(this),{$style:qv})}function Hv(t){var e=t.outlineLid,n=t.outlineQid;return ja(Je.getState("chatParams").sse_host+"/aichat/api/ppt/themelist?tk="+$r()+"&outlineLid="+e+"&outlineQid="+n,{credentials:"include"},4e3).then((function(t){return 1003===t.status?Promise.reject():0===t.status&&t.data?Promise.resolve(t.data):Promise.reject()})).catch((function(t){}))}"function"==typeof Nv?Nv.prototype.initData=Bv:Nv.initData=Bv;var $v=100,Uv=99,Fv=30;function Gv(){return Gv=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Gv.apply(this,Array.from(arguments))}var Wv=function(){function t(t,e,n){this.typewriterArr=[],this.activeItem=null,this.speed=Fv,this.skipDesc=!1,this.isEnd=!1,this.twMap=new Map,this.timer=null,this.consumeCallback=t,this.completeCallback=e,this.itemCompleteCallback=n}var e=t.prototype;return e.setOptions=function(t){void 0!==t.speed&&(this.speed=t.speed),void 0!==t.skipDesc&&(this.skipDesc=t.skipDesc),void 0!==t.isEnd&&(this.isEnd=t.isEnd)},e.setSkipDesc=function(t){this.skipDesc=t},e.setIsEnd=function(t){this.isEnd=t,!t||this.typewriterArr.length||this.activeItem||this.completeCallback()},e.initTwMap=function(t){this.twMap.set(t.id,{text:t.text||"",desc:t.desc||""})},e.addQueue=function(t){var e=t.id,n=t.parentId,a=t.text,i=t.desc;this.twMap.get(e)||(a&&this.typewriterArr.push({id:e,parentId:n,type:"text",str:a}),i&&!this.skipDesc&&this.typewriterArr.push({id:e,parentId:n,type:"desc",str:i}),this.twMap.set(e,{text:a||"",desc:i||""}))},e.start=function(){this.timer||this.consume()},e.stop=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.clear=function(){this.stop(),this.typewriterArr=[],this.activeItem=null,this.twMap.clear()},e.consume=function(){var t=this;if(!this.activeItem){if(0===this.typewriterArr.length)return void(this.isEnd&&this.completeCallback());if(this.activeItem=this.typewriterArr.shift()||null,!this.activeItem)return}var e=this.activeItem.str.charAt(0);if(!e)return this.itemCompleteCallback(this.activeItem),this.activeItem=null,void(this.timer=window.setTimeout((function(){t.timer=null,t.consume()}),this.speed));var n=Gv({},this.activeItem,{str:e});this.activeItem.str=this.activeItem.str.substring(1),this.consumeCallback(n),this.timer=window.setTimeout((function(){t.timer=null,t.consume()}),this.speed)},t}();function zv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Qv(){return Qv=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Qv.apply(this,Array.from(arguments))}function Jv(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return zv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zv(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Vv=function(t){var e=new Map,n=function(t){t.forEach((function(t){e.set(t.data.id,t.data),t.children&&t.children.length&&n(t.children)}))};return n(t),e},Kv=function(t,e){if(!t.length)return"";var n="";return t[0]&&(n+=t[0].data.text+"\n\n",t.slice(1).forEach((function(t,a){n+=""+("number"===e?a+1+". ":"")+t.data.text+"\n",t.data.desc&&(n+=t.data.desc+"\n"),t.children&&t.children.length&&t.children.forEach((function(t,i){n+="  "+("number"===e?a+1+"."+(i+1)+" ":"- ")+t.data.text+"\n",t.data.desc&&(n+="  "+t.data.desc+"\n")})),n+="\n"}))),n.trim()},Xv=function(t,e,n){if(!t.length)return{newNode:null,nodes:t};var a=JSON.parse(JSON.stringify(t)),i="outline-"+Math.random().toString(36).substring(2,10),o=null;if(1===n){var r=a.findIndex((function(t){return t.data.id===e}));-1!==r&&(o={data:{id:i,text:"",desc:"",parentId:""},children:[]},a.splice(r+1,0,o))}else if(2===n)for(var s,c=Jv(a);!(s=c()).done;){var l=s.value;if(l.data.id===e){o={data:{id:i,text:"",desc:"",parentId:l.data.id},children:[]},l.children.splice(0,0,o);break}var d=l.children.findIndex((function(t){return t.data.id===e}));if(-1!==d){o={data:{id:i,text:"",desc:"",parentId:l.data.id},children:[]},l.children.splice(d+1,0,o);break}}return{newNode:o,nodes:a}},Yv=function(t){if(!(null==t?void 0:t.length))return{hasEmptyTitle:!1,toast:"",editId:""};var e=function(t,e){var n,a;return(null==t||null==(a=t.data)||null==(n=a.text)?void 0:n.trim())?null:{hasEmptyTitle:!0,toast:e+"不能为空",editId:t.data.id}},n=e(t[0],"主标题");if(n)return n;for(var a,i=1,o=Jv(t.slice(1));!(a=o()).done;){var r=a.value,s=e(r,"第"+i+"章标题");if(s)return s;for(var c,l=1,d=Jv(r.children);!(c=d()).done;){var u=e(c.value,i+"."+l+"子章节标题");if(u)return u;l++}i++}return{hasEmptyTitle:!1,toast:"",editId:""}},Zv=a.defineComponent({trimWhitespace:"all",elementObserver:null,components:{"cos-icon":e.Icon},initData:function(){return{isTitleEmpty:!1,textareaHeight:0,descTextareaHeight:0,titleMaxLength:$v}},computed:{placeholder:function(){return this.data.get("canEdit")?{text:1==+this.data.get("level")?"请输入章节标题":"请输入子章节标题",desc:"可输入本节需要提及的内容"}:{text:"",desc:""}},addNodeText:function(){var t=this.data.get("level"),e=this.data.get("isHasChild");return 2===t||1===t&&!e?"子节":"章节"}},attached:function(){var t=this;if(this.autoResize(this.ref("textRef")),this.watch("data.text",(function(e,n){2!=+t.data.get("level")&&t.data.set("isTitleEmpty",!e),e!==n&&t.autoResize(t.ref("textRef"))})),this.watch("editId",(function(e){var n;e===t.data.get("data").id&&("desc"!==t.data.get("focusType")&&(null==(n=t.ref("textRef"))||n.focus()))})),window.ResizeObserver){this.elementObserver=new ResizeObserver(_n((function(){requestAnimationFrame((function(){t.autoResize(t.ref("textRef"))}))}),100));var e=this.ref("textRef");e&&this.elementObserver.observe(e)}},detached:function(){this.elementObserver&&this.elementObserver.disconnect()},autoResize:function(t,e){if(void 0===e&&(e="text"),t){var n=t.type;if("focus"===n&&this.data.set("focusType",e),t&&t.style){var a=t;a.style.height="auto",a.style.height=a.scrollHeight+"px"}"focus"===n&&t.scrollIntoView&&setTimeout((function(){t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}),0)}},onAddNode:function(t){this.data.get("isComposing")||(t.preventDefault(),this.data.set("focusType","text"),this.data.get("isTitle")||this.fire("add-node",{id:this.data.get("data").id,level:this.data.get("level")}))},onMoveLevel:function(t){if(!this.data.get("isComposing")){t.preventDefault();var e=+this.data.get("level");t.shiftKey&&2===e&&this.moveUpLevel(),t.shiftKey||1!==e||1===this.data.get("index")||this.moveDownLevel()}},onDelete:function(t,e){e||this.data.get("isComposing")||(t.preventDefault(),this.fire("delete-node",{id:this.data.get("data").id,level:this.data.get("level")}))},editContent:function(t){this.fire("enter-edit",t)},textareaInputHandle:function(t,n){var a=$v,i=t.target.value;if(i.length>a){var o=t.target;o.value=i.substring(0,a),this.data.set("data."+n,o.value),e.Toast.info({message:"标题不能超过100字"})}this.autoResize(t.target,n),this.fire("real-edited",{type:"input",id:this.data.get("data").id,level:this.data.get("level")})},textareaBlurHandle:function(t,e){this.fire("textarea-blur",e)},onKeyDown:function(t){var e=t.key;"Enter"===e?this.onAddNode(t):"Tab"===e?this.onMoveLevel(t):"Delete"===e&&this.onDelete(t,this.data.get("isTitle"))},textareaCopyHandle:function(t){this.fire("textarea-copy",t)},textareaPasteHandle:function(t,n){var a,i=null==(a=t.clipboardData)?void 0:a.getData("text");if(i){var o=$v,r=this.data.get("data."+n)||"";if(r.length+i.length>o){t.preventDefault();var s=o-r.length;if(s>0){var c=i.substring(0,s);this.data.set("data."+n,r+c),this.autoResize(this.ref(n+"Ref"),n),this.fire("real-edited",{type:n,id:this.data.get("data").id,level:this.data.get("level")})}e.Toast.info({message:"标题不能超过100字"})}}},autoFocus:function(t){t.stopPropagation()},handleCompositionStart:function(){this.data.set("isComposing",!0)},handleCompositionEnd:function(){this.data.set("isComposing",!1)},moveUpLevel:function(){var t=this.data.get("data").id,e=+this.data.get("level");this.fire("move-up-level",{id:t,level:e})},moveDownLevel:function(){var t=this.data.get("data").id,e=+this.data.get("level");this.fire("move-down-level",{id:t,level:e})},addNode:function(){var t=this.data.get("data").id,e=this.data.get("addNodeText");this.fire("add-node",{id:t,level:"章节"===e?1:2})},deleteNode:function(){var t=this.data.get("data").id,e=+this.data.get("level");this.fire("delete-node",{id:t,level:e})}}),ty={};ty=Object.assign(ty,{contentBox:"content-box_1anyt_1","content-box":"content-box_1anyt_1",disabled:"disabled_1anyt_9",tagText:"tag-text_1anyt_12","tag-text":"tag-text_1anyt_12",contentActions:"content-actions_1anyt_23","content-actions":"content-actions_1anyt_23",level1:"level-1_1anyt_26","level-1":"level-1_1anyt_26",isHasChild:"is-has-child_1anyt_26","is-has-child":"is-has-child_1anyt_26",contentInput:"content-input_1anyt_35","content-input":"content-input_1anyt_35",level2:"level-2_1anyt_40","level-2":"level-2_1anyt_40",contentContainer:"content-container_1anyt_54","content-container":"content-container_1anyt_54",outlineContentEdit:"outline-content-edit_1anyt_58","outline-content-edit":"outline-content-edit_1anyt_58",outlineContentEmpty:"outline-content-empty_1anyt_62","outline-content-empty":"outline-content-empty_1anyt_62",title:"title_1anyt_65",contentMain:"content-main_1anyt_68","content-main":"content-main_1anyt_68",actionsPanel:"actions-panel_1anyt_104","actions-panel":"actions-panel_1anyt_104",btnAreaItem:"btn-area-item_1anyt_113","btn-area-item":"btn-area-item_1anyt_113"}),Zv.template='\n    <div\n        class="\n            {{$style[\'content-box\']}}\n            {{$style[\'level-\' + level]}}\n            {{isLast ? $style[\'is-last\'] : \'\'}}\n            {{isHasChild ? $style[\'is-has-child\'] : \'\'}}\n            {{isTitle ? $style[\'is-title\'] : \'\'}}"\n    >\n        \x3c!--左侧tag--\x3e\n        <div\n            s-ref="boxLeftRef"\n            class="{{$style[\'tag-text\']}}"\n        >\n            {{ tag }}\n        </div>\n\n        \x3c!--内容区--\x3e\n        <div\n            class="{{$style[\'content-container\']}}"\n            tabindex="0"\n            on-click="editContent(data.id)"\n            on-compositionstart="handleCompositionStart"\n            on-compositionend="handleCompositionEnd"\n        >\n            <div class="{{$style[\'content-main\']}}">\n                <textarea\n                    data-id="{{data.id}}"\n                    s-ref="textRef"\n                    value="{=data.text=}"\n                    wrap="soft"\n                    class="{{$style[\'content-input\']}}"\n                    placeholder="{{placeholder.text}}"\n                    rows="1"\n                    disabled="{{disable}}"\n                    on-keydown="onKeyDown($event)"\n                    on-blur="textareaBlurHandle($event, level)"\n                    on-input="textareaInputHandle($event, \'text\')"\n                    on-focus="autoResize($event, \'text\')"\n                    on-keyup-esc="fire(\'cancel-edit\')"\n                    on-click="autoFocus($event)"\n                    on-copy="textareaCopyHandle"\n                    on-paste="textareaPasteHandle($event, \'text\')"\n                ></textarea>\n            </div>\n            <div\n                s-if="!disable && index !== 0"\n                class="{{$style[\'content-actions\']}}"\n            >\n                \x3c!--操作区--\x3e\n                <div class="{{$style[\'actions-panel\']}}">\n                    <div\n                        s-if="level === 1 && index !== 1"\n                        class="{{$style[\'btn-area-item\']}}"\n                        on-click="moveDownLevel"\n                    >\n                        <cos-icon name="to-down" />\n                        <span class="{{$style.text}}">降为子节</span>\n                    </div>\n                    <div\n                        s-if="level === 2"\n                        class="{{$style[\'btn-area-item\']}}"\n                        on-click="moveUpLevel"\n                    >\n                        <cos-icon name="to-up" />\n                        <span class="{{$style.text}}">升为章节</span>\n                    </div>\n                    <div\n                        class="{{$style[\'btn-area-item\']}}"\n                        on-click="addNode"\n                    >\n                        <cos-icon name="plus-circle" />\n                        <span class="{{$style.text}}">新增{{ addNodeText }}</span>\n                    </div>\n                    <div\n                        class="{{$style[\'btn-area-item\']}}"\n                        on-click="deleteNode"\n                    >\n                        <cos-icon name="bin" />\n                        <span class="{{$style.text}}">删除</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n';var ey="function"==typeof Zv?Zv.prototype.initData||ny:Zv.initData||ny;function ny(){return{$style:ty}}function ay(){return Object.assign({},ey.call(this),{$style:ty})}function iy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function oy(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function ry(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){oy(o,a,i,r,s,"next",t)}function s(t){oy(o,a,i,r,s,"throw",t)}r(void 0)}))}}function sy(){return sy=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},sy.apply(this,Array.from(arguments))}function cy(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return iy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iy(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ly(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Zv?Zv.prototype.initData=ay:Zv.initData=ay;var dy=St.connect(Je,{workspaceData:"workspaceData"})(a.defineComponent({trimWhitespace:"all",outlineTypewriter:null,setTimer:null,clearTimer:null,debounceEditOutline:null,components:{"content-box":Zv,"cos-loading":e.Loading,"chat-loading":Nv},initData:function(){return{nodes:[],canEdit:!1,editNodeId:"",needInitNode:!0,finished:!1,editOutlineLoading:!1,editOutlineActionQueue:[],selectTemplateButtonLoading:!1,isStop:!1}},computed:{globalDisable:function(){var t=this.data.get("isEditable");return void 0!==t?!t:!this.data.get("canEdit")},isLoading:function(){return!(this.data.get("finished")&&this.data.get("canEdit"))},isOpenCurWorkspace:function(){var t=this.data.get("outlineQid"),e=this.data.get("workspaceData.wenku.outlineQid");return e&&t===e},copyText:function(){return Kv(this.data.get("nodes"),"number")},hasEmptyTitle:function(){return Yv(this.data.get("nodes")).hasEmptyTitle?"1":"0"}},inited:function(){var t=this,e=function(t){var e=null;return{setTimer:function(n){e&&clearTimeout(e),e=window.setTimeout(n,t)},clearTimer:function(){e&&(clearTimeout(e),e=null)}}}(3e3),n=e.setTimer,a=e.clearTimer;this.setTimer=n,this.clearTimer=a,this.outlineTypewriter=new Wv(this.outlineTypewriterConsume.bind(this),this.outlineTypewriterComplete.bind(this),this.outlineTypewriterItemComplete.bind(this)),this.debounceEditOutline=wn(this.editOutline.bind(this),300),ci().on((function(e){e.outlineQid===t.data.get("outlineQid")&&t.checkEmptyTitleAction()}))},attached:function(){var t=this,e=this.data.get("value"),n=!!this.data.get("value.status");this.appendContent(e,n),Nn().on((function(e){e.rank===t.data.get("rank")&&t.handleFinished()})),this.setupHoverMenuListeners(),this.watch("isLoading",(function(e){e||t.setupHoverMenuListeners()})),di().on((function(e){e.rank===t.data.get("rank")&&t.data.set("isStop",!0)}))},setupHoverMenuListeners:function(){var t=this,e=gn(this.el,"cs-answer-container"),n=null==e?void 0:e.querySelector(".cs-answer-hover-menu"),a=function(t){void 0===t&&(t=!0),n&&(n.style.opacity=t?"1":"0")};this.nextTick((function(){n&&(n.style.transform="translateY(-40px)");var e=t.ref("selectTemplateButton");e&&(e.addEventListener("mouseenter",(function(){a(!1)})),e.addEventListener("mouseleave",(function(){a(!0)})))}))},appendContent:function(t,e){if(void 0===e&&(e=!1),t){var n=t.bdjson,a=t.status,i=t.edited;n&&this.handleOutlineChange(n),a&&(this.fire("render-finished"),e&&this.handleFinished()),this.data.assign({edited:i,outlineLid:t.outlineLid,outlineQid:t.outlineQid})}},handleOutlineChange:function(t){var e=this;try{var n,a;if(null==(n=this.outlineTypewriter)||n.setSkipDesc(!0),!t)return;var i=function(t){if(!Object.keys(t).length)return[];var e=[],n=function(t,e,n){var a,i,o=e.map((function(t){return t.c})).flat();return{id:t,text:(null==(a=o.find((function(t){return"span"===t.t})))?void 0:a.c)||"",desc:(null==(i=o.find((function(t){return"desc"===t.t})))?void 0:i.c)||"",parentId:n}},a=function(t,e,i){null==t||t.forEach((function(t){var o={data:n(t.id,t.c.c,i),children:[]};e.push(o),t.ch&&a(t.ch,o.children,t.id)}))},i={data:n(t.id,t.c.c,""),children:[]};return e.push(i),a(t.ch,e,""),e}("string"==typeof t?JSON.parse(t):t);if(!i.length)return;var o=this.getNodeMap(i);if(!o)return;o.forEach((function(t){var n;null==(n=e.outlineTypewriter)||n.addQueue(t)})),null==(a=this.outlineTypewriter)||a.start()}catch(t){Mm("Error parsing outline:",t)}},handleFinished:function(){var t,e;this.data.get("finished")||(this.data.set("finished",!0),null==(t=this.outlineTypewriter)||t.setIsEnd(!0),(null==(e=this.outlineTypewriter)?void 0:e.typewriterArr.length)||this.outlineTypewriterComplete())},getNodeMap:function(t){if(this.data.get("needInitNode")){this.data.set("needInitNode",!1);var e=Vv(t);return this.initTypedMap(e),this.data.set("nodes",t),this.fire("render-finished"),null}return Vv(t)},initTypedMap:function(t){var e=this;t.forEach((function(t){var n;null==(n=e.outlineTypewriter)||n.initTwMap(t)}))},outlineTypewriterConsume:function(t){var e=this.data.get("nodes");if(t.parentId){var n=e.findIndex((function(e){return e.data.id===t.parentId}));if(-1===n)return;var a=e[n].children,i=a.findIndex((function(e){return e.data.id===t.id}));if(-1!==i){var o=a.map((function(e,n){return n===i?sy({},e,{data:sy({},e.data,{text:"text"===t.type?e.data.text+t.str:e.data.text,desc:"desc"===t.type?e.data.desc+t.str:e.data.desc})}):e})),r=[].concat(e);r[n]=sy({},e[n],{children:o}),this.data.set("nodes",r)}else{var s=a.map((function(t){return sy({},t)}));s.push({children:[],data:{desc:"desc"===t.type?t.str:"",id:t.id,parentId:t.parentId,text:"text"===t.type?t.str:""}});var c=[].concat(e);c[n]=sy({},e[n],{children:s}),this.data.set("nodes",c)}}else{var l=e.findIndex((function(e){return e.data.id===t.id}));if(-1!==l){var d=e[l],u=[].concat(e);u[l]=sy({},d,{data:sy({},d.data,{text:"text"===t.type?d.data.text+t.str:d.data.text,desc:"desc"===t.type?d.data.desc+t.str:d.data.desc})}),this.data.set("nodes",u)}else this.data.push("nodes",{children:[],data:{desc:"desc"===t.type?t.str:"",id:t.id,parentId:"",text:"text"===t.type?t.str:""}})}},outlineTypewriterComplete:function(){this.data.set("canEdit",!0),this.fire("render-finished")},outlineTypewriterItemComplete:function(){this.fire("render-finished")},getTitle:function(){var t,e;return(null==(e=this.data.get("nodes")[0])||null==(t=e.data)?void 0:t.text)||""},getSub:function(t){return void 0===t&&(t=!0),function(t,e){if(!e.length)return[];var n=[];return e.slice(1).forEach((function(e){t&&!e.data.text||n.push(e.data.text)})),n}(t,this.data.get("nodes"))},getResult:function(t,e){switch(void 0===t&&(t="json"),void 0===e&&(e={prefix:"number"}),t){case"json":return JSON.stringify(function(t){if(!t.length)return{};var e={id:"",c:{t:"p",c:[]},dataType:"data",ch:[]},n=function(t,e){var n=[{t:"p",c:[{t:"span",c:t||""}]}];return e&&n[0].c.push({t:"desc",c:e}),n};if(t[0]){var a=t[0];e.id=a.data.id,e.c.c=n(a.data.text,a.data.desc),e.ch=t.slice(1).map((function(t){var e={id:t.data.id,c:{t:"p",c:n(t.data.text,t.data.desc)},dataType:"data"};return t.children&&t.children.length&&(e.ch=t.children.map((function(t){return{id:t.data.id,c:{t:"p",c:n(t.data.text,t.data.desc)},dataType:"data"}}))),e}))}return e}(this.data.get("nodes")));case"text":return Kv(this.data.get("nodes"),e.prefix);default:return""}},manageFocus:function(t,e,n){var a=this;void 0===n&&(n=""),this.nextTick((function(){null==a.clearTimer||a.clearTimer.call(a),"delete"===e&&n?(a.data.set("editNodeId",n),a.focusNodeById(n)):"add"!==e&&"move"!==e&&"edit"!==e||(a.data.set("editNodeId",t),a.focusNodeById(t),null==a.setTimer||a.setTimer.call(a,a.autoLoseFocus.bind(a)))}))},enterEdit:function(t){this.outlineClickHandle()&&this.manageFocus(t,"edit")},contentClickOutsideHandle:function(){this.data.get("editNodeId")&&(this.data.set("editNodeId",""),this.fire("edited",!1)),null==this.clearTimer||this.clearTimer.call(this)},autoLoseFocus:function(){var t,e,n=document.activeElement;t=n,(null!=(e=HTMLElement)&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e)&&(null==n||n.blur()),this.contentClickOutsideHandle()},outlineClickHandle:function(){return!!this.data.get("canEdit")||(e.Toast.info({message:"等大纲生成完，再开始编辑吧"}),!1)},addNode:function(t){var n=t.id,a=t.level;if(Vv(this.data.get("nodes")).size>Uv)e.Toast.error({message:"章节数量已达到上限"});else{var i=Xv(this.data.get("nodes"),n,a),o=i.newNode,r=i.nodes;this.data.set("nodes",r),this.realEditedHandle({type:"add",level:a}),o&&this.manageFocus(o.data.id,"add"),this.sendLog({value:"ppt_"+this.getLevelString(a)+"_new",type:"click"})}},deleteNode:function(t){var n=t.id,a=t.level,i=this.data.get("nodes");if(!((null==i?void 0:i.length)<=1)){if(i&&2===i.length)if(i.find((function(t){return t.data.id===n})))return void e.Toast.info({message:"至少需要一个一级标题"});var o="",r=n||this.data.get("editNodeId"),s=i.findIndex((function(t){return t.data.id===r}));if(-1!==s)s+1<i.length?o=i[s+1].data.id:s>0&&(o=i[s-1].data.id);else for(var c,l=cy(i);!(c=l()).done;){var d=c.value,u=d.children.findIndex((function(t){return t.data.id===r}));if(-1!==u){o=u+1<d.children.length?d.children[u+1].data.id:u>0?d.children[u-1].data.id:d.data.id;break}}var p=function(t,e){if(!t.length||!e)return t;var n=JSON.parse(JSON.stringify(t)),a=n.findIndex((function(t){return t.data.id===e}));if(-1!==a&&0!==a)return n.splice(a,1),n;for(var i,o=Jv(n);!(i=o()).done;){var r=i.value,s=r.children.findIndex((function(t){return t.data.id===e}));if(-1!==s)return r.children.splice(s,1),n}return n}(i,r);this.realEditedHandle({type:"delete",level:a}),this.data.set("nodes",p),o&&this.manageFocus(o,"delete",o),this.sendLog({value:"ppt_"+this.getLevelString(a)+"_delete",type:"click"})}},moveUpLevel:function(t){var e=t.id,n=this.data.get("nodes"),a=e||this.data.get("editNodeId"),i=function(t,e){var n=function(t){var n=i[t].children.findIndex((function(t){return t.data.id===e}));if(-1!==n){var a=i[t].children[n],o={data:Qv({},a.data,{parentId:""}),children:[]};if(n+1<i[t].children.length){var r=i[t].children.slice(n+1);r.forEach((function(t){t.data.parentId=a.data.id})),o.children=r,i[t].children.splice(n+1)}return i[t].children.splice(n,1),i.splice(t+1,0,o),{v:i}}};if(!t.length||!e)return t;for(var a,i=JSON.parse(JSON.stringify(t)),o=0;o<i.length;o++){var r=n(o);if("object"==((a=r)&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a))return r.v}return i}(n,a);this.realEditedHandle({type:"move",level:2}),this.data.set("nodes",i),this.manageFocus(a,"move"),this.sendLog({value:"ppt_2nd_upper",type:"click"})},moveDownLevel:function(t){var e=t.id,n=this.data.get("nodes"),a=e||this.data.get("editNodeId"),i=function(t,e){if(!t.length||!e)return t;var n=JSON.parse(JSON.stringify(t)),a=n.findIndex((function(t){return t.data.id===e}));if(-1!==a&&a>1){var i=n[a],o=n[a-1],r={data:Qv({},i.data,{parentId:o.data.id}),children:[]};n.splice(a,1),o.children.push(r),i.children&&i.children.length>0&&i.children.forEach((function(t){t.data.parentId=o.data.id,o.children.push(t)}))}return n}(n,a);this.realEditedHandle({type:"move",level:1}),this.data.set("nodes",i),this.manageFocus(a,"move"),this.sendLog({value:"ppt_1st_lower",type:"click"})},focusNodeById:function(t){if(t&&this.el){var e=this.el.querySelector('[data-id="'+t+'"]');if(e){e.focus();var n=e.value.length;e.setSelectionRange(n,n)}}},realEditedHandle:function(t){var e=t.type,n=t.level;this.data.set("edited",!0),null==this.debounceEditOutline||this.debounceEditOutline.call(this,{type:e,level:n})},clear:function(){var t;this.data.set("nodes",[]),null==(t=this.outlineTypewriter)||t.clear()},stop:function(){var t,e;this.data.set("isStop",!0),null==(t=this.outlineTypewriter)||t.stop(),null==(e=this.outlineTypewriter)||e.clear()},disposed:function(){var t;null==(t=this.outlineTypewriter)||t.clear(),null==this.clearTimer||this.clearTimer.call(this),this.data.get("outlineQid")===Je.getState("workspaceData.wenku.outlineQid")&&Je.dispatch("update",{showWorkspaceType:""})},checkEmptyTitleAction:function(){var t=this.data.get("nodes"),n=Yv(t),a=n.hasEmptyTitle,i=n.toast,o=n.editId;return a&&(e.Toast.info({message:i}),this.manageFocus(o,"edit")),a},handleSelectTemplateButtonClick:function(){return ry((function(){var t,e;return ly(this,(function(n){switch(n.label){case 0:return t=this,this.data.get("selectTemplateButtonLoading")?[2]:(this.sendLog({value:"choose_ppt",type:"click"}),this.checkEmptyTitleAction()?[2]:(this.data.set("selectTemplateButtonLoading",!0),[4,this.getThemesList().finally((function(){t.data.set("selectTemplateButtonLoading",!1)}))]));case 1:return(e=n.sent())?(this.scrollToQueue(),Je.dispatch("update",{showWorkspaceType:"wenku",workspaceData:{wenku:{outlineLid:this.data.get("outlineLid"),outlineQid:this.data.get("outlineQid")}}}),ri().emit({type:"template",data:{outlineLid:this.data.get("outlineLid"),outlineQid:this.data.get("outlineQid"),themeId:e.themeId,templateList:e.list}}),[2]):[2]}}))})).apply(this)},scrollToQueue:function(){var t=gn(this.el,"cs-rank-container");if(t){var e=t.querySelector(".cs-rank");e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}},getThemesList:function(){return ry((function(){var t,e,n;return ly(this,(function(a){switch(a.label){case 0:return t=this,this.data.get("tplInfo.query"),e=this.data.get("outlineLid"),n=this.data.get("outlineQid"),[4,new Promise((function(e){t.data.get("editOutlineLoading")?t.data.push("editOutlineActionQueue",e):e({})}))];case 1:return a.sent(),[4,Hv({outlineLid:e,outlineQid:n})];case 2:return[2,a.sent()]}}))})).apply(this)},editOutline:function(t){var e=t.type,n=t.level;return ry((function(){var t,a,i,o,r;return ly(this,(function(s){return t=this,["paste","input"].includes(e)&&this.sendLog({value:"ppt_"+this.getLevelString(n)+"_edit",type:"click"}),a=this.data.get("outlineLid"),i=this.data.get("outlineQid"),o=this.getResult("json"),r=Je.getState("chatParams").sse_host+"/aichat/api/ppt/outlineupdate?tk="+$r()+"&outlineLid="+a+"&outlineQid="+i,this.data.set("editOutlineLoading",!0),[2,fetch(r,{method:"post",credentials:"include",body:JSON.stringify({bdjson:o,title:this.getTitle()})}).then((function(t){return t.json()})).then((function(t){return 0===t.status?Promise.resolve(t.data):Promise.reject()})).finally((function(){t.data.set("editOutlineLoading",!1),t.handleEditOutlineQueue()}))]}))})).apply(this)},handleEditOutlineQueue:function(){var t=this.data.get("editOutlineActionQueue");this.data.set("editOutlineActionQueue",[]);for(var e,n=cy(t);!(e=n()).done;){var a=e.value;null==a||a()}},getLevelString:function(t){return 1===t?"1st":"2nd"},sendLog:function(t){var e=t.value;Aa({page:"resultpage",type:t.type,value:e,ext:{enter_type:Je.getState("pcEnterType"),re_rank:this.data.get("rank"),setype:"csaitab",a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}})}})),uy={};uy=Object.assign(uy,{outlineContainer:"outline-container_pfi3d_1","outline-container":"outline-container_pfi3d_1",outlineDisable:"outline-disable_pfi3d_4","outline-disable":"outline-disable_pfi3d_4",finishedText:"finished-text_pfi3d_7","finished-text":"finished-text_pfi3d_7",chapterWrapper:"chapter-wrapper_pfi3d_12","chapter-wrapper":"chapter-wrapper_pfi3d_12",outlineDisableMask:"outline-disable-mask_pfi3d_38","outline-disable-mask":"outline-disable-mask_pfi3d_38",contentBoxWrap:"content-box-wrap_pfi3d_47","content-box-wrap":"content-box-wrap_pfi3d_47",outlineBottomButtonContainer:"outline-bottom-button-container_pfi3d_51","outline-bottom-button-container":"outline-bottom-button-container_pfi3d_51",outlineBtnWrapper:"outline-btn-wrapper_pfi3d_54","outline-btn-wrapper":"outline-btn-wrapper_pfi3d_54",editText:"edit-text_pfi3d_60","edit-text":"edit-text_pfi3d_60",outlineActionButton:"outline-action-button_pfi3d_65","outline-action-button":"outline-action-button_pfi3d_65",outlineActionButtonLogo:"outline-action-button-logo_pfi3d_83","outline-action-button-logo":"outline-action-button-logo_pfi3d_83"}),dy.template='\n    <div\n        id="outline-editor{{outlineQid}}"\n        s-ref="wrapper"\n        class="{{$style[\'outline-container\']}}"\n        disabled-copy\n        data-copy="{{copyText}}"\n        has-empty-title="{{hasEmptyTitle}}"\n    >\n        <div\n            s-if="canEdit"\n            class="{{$style[\'finished-text\']}}"\n        >\n            已为您生成可自由编辑的大纲。确认无误后，点击下方「选择模板」按钮，即可进入PPT模板选择页面。\n        </div>\n        <div\n            s-else\n            class="{{$style[\'outline-disable-mask\']}}"\n            on-click="outlineClickHandle"\n        ></div>\n        <div\n            s-ref="wrapperInner"\n            class="{{$style[\'content-box-wrap\']}}"\n        >\n            <div\n                s-for="item, i in nodes"\n                class="{{$style[\'chapter-wrapper\']}}"\n            >\n                <content-box\n                    data="{=item.data=}"\n                    level="{{1}}"\n                    tag="{{i === 0 ? \'主标题：\' : \'第\' + i + \'章：\'}}"\n                    edit-id="{{editNodeId}}"\n                    is-title="{{i === 0}}"\n                    index="{{i}}"\n                    disable="{{globalDisable}}"\n                    type="{{outlineType}}"\n                    can-edit="{{canEdit}}"\n                    is-last="{{i === nodes.length - 1 && !item.children.length}}"\n                    is-has-child="{{!!item.children.length}}"\n                    on-add-node="addNode"\n                    on-delete-node="deleteNode"\n                    on-move-down-level="moveDownLevel"\n                    on-enter-edit="enterEdit"\n                    on-real-edited="realEditedHandle"\n                    on-textarea-blur="textareaBlurHandle"\n                />\n\n                <template s-for="child, j in item.children">\n                    <content-box\n                        data="{=child.data=}"\n                        level="{{2}}"\n                        tag="{{i + \'.\' + (j + 1)}}"\n                        edit-id="{{editNodeId}}"\n                        disable="{{globalDisable}}"\n                        type="{{outlineType}}"\n                        can-edit="{{canEdit}}"\n                        is-last="{{i === nodes.length - 1 && j === item.children.length - 1}}"\n                        on-add-node="addNode"\n                        on-delete-node="deleteNode"\n                        on-move-up-level="moveUpLevel"\n                        on-move-down-level="moveDownLevel"\n                        on-enter-edit="enterEdit"\n                        on-real-edited="realEditedHandle"\n                        on-textarea-blur="textareaBlurHandle"\n                    />\n                </template>\n            </div>\n        </div>\n\n        \x3c!-- 底部按钮 --\x3e\n        <div\n            s-if="!isStop"\n            class="{{$style[\'outline-bottom-button-container\']}}"\n        >\n            <div\n                s-if="isLoading"\n                class="{{$style[\'outline-loading\']}}"\n            >\n                <chat-loading\n                    sse-status="1"\n                    appearance="steps"\n                />\n            </div>\n            <div\n                s-else\n                class="{{$style[\'outline-btn-wrapper\']}}"\n            >\n                <div\n                    s-if="edited"\n                    class="{{$style[\'edit-text\']}}"\n                >\n                    已编辑\n                </div>\n                <div\n                    s-if="!isOpenCurWorkspace"\n                    s-ref="selectTemplateButton"\n                    class="{{$style[\'outline-action-button\']}}"\n                    on-click="handleSelectTemplateButtonClick"\n                    on-touchstart="handleSelectTemplateButtonClick"\n                >\n                    <cos-loading\n                        s-if="selectTemplateButtonLoading"\n                        position="right"\n                        appearance="reverse"\n                        text=" "\n                    />\n                    <img\n                        s-else\n                        class="{{$style[\'outline-action-button-logo\']}}"\n                        alt="ppt-logo"\n                        src="https://psstatic.cdn.bcebos.com/basics/chat/btn-ppt-logo_1742195947000.svg"\n                    />\n                    选择模板\n                </div>\n            </div>\n        </div>\n    </div>\n';var py="function"==typeof dy?dy.prototype.initData||hy:dy.initData||hy;function hy(){return{$style:uy}}function fy(){return Object.assign({},py.call(this),{$style:uy})}function gy(){return gy=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},gy.apply(this,Array.from(arguments))}"function"==typeof dy?dy.prototype.initData=fy:dy.initData=fy;var my=function(){function t(t){this.options={maxRetries:void 0!==t.maxRetries?t.maxRetries:3,retryDelay:void 0!==t.retryDelay?t.retryDelay:1e3,timeout:void 0!==t.timeout?t.timeout:1e4,onSuccess:"function"==typeof t.onSuccess?t.onSuccess:null,onError:"function"==typeof t.onError?t.onError:null},this.loadedResources={js:{},css:{}}}var e=t.prototype;return e.loadMicroApp=function(t,e){var n=this;void 0===e&&(e={});var a=gy({},this.options,e),i=t.js,o=void 0===i?[]:i,r=t.css,s=void 0===r?[]:r,c=o.every((function(t){return n.loadedResources.js[t]})),l=s.every((function(t){return n.loadedResources.css[t]}));if(c&&l)return"function"==typeof a.onSuccess&&a.onSuccess(),Promise.resolve({success:!0,alreadyLoaded:!0});var d=o.filter((function(t){return!n.loadedResources.js[t]})),u=s.filter((function(t){return!n.loadedResources.css[t]}));return new Promise((function(t,e){n._loadCssResources(u,a).then((function(){return n._loadJsResources(d,a)})).then((function(){"function"==typeof a.onSuccess&&a.onSuccess(),t({success:!0})})).catch((function(t){"function"==typeof a.onError&&a.onError(t),e(t)}))}))},e.unloadMicroApp=function(t){var e=this,n=t.js,a=void 0===n?[]:n,i=t.css;return(void 0===i?[]:i).forEach((function(t){if(e.loadedResources.css[t]){var n=document.querySelectorAll('link[href="'+t+'"]');Array.from(n).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)})),delete e.loadedResources.css[t]}})),a.forEach((function(t){if(e.loadedResources.js[t]){var n=document.querySelectorAll('script[src="'+t+'"]');Array.from(n).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)})),delete e.loadedResources.js[t]}})),{success:!0}},e._loadCssResources=function(t,e){var n=this;if(!t||0===t.length)return Promise.resolve();var a=t.map((function(t){return n.loadedResources.css[t]?Promise.resolve():n._loadResourceWithRetry((function(){return n._loadCss(t,e)}),e.maxRetries,e.retryDelay).then((function(){n.loadedResources.css[t]=!0}))}));return Promise.all(a)},e._loadJsResources=function(t,e){var n=this;return t&&0!==t.length?t.reduce((function(t,a){return t.then((function(){return n.loadedResources.js[a]?Promise.resolve():n._loadResourceWithRetry((function(){return n._loadJs(a,e)}),e.maxRetries,e.retryDelay).then((function(){n.loadedResources.js[a]=!0}))}))}),Promise.resolve()):Promise.resolve()},e._loadResourceWithRetry=function(t,e,n){var a=this;return new Promise((function(i,o){t().then(i).catch((function(r){if(e<=0)return o(r);console.warn("资源加载失败，"+n+"ms 后重试，剩余重试次数: "+e,r),setTimeout((function(){a._loadResourceWithRetry(t,e-1,n).then(i).catch(o)}),n)}))}))},e._loadCss=function(t,e){var n=this;return new Promise((function(a,i){if(document.querySelectorAll('link[href="'+t+'"]').length>0)return n.loadedResources.css[t]=!0,a();var o=document.createElement("link"),r=!1,s=null;e.timeout&&(s=setTimeout((function(){r=!0,i(new Error("加载 CSS 超时: "+t))}),e.timeout)),o.rel="stylesheet",o.type="text/css",o.href=t,o.onload=function(){r||(clearTimeout(s),a())},o.onerror=function(){r||(clearTimeout(s),i(new Error("加载 CSS 失败: "+t)))},document.head.appendChild(o)}))},e._loadJs=function(t,e){var n=this;return new Promise((function(a,i){if(document.querySelectorAll('script[src="'+t+'"]').length>0)return n.loadedResources.js[t]=!0,a();var o=document.createElement("script"),r=!1,s=null;e.timeout&&(s=setTimeout((function(){r=!0,i(new Error("加载 JS 超时: "+t))}),e.timeout)),o.type="text/javascript",o.src=t,o.async=!1,o.onload=function(){r||(clearTimeout(s),a())},o.onerror=function(){r||(clearTimeout(s),i(new Error("加载 JS 失败: "+t)))},document.head.appendChild(o)}))},e.isLoaded=function(t){var e=this,n=t.js,a=void 0===n?[]:n,i=t.css,o=void 0===i?[]:i,r=a.every((function(t){return e.loadedResources.js[t]})),s=o.every((function(t){return e.loadedResources.css[t]}));return r&&s},e.getLoadedResources=function(){return{js:Object.keys(this.loadedResources.js),css:Object.keys(this.loadedResources.css)}},e.clearAllResources=function(){return Object.keys(this.loadedResources.css).forEach((function(t){var e=document.querySelectorAll('link[href="'+t+'"]');Array.from(e).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))})),this.loadedResources.css={},Object.keys(this.loadedResources.js).forEach((function(t){var e=document.querySelectorAll('script[src="'+t+'"]');Array.from(e).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))})),this.loadedResources.js={},{success:!0}},t}();function vy(t){return"https://wenku.baidu.com/view/"+t+".html?fr=AI_search_AIPPT"}function yy(t,e){return"ppt-preview-root__"+t+"__"+e}function by(t,e){return t+"_"+e}function wy(t){var e="#"+t+" #mobile-thumbnails";return document.querySelector(e)}var _y,ky=(_y=null,function(){return _y||(_y=new my({maxRetries:3,retryDelay:1500,timeout:15e3,onSuccess:function(){},onError:function(t){return console.error("模块加载失败:",t)}})),_y});function Sy(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function xy(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Sy(o,a,i,r,s,"next",t)}function s(t){Sy(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Iy(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Ty=a.defineComponent({components:{"cos-icon":e.Icon},computed:{},initData:function(){return{docQid:"",docLid:"",docId:"",title:"",pptViewerId:"",isDownload:!1}},attached:function(){var t=this;si().on((function(e){e.pptUniqId===t.data.get("pptViewerId")&&t.handleDownload()}))},handleDownload:function(){return xy((function(){var t;return Iy(this,(function(n){var a,i,o,r,s;return t=this,e.Toast.show({message:"正在下载中...",duration:3e3}),(a={docQid:this.data.get("docQid"),docLid:this.data.get("docLid"),docId:this.data.get("docId"),title:this.data.get("title")},i=a.docQid,o=a.docLid,r=a.docId,s=a.title,ja(Je.getState("chatParams").sse_host+"/aichat/api/ppt/download?docQid="+i+"&tk="+$r()+"&docLid="+o+"&docId="+r+"&title="+s,{credentials:"include"},5e3).then((function(t){return 1003===t.status?Promise.reject():0===t.status&&t.data?Promise.resolve(t.data):Promise.reject()})).catch((function(t){}))).then((function(e){e.isDeleted?t.fire("ppt-file-deleted"):e.isLimit&&!t.data.get("isDownload")?window.open("https://wenku.baidu.com/ndbusiness/browse/wenkuvipcashier?third_fr=search_ppt&cashier_code=P*search_ppt-L*ppt_download"):(window.open(e.url),ri().emit({type:"updateUserInfo",data:{}}),t.data.set("isDownload",!0))})),[2]}))})).apply(this)},handlePreview:function(){this.fire("handle-preview")},handleEdit:function(){return xy((function(){return Iy(this,(function(t){switch(t.label){case 0:return[4,(e={docQid:this.data.get("docQid"),docLid:this.data.get("docLid"),docId:this.data.get("docId")},n=e.docQid,a=e.docLid,i=e.docId,ja(Je.getState("chatParams").sse_host+"/aichat/api/ppt/status?tk="+$r()+"&docQid="+n+"&docLid="+a+"&docId="+i,{credentials:"include"},3e3).then((function(t){return 1003===t.status?Promise.reject():0===t.status&&t.data?Promise.resolve(t.data):Promise.reject()})).catch((function(t){})))];case 1:return t.sent().isDeleted?this.fire("ppt-file-deleted"):window.open(vy(this.data.get("docId"))),[2]}var e,n,a,i}))})).apply(this)},getLogInfo:function(t){return JSON.stringify({type:"click",value:t,page:"resultpage",ubcExt:{enter_type:"home_tab",setype:"csaitab"}})}}),Cy={};Cy=Object.assign(Cy,{pptViewerPptMenuWrapper:"ppt-viewer-ppt-menu-wrapper_ahj5n_1","ppt-viewer-ppt-menu-wrapper":"ppt-viewer-ppt-menu-wrapper_ahj5n_1",pptViewerPptMenu:"ppt-viewer-ppt-menu_ahj5n_1","ppt-viewer-ppt-menu":"ppt-viewer-ppt-menu_ahj5n_1",pptViewerPptMenuItem:"ppt-viewer-ppt-menu-item_ahj5n_18","ppt-viewer-ppt-menu-item":"ppt-viewer-ppt-menu-item_ahj5n_18",pptViewerPptMenuItemIcon:"ppt-viewer-ppt-menu-item-icon_ahj5n_25","ppt-viewer-ppt-menu-item-icon":"ppt-viewer-ppt-menu-item-icon_ahj5n_25",pptViewerPptMenuItemText:"ppt-viewer-ppt-menu-item-text_ahj5n_29","ppt-viewer-ppt-menu-item-text":"ppt-viewer-ppt-menu-item-text_ahj5n_29"}),Ty.template='\n    <div class="{{$style[\'ppt-viewer-ppt-menu-wrapper\']}} ppt-viewer-ppt-menu-hover">\n        <div\n            class="{{$style[\'ppt-viewer-ppt-menu\']}}"\n            need-click-log\n        >\n            <div\n                class="{{$style[\'ppt-viewer-ppt-menu-item\']}}"\n                on-click="handleDownload"\n                on-touchstart="handleDownload"\n                data-click-log="{{getLogInfo(\'ppt_file_download\')}}"\n            >\n                <cos-icon\n                    name="download"\n                    class="{{$style[\'ppt-viewer-ppt-menu-item-icon\']}}"\n                />\n                <span class="{{$style[\'ppt-viewer-ppt-menu-item-text\']}}">下载</span>\n            </div>\n            <div\n                class="{{$style[\'ppt-viewer-ppt-menu-item\']}}"\n                on-click="handlePreview"\n                on-touchstart="handlePreview"\n                data-click-log="{{getLogInfo(\'ppt_file_preview\')}}"\n            >\n                <cos-icon\n                    name="eye"\n                    class="{{$style[\'ppt-viewer-ppt-menu-item-icon\']}}"\n                />\n                <span class="{{$style[\'ppt-viewer-ppt-menu-item-text\']}}">预览</span>\n            </div>\n            <div\n                class="{{$style[\'ppt-viewer-ppt-menu-item\']}}"\n                on-click="handleEdit"\n                on-touchstart="handleEdit"\n                data-click-log="{{getLogInfo(\'ppt_file_edit\')}}"\n            >\n                <cos-icon\n                    name="input"\n                    class="{{$style[\'ppt-viewer-ppt-menu-item-icon\']}}"\n                />\n                <span class="{{$style[\'ppt-viewer-ppt-menu-item-text\']}}">编辑</span>\n            </div>\n        </div>\n    </div>\n';var Ly="function"==typeof Ty?Ty.prototype.initData||Py:Ty.initData||Py;function Py(){return{$style:Cy}}function Dy(){return Object.assign({},Ly.call(this),{$style:Cy})}"function"==typeof Ty?Ty.prototype.initData=Dy:Ty.initData=Dy;var Ay="loading",Ey="success",Oy="fail",Ry="fail",Ny="delete";function qy(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function My(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){qy(o,a,i,r,s,"next",t)}function s(t){qy(o,a,i,r,s,"throw",t)}r(void 0)}))}}function jy(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function By(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Hy=St.connect(Je,{workspaceData:"workspaceData"})(a.defineComponent({components:{"cos-icon":e.Icon,"ppt-menu":Ty,"cos-loading":e.Loading},computed:{pptSuccessWidth:function(){return this.data.get("hasPPTImg")?"width: 270px;":"width: 220px;"},ubcPPTClickLog:function(){return JSON.stringify({type:"click",value:"ppt_cover",page:"resultpage",ubcExt:{enter_type:"home_tab",setype:"csaitab"}})},pptHeaderText:function(){var t=this.data.get("pptStatus"),e=this.data.get("errType");return t===Oy&&e===Ry?"":"基于上述大纲和模版即将为你生成PPT:"}},initData:function(){return{hasPPTImg:!0,pptStatus:Ay,errType:"",coverImg:"",pptTitle:"",bdjson:[],docId:"",docLid:"",docQid:"",qid:"",sessionId:"",value:{},rrToken:"",outlineLid:"",outlineQid:"",pptViewerId:"",wenkuQid:"",sseStop:!1,isDownload:!1,isHistory:!1}},attached:function(){var t=this;this.data.set("pptViewerId",Math.random().toString(36).substring(2,10));var e=this.data.get("value");e.status?this.appendContent(e,!0):(Nn().on((function(e){e.rank===t.data.get("rank")&&t.data.set("pptStatus",Ey)})),this.appendContent(e),Je.dispatch("update",{workspaceData:{wenku:{pptId:this.data.get("pptViewerId")}}})),li().on((function(e){t.data.get("sseStop")&&t.data.get("wenkuQid")===e.value.wenkuQid&&t.appendContent(e.value)})),di().on((function(e){e.rank===t.data.get("rank")&&t.stop("hint")}))},appendContent:function(t,e){var n=this;if(void 0===e&&(e=!1),this.data.set("value",t),t.status)setTimeout((function(){n.handlePCHoverMenu(["copy","reply"])}),500),this.data.assign({docId:t.docid,docLid:t.docLid,docQid:t.docQid,pptTitle:t.title,coverImg:t.coverImg,hasPPTImg:e&&t.coverImg,qid:t.qid,outlineLid:t.outlineLid,outlineQid:t.outlineQid,styleId:t.styleId,tplId:t.tplId,themeId:t.themeId,wenkuQid:t.wenkuQid,isHistory:e}),e?this.data.assign({isDownload:t.isDownload,pptStatus:t.isDeleted?Oy:Ey,errType:t.isDeleted?Ny:""}):(t.rrToken&&this.data.set("rrToken",t.rrToken),ri().emit({type:"ppt",pptUniqId:this.data.get("pptViewerId"),data:{bdjson:this.data.get("bdjson"),renderType:"sse",docId:t.docid,endTurn:!0}}));else{var a,i=t.bdjson;this.data.push("bdjson",i?null==(a=JSON.parse(i))?void 0:a[0]:{}),this.data.assign({outlineLid:t.outlineLid,outlineQid:t.outlineQid,wenkuQid:t.wenkuQid}),this.data.get("workspaceData.wenku.pptId")===this.data.get("pptViewerId")&&ri().emit({type:"ppt",pptUniqId:this.data.get("pptViewerId"),data:{bdjson:this.data.get("bdjson"),renderType:"sse"}})}this.fire("render-finished")},stop:function(t){var e=this;this.data.set("sseStop",!0),"hint"===t&&(this.data.set("pptStatus",Oy),this.data.set("errType",Ry),this.nextTick((function(){e.handleErrClick()})))},handlePCHoverMenu:function(t){void 0===t&&(t=[]);for(var e=null,n="",a=["feedback","delete","reply","copy"],i=a.length-1;i>=0;i--)if(!t.includes(a[i])){n=a[i];break}var o=gn(this.el,"cs-answer-container");if(o){var r=o.querySelector(".cs-answer-hover-menu");if(r){var s,c=null==(s=r.children)?void 0:s[0].children;if(Array.from(c).forEach((function(a){var i=a.dataset.clickLog;if(i){var o=JSON.parse(i);t.includes(o.ubcExt.button)?a.style.display="none":n===o.ubcExt.button&&(e=a)}})),"delete"===n){var l,d=null==(l=r.children)?void 0:l[0];jy(d,HTMLElement)&&(d.style.paddingRight="0")}else jy(e,HTMLElement)&&(e.style.marginRight="0")}}},handlePPTFileDeleted:function(){this.data.set("pptStatus",Oy),this.data.set("errType",Ny),e.Toast.show({message:"该文件已在百度文库删除，选择模板可重新生成",duration:2e3})},handleLoadingClick:function(){Je.dispatch("update",{showWorkspaceType:"wenku",workspaceData:{wenku:{pptId:this.data.get("pptViewerId")}}}),ri().emit({type:"ppt-active"})},handleErrClick:function(){this.handleTemplateData()},handleSuccessClick:function(){return My((function(){var t,e;return By(this,(function(n){switch(n.label){case 0:return Je.dispatch("update",{showWorkspaceType:"wenku",workspaceData:{wenku:{pptId:this.data.get("pptViewerId")}}}),ri().emit({type:"ppt-active"}),(t=this.data.get("isHistory"))||this.handleDataPreview(),[4,(a={docQid:this.data.get("docQid"),docLid:this.data.get("docLid"),docId:this.data.get("docId")},i=a.docId,o=a.docQid,r=a.docLid,ja(Je.getState("chatParams").sse_host+"/aichat/api/ppt/preview?tk="+$r()+"&docId="+i+"&docQid="+o+"&docLid="+r,{credentials:"include"},5e3).then((function(t){return 1003===t.status?Promise.reject():0===t.status&&t.data?Promise.resolve(t.data):Promise.reject()})).catch((function(t){})))];case 1:return(e=n.sent())?(e.isDeleted?(Je.dispatch("update",{showWorkspaceType:""}),this.handlePPTFileDeleted(),this.handleTemplateData()):(this.data.set("bdjson",e.slide),t&&this.handleDataPreview()),[2]):[2]}var a,i,o,r}))})).apply(this)},handleDataPreview:function(){ri().emit({type:"ppt",pptUniqId:this.data.get("pptViewerId"),data:{bdjson:this.data.get("bdjson"),renderType:"static",docId:this.data.get("docId"),isDownload:this.data.get("isDownload")}})},handleTemplateData:function(){return My((function(){var t,e,n;return By(this,(function(a){switch(a.label){case 0:return this.data.get("tplInfo.query"),t=this.data.get("outlineQid"),[4,Hv({outlineLid:e=this.data.get("outlineLid"),outlineQid:t})];case 1:return(n=a.sent())?(Je.dispatch("update",{showWorkspaceType:"wenku"}),ri().emit({type:"template",data:{outlineLid:e,outlineQid:t,themeId:n.themeId,templateList:n.list}}),[2]):[2]}}))})).apply(this)},disposed:function(){this.data.get("pptViewerId")===Je.getState("workspaceData.wenku.pptId")&&Je.dispatch("update",{showWorkspaceType:""})}})),$y={};$y=Object.assign($y,{pptViewerWrapper:"ppt-viewer-wrapper_1w1uz_1","ppt-viewer-wrapper":"ppt-viewer-wrapper_1w1uz_1",pptViewerGuideTitle:"ppt-viewer-guide-title_1w1uz_5","ppt-viewer-guide-title":"ppt-viewer-guide-title_1w1uz_5",pptViewerLoading:"ppt-viewer-loading_1w1uz_11","ppt-viewer-loading":"ppt-viewer-loading_1w1uz_11",pptViewerLoadingImgContainer:"ppt-viewer-loading-img-container_1w1uz_22","ppt-viewer-loading-img-container":"ppt-viewer-loading-img-container_1w1uz_22",pptViewerLoadingImg:"ppt-viewer-loading-img_1w1uz_22","ppt-viewer-loading-img":"ppt-viewer-loading-img_1w1uz_22",csLoading:"cs-loading_1w1uz_34","cs-loading":"cs-loading_1w1uz_34",pptViewerLoadingContent:"ppt-viewer-loading-content_1w1uz_43","ppt-viewer-loading-content":"ppt-viewer-loading-content_1w1uz_43",pptViewerLoadingContentDesc:"ppt-viewer-loading-content-desc_1w1uz_49","ppt-viewer-loading-content-desc":"ppt-viewer-loading-content-desc_1w1uz_49",pptViewerSuccessContent:"ppt-viewer-success-content_1w1uz_54","ppt-viewer-success-content":"ppt-viewer-success-content_1w1uz_54",pptViewerNoImg:"ppt-viewer-no-img_1w1uz_61","ppt-viewer-no-img":"ppt-viewer-no-img_1w1uz_61",pptViewerPptImg:"ppt-viewer-ppt-img_1w1uz_76","ppt-viewer-ppt-img":"ppt-viewer-ppt-img_1w1uz_76",pptViewerPptContent:"ppt-viewer-ppt-content_1w1uz_80","ppt-viewer-ppt-content":"ppt-viewer-ppt-content_1w1uz_80",pptViewerPptTitle:"ppt-viewer-ppt-title_1w1uz_83","ppt-viewer-ppt-title":"ppt-viewer-ppt-title_1w1uz_83",pptViewerPptDesc:"ppt-viewer-ppt-desc_1w1uz_93","ppt-viewer-ppt-desc":"ppt-viewer-ppt-desc_1w1uz_93",pptViewerHasImg:"ppt-viewer-has-img_1w1uz_99","ppt-viewer-has-img":"ppt-viewer-has-img_1w1uz_99",pptViewerHasImgContent:"ppt-viewer-has-img-content_1w1uz_108","ppt-viewer-has-img-content":"ppt-viewer-has-img-content_1w1uz_108",pptViewerHasImgContentTitle:"ppt-viewer-has-img-content-title_1w1uz_117","ppt-viewer-has-img-content-title":"ppt-viewer-has-img-content-title_1w1uz_117",pptViewerHasImgContentImg:"ppt-viewer-has-img-content-img_1w1uz_123","ppt-viewer-has-img-content-img":"ppt-viewer-has-img-content-img_1w1uz_123",pptViewerPptImgContainer:"ppt-viewer-ppt-img-container_1w1uz_127","ppt-viewer-ppt-img-container":"ppt-viewer-ppt-img-container_1w1uz_127",pptViewerErrWrapper:"ppt-viewer-err-wrapper_1w1uz_147","ppt-viewer-err-wrapper":"ppt-viewer-err-wrapper_1w1uz_147",pptViewerErrContent:"ppt-viewer-err-content_1w1uz_156","ppt-viewer-err-content":"ppt-viewer-err-content_1w1uz_156",pptViewerErrContentTitle:"ppt-viewer-err-content-title_1w1uz_163","ppt-viewer-err-content-title":"ppt-viewer-err-content-title_1w1uz_163",pptViewerErrContentIcon:"ppt-viewer-err-content-icon_1w1uz_168","ppt-viewer-err-content-icon":"ppt-viewer-err-content-icon_1w1uz_168",pptViewerErrImg:"ppt-viewer-err-img_1w1uz_173","ppt-viewer-err-img":"ppt-viewer-err-img_1w1uz_173",errImg:"err-img_1w1uz_183","err-img":"err-img_1w1uz_183"}),Hy.template='\n    <div class="{{$style[\'ppt-viewer-wrapper\']}}">\n        <div class="{{$style[\'ppt-viewer-guide-title\']}}"> {{ pptHeaderText }} </div>\n        <div\n            s-if="{{pptStatus === \'loading\'}}"\n            class="{{$style[\'ppt-viewer-loading\']}}"\n            on-click="handleLoadingClick"\n            on-touchstart="handleLoadingClick"\n        >\n            <div class="{{$style[\'ppt-viewer-loading-img-container\']}}">\n                <cos-loading\n                    text=""\n                    class="{{$style[\'cs-loading\']}}"\n                />\n                <img\n                    class="{{$style[\'ppt-viewer-loading-img\']}}"\n                    src="https://psstatic.cdn.bcebos.com/basics/aichat/empty-file_1741832059000.png"\n                    alt=""\n                />\n            </div>\n            <div class="{{$style[\'ppt-viewer-loading-content\']}}">\n                <div class="{{$style[\'ppt-viewer-loading-content-desc\']}}">正在生成中...</div>\n            </div>\n        </div>\n        <div\n            s-else-if="{{pptStatus === \'success\'}}"\n            class="{{$style[\'ppt-viewer-success-content\']}}"\n            style="{{pptSuccessWidth}}"\n        >\n            <div\n                s-if="{{hasPPTImg}}"\n                class="{{$style[\'ppt-viewer-has-img\']}}"\n                on-click="handleSuccessClick"\n                on-touchstart="handleSuccessClick"\n                data-click-log="{{ubcPPTClickLog}}"\n                need-click-log\n            >\n                <div class="{{$style[\'ppt-viewer-has-img-content\']}}">\n                    <img\n                        class="{{$style[\'ppt-viewer-has-img-content-img\']}}"\n                        src="https://psstatic.cdn.bcebos.com/basics/aichat/image_1741847966000.png"\n                        alt=""\n                    />\n                    <span class="{{$style[\'ppt-viewer-has-img-content-title\']}}">{{ pptTitle }}</span>\n                </div>\n                <div class="{{$style[\'ppt-viewer-ppt-img-container\']}}">\n                    <img\n                        class="{{$style[\'ppt-viewer-ppt-img\']}}"\n                        src="{{coverImg}}"\n                        alt=""\n                    />\n                </div>\n            </div>\n            <div\n                s-else\n                class="{{$style[\'ppt-viewer-no-img\']}}"\n                on-click="handleSuccessClick"\n                on-touchstart="handleSuccessClick"\n                data-click-log="{{ubcPPTClickLog}}"\n                need-click-log\n            >\n                <img\n                    class="{{$style[\'ppt-viewer-ppt-img\']}}"\n                    src="https://psstatic.cdn.bcebos.com/basics/aichat/ppt-file_1741832038000.png"\n                    alt=""\n                />\n                <div class="{{$style[\'ppt-viewer-ppt-content\']}}">\n                    <div class="{{$style[\'ppt-viewer-ppt-title\']}}">\n                        {{ pptTitle }}\n                    </div>\n                    <div class="{{$style[\'ppt-viewer-ppt-desc\']}}"> PPT已完成 </div>\n                </div>\n            </div>\n            <ppt-menu\n                on-handle-preview="handleSuccessClick"\n                on-ppt-file-deleted="handlePPTFileDeleted"\n                doc-id="{{docId}}"\n                doc-Qid="{{docQid}}"\n                doc-Lid="{{docLid}}"\n                title="{{pptTitle}}"\n                ppt-viewer-id="{{pptViewerId}}"\n                is-download="{=isDownload=}"\n            />\n        </div>\n        <div\n            s-else-if="{{pptStatus === \'fail\'}}"\n            class="{{$style[\'ppt-viewer-err-wrapper\']}}"\n            on-click="handleErrClick"\n            on-touchstart="handleErrClick"\n        >\n            <div class="{{$style[\'ppt-viewer-err-content\']}}">\n                <cos-icon\n                    name="info-circle-fill"\n                    class="{{$style[\'ppt-viewer-err-content-icon\']}}"\n                />\n                <span\n                    class="{{$style[\'ppt-viewer-err-content-title\']}}"\n                    s-if="{{errType === \'delete\'}}"\n                >\n                    PPT已删除，点击重新生成\n                </span>\n                <span\n                    class="{{$style[\'ppt-viewer-err-content-title\']}}"\n                    s-else\n                >\n                    PPT生成失败，点击重新生成\n                </span>\n            </div>\n            <div class="{{$style[\'ppt-viewer-err-img\']}}">\n                <img\n                    class="{{$style[\'err-img\']}}"\n                    src="https://psstatic.cdn.bcebos.com/basics/aichat/empty_img_1741865189000.png"\n                    alt=""\n                />\n            </div>\n        </div>\n    </div>\n';var Uy="function"==typeof Hy?Hy.prototype.initData||Fy:Hy.initData||Fy;function Fy(){return{$style:$y}}function Gy(){return Object.assign({},Uy.call(this),{$style:$y})}function Wy(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function zy(){return zy=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zy.apply(this,Array.from(arguments))}function Qy(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Hy?Hy.prototype.initData=Gy:Hy.initData=Gy;var Jy,Vy=["ai-writing"],Ky=["ai-markdown","ai-markdown-editor"],Xy=["ai-office-writing"],Yy=["ai-copyable-text"],Zy=["searchingSteps","reference","imageGroup","generalVideo","uijson","officeWriting","shortcuts","capsule","writing","ala-card","questionGuide"];!function(t){t.WORD="word",t.ALL="all"}(Jy||(Jy={}));var tb={"ai-markdown":e.Markdown,"ai-image":_h,"ai-image-group":Th,"ai-image-scroll":Eh,"ai-video-scroll":Oh,"ai-general-video":Wf,"ai-echart":n.AIEchart,"ai-image-with-thumbnail":n.AIImageWithThumbnail,"ai-markdown-editor":n.AIMarkdownEditor,"ai-comparison":e.Comparison,"ai-uijson":tg,"ai-exam-qa":fm,"ai-writing":xm,"ai-office-writing":Pm,"ai-copyable-text":e.CopyableText,"ai-reasoning-content":cf,"ai-thinking-steps":Bf,"ai-chat-form":_v,"ai-bottom-tip":Tv,"ai-outline-editor":dy,"ai-ppt-viewer":Hy,"ai-progress":mf},eb=/\^(\d+)\^/g,nb=/\^(\^|\d|\s)+\^/g,ab={play:"video_cpt_play",pause:"video_cpt_pause",muted:"video_cpt_mute",volume:"video_cpt_sound",seeked:"video_cpt_slide"},ib={play:"music_cpt_play",pause:"music_cpt_pause"},ob=null,rb=a.defineComponent({trimWhitespace:"all",components:tb,initData:function(){return{agentInfo:null,context:void 0,id:"",renderMode:"ssr-csr",blocks:[],audios:{},hasFold:!1,maxHeight:1680,typingSpeed:30,generatingSuffix:"",completeSuffix:"",referenceBlock:void 0,referenceElement:void 0,thinkingReference:[],blocksForCsrStatic:[],status:mh.IDLE,StatusSet:mh,accBlocks:[],curBlock:void 0,askUsedModel:{},usedModel:{},queqeIndex:-1,queue:[],prevBlockRenderFinished:!0,lastBlockRender:!1,isYiyan:!1,abortType:void 0,abortMsg:"",abortMsgShow:"",abortMsgHasTopSpace:!0,isRenderFinishedDispatched:!1,hasMarkdownRenderReady:!1,answerIndex:0,cid:"",isPc:"pc"===rt(),normalizeContent:Wh,isHistory:!1}},inited:function(){var t=this.data.get("renderMode"),e=this.data.get("context");e?e.renderMode=t:e={renderMode:t},this.data.set("context",e);var n=this.data.get("blocks");n.forEach(this.formatBlock.bind(this)),this.data.set("blocks",n)},dynamicStyle:function(t,e,n){return 0===e&&0===n&&"ai-markdown"!==t.component?"clear:both;":""},dynamicClass:function(t,e,n){var a=t.component;return 0===e?["ai-markdown","ai-exam-qa","ai-image","ai-general-video","ai-image-group","ai-office-writing","ai-reasoning-content"].includes(a)||0!==n?"":"ai-uijson"===a?"cos-space-pt-sm":"cos-space-pt-md":["ai-input","ai-markdown-editor"].includes(a)?"cos-space-mt-md":"cos-space-mt-lg"},realShowExt:function(t){var e;if(!Yy.includes(t.component))return"";var n=(null==(e=t.data)?void 0:e.logExtData)||{};return JSON.stringify(zy({component_content:{component_name:this.kebabToCamel(t.component)},value:"nonala_cpt"},n))},noDialog:function(t){return["ai-markdown-editor","ai-image-with-thumbnail","ai-writing","ai-office-writing","ai-copyable-text"].includes(t.component)},attached:function(){var t=this;if("only-csr-static"===this.data.get("renderMode")){var e,n=this.data.get("blocks"),a=n.find((function(t){return"ai-thinking-steps"===t.component})),i=((null==a||null==(e=a.data)?void 0:e.referenceList)||[]).length?a:n.find((function(t){return"ai-reference"===t.component}));this.data.set("referenceBlock",i),this.data.set("blocksForCsrStatic",n),i&&(null==n||n.forEach((function(e){"ai-markdown"===e.component&&(e.data.referenceList=e.data.referenceList||i.data.referenceList,setTimeout(t.insertReferenceToMarkdown.bind(t,n,e.data.referenceList),1e3))}))),this.data.get("isPc")&&this.nextTick(this.addImageTools.bind(this))}this.startVisibilityChangeListener()},handleReady:function(t){-1===Vy.indexOf(t.component)&&-1===Ky.indexOf(t.component)||this.data.get("hasMarkdownRenderReady")||(this.data.set("hasMarkdownRenderReady",!0),this.fire("markdown-render-ready"))},clear:function(){this.data.set("status",mh.WAITING),this.data.set("accBlocks",[]),this.data.set("curBlock",void 0),this.data.set("queue",[]),this.data.set("prevBlockRenderFinished",!0),this.data.set("lastBlockRender",!1),this.data.set("isYiyan",!1),this.data.set("abortType",void 0),this.data.set("abortMsg",""),this.data.set("abortMsgShow",""),this.data.set("abortMsgHasTopSpace",!0),this.data.set("isRenderFinishedDispatched",!1)},stop:function(t,e){var n=this;this.data.set("status",mh.ABORT),this.data.set("abortType",t),this.data.set("abortMsg",e);var a,i,o,r,s=this.data.get("curBlock"),c=this.data.get("accBlocks"),l=c.length-1;("ai-markdown"!==(null==s?void 0:s.component)&&"ai-copyable-text"!==(null==s?void 0:s.component)&&"ai-reasoning-content"!==(null==s?void 0:s.component)&&"separate-bub"!==t||this.stopTyping(l),"ai-outline-editor"===(null==s?void 0:s.component))&&(null==(a=this.ref(s.component+l))||a.stop());"ai-ppt-viewer"===(null==s?void 0:s.component)&&(null==(i=this.ref(s.component+l))||i.stop(t));"ai-markdown-editor"===(null==s?void 0:s.component)&&(null==(o=this.ref(s.component+l))||o.cancelTyping());(Vy.includes(null==s?void 0:s.component)||Xy.includes(null==s?void 0:s.component))&&(null==(r=this.ref(s.component+l))||r.stop());var d,u=c.findIndex((function(t){return"ai-thinking-steps"===t.component}));-1!==u&&(null==(d=this.ref("ai-thinking-steps"+u))||d.forceStop(t));this.nextTick((function(){n.isEmpty()?(n.data.set("abortMsgShow",n.data.get("abortMsg")),n.data.set("abortMsgHasTopSpace",!1)):"user-abort"===n.data.get("abortType")?n.data.set("abortMsgShow",""):n.data.set("abortMsgShow",n.data.get("abortMsg")),n.dispatchRenderFinished(t)})),this.lastUiJsonStop()},startWaiting:function(){this.data.set("status",mh.WAITING)},startGenerating:function(){this.data.set("status",mh.GENERATING)},pushBlock:function(t){this.data.get("status")!==mh.ABORT&&t&&(t.data||(t.data={}),t&&t.component&&!t.component.includes("markdown")&&!Zy.includes(t.component)&&(!function(t){var e;tn.sendExcept({group:"chat_compontent_display",info:{msg:t,query:yt(Je.getState("query")),platform:rt(),agentName:(null==(e=Je.getState("agentInfo"))?void 0:e.agentName)||""}})}(t.component),Zy.push(t.component)),"reference"!==t.component&&"dqaReference"!==t.component||this.data.set("referenceBlock",t),this.formatBlock(t),t._index=this.data.get("queqeIndex")+1,this.data.set("queqeIndex",t._index),this.data.push("queue",t),Mm("进新包：","序号("+(null==t?void 0:t._index)+")",t.component,t.data),Mm("当前正在处理的包的完成情况：",this.data.get("prevBlockRenderFinished")),this.data.get("prevBlockRenderFinished")&&(this.data.set("prevBlockRenderFinished",!1),this.findNextBlockAndRender()))},insertReferenceToMarkdown:function(t,e){var n=t||this.data.get("accBlocks");if(e&&n)for(var a=0;a<n.length;a++){var i=n[a],o=i.component,r=void 0===o?"":o;if("ai-markdown"===r||"ai-reasoning-content"===r||"ai-thinking-steps"===r||Xy.includes(r)){var s="";if(null==e?void 0:e.length){var l,d,u,p=e.map((function(t){return zy({},t,{source:{logo:t.icon,name:t.source},title:t.text,thumbnail:t.poster,linkInfo:{href:t.url}})}));s+=c.dataToSource("citationList",p);var h=this.ref(""+r+a);Xy.includes(r)||"ai-reasoning-content"===r?(null==h?void 0:h.appendContent)&&h.appendContent(s,i.data):"ai-thinking-steps"===r?(null==h?void 0:h.appendReference)&&h.appendReference(s):null==h||h.appendContent(s),Mm("已经增加溯源扩展数据到markdown","序号"+(null==(l=n[a])?void 0:l._index),null==(d=n[a])?void 0:d.component,null==(u=n[a])?void 0:u.data,p)}}else"ai-writing"===i.component&&(i.data.referenceList||this.data.set("accBlocks["+a+"].data.referenceList",e))}this.handleBlockRenderFinished("referer包主动调用")},handleBlockRenderFinished:function(t){var e=this;this.nextTick((function(){var n=e.data.get("curBlock");if(!e.data.get("isHistory")&&n&&(e.fire("fragment-render-finished",e.data.get("curBlock")),e.data.set("prevBlockRenderFinished",!0),Mm("当前正在处理的包 已完成","序号"+(null==n?void 0:n._index),n.component,n.data,"处理完成的原因：",t,"还剩余未消费包数量：",e.data.get("queue").length),e.data.get("status")!==mh.ABORT))if(e.data.get("queue").length)e.findNextBlockAndRender();else if(e.data.get("lastBlockRender")){Mm("准备结束ai-entry（因为队列为空且有结束包）","序号"+(null==n?void 0:n._index),n.component,n.data);var a=e.getLastBlockIndex("ai-markdown"),i=e.getLastBlockIndex("ai-office-writing"),o=e.getLastBlockIndex("ai-reasoning-content");(a>=0||i>=0||o>=0)&&(e.stopTyping(a),e.stopTyping(i),Ta().emit({isThinkingDone:!0}));var r=e.getLastBlockIndex("ai-function-buttons");r>-1&&e.data.set("accBlocks["+r+"].data.hasUnderline",!1);var s=e.getLastBlockIndex("ai-markdown-editor");if(s>-1&&e.data.set("accBlocks["+s+"].data.hasUnderline",!1),e.data.set("status",mh.COMPLETE),e.dispatchRenderFinished(),e.isInvalidBlock(n))e.data.get("accBlocks").forEach((function(t,n){var a;null==(a=e.ref("ai-markdown"+n))||a.setTextDisable()}));e.stopTouchPropagationForScroll()}}))},stopTyping:function(t){var e,n,a,i,o;t<0||(null==(e=this.ref("ai-markdown"+t))||e.stop(),null==(n=this.ref("ai-office-writing"+t))||n.stop(),null==(a=this.ref("ai-copyable-text"+t))||a.stop(),null==(i=this.ref("ai-reasoning-content"+t))||i.stop(),null==(o=this.ref("ai-thinking-steps"+t))||o.stop(),this.lastUiJsonStop())},lastUiJsonStop:function(){null==ob||ob.lastUiJsonDone(),ob=null},findNextBlockAndRender:function(){return(t=function(){var t,e,n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_,k;return Qy(this,(function(S){switch(S.label){case 0:if(t=this,e=this.data.get("curBlock"),n=this.data.get("queue"),this.data.get("isPc")||(a=Qm(n),this.data.set("queue",a)),i=this.data.shift("queue"),this.data.set("curBlock",i),Mm("开始消费队列的包","序号"+(null==i?void 0:i._index),i.component,i.data),this.isLastBlock(i)&&(Mm("出现了finish的包","序号"+(null==i?void 0:i._index),i.component,i.data),this.data.set("lastBlockRender",!0),this.stopTouchPropagationForScroll(),this.lastUiJsonStop()),!fo(i.usedModel)&&fo(this.data.get("usedModel"))&&this.data.set("usedModel",i.usedModel),this.data.set("prevBlockRenderFinished",!1),this.isBlockNotForRender(i))return"ai-reference"===i.component?this.insertReferenceToMarkdown(this.data.get("accBlocks"),null==(o=i.data)?void 0:o.referenceList):this.handleBlockRenderFinished("非渲染包"),[2];if("ai-uijson"!==i.component)return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,Ro(this.data.get("agentInfo"))];case 2:return S.sent(),[3,4];case 3:return S.sent(),this.handleBlockRenderFinished("非渲染包"),[2];case 4:if(e&&e.component===i.component){if(l=this.data.get("accBlocks"),d=l.length-1,u=this.ref(""+(null==(r=l[d])?void 0:r.component)+d),e.data.isComponentFinished)return this.data.push("accBlocks",i),[2];p=this.data.get("accBlocks["+d+"]").data.functionButtons,"ai-uijson"!==i.component&&ob&&this.lastUiJsonStop(),"ai-markdown-editor"===i.component&&p||(null==(s=e.data)?void 0:s.referenceToggleIcon)||(null==(c=i.data)?void 0:c.referenceToggleIcon)?(this.data.push("accBlocks",i),this.stopTyping(d)):i.data.functionButtons?this.data.set("accBlocks["+d+"].data.functionButtons",i.data.functionButtons):"ai-uijson"===i.component?"uiMeta"!==i.dataType?(null==u||u.updateData(i.data),ob=u):this.data.push("accBlocks",i):"ai-markdown"===i.component?i.data.content?((null==u?void 0:u.appendContent)&&(null==(h=i.data)?void 0:h.content)&&(null==u||u.appendContent(i.data.content)),l[d].data.content+=i.data.content):this.handleBlockRenderFinished("空markdown包"):-1!==Vy.indexOf(i.component)||Xy.includes(i.component)?(f=i.data.content,(null==u?void 0:u.appendContent)&&u.appendContent(f,i.data),f||this.handleBlockRenderFinished("空markdown包")):"ai-thinking-steps"===i.component?(null==u?void 0:u.updateData)&&u.updateData(i.data):"ai-progress"===i.component?(null==u?void 0:u.updateData)&&u.updateData({content:i.data}):(null==u?void 0:u.appendContent)&&u.appendContent(i.data.rawValue||i.data.value)}else g=this.getLastBlockIndex("ai-markdown"),m=this.getLastBlockIndex("ai-office-writing"),v=this.getLastBlockIndex("ai-reasoning-content"),(g>=0||m>=0||v>=0)&&(this.stopTyping(g),this.stopTyping(m),Ta().emit({isThinkingDone:!0})),"ai-markdown"!==i.component||i.data.content?"ai-progress"===i.component?(this.data.push("accBlocks",i),this.handleBlockRenderFinished("图片加载包")):"ai-thinking-steps"===i.component?(y=this.data.get("accBlocks"),b=y.findIndex((function(t){return"ai-thinking-steps"===t.component})),y.filter((function(t){return"ai-progress"===t.component})).length>0&&this.data.set("accBlocks",y.filter((function(t){return"ai-progress"!==t.component}))),b<0?this.data.push("accBlocks",i):this.insertReferenceToMarkdown(y,this.data.get("thinkingReference")),w=b<0?y.length-1:b,this.nextTick((function(){var e,n=t.ref(""+(null==(e=y[w])?void 0:e.component)+w);(null==n?void 0:n.updateData)&&n.updateData(i.data),t.handleBlockRenderFinished("当前包渲染结束")}))):(this.data.push("accBlocks",i),"ai-reasoning-content"===i.component&&(_=this.data.get("accBlocks"),k=_.length-1,this.nextTick((function(){var e,n=t.ref(""+(null==(e=_[k])?void 0:e.component)+k);"ai-reasoning-content"===i.component&&(null==n?void 0:n.appendContent)&&n.appendContent(i.data.value),t.handleBlockRenderFinished("当前包渲染结束")})))):(this.data.push("accBlocks",i),this.handleBlockRenderFinished("空markdown包"));return[2]}}))},function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Wy(o,a,i,r,s,"next",t)}function s(t){Wy(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var t},handleAudioPlay:function(t){var e=t.markdownId,n=t.audioList,a=t.playIndex,i=this.data.get("audios");i[e]=n,Object.keys(i).forEach((function(t){i[t].forEach((function(n,i){+e==+t&&+a==+i||!n.data.get("playStatus")||n.handlePlayPause()}))})),this.dispatch("ai-entry:audio",{entryId:this.data.get("id"),markdownId:e,playIndex:a,audios:i})},handleToggleReference:function(t){var e=this,n=t.id,a=t.referenceIcon;this.dispatch("ai-entry:toggle-reference",{entryId:this.data.get("id"),markdownId:n,referenceIcon:a});var i=this.data.get("renderMode"),o=this.data.get("blocks"),r=this.data.get("accBlocks"),s=o,c="blocks";"only-csr"===i&&(s=r,c="accBlocks"),null==s||s.forEach((function(t,i){e.data.splice(c,[i,1,zy({},t,{data:zy({},t.data,{referenceToggleIcon:"hidden"===t.data.referenceToggleIcon?"hidden":i===n?a:"down"})})])}))},handleCopyClick:function(t){this.fire("copy",{event:t.event,text:t.content})},handleUpdateReference:function(t){this.data.set("thinkingReference",t)},formatBlock:function(t){var e=this;("markdown-yiyan"===t.component&&(this.data.set("isYiyan",!0),t.isYiyan=!0,this.data.set("normalizeContent",(function(t){return Gh(t,e.data.get("isPc"))}))),["markdown-yiyan","markdown-hamburg"].includes(t.component)?(t.data.type="markdown-yiyan"===t.component?"yiyan":"sfm",t.component="markdown"):"markdown-with-askback"===t.component&&(t.component="markdown"),"uijson"===t.component)&&("only-csr"===this.data.get("renderMode")&&(t.data.generatingSuffix=this.data.get("generatingSuffix")));if("markdownEditor"===t.component&&t.data){var n=this.data.get("renderMode");"only-csr"===n?(t.data.typingSwitch=!0,t.data.typingSpeed=this.data.get("typingSpeed"),t.data.rawValue=t.data.value,t.data.value="",t.data.suffix=this.data.get("generatingSuffix")):"only-csr-static"===n&&(t.data.typingSwitch=!1,t.data.rawValue=t.data.value,t.data.value="")}if("reasoningContent"===t.component){var a=this.data.get("renderMode");"only-csr"===a?t.data.typing={speed:this.data.get("isPc")?10:300,cursor:!0,mode:"all"}:"only-csr-static"===a&&(t.data.typing=null)}if("thinkingSteps"===t.component){var i=this.data.get("renderMode");"only-csr"===i?t.data.typing={speed:this.data.get("isPc")?10:30,cursor:!0,mode:"all"}:"only-csr-static"===i&&(t.data.typing=null)}if("copyableText"===t.component){var o=this.data.get("renderMode");"only-csr"===o?(t.data.typing={speed:this.data.get("typingSpeed")},t.data.suffix=this.data.get("generatingSuffix")):"only-csr-static"===o&&(t.data.typing=null)}if("writing"===t.component){var r=this.data.get("renderMode");"only-csr"===r?"all"===t.data.typingMode?t.data.typing=null:(t.data.typing={speed:this.data.get("typingSpeed")},t.data.suffix=this.data.get("generatingSuffix")):"only-csr-static"===r&&(t.data.typing=null)}"officeWriting"===t.component&&("only-csr-static"===this.data.get("renderMode")&&(t.data.typing={cursor:!1,mode:t.data.typingMode||"all"}));var s=t.component&&this.camel2kebab(t.component);if(t.component=s&&this.formatComponentName(s),"ai-markdown"===t.component){var c=t.data.value;t.data=zy({},t.data,{content:c}),"only-csr"===this.data.get("renderMode")&&(t.data.typing={speed:this.data.get("isPc")?10:"all"===t.data.typingHideMask?300:30,cursor:!0,hideMask:t.data.typingHideMask||!1,mode:t.data.typingMode||"all"}),this.data.get("isPc")&&this.handleImgs(c)}else t.data=zy({context:this.data.get("context")},t.data);"ai-markdown"===t.component&&this.markdownPreProcess(t)},handleImgs:function(t){var e=new MutationObserver(this.addImageTools.bind(this));this.el&&(null==e||e.observe(this.el,{childList:!0,subtree:!0})),this.data.set("imagDomObserver",e)},addImageTools:function(){var t,e;(t=this.el)&&(t.querySelector('.cosd-markdown .marklang a[type="agent"]')||(null==(e=t.closest(".cs-answer-container"))?void 0:e.querySelector("#agent-icon")))||Fm(this.el,this.imageToolClickCallBack.bind(this),this.data.get("question"))},imageToolClickCallBack:function(t){this.dispatch("send-ubclog",{type:"click",value:"create_pic",extra:{button:t}})},markdownPreProcess:function(t){t.data&&t.data.content&&(t.data.content=t.data.content.replace(nb,(function(t){var e,n=(null==(e=t.match(eb))?void 0:e.filter((function(t,e){return e<2})))||[];return n.join("")})))},camel2kebab:function(t){return t.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}))},kebabToCamel:function(t){return t.split("-").map((function(t,e){return 0===e?"":1===e?t.toLowerCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()})).join("")},formatComponentName:function(t){return t.startsWith("ai-")?t:"ai-"+t},getCurrentBlock:function(){var t=this.data.get("blocksForCsrStatic"),e=this.data.get("accBlocks"),n=this.data.get("blocks"),a=this.data.get("renderMode"),i=n;return"only-csr"===a?i=e:"only-csr-static"===a&&(i=t),i},handleComponent:function(t,e){for(var n=this,a=Array.from(arguments).length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=Array.from(arguments)[o];var r=this.getCurrentBlock();r&&r.forEach((function(a,o){var r;a.component===n.formatComponentName(t)&&(n.ref(a.component+o)&&(r=n.ref(a.component+o))[e].apply(r,[].concat(i)))}))},handleComponentAll:function(t){for(var e=this,n=Array.from(arguments).length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=Array.from(arguments)[i];var o=this.getCurrentBlock(),r=[];return o&&o.forEach((function(n,i){var o,s=e.ref(n.component+i);s&&s[t]&&r.push((o=s)[t].apply(o,[].concat(a)))})),Promise.all(r)},isBlockNotForRender:function(t){var e;return!t.component||"ai-reference"===t.component||!Object.keys(tb).includes("ai-"===t.component.slice(0,3)?t.component:"ai-"+t.component)||Xy.includes(null==t?void 0:t.component)&&!(null==(e=t.data)?void 0:e.content)},isMarkdownCmpt:function(t){return["markdown-yiyan","markdown-hamburg","markdown"].includes(t.component)},isLastBlock:function(t){return t.isFinished},isInvalidBlock:function(t){var e,n;return"hint"===(null==(e=t.notice)?void 0:e.noticeIcon)&&"dict3S"===(null==(n=t.notice)?void 0:n.noticeStyleType)},getLastBlockIndex:function(t){for(var e=this.data.get("accBlocks"),n=e.length-1;n>=0;n--)if(e[n].component===t)return n;return-1},stopTouchPropagationForScroll:function(){var t=this;this.nextTick((function(){var e=t.el;if(e){var n=e.querySelectorAll("code"),a=e.querySelectorAll("table");n.forEach(t.stopTouchPropagation),a.forEach(t.stopTouchPropagation)}}))},stopTouchPropagation:function(t){t.scrollWidth>=t.clientWidth&&(t.addEventListener("touchstart",(function(t){t.stopPropagation()})),t.addEventListener("touchmove",(function(t){t.stopPropagation()})),t.addEventListener("touchend",(function(t){t.stopPropagation()})))},isEmpty:function(){var t=this.ref("generatedContent");return!t||0===t.clientHeight},dispatchRenderFinished:function(t){void 0===t&&(t=""),this.data.get("isRenderFinishedDispatched")||(this.fire("render-finished"),this.dispatch("ai-entry:render-finished",{type:t}),this.data.set("isRenderFinishedDispatched",!0),this.stopVisibilityChangeListener())},handleActionLogEvent:function(t){this.fire("action-log-event",t)},handleShowLogEvent:function(t){this.fire("show-log-event",t)},handleMarkdownClick:function(t,e){var n=t.directive,a=t.event,i=t.from,o=t.data,r=t.action,s=t.target,c=this.data.get("isHistory")?"1":"0";n!==yh.AUDIO&&n!==yh.VIDEO||!s||"play"!==r||qm(n===yh.AUDIO?null==s?void 0:s.audio:null==s?void 0:s.el,n,this.data.get("isPc"));if("ai-markdown"===e||Xy.includes(e))if(this.data.get("isPc")&&"ml-citation"===n)this.dispatch("send-ubclog",{type:"click",value:"subscriptJump",extra:{valueInfo:[{component_name:"markdown",component_type:"reference"}],info_rank:o.citationId,is_his:c}});else{if("ml-citation"===n)"citationId"===i?this.fire("action-log-event",{actionType:"o",component:"markdown",componentType:"reference",ext:{action:"sup",entry_type:"1",refer_type:"text",is_his:c}}):"tooltip"===i&&this.fire("action-log-event",{actionType:"na",component:"markdown",componentType:"reference",ext:{panel_type:"1",refer_type:"",is_his:c}});else if(n===yh.AUDIO&&r&&Object.keys(ib).includes(r))this.fire("ubc-log-event",{type:"click",value:ib[r],extra:{music_name:null==s?void 0:s.data.get("title")}});else if(n===yh.VIDEO&&r&&Object.keys(ab).includes(r))this.fire("ubc-log-event",{type:"click",value:ab[r],extra:{video_name:null==s?void 0:s.data.get("src")}});else if("ml-site-vcard"===n){var l,d;this.fire("ubc-log-event",{type:"click",value:"siteVcard",extra:{valueInfo:[{component_name:"siteVcard",component_content:a.target.innerText}],agent_id:null==(l=this.data.get("agentInfo"))?void 0:l.agentId,agent_name:null==(d=this.data.get("agentInfo"))?void 0:d.agentName}})}if(a){var u,p=(null==(u=a.target)?void 0:u.closest("a.cosd-site-vcard"))||a.target,h=p.tagName.toLowerCase(),f=p.getAttribute("href")||"";if(("a"===h||"link"===i)&&ho(f))return a.preventDefault(),a.stopPropagation(),void wo({url:f},{env:{platform:"pc"===rt()?"pc":ut()?"na":"wise"}})}}},handleMarkdownToggle:function(t,e){var n=t.directive;t.event;var a=t.open,i=t.data;if(this.data.get("isPc")&&"ml-citation"===n&&a){var o=this.data.get("isHistory")?"1":"0";if(Xy.includes(e))return void this.dispatch("send-ubclog",{type:"click",value:"subscript",extra:{valueInfo:[{component_name:"markdown",component_type:"reference"}],info_rank:i.citationId,value:"subscript",is_his:o}});"ai-markdown"===e&&ld({type:"click",value:"subscript",ubcExt:{valueInfo:[{component_name:"markdown",component_type:"reference"}],info_rank:i.citationId,value:"subscript",is_his:o}},this.data.get("tplInfo"),this.el)}},handleMarkdownShow:function(t,e){var n,a,i=t.directive,o=t.target;if(!("ai-markdown"!==e||this.data.get("isPc")||i!==yh.VIDEO&&i!==yh.AUDIO&&"ml-site-vcard"!==i)){var r={};i===yh.VIDEO?r=JSON.stringify({value:"video_cpt",video_name:null==o?void 0:o.data.get("src")}):i===yh.AUDIO?r=JSON.stringify({value:"music_cpt",music_name:null==o?void 0:o.data.get("title")}):"ml-site-vcard"===i&&(r=JSON.stringify({value:"sitevcard",valueInfo:{component_name:"siteVcard",component_content:null==o?void 0:o.data.get("title")}})),null==o||null==(n=o.el)||n.setAttribute("data-show-area",""),null==o||null==(a=o.el)||a.setAttribute("data-show-ext",r),this.fire("markdown-inner-show-event")}},handleUBCLogEvent:function(t){this.fire("ubc-log-event",t)},startVisibilityChangeListener:function(){var t=this;this.visibilityChangeHandler=function(){if("visible"===document.visibilityState){var e=t.data.get("queue");if(e.length<=1)return;var n=Qm(e);t.data.set("queue",n)}},document.addEventListener("visibilitychange",this.visibilityChangeHandler)},stopVisibilityChangeListener:function(){this.visibilityChangeHandler&&(document.removeEventListener("visibilitychange",this.visibilityChangeHandler),this.visibilityChangeHandler=null)},destroy:function(){this.stopVisibilityChangeListener()}});rb.template='\n\n    <div class="ai-entry">\n        <div s-if="renderMode === \'only-csr\'">\n            <slot name="idle" s-if="status === StatusSet.IDLE">\n            </slot>\n            <slot name="waiting" s-elif="status === StatusSet.WAITING">\n                正在思考...\n            </slot>\n            <slot name="generating" s-elif="status >= StatusSet.GENERATING">\n                <div s-ref="generatedContent">\n                    \x3c!--分享也展现这部分--\x3e\n                    <div\n                        s-for="block, index in accBlocks"\n                        data-show-ext="{{realShowExt(block)}}"\n                        data-no-na-dialog="{{noDialog(block)}}">\n                        \x3c!--class特殊处理：首个渲染包是markdown文字，文字需要在AI标前缀后紧接着显示；若不是，则需要换行，因为AI标的实现是float，所以需要增加间距和clear--\x3e\n                        \x3c!--used-model字段协议设计不合理，待优化--\x3e\n                        <div\n                            s-if="!isBlockNotForRender(block)"\n                            s-is="block.component"\n                            s-ref="{{block.component + index}}"\n                            s-bind="block.data"\n                            id="{{index}}"\n                            cid="{{cid}}"\n                            rank="{{rank}}"\n                            index="{{index}}"\n                            bind-data="{{block.data}}"\n                            ask-used-model="{{askUsedModel}}"\n                            used-model="{{usedModel}}"\n                            tplInfo="{{tplInfo}}"\n                            reference-element="{{referenceElement}}"\n                            on-render-finished="handleBlockRenderFinished(block.component + \'-render-finished\')"\n                            class="{{dynamicClass(block, index, answerIndex)}}"\n                            style="{{dynamicStyle(block, index, answerIndex)}}"\n                            on-action-log-event="handleActionLogEvent"\n                            on-ubc-log-event="handleUBCLogEvent"\n                            on-show-log-event="handleShowLogEvent"\n                            on-render-ready="handleReady(block)"\n                            on-toggle-reference="handleToggleReference"\n                            on-load-ready="handleReady(block)"\n                            on-typing-finished="handleBlockRenderFinished(\'typing-finished\')"\n                            on-click="handleMarkdownClick($event, block.component)"\n                            on-show="handleMarkdownShow($event, block.component)"\n                            on-toggle="handleMarkdownToggle($event, block.component)"\n                            on-copy-click="handleCopyClick($event, block.component)"\n                            on-update-reference="handleUpdateReference($event, block)"\n                            normalizeContent="{{normalizeContent}}"\n                        >\n                        </div>\n                    </div>\n                    <div\n                        s-if="abortMsgShow"\n                        class="ai-entry-msg-show cos-color-text{{\n                            abortMsgHasTopSpace ? \' cos-space-mt-lg\' : \'\'}}"\n                    >\n                        <div class="ai-entry-abort-msg">{{abortMsgShow}}</div>\n                    </div>\n                </div>\n            </slot>\n        </div>\n        <template s-elif="renderMode === \'only-csr-static\'">\n            <div\n                s-for="block, index in blocksForCsrStatic"\n                data-show-ext="{{realShowExt(block)}}">\n                <div\n                    s-if="!isBlockNotForRender(block)"\n                    s-is="block.component"\n                    s-ref="{{block.component + index}}"\n                    s-bind="block.data"\n                    bind-data="{{block.data}}"\n                    used-model="{{usedModel}}"\n                    tplInfo="{{tplInfo}}"\n                    rank="{{rank}}"\n                    reference-element="{{referenceElement}}"\n                    class="{{index === 0 ? \'\'\n                        : block.component === \'ai-input\' ? \'cos-space-mt-md\' : \'cos-space-mt-lg\'}}"\n                    on-action-log-event="handleActionLogEvent"\n                    on-ubc-log-event="handleUBCLogEvent"\n                    on-show-log-event="handleShowLogEvent"\n                    on-click="handleMarkdownClick($event, block.component)"\n                    on-show="handleMarkdownShow($event, block.component)"\n                    on-toggle="handleMarkdownToggle($event, block.component)"\n                    on-copy-click="handleCopyClick($event, block.component)"\n                    normalizeContent="{{normalizeContent}}"\n                >\n                </div>\n            </div>\n        </template>\n        <template s-else>\n            <template s-for="block, index in blocks">\n                <div\n                    s-if="!isBlockNotForRender(block)"\n                    s-is="block.component"\n                    s-ref="{{block.component + index}}"\n                    s-bind="block.data"\n                    id="{{index}}"\n                    rank="{{rank}}"\n                    reference-element="{{referenceElement}}"\n                    class="{{index === 0 ? \'\'\n                        : block.component === \'ai-input\' ? \'cos-space-mt-md\' : \'cos-space-mt-lg\'}}"\n                    on-toggle-reference="handleToggleReference"\n                    on-audio-play="handleAudioPlay"\n                    on-action-log-event="handleActionLogEvent"\n                    bind-data="{{block.data}}"\n                    tplInfo="{{tplInfo}}"\n                    on-ubc-log-event="handleUBCLogEvent"\n                    on-show-log-event="handleShowLogEvent"\n                >\n                </div>\n            </template>\n        </template>\n    </div>\n';var sb=a.defineComponent({computed:{customBgImgStyle:function(){var t=this.data.get("logExtData");if("text"===(null==t?void 0:t.scene)&&"text_work"===(null==t?void 0:t.scene_1st))return{};var e=this.data.get("bgProps"),n=e.backgroundImage,a=e.backgroundImageDark,i=e.bgLinearGradient,o="",r="";return n&&(o+="url("+n+")",r+="url("+(a||n)+")"),i&&(o=o?o+", ":"",r=r?r+", ":"",o+="linear-gradient(to bottom, "+i+")",r+="linear-gradient(to bottom, "+i+")"),o?{"--custom-bg":o,"--custom-bg-dark":r}:{}}},initData:function(){return{bgProps:{}}},attached:function(){}}),cb={};cb=Object.assign(cb,{container:"container_17olx_1",borderLayer:"border-layer_17olx_17","border-layer":"border-layer_17olx_17",containerCustom:"container-custom_17olx_28","container-custom":"container-custom_17olx_28",bgHeader:"bg-header_17olx_41","bg-header":"bg-header_17olx_41",horizontalGradientBox:"horizontal-gradient-box_17olx_51","horizontal-gradient-box":"horizontal-gradient-box_17olx_51"}),sb.template="\n    <div\n        style=\"{{customBgImgStyle}}\"\n        class=\"{{$style['container']}} {{bgProps && (bgProps.backgroundImage || bgProps.bgLinearGradient) ? $style['container-custom'] : ''}}\"\n    >\n        <div s-if=\"bgProps && bgProps.image\" class=\"{{$style['bg-header']}}\">\n            <div\n                data-no-na-dialog\n                class=\"{{$style['horizontal-gradient-box']}}\"\n            ></div>\n            <div class=\"{{$style['border-layer']}}\"></div>\n        </div>\n        <slot></slot>\n    </div>\n";var lb="function"==typeof sb?sb.prototype.initData||db:sb.initData||db;function db(){return{$style:cb}}function ub(){return Object.assign({},lb.call(this),{$style:cb})}"function"==typeof sb?sb.prototype.initData=ub:sb.initData=ub;var pb="data-has-question-head",hb=St.connect(Je,{imageQuery:"imageQuery"})(a.defineComponent({initData:function(){return{isShowTitle:!1,isShowPos:!1,titleClass:"",titleText:"",currentIndex:1,length:1,imageQuery:{},isPc:"pc"===rt()}},computed:{rectList:function(){var t=this.data.get("rank"),e=this.data.get("imageQuery");return e&&e[t]&&e[t].rectList&&e[t].rectList.length?e[t].rectList:[]},rectIndex:function(){var t=this.data.get("rank"),e=this.data.get("imageQuery");return e&&e[t]&&void 0!==e[t].rectIndex?e[t].rectIndex:-1},isShowQuestionHead:function(){var t=this.data.get("isHistory"),e=this.data.get("rectList");return!t&&e&&e.length>1}},onTitleClick:function(t){this.fire("title-click",t)},handleImageQueryClick:function(t){var e=this.data.get("rank");this.dispatch("image-query-tab:click",t),Un().emit({index:t,rank:e})},attached:function(){var t=this.data.get("isHistory"),e=this.data.get("rectList");!t&&e&&e.length>1&&this.dispatch("image-query-tab:show-log",{ubcId:"17132",page:"resultpage",type:"show",value:"change_question_number",extra:{question_number:this.data.get("rectIndex")}}),this.listenQuestionHeadShow()},setQuestionHeadData:function(){this.answerBoxDom&&pn(this.answerBoxDom,pb,"true")},removeQuestionHeadData:function(){this.answerBoxDom&&pn(this.answerBoxDom,pb,null)},listenQuestionHeadShow:function(){var t=this;this.answerBoxDom=fn(this.el,Qt,null),this.data.get("isShowQuestionHead")&&this.setQuestionHeadData(),this.watch("isShowQuestionHead",(function(e){e?t.setQuestionHeadData():t.removeQuestionHeadData()}))},disposed:function(){this.removeQuestionHeadData(),this.answerBoxDom=null}})),fb={};fb=Object.assign(fb,{title:"title_z54ny_1",pos:"pos_z54ny_9",imageQueryHeadQuestion:"image-query-head-question_z54ny_38","image-query-head-question":"image-query-head-question_z54ny_38",imageQueryHeadContain:"image-query-head-contain_z54ny_48","image-query-head-contain":"image-query-head-contain_z54ny_48",imageQueryHeadImg:"image-query-head-img_z54ny_55","image-query-head-img":"image-query-head-img_z54ny_55",imageQueryHeadChoose:"image-query-head-choose_z54ny_77","image-query-head-choose":"image-query-head-choose_z54ny_77"}),hb.template='\n    <div>\n        \x3c!-- 标题 --\x3e\n        <div s-if="isShowTitle" class="{{titleClass}}">\n            <div\n                data-module="char"\n                class="{{$style[\'title\']}}"\n                on-click="onTitleClick"\n            >\n                <span class="cu-line-clamp-default">{{titleText}}</span>\n            </div>\n        </div>\n        \x3c!-- 角标 --\x3e\n        <div\n            s-if="{{isShowPos && !isPc}}"\n            class="{{$style.pos}}"\n        >\n            {{currentIndex}}/{{length}}\n        </div>\n        <fragment s-if="!isHistory && rectList && rectList.length > 1">\n            <div class="{{$style[\'image-query-head-contain\']}} cos-space-mb-lg">\n                <div class="{{$style[\'image-query-head-question\']}}">\n                    <div\n                        s-for="item, index in rectList"\n                        on-click="handleImageQueryClick(index)"\n                        class="{{$style[\'image-query-head-img\']}} {{index === rectIndex ? $style[\'image-query-head-choose\'] : \'\'}}"\n                    >{{index + 1}}</div>\n                </div>\n            </div>\n        </fragment>\n    </div>\n';var gb="function"==typeof hb?hb.prototype.initData||mb:hb.initData||mb;function mb(){return{$style:fb}}function vb(){return Object.assign({},gb.call(this),{$style:fb})}function yb(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function bb(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){yb(o,a,i,r,s,"next",t)}function s(t){yb(o,a,i,r,s,"throw",t)}r(void 0)}))}}function wb(){return wb=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},wb.apply(this,Array.from(arguments))}function _b(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof hb?hb.prototype.initData=vb:hb.initData=vb;var kb=a.defineComponent({components:{"cos-icon":e.Icon},computed:{paused:function(){var t;return 1!==(null==(t=this.data.get("conf"))?void 0:t.status)},audioHandler:function(){return this.data.get("audioHandlerList")[0]||new Audio}},initData:function(){return{audioHandlerList:[],voiceApi:"",getVoiceListing:!1,conf:{status:0,speed:"speed"},tmpAudioList:[],storeAudioList:[],broadcastSignal:{tgNum:-1},tplInfo:{},text:"",isChatSearch:!1,graphCreationLog:{},ttsApiFrom:"h5",useCardSendLog:!1,newIcon:!1,setype:"",agentInfo:{},voicePanelStatus:0,preloadIndex:0}},listenTtsPlay:null,attached:function(){var t=this;this.globalPauseAudio=this.globalPauseAudio.bind(this),window.addEventListener("visibilitychange",this.globalPauseAudio),window.addEventListener("pagehide",this.globalPauseAudio),this.watch("conf.status",(function(e){t.fire("change",{paused:1!==e})})),this.dispatch("send-ubclog",{type:"show",value:"broadcast"}),this.eventListener(),this.listenTtsPlay=function(e){e!==t&&t.pauseAudio()},Vn().on(this.listenTtsPlay)},listenVoicePanelStatus:null,eventListener:function(){var t=this,e=On();this.listenVoicePanelStatus=function(e){var n,a;t.data.set("voicePanelStatus",null==(n=e.params)?void 0:n.show_status);var i=t.data.get("conf.status");1===(null==(a=e.params)?void 0:a.show_status)&&1===i&&t.pauseAudio()},e.container.voicePanelStatus.on(this.listenVoicePanelStatus)},disposed:function(){window.removeEventListener("visibilitychange",this.globalPauseAudio),window.removeEventListener("pagehide",this.globalPauseAudio),this.listenTtsPlay&&(Vn().off(this.listenTtsPlay),this.listenTtsPlay=null),this.listenVoicePanelStatus&&(On().container.voicePanelStatus.off(this.listenVoicePanelStatus),this.listenVoicePanelStatus=null)},globalPauseAudio:function(){this.pauseAudio();var t=this.data.get("audioHandler");t&&(t.currentTime=0,this.data.set("conf.status",0),this.dispatch("send-broadcast-ubclog",{extra:{info:this.data.get("text"),agent_id:this.data.get("agentInfo.agentId")||"",agent_name:this.data.get("agentInfo.agentName")||"",end_reas:"leave"}}))},clickAudio:function(t){return bb((function(){var n,a,i,o,r,s,c,l,d,u;return _b(this,(function(p){switch(p.label){case 0:return t.preventDefault(),t.stopPropagation(),this.createAudio(),Vn().emit(this),n=this.data.get(),a=n.conf,i=void 0===a?{}:a,o=n.audioHandler,r=void 0===o?null:o,s=n.voiceApi,c=void 0===s?"":s,l=n.text,c||l?this.data.get("getVoiceListing")?[2]:(this.data.set("getVoiceListing",!0),this.sendTtsLog(t),[4,l?this.getAudioListByText(l):this.getAudioListByApi(c)]):[2];case 1:return d=p.sent()||[],this.data.set("getVoiceListing",!1),r&&0!==d.length?(u=this.data.get("tmpAudioList"),2!==i.status?[3,3]:[4,this.resumeAudio()]):(e.Toast.show({message:"播报异常，请稍后再试"}),[2]);case 2:return p.sent(),[3,8];case 3:return 1!==i.status?[3,4]:(this.pauseAudio(),this.dispatch("send-broadcast-ubclog",{extra:{info:this.data.get("text"),agent_id:this.data.get("agentInfo.agentId")||"",agent_name:this.data.get("agentInfo.agentName")||"",end_reas:"stop"}}),[3,8]);case 4:return 0!==u.length||i.status?[3,6]:(this.data.set("tmpAudioList",d),[4,this.playNewAudio()]);case 5:return p.sent(),[3,8];case 6:return i.status?[3,8]:[4,this.playNewAudio()];case 7:p.sent(),p.label=8;case 8:return[2]}}))})).apply(this)},fetchAudioListSSE:function(t){return bb((function(){var n;return _b(this,(function(a){return n=this,[2,new Promise((function(a){var i=n.data.get("storeAudioList");if(i.length>0)a(i);else{var o=new EventSource(t);o.onmessage=function(t){var e=JSON.parse(t.data).data,i=e.url,r=e.isEnd;n.data.set("storeAudioList",[].concat(n.data.get("storeAudioList"),[i])),n.data.set("tmpAudioList",[].concat(n.data.get("tmpAudioList"),[i])),a(n.data.get("storeAudioList")),0===n.data.get("conf.status")&&n.playNewAudio(),r&&o.close()},o.onerror=function(){n.data.set("storeAudioList",[]),n.data.set("tmpAudioList",[]),o.close(),e.Toast.show({message:"播报异常了，请稍后再试"})}}}))]}))})).apply(this)},getAudioListByApi:function(t){return bb((function(){var e;return _b(this,(function(n){return e=this,[2,new Promise((function(n){var a=e.data.get("storeAudioList");a.length>0?n(a):fetch(t,{method:"jsonp",timeout:1500,jsonpCallback:"callback",jsonpCallbackFunction:"callback"}).then((function(t){var a=t.errno,i=t.data;if(0===a){var o=(void 0===i?{}:i).contentList,r=void 0===o?[]:o,s=e.data.get("broadcastSignal").tgNum;if(r.length>0)return e.data.set("tmpAudioList",r.filter((function(t){return t.tgNum>=s}))),e.data.set("storeAudioList",r.concat([])),void n(r)}n([])})).catch((function(){n([])}))}))]}))})).apply(this)},preloadAudio:function(){var t=this,e=this.data.get("storeAudioList");e.slice(0,Math.min(3,e.length)).forEach((function(e,n){var a=t.data.get("audioHandlerList")[n];a&&(a.src=e)}))},getAudioListByText:function(t){return bb((function(){var e,n,a,i;return _b(this,(function(o){return e=this,n=this.data.get("ttsApiFrom"),a={text:t,from:n,appId:this.data.get("agentInfo.agentId")||"",agentSearchId:this.data.get("agentInfo.agentSearchId")||"",per:4100,rate:this.data.get("agentInfo.ttsApi")?32:64,mid:this.data.get("agentInfo.mid")||""},this.data.get("agentInfo.speechId")&&(a.per=this.data.get("agentInfo.speechId")),i=(this.data.get("agentInfo.ttsApi")||"https://chat.baidu.com/aichat/api/tts")+"?",Object.keys(a).forEach((function(t){a[t]=encodeURIComponent(a[t]),i+=t+"="+a[t]+"&"})),this.data.get("agentInfo.ttsApi")?[2,this.fetchAudioListSSE(i)]:[2,new Promise((function(t){var n=e.data.get("storeAudioList");n.length>0?t(n):fetch(i,{method:"get",mode:"cors",credentials:"include"}).then((function(t){if(t.ok)return t.json()})).then((function(n){var a=n.status,i=n.data;if(0==+a){var o=(void 0===i?{}:i).contentList,r=void 0===o?[]:o;r.length&&(e.data.set("storeAudioList",r),e.preloadAudio(),t(r))}})).catch((function(){t([])}))}))]}))})).apply(this)},getAudioIns:function(){var t=this,e=new Audio;e.className="chat-search-own-audio",this.el.appendChild(e);var n=this;return e.addEventListener("ended",bb((function(){var t,e,a;return _b(this,(function(i){switch(i.label){case 0:return n.data.shift("tmpAudioList"),a=n.data.shift("audioHandlerList"),n.data.push("audioHandlerList",a),n.data.get("tmpAudioList")[2]&&(a.src=n.data.get("tmpAudioList")[2]),0===(null==(t=n.data.get("tmpAudioList"))?void 0:t.length)&&(n.data.set("conf.status",0),n.preloadAudio()),[4,n.playNewAudio()];case 1:return i.sent(),0===(null==(e=n.data.get("tmpAudioList"))?void 0:e.length)&&(aa().emit({isAction:!0,action:4,actionName:"播报",rank:Je.getState("rank")}),n.dispatch("send-ubclog",{type:"show",value:"broadcast_over"}),n.dispatch("send-broadcast-ubclog",{extra:{info:n.data.get("text"),agent_id:n.data.get("agentInfo.agentId")||"",agent_name:n.data.get("agentInfo.agentName")||"",end_reas:"finish"}})),[2]}}))}))),e.addEventListener("pause",(function(){t.data.set("conf.status",2)})),e},createAudio:function(){var t;if(!this.data.get("audioHandlerList").length||!(null==(t=this.el)?void 0:t.querySelector(".chat-search-own-audio")))for(var e=0;e<3;e++){var n=this.getAudioIns();this.data.push("audioHandlerList",n)}},pauseAudio:function(){var t=this.data.get("audioHandler");t&&(t.pause(),this.data.set("conf.status",2))},resumeAudio:function(){return bb((function(){var t;return _b(this,(function(e){switch(e.label){case 0:t=this.data.get("audioHandler"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.play()];case 2:return e.sent(),qm(t),this.data.set("conf.status",1),[3,4];case 3:return e.sent(),this.data.set("conf.status",0),[3,4];case 4:return[2]}}))})).apply(this)},playNewAudio:function(){return bb((function(){var t,e,n,a;return _b(this,(function(i){switch(i.label){case 0:if(t=this.data.get(),e=t.audioHandler,n=t.tmpAudioList,!(a=(void 0===n?[]:n)[0]))return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),e.src=a.audio||a,[4,e.play()];case 2:return i.sent(),qm(e),1===this.data.get("voicePanelStatus")?(this.pauseAudio(),[2]):(this.data.set("conf.status",1),[3,4]);case 3:return i.sent(),this.data.set("conf.status",0),[3,4];case 4:return[2]}}))})).apply(this)},longPressPlay:function(t){return bb((function(){var n,a,i,o,r,s,c;return _b(this,(function(l){switch(l.label){case 0:return t&&(this.data.set("storeAudioList",[]),this.data.set("text",t)),this.createAudio(),Vn().emit(this),n=this.data.get(),a=n.audioHandler,i=void 0===a?null:a,o=n.voiceApi,r=void 0===o?"":o,s=n.text,r||s?this.data.get("getVoiceListing")?[2]:(this.data.set("getVoiceListing",!0),[4,s?this.getAudioListByText(s):this.getAudioListByApi(r)]):[2];case 1:return c=l.sent()||[],this.data.set("getVoiceListing",!1),i&&0!==c.length?(this.data.set("tmpAudioList",c),[4,this.playNewAudio()]):(e.Toast.show({message:"播报异常，请稍后再试"}),[2]);case 2:return l.sent(),[2]}}))})).apply(this)},detached:function(){var t=document.querySelector(".chat-search-own-audio");t&&t.parentNode.removeChild(t),window.removeEventListener("visibilitychange",this.globalPauseAudio),window.removeEventListener("pagehide",this.globalPauseAudio)},sendTtsLog:function(t){var e=this.data.get("conf.status");this.data.get("useCardSendLog")&&this.dispatch("send-log",wb({type:"b",fm:"beha",target:t.target,action:1===e?"pause":"play"},this.data.get("graphCreationLog")))}}),Sb={};Sb=Object.assign(Sb,{audioIconWrapper:"audio-icon-wrapper_rj1ut_1","audio-icon-wrapper":"audio-icon-wrapper_rj1ut_1",audioIcon:"audio-icon_rj1ut_1","audio-icon":"audio-icon_rj1ut_1",playIcon:"play-icon_rj1ut_26","play-icon":"play-icon_rj1ut_26",playIconSvg:"play-icon-svg_rj1ut_34","play-icon-svg":"play-icon-svg_rj1ut_34",playIconDark:"play-icon-dark_rj1ut_41","play-icon-dark":"play-icon-dark_rj1ut_41",playIconDarkAndroid:"play-icon-dark-android_rj1ut_44","play-icon-dark-android":"play-icon-dark-android_rj1ut_44",yinbo1:"yinbo1_rj1ut_93",animationYinbo1:"animationYinbo1_rj1ut_1",yinbo2:"yinbo2_rj1ut_98",animationYinbo2:"animationYinbo2_rj1ut_1",laba:"laba_rj1ut_103",animationLaba:"animationLaba_rj1ut_1",audioIconNew:"audio-icon-new_rj1ut_107","audio-icon-new":"audio-icon-new_rj1ut_107",playIconNew:"play-icon-new_rj1ut_118","play-icon-new":"play-icon-new_rj1ut_118",playIconImgNew:"play-icon-img-new_rj1ut_124","play-icon-img-new":"play-icon-img-new_rj1ut_124",playIconSvgNew:"play-icon-svg-new_rj1ut_128","play-icon-svg-new":"play-icon-svg-new_rj1ut_128",playAgentSvg:"play-agent-svg_rj1ut_145","play-agent-svg":"play-agent-svg_rj1ut_145",playAgentIcon:"play-agent-icon_rj1ut_148","play-agent-icon":"play-agent-icon_rj1ut_148",playIconHolder:"play-icon-holder_rj1ut_158","play-icon-holder":"play-icon-holder_rj1ut_158"}),kb.template='\n    <span\n        on-click="clickAudio"\n        class="{{$style[\'audio-icon-wrapper\']}}"\n        data-module="broadcast"\n    >\n        <span\n            rl-type="stop"\n            on-click="handleClick"\n            class="{{$style[\'audio-icon\']}} {{newIcon ? $style[\'audio-icon-new\'] : \'\'}}"\n        >\n            \x3c!-- 播报按钮旧样式 --\x3e\n            <fragment s-if="!newIcon">\n                \x3c!-- 简搜下，点击小喇叭图标时会位移，使用新的初始图标来解决这个问题 --\x3e\n                <img\n                    s-if="isChatSearch"\n                    s-show="paused"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-holder\']}} {{$style[\'play-agent-icon\']}}"\n                    src="https://gips2.baidu.com/it/u=1345486302,3844882547&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f54_54"\n                >\n                <img\n                    s-if="isChatSearch"\n                    s-show="paused"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-dark\']}} {{$style[\'play-agent-icon\']}}"\n                    src="https://gips2.baidu.com/it/u=3588279344,2361854075&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f54_54"\n                >\n                <img\n                    s-if="isChatSearch"\n                    s-show="paused"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-dark-android\']}} {{$style[\'play-agent-icon\']}}"\n                    src="https://gips3.baidu.com/it/u=2653560114,3221238357&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f54_54"\n                >\n                \x3c!-- TODO: 非简搜，与简搜下存在同样的位移问题，需要修复 --\x3e\n                <cos-icon\n                    s-else\n                    s-show="paused"\n                    name="volume"\n                    class="{{$style[\'play-icon\']}}"\n                />\n                <svg\n                    s-show="!paused && !isChatSearch"\n                    viewBox="4 4 46 46"\n                    version="1.1"\n                    xmlns="http://www.w3.org/2000/svg"\n                    xmlns:xlink="http://www.w3.org/1999/xlink"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-svg\']}}"\n                >\n                    <g\n                        stroke="none"\n                        stroke-width="1"\n                        fill="none"\n                        fill-rule="evenodd"\n                    >\n                        \x3c!-- eslint-disable max-len --\x3e\n                        <path class="{{$style.laba}}" d="M23.6146695,9.01535795 C25.5007297,7.58269765 28.1890004,7.95299931 29.61909,9.84244985 C30.1840156,10.588836 30.4897901,11.4998243 30.4897901,12.4365108 L30.4897901,41.5637248 C30.4897901,43.9349141 28.5710105,45.8571429 26.2040758,45.8571429 C25.2690701,45.8571429 24.3597164,45.5508187 23.6146695,44.9848776 L17.2858735,40.1774942 C17.1368642,40.064306 16.9549934,40.0030411 16.7679923,40.0030411 L11.6326473,40.0030411 C7.84555185,40.0030411 4.77550442,36.9274751 4.77550442,33.1335722 L4.77550442,20.8666634 C4.77550442,17.0727604 7.84555185,13.9971944 11.6326473,13.9971944 L16.7679923,13.9971944 C16.9549934,13.9971944 17.1368642,13.9359296 17.2858735,13.8227414 Z M26.8167952,11.8296657 C26.5192941,11.5241776 26.0343903,11.4814011 25.6861946,11.7459995 L19.3573986,16.5553334 C18.6123517,17.1215042 17.702998,17.4279526 16.7679923,17.4279526 L11.6326473,17.4279526 C9.73909956,17.4279526 8.20407585,18.9663595 8.20407585,20.8640806 L8.20407585,33.1359665 C8.20407585,35.0336876 9.73909956,36.5720945 11.6326473,36.5720945 L16.7679923,36.5720945 C17.702998,36.5720945 18.6123517,36.878543 19.3573986,37.4447137 L25.6861946,42.2540476 C25.8352039,42.3672817 26.0170747,42.4285714 26.2040758,42.4285714 C26.6774628,42.4285714 27.0612187,42.0439697 27.0612187,41.5695394 L27.0612187,12.4305077 C27.0612187,12.2430944 27.0000638,12.0608228 26.8870787,11.911485 Z" />\n                        <path class="{{$style.yinbo1}}" d="M34.1203339,18 C37.3135965,20.6762737 39,23.5030236 39,26.5 C39,29.4061589 37.4142542,32.1522518 34.4064744,34.7562873 L34.1203339,35 L32,32.2233562 C34.4637213,30.1585112 35.6058097,28.2441423 35.6058097,26.5 C35.6058097,24.8160005 34.541128,22.9733119 32.2501606,20.9897109 L32,20.7766438 L34.1203339,18 Z" />\n                        <path class="{{$style.yinbo2}}" d="M40.4443367,13 C44.7766757,17.5531617 47,22.2264593 47,27 C47,31.6571129 44.883808,36.2188129 40.7575716,40.6666277 L40.4443367,41 L38,38.4310736 C41.7335604,34.5072108 43.5431859,30.7034838 43.5431859,27 C43.5431859,23.3993907 41.8326989,19.70403 38.3066789,15.8956373 L38,15.5689264 L40.4443367,13 Z" />\n                        \x3c!-- eslint-enable max-len --\x3e\n                    </g>\n                </svg>\n                <svg\n                    s-show="!paused && isChatSearch"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-svg\']}} {{$style[\'play-agent-svg\']}}"\n                    width="18"\n                    height="18"\n                    viewBox="0 0 18 18"\n                    fill="none"\n                    xmlns="http://www.w3.org/2000/svg"\n                >\n                    \x3c!-- eslint-disable max-len --\x3e\n                    <path\n                        class="{{$style.yinbo2}}"\n                        d="M14.5449 2.65743L15.0638 3.22126C16.4545 4.73221 17.3056 6.83707 17.3056 9.14877C17.3056 11.4591 16.4555 13.5629 15.0663 15.0736L14.5476 15.6377L13.4195 14.6003L13.9381 14.0363C15.0608 12.8154 15.7731 11.0845 15.7731 9.14877C15.7731 7.21187 15.06 5.48014 13.9362 4.25914L13.4172 3.69531L14.5449 2.65743Z"\n                        fill="#6e4bfa"\n                    />\n                    <path\n                        class="{{$style.yinbo1}}"\n                        d="M13.1319 5.85007L12.6875 5.2258L11.439 6.11454L11.8833 6.7388C12.3383 7.3779 12.6167 8.1969 12.6167 9.0988C12.6167 10.0049 12.3357 10.8273 11.877 11.4677L11.4308 12.0907L12.6767 12.9831L13.1229 12.3601C13.7695 11.4574 14.1493 10.3224 14.1493 9.0988C14.1493 7.8808 13.773 6.7507 13.1319 5.85007Z"\n                        fill="#6e4bfa"\n                    />\n                    <path\n                        class="{{$style.laba}}"\n                        d="M8.93333 3.25245L5.62553 6.21187C5.20593 6.58727 4.6627 6.7948 4.0997 6.7948H2.33333V11.4135H4.0506C4.61007 11.4135 5.15017 11.6185 5.5688 11.9896L8.93333 14.9728V3.25245ZM8.3846 1.95431C8.61683 1.74652 8.91267 1.65242 9.20017 1.6684C9.48767 1.68439 9.77123 1.81069 9.97903 2.04293C10.1643 2.24997 10.2667 2.51803 10.2667 2.79583V15.4267C10.2667 15.7383 10.1395 16.0215 9.93593 16.2251C9.73233 16.4287 9.44913 16.5559 9.1375 16.5559C8.86143 16.5559 8.59493 16.4547 8.38837 16.2716L4.6842 12.9873C4.5095 12.8324 4.2841 12.7468 4.0506 12.7468H2.12917C1.81754 12.7468 1.53433 12.6197 1.33073 12.4161C1.12712 12.2125 1 11.9293 1 11.6177V6.59064C1 6.27904 1.12712 5.9958 1.33073 5.7922C1.53433 5.5886 1.81754 5.46147 2.12917 5.46147H4.0997C4.33467 5.46147 4.56137 5.37487 4.7365 5.2182L8.3846 1.95431Z"\n                        fill="#6e4bfa"\n                    />\n                    \x3c!-- eslint-enable max-len --\x3e\n                </svg>\n            </fragment>\n            \x3c!-- 播报按钮新样式 --\x3e\n            <fragment s-else>\n                <div\n                    s-show="paused"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-new\']}} {{$style[\'play-icon-img-new\']}}"\n                ></div>\n                <svg\n                    s-show="!paused"\n                    xmlns="http://www.w3.org/2000/svg"\n                    viewBox="0 0 22 22"\n                    fill="none"\n                    class="{{$style[\'play-icon\']}} {{$style[\'play-icon-new\']}} {{$style[\'play-icon-svg-new\']}}"\n                >\n                    <g\n                        stroke="none"\n                        stroke-width="1"\n                        fill="none"\n                        fill-rule="evenodd"\n                    >\n                        \x3c!-- eslint-disable max-len --\x3e\n                        <path\n                            class="{{$style.laba}}"\n                            d="M5.6556 15.9521L10.1829 19.9662C10.4545 20.207 10.805 20.3401 11.168 20.3401C11.5779 20.3401 11.9503 20.1728 12.218 19.9051C12.4856 19.6375 12.6529 19.265 12.6529 18.8552V3.41747C12.6529 3.05216 12.5182 2.69966 12.2746 2.42741C12.0014 2.12199 11.6284 1.95591 11.2504 1.9349C10.8725 1.91389 10.4834 2.03761 10.178 2.31087L5.71918 6.30007C5.52434 6.47437 5.27213 6.57071 5.01072 6.57071H2.60229C2.19247 6.57071 1.82 6.73797 1.55234 7.00562C1.28467 7.27328 1.11743 7.64578 1.11743 8.05557V14.1997C1.11743 14.6095 1.28467 14.982 1.55234 15.2497C1.82 15.5173 2.19246 15.6846 2.60229 15.6846H4.9507C5.21048 15.6846 5.46125 15.7797 5.6556 15.9521ZM10.8137 18.0675V4.20985L6.94547 7.6707C6.41342 8.14671 5.7246 8.40986 5.01072 8.40986H2.95658V13.8454H4.9507C5.66011 13.8454 6.34496 14.1053 6.87578 14.576L10.8137 18.0675Z"\n                            fill="#6e4bfa"\n                        />\n                        <path\n                            class="{{$style.yinbo1}}"\n                            d="M13.8248 14.8019L15.518 16.0146L16.1243 15.168C16.9274 14.0468 17.3984 12.6382 17.3984 11.121C17.3984 9.6107 16.9318 8.2082 16.1355 7.08955L15.5316 6.24121L13.8349 7.44894L14.4387 8.29728C14.9821 9.06053 15.3157 10.0403 15.3157 11.121C15.3157 12.2067 14.9789 13.1905 14.4312 13.9553L13.8248 14.8019Z"\n                            fill="#6e4bfa"\n                        />\n                        <path\n                            class="{{$style.yinbo2}}"\n                            d="M17.7866 19.2609L18.4914 18.4944C20.2076 16.6281 21.2561 14.0314 21.2561 11.182C21.2561 8.33096 20.2064 5.73284 18.4884 3.8663L17.7832 3.1001L16.2508 4.5105L16.956 5.27671C18.3113 6.74923 19.1734 8.84029 19.1734 11.182C19.1734 13.5223 18.3123 15.6123 16.9584 17.0847L16.2535 17.8512L17.7866 19.2609Z"\n                            fill="#6e4bfa"\n                        />\n                        \x3c!-- eslint-enable max-len --\x3e\n                    </g>\n                </svg>\n            </fragment>\n        </span>\n    </span>\n';var xb="function"==typeof kb?kb.prototype.initData||Ib:kb.initData||Ib;function Ib(){return{$style:Sb}}function Tb(){return Object.assign({},xb.call(this),{$style:Sb})}function Cb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Lb(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Pb(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Cb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cb(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Db(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof kb?kb.prototype.initData=Tb:kb.initData=Tb;var Ab={copy:"复制","copy-link":"复制链接","view-picture":"查看图片","save-picture":"保存图片","share-picture":"分享图片","save-cloud":"保存云盘","ai-picture":"AI图","qr-code":"二维码",category:"图片垂类"};function Eb(){var t;return t=function(t){var e,n,a,i,o,r,s;return Db(this,(function(c){switch(c.label){case 0:if("pc"===rt())return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,ws()];case 2:return c.sent(),[3,4];case 3:return c.sent(),Bn().emit({text:"登录失败，请稍后再试"}),[2];case 4:if(e=t.data.get("rank"),n=Je.getState("qaPairIdDiff"),(i=un('.cs-rank-container[rank="'+(a=e-n)+'"]'))&&un("[data-delete]",i)){o=un("[data-delete]",i).getAttribute("data-delete"),r=null;try{r=JSON.parse(o)}catch(t){r={}}r.sessionId&&r.deleteQidList.length>0&&(s={req_type:2,ori_lid_list:[{ori_lid:r.sessionId,qid_list:r.deleteQidList}]},setTimeout((function(){ia().emit({content:"pc"===rt()?"":"是否删除该条消息",title:"pc"===rt()?"是否删除该条消息？":"",type:"warning",confirm:function(){!function(t,e){_r.deleteQAPair(t,e)}(a,s)}})}),200))}return[2]}}))},Eb=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Lb(o,a,i,r,s,"next",t)}function s(t){Lb(o,a,i,r,s,"throw",t)}r(void 0)}))},Eb.apply(this,Array.from(arguments))}function Ob(t,e){void 0===e&&(e="generate");var n=wn((function(n){var a="pc"===rt(),i=n.params||{},o=t.data.get("rank"),r=0;if(i.location_id){var s=i.location_id.split("_"),c=s[0],l=+s[1];if(!a)l+=Je.getState("qaPairIdDiff");if(r=s[2],c!==e||l!==o)return}switch(i.function_type){case"card_function_tts":var d,u;if("history"===e){var p;null==(p=t.ref("ttsPlayer"))||p.longPressPlay();break}var h=null==(u=t.ref("footer-"+t.data.get("currentAnswerIndex")))||null==(d=u.ref("interact"))?void 0:d.ref("ttsPlayer");if(h)null==h||h.longPressPlay();else{h=t.ref("ttsPlayer");var f=t.data.get("ttsTextList["+t.data.get("currentIndex")+"]["+(r||t.data.get("currentAnswerIndex"))+"]");null==h||h.longPressPlay(f)}break;case"card_function_regenerate":var g=t.data.get("agentInfo"),m={sa:"re_dl_reans",agentInfo:{},is_rebuild:1};g&&(m.agentInfo=g);var v=function(t){var e=[],n=0;return null==t||t.forEach((function(t){var a,i;if("text"===t.type)e.push({type:"TEXT",data:{text:{query:(null==(i=t.data)||null==(a=i.question)?void 0:a.question)||"",text_type:""}}});else if("image"===t.type){var o,r;null==(r=t.data)||null==(o=r.question)||o.question.forEach((function(t){e.push({type:"IMAGE",data:{image:{image_url:t.image_url||t.imageUrl,image_id:t.image_id,image_b64:t.imageB64}}})})),n=2}else if("file"===t.type){var s,c,l,d,u,p,h,f,g,m,v,y;e.push({type:"FILE",data:{file:{file_id:null==(c=t.data)||null==(s=c.question)?void 0:s.question.fileId,file_name:null==(d=t.data)||null==(l=d.question)?void 0:l.question.fileName,file_url:null==(p=t.data)||null==(u=p.question)?void 0:u.question.fileUrl,file_path:null==(f=t.data)||null==(h=f.question)?void 0:h.question.filePath,file_size:null==(m=t.data)||null==(g=m.question)?void 0:g.question.fileSize,status:1,file_type:null==(y=t.data)||null==(v=y.question)?void 0:v.question.fileType}}}),n=1}})),{sseQuery:e,interactionType:n}}(t.data.get("question")),y=v.sseQuery,b=v.interactionType;m.interactionType=b,Ar({query:y,extParams:m}).catch((function(t){console.error(t)}));break;case"card_function_report_feedback":var w=kn(o),_=function(t,e){if("generate"===e){var n,a,i=(null==t||null==(n=t.data)?void 0:n.get("agentInfo"))||"",o=(null==t||null==(a=t.data)?void 0:a.get("baseData"))||{},r=o.queryIndustry,s=void 0===r?"":r,c=o.queryIntent,l=void 0===c?"":c,d=o.lid;return{isAgent:i,queryIndustry:s,queryIntent:l,lid:void 0===d?"":d}}if("history"===e){var u,p=(null==t||null==(u=t.data)?void 0:u.get("question[0].data.agentInfo"))||"",h="",f="";try{for(var g,m,v=Pb((null==t||null==(g=t.data)?void 0:g.get("blocksList")[0][0])||[]);!(m=v()).done;){var y=m.value;if((null==y?void 0:y.queryIndustry)&&(h=y.queryIndustry),(null==y?void 0:y.queryIntent)&&(f=y.queryIntent),h&&f)return{queryIndustry:h,queryIntent:f,isAgent:p}}}catch(t){}return{queryIndustry:h,queryIntent:f,isAgent:p}}}(t,e),k=_.isAgent,S=_.queryIndustry,x=_.queryIntent,I=_.lid,T=void 0===I?"":I,C=("pc"===rt()?"https://ufosdk.baidu.com/ufosdk/report/KoJVyE33%2BjJq0Y1tDecU9Q%3D%3D/294248":"https://ufosdk.baidu.com/ufosdk/report/iEm3bO8WwytHJrBiMWnFRg%3D%3D/294248")+"?question="+encodeURIComponent(t.data.get("question[0].data.question.question"))+"&answer_url="+encodeURIComponent(w)+"&extend_is_znt="+encodeURIComponent(k?1:2)+"&extend_industry="+encodeURIComponent(S)+"&extend_intention="+encodeURIComponent(x)+"&extend_lid="+encodeURIComponent(T);window.open(C,"_blank");break;case"card_function_share":!function(t,e){var n,a=t.data.get("rank"),i=a-Je.getState("qaPairIdDiff"),o=kn(i),r=un('.cs-rank-container[rank="'+i+'"]'),s=null==(n=un("[data-query]",r))?void 0:n.getAttribute("data-query");na().emit({query:s,shareUrl:o,rank:a,type:e})}(t,e);break;case"card_function_delete":!function(t){Eb.apply(this,Array.from(arguments))}(t);break;case"copy":case"copy-link":case"view-picture":case"save-picture":case"share-picture":case"save-cloud":case"ai-picture":case"qr-code":case"category":var L=Ab[i.function_type]||"";!function(t,e,n,a){var i;if("generate"===n&&(null==(i=t.data)?void 0:i.get("rank"))===Je.getState("rank")&&Number.isFinite(e.location_x)&&Number.isFinite(e.location_y)){for(var o=window.document.elementsFromPoint(e.location_x,e.location_y),r="",s=0;s<o.length;s++){var c=o[s];c.closest(".cs-rank-container")&&(r=c.getAttribute("rank"))}if(Number(r)===Je.getState("rank")){var l="copy"===e.function_type?1:5;aa().emit({isAction:!0,rank:Je.getState("rank"),action:l,actionName:a})}}}(t,i,e,L)}}),300,{leading:!0,trailing:!1});return ti().on(n),window.addEventListener("longPress",n),n}function Rb(){return Rb=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Rb.apply(this,Array.from(arguments))}var Nb=a.defineComponent({components:{"dqa-reference":e.CitationList,icon:e.Icon},computed:{items:function(){return this.data.get("isPc"),this.data.get("referList").map((function(t,e){var n,a=Rb({},t,{linkInfo:{href:t.url,target:"_blank"},isVideo:(null==(n=t.type)?void 0:n.indexOf("video"))>-1,thumbnail:t.poster,title:t.text,source:{logo:t.icon,name:t.source}});return t.suffix&&(a.tags=[{text:t.suffix,appearance:"filled",bgColor:"rgba(57, 179, 98, 0.10)",color:"var(--cos-color-text-success, #39B362)",icon:"medical"}]),a}))},btnClickLog:function(){var t=this.data.get("logExtParams")||{},e=this.data.get("showReference"),n=this.data.get("extra");return JSON.stringify({type:"click",value:e?"site_fold":"site_open",ubcExt:Rb({valueInfo:[{component_name:"reference"}]},n,t)})}},initData:function(){return{text:"",status:"fold",height:"100%",foldIndex:0,lastNum:0,referArray:[],maxRow:1,isChatSearch:!1,realShowExt:'{"value":"site_show","component_content":{"component_name":"reference"}}',showReference:!0,isPc:"pc"===rt(),logExtParams:{},isDownloadReference:!1,isHistory:!1,extra:{}}},created:function(){this.data.set("extra",{is_his:this.data.get("isHistory")?"1":"0"})},attached:function(){var t=this,e=this.data.get("extra"),n=zf(this.el);if(this.data.set("realShowExt",JSON.stringify(Rb({value:"site_show",component_content:{component_name:"reference"}},e,n))),this.setReferArray(),this.watch("referList",(function(){t.setReferArray()})),this.data.get("isPc")){var a=this.data.get("showReference");this.dispatch("send-ubclog",{type:"show",value:a?"site_fold":"site_open",extra:e})}this.dispatch("send-ubclog",{type:"show",value:"site",extra:e})},setReferArray:function(){var t=this.data.get("referList");if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];this.data.splice("referArray",[e,1,Rb({},n,{index:e+1})])}},handleShowReference:function(){var t=this.data.get("showReference"),e=this.data.get("extra");this.data.set("showReference",!t),!t&&this.data.get("isPc")&&this.dispatch("send-ubclog",{type:"show",value:"site",extra:e})},handleReferenceClick:function(t){var e=this.data.get("tplInfo"),n=this.data.get("extra");if(this.data.get("isPc")){var a=this.data.get("logExtParams")||{};ld({type:"click",value:"site",ubcExt:Rb({info_rank:null==t?void 0:t.index,valueInfo:[{component_name:"reference"}]},n,a)},e,this.el)}else{var i,o=this.data.get("logExtParams")||{};qd({component:"reference",tplname:"nonala_cpt",actionType:"na",ext:Rb({panel_type:"0",panel_order:null==t||null==(i=t.index)?void 0:i.toString(),component_content:{component_name:"reference"}},n,o)},e,{launchMultiSearch:!0},this.el)}},handleReferenceScrollEnd:function(t){qd({component:"reference",actionType:"scroll",ext:Rb({action:"slideslip",component_content:{component_name:"reference"}},this.data.get("extra"))},this.data.get("tplInfo"),{launchMultiSearch:!0},this.el)},handleReferenceChange:function(t){var e=this.data.get("extra");this.data.get("isPc")&&this.dispatch("send-ubclog",{type:"click",value:"site_slide",extra:Rb({info_rank:t.prevIndex},e)})}}),qb={};qb=Object.assign(qb,{reference:"reference_13zwx_1",referencePanel:"reference-panel_13zwx_7","reference-panel":"reference-panel_13zwx_7",referenceFold:"reference-fold_13zwx_10","reference-fold":"reference-fold_13zwx_10",referenceSummary:"reference-summary_13zwx_13","reference-summary":"reference-summary_13zwx_13",referenceList:"reference-list_13zwx_26","reference-list":"reference-list_13zwx_26",downloadReference:"download-reference_13zwx_41","download-reference":"download-reference_13zwx_41"}),Nb.template='\n    <div\n        disable-copy\n        s-ref="reference"\n        class="{{$style.reference}}"\n        style="height:{{height}}"\n        data-module="site"\n        data-show-ext="{{realShowExt}}"\n        data-show-area\n    >\n        <div\n            s-if="isPc"\n            class="{{$style.referencePanel}}"\n            need-click-log\n        >\n            <div\n                data-click-log="{{btnClickLog}}"\n                class="{{$style.referenceSummary}} {{!showReference && isDownloadReference ? $style.referenceFold : \'\'}}"\n                on-click="handleShowReference">\n                <span>查看{{items.length}}篇参考资料</span>\n                <icon name="{{showReference ? \'up\' : \'down\'}}"/>\n            </div>\n        </div>\n        <div\n            s-if="!isPc || showReference"\n            class="{{isDownloadReference ? $style.downloadReference : \'\'}}"\n        >\n            <dqa-reference\n                class="{{$style.referenceList}}"\n                appearance="stripe"\n                on-click="handleReferenceClick"\n                on-change="handleReferenceChange"\n                on-scrollend="handleReferenceScrollEnd"\n                items="{{items}}"\n            />\n        </div>\n    </div>\n';var Mb="function"==typeof Nb?Nb.prototype.initData||jb:Nb.initData||jb;function jb(){return{$style:qb}}function Bb(){return Object.assign({},Mb.call(this),{$style:qb})}"function"==typeof Nb?Nb.prototype.initData=Bb:Nb.initData=Bb;var Hb=a.defineComponent({components:{"dqa-reference":Nb},initData:function(){return{referenceList:[],scrollStartX:0,isLeftScroll:!1,isChatSearch:!0,isShowDownload:!1,logExtParams:{},tplInfo:{},isHistory:!1}},handleReferenceClick:function(t){var e=t.event,n=t.url;e.stopPropagation(),n&&window.open(n,"_blank")},touchstartHandle:function(t){var e;this.data.set("scrollStartX",(null==t||null==(e=t.touches[0])?void 0:e.clientX)||0)},touchmoveHandle:function(t){var e,n=((null==t||null==(e=t.touches[0])?void 0:e.clientX)||0)<this.data.get("scrollStartX");this.data.set("isLeftScroll",n);var a=this.ref("reference").el,i=a&&a.querySelector('[class*="list-scroll"]');i&&(n?i.scrollLeft+i.offsetWidth<i.scrollWidth:i.scrollLeft>0)&&t.stopPropagation()},touchendHandle:function(t){var e;this.data.set("scrollStartX",(null==t||null==(e=t.touches[0])?void 0:e.clientX)||0);var n=this.data.get("isLeftScroll"),a=this.ref("reference").el,i=a&&a.querySelector('[class*="list-scroll"]');i&&(n?i.scrollLeft+i.offsetWidth-5<i.scrollWidth:i.scrollLeft>5)&&t.stopPropagation()}}),$b={};$b=Object.assign($b,{reference:"reference_1sdr1_1",download:"download_1sdr1_5",historyReference:"history-reference_1sdr1_15","history-reference":"history-reference_1sdr1_15"}),Hb.template='\n    <div\n        class="{{isShowDownload ? $style[\'download\'] : \'\'}}"\n        on-touchstart="touchstartHandle"\n        on-touchend="touchendHandle"\n        on-touchmove="touchmoveHandle"\n    >\n        <dqa-reference\n            s-ref="reference"\n            is-chat-search="{{isChatSearch}}"\n            is-download-reference="{{isShowDownload}}"\n            refer-list="{{referList}}"\n            log-ext-params="{{logExtParams}}"\n            on-click="handleReferenceClick"\n            tplInfo="{{tplInfo}}"\n            class="\n                {{$style[\'reference\']}}\n                {{isHistory ? $style[\'history-reference\'] : \'\'}}\n            "\n            is-history="{{isHistory}}"\n        />\n    </div>\n';var Ub="function"==typeof Hb?Hb.prototype.initData||Fb:Hb.initData||Fb;function Fb(){return{$style:$b}}function Gb(){return Object.assign({},Ub.call(this),{$style:$b})}function Wb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function zb(){return zb=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zb.apply(this,Array.from(arguments))}function Qb(t,e){return Qb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Qb(t,e)}function Jb(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Wb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wb(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}"function"==typeof Hb?Hb.prototype.initData=Gb:Hb.initData=Gb;var Vb=function(t){function n(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qb(t,e)}(n,t);var a=n.prototype;return a.initData=function(){return{bgProps:{},indicatorColor:"#6e4bfaff",blocksList:[],hints:{},currentIndex:0,independenBlocks:[],entryRef:"entry-"+Date.now(),shareParams:"",rank:0,deleteParams:"",initShowHistory:!1,isPc:!1,isExtension:ft(),aiEntryStyle:"",isSeparateBub:!1,referenceList:[],logExtParams:{},tplInfo:{}}},a.created=function(){var t=this,e=[],n=[],a=this.data.get("blocksList"),i=this.data.get("isSeparateBub"),o=this.data.get("independenBlocks");this.watch("referenceList",(function(e){e&&e.length&&setTimeout((function(){t.referShowLog()}),1e3)})),this.data.set("referenceList",this.getReferenceList());a.forEach((function(a,r){i&&!o.length?(a.forEach((function(t){!function(t,e){return 0===e.length||!t.sectionId||!e[e.length-1].sectionId||t.sectionId===e[e.length-1].sectionId}(t,n)?(e.push(n),n=[t]):n.push(t)})),n.length&&e.push(n),t.data.set("blocksList["+r+"]",e),e=[],n=[]):t.data.set("blocksList["+r+"]",[a])}))},a.attached=function(){var t=this;setTimeout((function(){var e,n=t.data.get("initShowHistory"),a=t.data.get("isAiCall");zn().emit({initShowHistory:n,isAiCall:a});var i=t.data.get("entryRef"),o=Rd(null==(e=t.ref(i))?void 0:e.el);t.data.set("ttsText",o),t.listenLongPressHandler=Ob(t,"history")}),100),this.data.set("isPc","pc"===rt())},a.handleSwiperChange=function(t){var e=(t||{}).index,n=void 0===e?0:e;this.data.set("currentIndex",n)},a.handleCopy=function(t){this.copyText(t.text)},a.sendUbcLog=function(t){if(t&&t.value&&["site","sitescroll","site_open","site_fold","subscript","site_slide","subscriptJump","answer_title_open","answer_title_close","answer_content","answer_origin"].includes(t.value)){var e=t.type,n=void 0===e?"show":e,a=t.value,i=void 0===a?"":a,o=t.extra,r=void 0===o?{}:o,s=this.data.get("rank"),c=this.data.get("tplInfo");Aa({ubcId:t.ubcId,page:t.page,type:n,value:i,source:"active",ext:zb({lid:"",ori_lid:"",re_rank:s.toString(),setype:"csaitab"},r)},c)}},a.copyText=function(t){Ed(t).then((function(){e.Toast.show({message:"复制成功"})})).catch((function(){e.Toast.show({message:"复制失败"})}))},a.showToast=function(){this.data.get("isPc")?Bn().emit({text:"历史记录不支持该功能",type:"info"}):e.Toast.show({message:"历史记录不支持该功能"})},a.formatUbcParams=function(t,e){var n=(e[0]||{}).agentInfo||{},a=n.agentSearchId,i=n.agentName;return t.ext=Object.assign({},t.extra,{ori_lid:"",lid:"",re_rank:String(this.data.get("rank")),agent_id:a,agent_name:i}),t},a.handleUbcLogEvent=function(t,e){e&&e.length&&!this.data.get("isPc")&&Aa(this.formatUbcParams(t,e))},a.goToAgent=function(t){var n,a;if("pc"===rt()&&"agent"===(null==(a=t.target.attributes)||null==(n=a.type)?void 0:n.value)){if(t.preventDefault(),this.data.get("isExtension"))return t.stopPropagation(),void e.Toast.info({message:"请到网页版使用",duration:2e3});var i,o,r=(null==(i=this.data.get("question")[0].data)?void 0:i.agentInfo)||{},s=null==(o=t.target)?void 0:o.href;if(s){var c=rs(s);if(c){var l=zb({},r,{realUrl:c});ca().emit(l)}}}},a.getReferenceList=function(){var t,e=this.data.get("blocksList"),n=this.data.get("independenBlocks");return Array.isArray(e)?(t=this.findReferenceList(e))&&t.length?t:this.findReferenceList(n)||[]:this.findReferenceList(n)},a.findReferenceList=function(t){if(!Array.isArray(t))return[];for(var e,n=null,a=!1,i=Jb(t);!(e=i()).done;){var o=e.value;if(Array.isArray(o))for(var r,s=Jb(o);!(r=s()).done;){var c=r.value;if(c&&c.component){if(c.component.includes("markdown")&&c.data&&Array.isArray(c.data.referenceList))return a=!0,n=c.data.referenceList;c.component.includes("reference")&&!a&&c.data&&Array.isArray(c.data.referenceList)&&(n=c.data.referenceList)}}}return n||[]},a.referShowLog=function(){var t,e=this,n=this.data.get("entryRef"),a=null==(t=this.ref(n))?void 0:t.el;if(a){var i=dn(".cosd-citation",a);i.forEach((function(t,n){var a,o,r;(null==(a=t.parentElement)?void 0:a.nextElementSibling)!==(null==(o=i[n+1])?void 0:o.parentElement)&&e.sendUbcLog({type:"show",value:"subscript",extra:{is_his:"1",info_rank:null==(r=t.getElementsByClassName("cosd-citation-citationId")[0])?void 0:r.innerText}})}))}},a.handleActionLogEvent=function(t){var e,n;if("reference"===t.componentType){var a=this.data.get("logExtParams")||{},i=this.data.get("rank"),o=this.data.get("tplInfo")||{},r=this.data.get("entryRef");t.ext=Object.assign({},t.ext,zb({re_rank:String(i),ori_lid:"",lid:""},a)),qd(t,o,{launchMultiSearch:!0},(null==(e=t.ext)?void 0:e.target)||(null==(n=this.ref(r))?void 0:n.el))}},a.disposed=function(){this.listenLongPressHandler&&ti().off(this.listenLongPressHandler),this.listenLongPressHandler=null},n}(a.Component);Vb.components={"cs-container":sb,"sc-ai-entry":rb,"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,header:hb,"wd-tts-player":kb,"answer-recommend":Hp,"reference-wrapper":Hb},Vb.messages={"ai-markdown-editor:btn-click":function(t){var e=this,n=t.value,a=n.actionType,i=n.text,o=n.id;if("recipient"===a||"from"===a||"edit"===a||"image"===a)return this.showToast(),void("image"===a&&setTimeout((function(){var t;null==(t=e.ref("independenCard"))||t.handleComponent("ai-markdown-editor","changeEditStatus",{isDanger:0,id:o})}),0));"copy"!==a||this.copyText(i)},"ai-image-with-thumbnail:jump-diy-page":function(t){this.showToast()},"ai-image-with-thumbnail:update":function(t){this.showToast()},"open-half-screen":function(){this.showToast()},"send-ubclog":function(t){this.sendUbcLog(t.value)}},Vb.computed={hintText:function(){return"notSupport"===this.data.get("hints.parts[0].type")?this.data.get("hints.parts[0].text"):""}};var Kb={},Xb={},Yb={};Yb=Object.assign(Yb,{hideItem:"hide-item_a7ez0_1","hide-item":"hide-item_a7ez0_1",independenStyle:"independen-style_a7ez0_5","independen-style":"independen-style_a7ez0_5",independenStylePadding:"independen-style-padding_a7ez0_9","independen-style-padding":"independen-style-padding_a7ez0_9",indicatorMargin:"indicator-margin_a7ez0_14","indicator-margin":"indicator-margin_a7ez0_14",showAnimation:"show-animation_a7ez0_25","show-animation":"show-animation_a7ez0_25",chatSearchHistoryShow:"chatSearchHistoryShow_a7ez0_1",answerHistory:"answer-history_a7ez0_28","answer-history":"answer-history_a7ez0_28",historyAnswerSwiper:"history-answer-swiper_a7ez0_56","history-answer-swiper":"history-answer-swiper_a7ez0_56"}),Vb.template='\n    <div\n        data-share="{{shareParams}}"\n        data-delete="{{deleteParams}}"\n        class="{{initShowHistory ? $style[\'show-animation\'] : \'\'}}"\n        on-click="capture:goToAgent"\n    >\n        <cs-container s-if="hintText">{{hintText}}</cs-container>\n        <cos-swiper\n            s-else\n            styles="{{$swiper}}"\n            style="\n                --indicator-color: {{indicatorColor}};\n                {{!agentRecommendList.length ? \'\' : \'pointer-events: none\'}}\n            "\n            class="{{$style[\'history-answer-swiper\']}}"\n            s-ref="swiper"\n            type="page"\n            snap-align="start"\n            snap-stop="always"\n            indicator="{{blocksList.length > 1 && !agentRecommendList.length}}"\n            on-change="handleSwiperChange"\n            indicator="{{blocksList.length > 1 && !agentRecommendList.length ? \'center\': \'\'}}"\n            prevent-default="{{false}}"\n        >\n            <cos-swiper-item\n                styles="{{$swiperItem}}"\n                s-for="blocks, index in blocksList"\n                width="100%"\n                class="{{index !== currentIndex ? $style[\'hide-item\'] : \'\'}} cs-history-answer"\n            >\n                <fragment s-for="currentAnswer, currentAnswerIndex in blocks">\n                    <cs-container\n                        class="{{$style[\'answer-history\']}}\n                            {{blocksList.length > 1 && (!independenBlocks[index] || !independenBlocks[index].length) && !agentRecommendList.length ? $style[\'indicator-margin\'] : \'\'}}"\n                        bg-props="{{bgProps}}"\n                    >\n                        <header\n                            is-show-pos="{{blocksList.length > 1 && !agentRecommendList.length}}"\n                            current-index="{{index + 1}}"\n                            length="{{blocksList.length}}"\n                        ></header>\n                        <sc-ai-entry\n                            s-ref="{{entryRef}}"\n                            render-mode="only-csr-static"\n                            context="{{ {\n                                scene: \'chat-search\',\n                                app: \'bdbox\'\n                            } }}"\n                            style="{{aiEntryStyle}}"\n                            blocks="{{currentAnswer}}"\n                            rank="{{rank}}"\n                            question="{{question}}"\n                            on-ubc-log-event="handleUbcLogEvent($event, currentAnswer)"\n                            on-action-log-event="handleActionLogEvent"\n                            is-history="true"\n                        />\n                        <template s-if="!(independenBlocks[index] && independenBlocks[index].length > 0)">\n                            <template s-if="{{referenceList && referenceList.length}}">\n                                <reference-wrapper\n                                    is-chat-search="true"\n                                    refer-list="{{referenceList}}"\n                                    log-ext-params="{{logExtParams}}"\n                                    tplInfo="{{tplInfo}}"\n                                    is-history="true"\n                                />\n                            </template>\n                        </template>\n                    </cs-container>\n                </fragment>\n                \x3c!-- 拆卡 --\x3e\n                <cs-container\n                    s-if="independenBlocks[index] && independenBlocks[index].length > 0"\n                    class="\n                        {{independenBlocks[index].length > 0 && blocks && blocks.length > 0 && blocks[0].length > 0 && blocks[0][0].data && !blocks[0][0].data.hideAlaStyle\n                            ? $style[\'independen-style-padding\']\n                            : $style[\'independen-style\']}}\n                        {{$style[\'answer-history\']}}\n                        {{blocksList.length > 1 ? $style[\'indicator-margin\'] : \'\'}}\n                    "\n                    bg-props="{{independenBlocks[index].length > 0 && independenBlocks[index][0].bgProps}}"\n                >\n                    <sc-ai-entry\n                        s-ref="independenCard"\n                        render-mode="only-csr-static"\n                        context="{{ {\n                            scene: \'chat-search\',\n                            app: \'bdbox\'\n                        } }}"\n                        blocks="{{independenBlocks[index]}}"\n                        question="{{question}}"\n                        on-ubc-log-event="handleUbcLogEvent($event, blocks[0])"\n                        on-copy="handleCopy"\n                        isHistory="true"\n                        on-action-log-event="handleActionLogEvent"\n                    />\n                    <template s-if="{{referenceList && referenceList.length}}">\n                        <reference-wrapper\n                            is-chat-search="true"\n                            refer-list="{{referenceList}}"\n                            log-ext-params="{{logExtParams}}"\n                            tplInfo="{{tplInfo}}"\n                            isHistory="true"\n                        />\n                    </template>\n                </cs-container>\n                \x3c!--历史人脉卡在拆泡场景下的特殊处理--\x3e\n                <template s-for="block in blocks">\n                    <template s-for="item in block">\n                        <answer-recommend\n                            s-if="item.data.agentRecommendList.length && item.component === \'ai-agent-recommend\'"\n                            is-history="true"\n                            s-ref="answer-recommend"\n                            question="{{question}}"\n                            history-content="{{item.data.content}}"\n                            agent-recommend-list="{{item.data.agentRecommendList}}"\n                        />\n\n                    </template>\n                </template>\n            </cos-swiper-item>\n            \x3c!-- 长按菜单语音播报功能，仅播报不展现 --\x3e\n            <wd-tts-player\n                s-show="false"\n                text="{{ttsText}}"\n                s-ref="ttsPlayer"\n                tts-api-from="csaitab"\n            />\n        </cos-swiper>\n    </div>\n';var Zb="function"==typeof Vb?Vb.prototype.initData||tw:Vb.initData||tw;function tw(){return{$style:Yb,$swiper:Kb,$swiperItem:Xb}}function ew(){return Object.assign({},Zb.call(this),{$style:Yb,$swiper:Kb,$swiperItem:Xb})}function nw(){return nw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},nw.apply(this,Array.from(arguments))}"function"==typeof Vb?Vb.prototype.initData=ew:Vb.initData=ew;var aw=a.defineComponent({components:{"ask-entrance":jd,"chat-guide":qu,"cosd-question-guide":e.QuestionGuide},initData:function(){return{isChatSearch:!0,isNewConversationLaunched:!1,sseQuery:"",sseApi:"",chatAsyncRequest:0,tplInfo:{tplname:"nonala_cpt",srcid:"60259",lid:"",order:-1},chatParams:{},askData:{guideWord:"",category:[],endWord:""},context:{app:"bdbox",scene:"chat-search"},isBaiduBox:!0,hasComponentData:!1,canLaunchMultiSearch:!1,askComponentData:[],asyncAskComponentData:[],chatSearchAiTabInfo:{isChatSearchAiTabExperiment:!0,isAiTab:!0},baseData:{},isPc:"pc"===rt(),questionGuide:{},guideWord:Je.getState("guideWord"),agentList:Je.getState("agentList"),hideTopAgentList:Je.getState("hideTopAgentList"),askComponentShow:!0,curAgentInfo:null}},messages:{"ai-ask-back:change":function(t){if(this.data.get("isChatSearch")){var e=t.value;On().conversation.updataTag.emit(nw({cardId:this.data.get("tplInfo.lid"),categoryName:e.categoryName,categoryId:e.categoryId,tagList:e.tagList},e.extra))}}},computed:{customTplInfo:function(){var t=this.data.get("tplInfo");return t.is_group?t:nw({},t,{order:1})},aiTabCustomStyle:function(){var t,e=this.data.get("$style"),n=this.data.get("askComponentData");if("askBack"===(null==(t=n[0])?void 0:t.component)){var a,i,o,r;if(!(null==(o=n[0])||null==(i=o.data)||null==(a=i.category)?void 0:a.length))return e.noOption;if("mulaskback"===(null==(r=n[0])?void 0:r.type))return e.cardWarp}return""},chatParams:function(){return this.data.get("baseData.chatParams")},"tplInfo.lid":function(){return this.data.get("baseData.lid")},questionGuideShowUbcLog:function(){var t,e,n,a,i,o="";return null==(e=this.data.get("questionGuide"))||null==(t=e.items)||t.forEach((function(t){var e;null==(e=t.options)||e.forEach((function(t){o+=t.value+","}))})),JSON.stringify({value:"nonala_cpt",valueInfo:{component_id:"47_2",component_name:"questionGuide",component_type:"askBack",component_subtype:(null==(n=this.data.get("questionGuide"))?void 0:n.scrollable)?"slide":"unslide",component_content:o},agent_id:null==(a=Je.getState("agentInfo"))?void 0:a.agentId,agent_name:null==(i=Je.getState("agentInfo"))?void 0:i.agentName})}},listenNewConversation:null,listenNewConversationLaunched:null,attached:function(){var t=this;this.listen(),this.listenDataChange(),this.listenQuestionGuide(),this.listenNewConversation=function(){t.handleNewConversation()},this.listenNewConversationLaunched=function(){t.data.set("isNewConversationLaunched",!0)},Hn().on(this.listenNewConversation),Fn().on(this.listenNewConversation),Gn().on(this.listenNewConversation),Qn().on(this.listenNewConversationLaunched)},disposed:function(){this.listenNewConversation&&(Hn().off(this.listenNewConversation),Fn().off(this.listenNewConversation),Gn().off(this.listenNewConversation),this.listenNewConversation=null),this.listenNewConversationLaunched&&(Qn().off(this.listenNewConversationLaunched),this.listenNewConversationLaunched=null);var t=On();this.listenAskDataInterflow&&(t.conversation.askDataInterflow.off(this.listenAskDataInterflow),this.listenAskDataInterflow=null);this.listenQuestionGuideFlow&&(t.component.questionGuide.off(this.listenQuestionGuideFlow),this.listenQuestionGuideFlow=null)},handleNewConversation:function(){this.el&&Yn().emit(this.el.offsetHeight),this.data.set("isNewConversationLaunched",!0)},listenAskDataInterflow:null,listenDataChange:function(){var t=this,e=On().conversation.askDataInterflow;if(e){var n=this.data.get("rank");this.listenAskDataInterflow=function(e){var a;if(!t.data.get("hasComponentData")||Boolean(null==(a=e.params)?void 0:a.allowMultiUpdate)){var i=e.params.generator;if(i&&i.data){switch(Object.assign(i.data,{type:"primary",showLoading:!1,emptyDisabled:!0,showAi:!0,jumpTypes:["multiSearch"],hideAskItem:!0,toChatSearch:!0,context:{app:"bdbox",scene:"chat-search"}}),i.component){case"askBack":var o;Object.assign(i.data,{showAi:!1,context:{app:"bdbox",scene:"ai-tab"},showCategoryItemIcon:!1,defaultActiveStyle:!1}),(null==(o=i.data)?void 0:o.logExt)&&Object.assign(i.data.logExt,{type:i.type});break;case"questionClosely":var r;if((null==(r=i.data.recommendWord)?void 0:r.length)>3){var s,c=Math.ceil((null==(s=i.data.recommendWord)?void 0:s.length)/2);Object.assign(i.data,{rowNum:2,maxColNum:c})}var l=i.agentInfo||{};(null==l?void 0:l.log_ext)&&"text"===l.log_ext.scene&&"text_short"===l.log_ext.scene_1st&&"text_bless"===l.log_ext.scene_2nd&&(i.data.logExt||(i.data.logExt={}),Object.assign(i.data.logExt,l.log_ext))}var d=[],u=i.data.recommendWord||[],p=0;u.forEach((function(t){var e;if("agentRec"===t.type){var a=t.agentInfo;a&&d.push(a.agentName+a.label)}else d.push(t.text);"photoQuestion"===t.scene?p=1:(null==(e=Je.getState("imageQuery"))?void 0:e[n])&&(p=2)})),Object.assign(i.data,{photoQuestions:p}),t.nextTick((function(){t.data.set("askComponentData",[i]),t.nextTick((function(){uo({re_rank:n,lid:t.data.get("tplInfo.lid"),ori_lid:Je.getState("oriLid"),photo_questions:p,text:d})}))})),t.data.set("hasComponentData",!0)}}},e.on(this.listenAskDataInterflow,{when:function(e){void 0===e&&(e={});var a=t.data.get("latestRank");return e.rank===n&&n===a}})}},listenQuestionGuideFlow:null,listenQuestionGuide:function(){var t=this,e=On().component.questionGuide,n=this.data.get("rank");this.listenQuestionGuideFlow=function(e){var n,a=e.params.questionGuideInfo;t.data.set("askComponentShow",!(null==(n=Je.getState("agentInfo"))?void 0:n.agentName)),a.items.forEach((function(e){e.options=null==e?void 0:e.options.map((function(e){var n,a,i,o;return nw({},e,{"data-show-area":!0,"data-show-ext":JSON.stringify({type:"show",value:"cpt_option",valueInfo:{component_id:"47_2",component_name:"questionGuide",component_type:"askBack",component_subtype:(null==(n=t.data.get("questionGuide"))?void 0:n.scrollable)?"slide":"unslide",component_content:e.value},agent_id:null==(a=Je.getState("agentInfo"))?void 0:a.agentId,agent_name:null==(i=Je.getState("agentInfo"))?void 0:i.agentName}),"need-click-log":!0,"data-click-log":JSON.stringify({clk_info:{srcid:t.data.get("tplInfo.srcid"),tplname:"nonala_cpt",type:"b",action:"invokecsaitab"},extra:{component_content:{component_id:"47_2",component_name:"questionGuide",component_type:"askBack",component_subtype:(null==(o=t.data.get("questionGuide"))?void 0:o.scrollable)?"slide":"unslide",component_content:e.value}}})})}))})),t.data.set("questionGuide",a),t.data.set("hasComponentData",!0)},e.on(this.listenQuestionGuideFlow,{when:function(e){void 0===e&&(e={});var a=t.data.get("latestRank");return e.rank===n&&n===a}})},listen:function(){this.data.get("tplInfo.lid")},changeCard:function(t){var e=this.data.get("askData.category");e&&e.length&&t.data.id!==this.data.get("tplInfo.lid")&&this.ref("ask").deleteTags({needDeleteAll:!0})},handleAskBackEvent:function(t){this.askTagEventHandle(t.data,t.el)},handleUpdateAgentInfo:function(t){Je.dispatch("update",nw({},t))},askTagEventHandle:function(t,e){void 0===e&&(e=null);var n=t.name,a=t.params;switch(n){case"submit-tag":if(a.cardId!==this.data.get("tplInfo.lid"))return;(null==e?void 0:e.sendJumpLog)?e.sendJumpLog(a):this.ref("ask").sendJumpLog(a);break;case"delete-tag":if(a.cardId!==this.data.get("tplInfo.lid"))return;(null==e?void 0:e.deleteTags)?e.deleteTags(a):this.ref("ask").deleteTags(a)}},handleQuestionGuideChange:function(t){var e,n,a=null==(e=this.data.get("questionGuide"))?void 0:e.items[t.index],i=(null==a?void 0:a.prefix)||"",o=(null==a?void 0:a.suffix)||"",r=(null==t||null==(n=t.option)?void 0:n.value)||"";Je.dispatch("update",{truncQueryIndexRange:[i.length,i.length+r.length]}),Ar({query:i+r+o})}}),iw={};iw=Object.assign(iw,{answerAskWrapper:"answer-ask-wrapper_6o1ue_1","answer-ask-wrapper":"answer-ask-wrapper_6o1ue_1",immerseGroup:"immerse-group_6o1ue_6","immerse-group":"immerse-group_6o1ue_6",aiTabWrap:"ai-tab-wrap_6o1ue_9","ai-tab-wrap":"ai-tab-wrap_6o1ue_9",divider:"divider_6o1ue_12",noOption:"no-option_6o1ue_62","no-option":"no-option_6o1ue_62",cardWarp:"card-warp_6o1ue_65","card-warp":"card-warp_6o1ue_65",questionGuideWrapper:"question-guide-wrapper_6o1ue_73","question-guide-wrapper":"question-guide-wrapper_6o1ue_73",assitantHeight:"assitant-height_6o1ue_79","assitant-height":"assitant-height_6o1ue_79",aiTabWeatherExpStyle:"ai-tab-weather-exp-style_6o1ue_122","ai-tab-weather-exp-style":"ai-tab-weather-exp-style_6o1ue_122",askEntranceWrap:"ask-entrance-wrap_6o1ue_129","ask-entrance-wrap":"ask-entrance-wrap_6o1ue_129"}),aw.template='\n    <div data-show-area>\n        <div\n            s-show="{{hasComponentData && !isNewConversationLaunched}}"\n            class="\n                {{$style[\'answer-ask-wrapper\']}}\n                {{!hideTopAgentList ? $style[\'ai-tab-wrap\'] : \'\'}}\n                {{aiTabCustomStyle}}\n                {{hideTopAgentList ? $style[\'ai-tab-weather-exp-style\'] : \'\'}}\n            "\n        >\n            \x3c!-- 不上框反问组件 --\x3e\n            <div class="{{$style[\'question-guide-wrapper\']}}" s-if="questionGuide.title">\n                <cosd-question-guide\n                    class="{{!questionGuide.scrollable ? $style[\'assitant-height\'] : \'\'}}"\n                    attr-data-show-area\n                    attr-data-show-ext="{{questionGuideShowUbcLog}}"\n                    title="{{questionGuide.title}}"\n                    items="{{questionGuide.items}}"\n                    appearance="{{questionGuide.appearance}}"\n                    scrollable="{{questionGuide.scrollable}}"\n                    on-change="handleQuestionGuideChange"\n                />\n            </div>\n\n            \x3c!-- 反问/追问/输入框区 --\x3e\n            \x3c!-- 手百 A 页、互动多轮框架内 --\x3e\n            <template s-if="askComponentShow">\n                <div\n                    s-for="data in askComponentData"\n                    class="{{hideTopAgentList ? $style[\'ask-entrance-wrap\'] : \'\'}}"\n                >\n                    <ask-entrance\n                        ask-component-data="{{data}}"\n                        tpl-info="{{tplInfo}}"\n                        can-launch-multi-search="{{canLaunchMultiSearch}}"\n                        theme="{{theme}}"\n                        chat-params="{{chatParams}}"\n                        is-single-card="{{true}}"\n                        chat-search-ai-tab-info="{{chatSearchAiTabInfo}}"\n                        rank="{{rank}}"\n                        cur-agent-info="{{curAgentInfo}}"\n                        on-tag-event="handleAskBackEvent"\n                        on-update-agent-info="handleUpdateAgentInfo"\n                    />\n                </div>\n\n                \x3c!-- AI助手首页天气入口实验：agentList需展示在answer-ask中 --\x3e\n                <chat-guide\n                    guide-word="{{guideWord}}"\n                    agent-list="{{agentList}}"\n                    show-in-answer-ask="{{true}}"\n                    s-if="{{hideTopAgentList}}"\n                />\n            </template>\n        </div>\n    </div>\n';var ow="function"==typeof aw?aw.prototype.initData||rw:aw.initData||rw;function rw(){return{$style:iw}}function sw(){return Object.assign({},ow.call(this),{$style:iw})}"function"==typeof aw?aw.prototype.initData=sw:aw.initData=sw;var cw=a.defineComponent({components:{"cosc-feedback-form":e.index_pc},computed:{tcClickLog:function(){return JSON.stringify({clk_info:{pd:"csaitab",srcid:"",tab_se:"1",tplname:"nonala_cpt",type:"b",action:"feedbackForm"},extra:{component_content:{component_name:"feedbackForm"}}})},ubcShowLog:function(){return JSON.stringify({value:"nonala_cpt",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),setype:"csaitab",valueInfo:{component_name:"feedbackForm"}})}},initData:function(){return{feedbackFormData:{},product:{},showCard:!0}},attached:function(){Aa({type:"show",value:"nonala_cpt_disp",page:"resultpage",ext:{ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:String(+Je.getState("rank")),setype:"csaitab",valueInfo:[{component_name:"feedbackForm"}]}})},hideCard:function(){this.data.set("showCard",!1),this.fire("closeCard")}}),lw={};lw=Object.assign(lw,{feedbackForm:"feedback-form_gd6qt_1","feedback-form":"feedback-form_gd6qt_1"}),cw.template='\n\n    <div s-if="showCard"\n        need-click-log\n        data-show-ext="{{ubcShowLog}}"\n        data-show-area\n        data-click-log="{{tcClickLog}}"\n    >\n        <cosc-feedback-form\n            class="{{$style[\'feedback-form\']}}"\n            title="{{feedbackFormData.title}}"\n            type="{{feedbackFormData.type}}"\n            product="{{product}}"\n            successMessage="{{feedbackFormData.successMessage}}"\n            scoreCaptions="{{feedbackFormData.scoreCaptions}}"\n            options="{{feedbackFormData.options}}"\n            on-submit="hideCard"\n        />\n    </div>\n';var dw="function"==typeof cw?cw.prototype.initData||uw:cw.initData||uw;function uw(){return{$style:lw}}function pw(){return Object.assign({},dw.call(this),{$style:lw})}"function"==typeof cw?cw.prototype.initData=pw:cw.initData=pw;var hw=a.defineComponent({enableScrollClose:!0,components:{"cosc-title":e.Title,"cos-icon":e.Icon},attached:function(){this.listenerInit()},listenFeedbackPop:null,listenerInit:function(){var t=this,e=On().conversation.feedbackPop;this.listenFeedbackPop=function(e){void 0===e&&(e={}),e.id&&e.id!==t.data.get("id")||(t.data.set("url",e.url),t.data.set("title",e.title),t.data.set("contentList",e.content),t.data.set("showPop",!0),t.data.set("isGenPc",e.isGenPc),t.data.set("feDislikeKey",e.feDislikeKey),((null==e?void 0:e.left)&&(null==e?void 0:e.bottom)||(null==e?void 0:e.top))&&t.computeContentDisplay(e),window.addEventListener("scroll",t.scrollHandler),t.initContentListStatus(e.content))},null==e||e.on(this.listenFeedbackPop),this.scrollHandler=this.srcollListen.bind(this),window.addEventListener("scroll",this.scrollHandler)},disposed:function(){var t=On().conversation.feedbackPop;this.listenFeedbackPop&&t&&(t.off(this.listenFeedbackPop),window.removeEventListener("scroll",this.scrollHandler),this.listenFeedbackPop=null)},initData:function(){return{id:null,title:"",contentList:[],contentListStatus:[],tplInfo:{},showTopTriangle:!0,triangleLeft:120,contentTop:260,showPop:!1,popInitialize:!0,url:"",popupData:{content:["已收到您的问题反馈"]},tipVisible:!1,feedbackTipsFixed:!1,useCardSendLog:!1,feedbackShowInput:!1,feedBackText:"",feDislikeKey:"",inputWarn:!1,isDataFlyWheel:!1,color:"#6e4bfaff",feedbackCustomTheme:!1}},computeContentDisplay:function(t){var e=this;this.data.set("triangleLeft",t.left-7);var n=document.documentElement.clientHeight||document.body.clientHeight;this.nextTick((function(){var a,i=null==(a=e.ref("fdPopContent").getBoundingClientRect())?void 0:a.height;if(i){var o=n-t.bottom-8>i+(window.BdboxBottomBarHeight||0);e.data.set("showTopTriangle",o),e.data.set("contentTop",o?t.bottom+12:t.top-i-12),e.preventSilde(),e.data.set("popInitialize",!1)}else e.data.set("showPop",!1)}))},shadowClick:function(t){t.preventDefault(),t.stopPropagation();var e=t.target.getAttribute("textTag");if(this.data.get("useCardSendLog")&&e){var n={type:"b",fm:"beha",action:"feedback",subpos:e};if(this.data.get("isDataFlyWheel")){var a=Math.floor(+e/2),i=+e%2,o=this.data.get("contentList");n={type:"b",fm:"beha",action:"feedback",extra:{interactKey:this.data.get("feDislikeKey"),feedback_option:o[a][i]}}}this.dispatch("send-log",n),this.showTextToast()}else this.data.get("isPc")&&this.data.get("isHuabu")&&e?(this.dispatch("Event:logEvent",{type:"b",action:"feedback",subpos:e,fm:"beha",extra:{clk_region:"hudong"}}),this.showTextToast()):e&&this.showTextToast();this.closePop()},closePop:function(){this.data.set("showPop",!1),this.data.set("popInitialize",!0),this.data.set("feedBackText",""),this.recoverSlide(),window.removeEventListener("scroll",this.scrollHandler)},showTextToast:function(){this.data.get("isGenPc")||this.data.get("isPc")&&this.data.get("isHuabu")?this.dispatch("UI:showToast",{content:"已收到您的问题反馈"}):"pc"===this.data.get("tplInfo").env?this.ref("tip").show():e.Toast.show({message:"已收到您的问题反馈"})},preventSilde:function(){document.body.addEventListener("touchmove",this.preventDefault,{passive:!1}),this.data.get("isPc")&&this.data.get("isHuabu")||(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden")},recoverSlide:function(){document.body.removeEventListener("touchmove",this.preventDefault,{passive:!1}),this.data.get("isPc")&&this.data.get("isHuabu")||(document.body.style.overflow="",document.documentElement.style.overflow="")},preventDefault:function(t){t.preventDefault()},srcollListen:function(){this.enableScrollClose&&this.closePop()},initContentListStatus:function(t){for(var e=new Array(t.length).fill([]),n=0;n<t.length;n++)e[n]=new Array(t[n].length).fill(!1);this.data.set("contentListStatus",e)},handleItemClick:function(t,e,n){if(this.data.get("feedbackShowInput")){t.stopPropagation();var a=this.data.get("contentListStatus["+e+"]["+n+"]");this.data.set("contentListStatus["+e+"]["+n+"]",!a)}},stop:function(t){t.stopPropagation()},handleInput:function(t){this.data.set("inputWarn",t.target.value.length>=500)},submitFeedBack:function(t){t.stopPropagation();for(var n=this.data.get(),a=n.feedBackText,i=n.contentList,o=n.contentListStatus,r=[],s=0;s<o.length;s++)for(var c=0;c<o[s].length;c++)o[s][c]&&r.push(i[s][c]);if(a||0!==r.length){if(this.data.get("useCardSendLog")){var l={type:"b",fm:"beha",action:"feedback",extra:{interactKey:this.data.get("feDislikeKey")}};a&&(l.extra.feedback_input=a),r.length>0&&(l.extra.feedback_option=r.join("_")),this.dispatch("send-log",l)}e.Toast.show({message:"已收到您的问题反馈"}),this.closePop()}else this.closePop()},handleFocus:function(){this.enableScrollClose=!1},handleBlur:function(){this.enableScrollClose=!0}}),fw={};fw=Object.assign(fw,{popWrap:"pop-wrap_1jcah_1","pop-wrap":"pop-wrap_1jcah_1",contentWrap:"content-wrap_1jcah_9","content-wrap":"content-wrap_1jcah_9",triangleIcon:"triangle-icon_1jcah_16","triangle-icon":"triangle-icon_1jcah_16",topTriangle:"top-triangle_1jcah_34","top-triangle":"top-triangle_1jcah_34",bottomTriangle:"bottom-triangle_1jcah_40","bottom-triangle":"bottom-triangle_1jcah_40",content:"content_1jcah_9",title:"title_1jcah_53",texts:"texts_1jcah_58",text:"text_1jcah_58",selectItem:"select-item_1jcah_75","select-item":"select-item_1jcah_75",popInitialize:"pop-initialize_1jcah_79","pop-initialize":"pop-initialize_1jcah_79",popReady:"pop-ready_1jcah_82","pop-ready":"pop-ready_1jcah_82",closeIcon:"close-icon_1jcah_85","close-icon":"close-icon_1jcah_85",feedbackTextarea:"feedback-textarea_1jcah_95","feedback-textarea":"feedback-textarea_1jcah_95",count:"count_1jcah_100",inputWarn:"input-warn_1jcah_108","input-warn":"input-warn_1jcah_108",textareaWrapper:"textarea-wrapper_1jcah_111","textarea-wrapper":"textarea-wrapper_1jcah_111",textInputTextarea:"text-input-textarea_1jcah_116","text-input-textarea":"text-input-textarea_1jcah_116",btnWrap:"btn-wrap_1jcah_137","btn-wrap":"btn-wrap_1jcah_137",btn:"btn_1jcah_137",submit:"submit_1jcah_154"}),hw.template='\n    <div\n        style="--color: {{color || \'#6e4bfaff\'}}"\n        class="{{feedbackCustomTheme ? [\'theme-customize\', \'cos-dqa\'] : \'\'}}"\n        data-stop-bubble\n        on-click="shadowClick($event)"\n    >\n        <div\n            s-if="showPop"\n            class="\n                {{$style[\'pop-wrap\']}}\n                {{popInitialize ? $style[\'pop-initialize\'] : $style[\'pop-ready\']}}\n                {{isGenPc || (isPc && isHuabu) ? $style[\'pop-genpc\'] :\'\'}}\n                cs-feedback-pop\n            "\n            rl-type="stop"\n        >\n            <div\n                class="{{$style[\'content-wrap\']}}"\n                s-ref="fdPopContent"\n                style="top: {{contentTop}}px;"\n            >\n                <cos-icon\n                    name="close_line"\n                    class="{{$style[\'close-icon\']}}"\n                    on-click="native:hide"\n                    s-if="tplInfo && tplInfo.env === \'pc\'"\n                />\n                <div\n                    s-if="showTopTriangle"\n                    class="{{$style[\'triangle-icon\']}} {{$style[\'top-triangle\']}}"\n                    style="left: {{triangleLeft}}px"\n                />\n                <div class="{{$style[\'content\']}}">\n                    <cosc-title\n                        s-if="title"\n                        class="cos-space-pb-md cos-line-clamp-1 {{$style[\'title\']}}"\n                    >\n                        <span class="cos-line-clamp-1">{{title}}</span>\n                    </cosc-title>\n                    <div\n                        s-for="texts,lineIndex in contentList"\n                        class="{{$style[\'texts\']}}"\n                    >\n                        <div\n                            s-for="text,index in texts"\n                            enableHotspot="true"\n                            class="\n                                cos-link-button\n                                cos-block\n                                cos-line-clamp-1\n                                {{$style[\'text\']}}\n                                {{contentListStatus[lineIndex][index] ? $style[\'select-item\'] : \'\'}}\n                            "\n                            on-click="native:handleItemClick($event, lineIndex, index)"\n                        >\n                            <p textTag="{{lineIndex * 2 + index}}" class="cos-line-clamp-1">\n                                {{text}}\n                            </p>\n                        </div>\n                    </div>\n\n                    \x3c!-- 用于评估使用的输入框 --\x3e\n                    \x3c!-- 请注意：以下输入框仅用于配置零流量线下评估使用，不可以用于线上用户使用，存在部分暂无法解决的体验问题，长线考虑NA面板 --\x3e\n                    <div\n                        s-if="feedbackShowInput"\n                        class="{{$style[\'feedback-textarea\']}}"\n                        on-click="stop"\n                    >\n                        <div\n                            class="{{$style[\'textarea-wrapper\']}}"\n                            on-touchmove="stop"\n                        >\n                            <textarea\n                                class="cos-text-body {{$style[\'text-input-textarea\']}}"\n                                placeholder="请输入你的反馈意见"\n                                value="{=feedBackText=}"\n                                on-input="handleInput"\n                                on-focus="handleFocus"\n                                on-blur="handleBlur"\n                                maxlength="500"\n                            >\n                            </textarea>\n                            <div\n                                class="{{$style[\'count\']}} {{inputWarn ? $style[\'input-warn\'] : \'\'}}"\n                            >{{feedBackText.length}}/500</div>\n                        </div>\n                    </div>\n                    <div s-if="feedbackShowInput" class="{{$style[\'btn-wrap\']}}">\n                        <div class="{{$style[\'btn\']}}">取消</div>\n                        <div class="{{$style[\'btn\']}} {{$style[\'submit\']}}" on-click="submitFeedBack">反馈给我</div>\n                    </div>\n                </div>\n                <div\n                    s-if="!showTopTriangle"\n                    class="{{$style[\'triangle-icon\']}} {{$style[\'bottom-triangle\']}}"\n                    style="left: {{triangleLeft}}px"\n                />\n            </div>\n        </div>\n    </div>\n';var gw="function"==typeof hw?hw.prototype.initData||mw:hw.initData||mw;function mw(){return{$style:fw}}function vw(){return Object.assign({},gw.call(this),{$style:fw})}function yw(){return yw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},yw.apply(this,Array.from(arguments))}"function"==typeof hw?hw.prototype.initData=vw:hw.initData=vw;var bw=new X({pid:"19_103",lid:"",sample:1}),ww=function(){function t(t){var e;this.groupList={};var n=t.params,a=t.platform,i=t.card,o=t.dim,r=void 0===o?{}:o,s=t.sendType;this.monitorInfo={},this.modelName="",this.typingTimer=null,this.typingObserveDelay=5e3,this.hasInit=!1,this.observer=null,this.params=n,this.platform=a||"wise",this.card=i||"",this.dim=yw({platform:this.platform,card:this.card,isSync:Je.getState("isSync")||"0",isAgent:(null==(e=Je.getState("agentInfo"))?void 0:e.agentName)?"1":"0"},r),this.sendType=s,this.initGroupList()}var e=t.prototype;return e.initListener=function(){var t=this;if(!this.hasInit){var e=!1,n=0,a=this.params.aiContainerEl;this.observer=new MutationObserver((function(e){e.forEach((function(e){if("characterData"===e.type||"childList"===e.type){var i=a.textContent.length;i!==n&&(n=i,t.clearTypingTimer(),t.setTypingTimer())}}))})),a&&this.observer&&this.observer.observe(a,{childList:!0,subtree:!0,characterData:!0});document.addEventListener("visibilitychange",(function(){var n;(t.sendCount(),t.sendExceptMonitor(),document.hidden)?(clearTimeout(t.typingTimer),t.observer&&t.observer.disconnect(),e=!1):(!e&&!(null==(n=t.monitorInfo)?void 0:n.finishedTime)&&a&&t.observer&&t.observer.observe(a,{childList:!0,subtree:!0,characterData:!0}),e=!0)})),this.hasInit=!0}},e.stopListen=function(){this.observer&&this.observer.disconnect(),this.clearTypingTimer()},e.setTypingTimer=function(){var t=this;this.typingTimer||(this.typingTimer=setTimeout((function(){t.sendTypingExcept()}),this.typingObserveDelay))},e.clearTypingTimer=function(){clearTimeout(this.typingTimer),this.typingTimer=null},e.isSend=function(t){return!!t&&(!this.sendType||this.sendType.includes(t))},e.initGroupList=function(){"wise"===this.platform?(this.groupList.perf="chatsearch",this.groupList.whiteScreen="ai_index_white_screen",this.groupList.interface="ai_index_interface",this.groupList.lostPackage="ai_index_lost_package",this.groupList.show="aiIndexShow"):(this.groupList.perf="chat_pc",this.groupList.whiteScreen="chat_pc_white_screen",this.groupList.interface="chat_pc_interface",this.groupList.lostPackage="chat_pc_lost_package",this.groupList.show="chat_pc_show")},e.setMonitorData=function(t,e){var n;"object"==(void 0===t?"undefined":(n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)?Object.assign(this.monitorInfo,t):this.monitorInfo[t]=e},e.setModelName=function(t){!this.modelName&&(this.modelName=t)},e.sendPerfMonitor=function(t,e){var n,a,i,o=e.tti,r=e.dangerCheckTime,s=e.generatingStartTime,c=e.waitProcessStartTime,l=e.startTime,d=e.finishedTime,u=e.fetchEndTime,p=e.sseRequestStart,h=e.serverSpeed,f=void 0===h?{}:h,g=e.chunkFirstPackageTime,m=e.overviewBlockFirstTokenDur,v=f.costs||{},y=v.vuiPreTime,b=v.vuiFirstTokenCost,w=yw({tti:o-l,start2SseRequest:p-l},window.renderHeadStartTime&&t<=1&&(null==(a=performance)||null==(n=a.timing)?void 0:n.navigationStart)?{start2Rendered:window.renderHeadStartTime-performance.timing.navigationStart,render2BootstrapStart:Je.getState("bootstrapStart")-window.renderHeadStartTime}:{},r?{dangerCheckTime:r}:{},d?{sseAllTime:d-l}:{},u?{sseRequestTime:u-p}:{},c?{sseWaitTime:c-p}:{},s?yw({start2SseFirstGenerateTime:s-l},p?{newSseFirstGenerateTime:s-p}:{}):{},g?{startToChunkFirstPackageTime:g-l}:{},y&&b?{feAndNetTime:s-l-y-b,severTime:y+b}:{},v,void 0===m?{}:{overviewBlockFirstTokenDur:m}),_=f.labels||{};Object.keys(_).length&&(delete f.labels.asid,delete f.labels.query),this.isSend("pref")&&l&&Object.keys(w).length&&bw.sendPerf({group:"1"===_.frame_type?"chatsearch_new":this.groupList.perf,info:w,dim:yw({rank:t<=1?"first":"other",modelName:this.modelName||"unknow",loadMode:t<=1?"1"===(null==(i=this.dim)?void 0:i.isSync)?"first_sync":"first_async":"non_first_async"},_,this.dim)})},e.sendExceptMonitor=function(){var t,e=this.monitorInfo,n=e.hasSendExceptMonitor,a=e.generatingStartTime,i=e.finishedTime,o=e.netError,r=e.antiCheat,s=e.timeout,c=e.aiContainerEmpty,l=e.stopGenerateAbnormal,d=e.allPackageCount,u=e.lostPackages;if(!n){var p=this.params,h=p.ctse_id,f=p.ori_lid,g=p.rank,m="",v="";o?(m="网络异常",v="网络异常"):r?m="反作弊":s?(m="请求超时",v="请求超时"):c?m="命中画布空白兜底":l?(m="请求异常中断",v="请求异常中断"):!a&&i&&(m="提前结束回调后才开始生成",v="提前结束回调后才开始生成");var y=yw({},this.monitorInfo,{ctse_id:h,ori_lid:f,rank:g,query:yt(Je.getState("query")),lid:Je.getState("lid"),agentName:null==(t=Je.getState("agentInfo"))?void 0:t.agentName}),b=yw({msg:m},y),w="";u>0&&(w="共发送"+d+"包，丢了"+u+"包"),m&&this.isSend("whiteScreen")&&bw.sendExcept({group:this.groupList.whiteScreen,info:b,dim:yw({type:m},this.dim)}),this.isSend("interface")&&v&&bw.sendExcept({group:this.groupList.interface,info:yw({msg:v},y),dim:yw({type:v},this.dim)}),this.isSend("lostPackage")&&"wise"===this.platform&&w&&bw.sendExcept({group:this.groupList.lostPackage,info:yw({msg:w},y),dim:this.dim}),this.monitorInfo.hasSendExceptMonitor=1}},e.sendPerf=function(){if(!Je.getState("isDev")){var t=this.monitorInfo||{},e=this.params.rank,n=void 0===e?"":e;!t.isRetry&&this.sendPerfMonitor(n,this.monitorInfo)}},e.sendTypingExcept=function(){var t,e=this.monitorInfo||{};if(!e.hasSendTypingExec){var n=e.fetchEndTime,a=e.finishedTime,i=e.isUserActiveAbort,o=e.lastPack,r=this.params,s=r.ctse_id,c=void 0===s?"":s,l=r.ori_lid,d=void 0===l?"":l,u=r.rank,p=void 0===u?"":u,h=r.aiContainerEl;if(!i){var f=yw({msg:""},e,{ctse_id:c,ori_lid:d,rank:p,query:yt(Je.getState("query")),lid:Je.getState("lid"),agentName:null==(t=Je.getState("agentInfo"))?void 0:t.agentName,reciviedLastPack:o,renderedLastPack:h.innerText.substr(-50)});n?a||(f.msg="打字卡住"):(f.msg="无结束回调",this.isSend("interface")&&bw.sendExcept({group:this.groupList.interface,info:f,dim:yw({type:"无结束回调"},this.dim)})),this.isSend("whiteScreen")&&f.msg&&bw.sendExcept({group:this.groupList.whiteScreen,info:f,dim:yw({type:f.msg},this.dim)}),this.monitorInfo.hasSendTypingExec=1}}},e.sendCount=function(){(this.monitorInfo||{}).hasSendCount||(this.isSend("show")&&bw.sendCount({group:this.groupList.show,info:{show:1},dim:this.dim}),this.monitorInfo.hasSendCount=1)},t}(),_w=function(){function t(t,e){this.SUCCESS_TOASTT_MSG="数据复制成功",this.FAIL_TOASTT_MSG="数据复制失败",this.CLICK_COUNT=5,this.TIME_LENGTH=5e3,this.sseDataList=[],this.clickList=[],this.doubleTouch=!1,this.threeTouch=!1,this.cardEl=t,this.Toast=e,this.bindClickListener(),this.bindTouchListener()}var e=t.prototype;return e.bindClickListener=function(){var t,e=this;null==(t=this.cardEl)||t.addEventListener("click",(function(){e.addClickEvent(),e.touchHandler()}))},e.addClickEvent=function(){this.clickList.length>=this.CLICK_COUNT&&this.clickList.shift(),this.clickList.push(+new Date)},e.bindTouchListener=function(){var t,e=this;null==(t=this.cardEl)||t.addEventListener("touchstart",(function(t){2===t.touches.length?(e.doubleTouch=!0,e.clickList=[]):3===t.touches.length&&(e.threeTouch=!0,e.clickList=[])}))},e.touchHandler=function(){this.clickList.length===this.CLICK_COUNT&&this.clickList[this.clickList.length-1]-this.clickList[0]<=this.TIME_LENGTH&&this.doubleTouch&&this.threeTouch&&(this.copy(),this.doubleTouch=!1,this.threeTouch=!1)},e.addSseData=function(t,e){this.sseDataList.push({status:e,data:t,time:+new Date})},e.clearSseData=function(){this.sseDataList=[]},e.copy=function(){var t=this;this.sseDataList.length&&this.Toast&&Ed(JSON.stringify(this.sseDataList)).then((function(){t.Toast.show({message:t.SUCCESS_TOASTT_MSG})})).catch((function(e){t.Toast.show({message:t.FAIL_TOASTT_MSG+"\nerr: "+e})}))},t}();function kw(){return kw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},kw.apply(this,Array.from(arguments))}var Sw="操作次数超过限制值",xw=a.defineComponent({template:"\n\n    ",components:{"cos-icon":e.Icon},initData:function(){return{status:null,url:null,likeNum:0,feLikeKey:null,feDislikeKey:null,feLikeType:null,reqParams:{},word:"",feedbackId:null,feedbackTitle:"请选择遇到的问题",feedbackContentList:[["内容错误","与搜索词无关"],["内容陈旧","包含违规信息"],["页面打不开","浏览体验差"]],feedbackTipsFixed:!1,feedbackShowInput:!1,feedbackCustomTheme:!1,useWiseStyle:!1,useCardSendLog:!1,praiseFrequencyLimitAlert:{content:[Sw]},tplInfo:{},notShowPopup:!1,changeField:!1,praisedTimes:0,isPraising:!1,tipVisible:!1,color:"#6e4bfaff",isWendaIndex:!1,isChatSearch:!1,graphCreationLog:{},isPreventLog:!1,isDataFlyWheel:!1,uselessShow:!0,isBless:!1}},created:function(){this.handlePraise=_n(this.handlePraise,100)},attached:function(){this.data.get("isPreventLog")||this.dispatch("send-ubclog",{type:"show",value:"like_unlike"})},computed:{praiseNumStr:function(){var t=this.data.get("likeNum");return t>0?t>999?"999+":t+"":""}},handlePraise:function(t,e){var n=this;e.stopPropagation();var a=this.data.get(),i=a.isPraising,o=a.praisedTimes,r=a.status,s=a.likeNum,c=a.feedbackId,l=a.feedbackTitle,d=a.feedbackContentList,u=a.likeNumDisable;if(!i)if(o>9)this.showFrequencyLimit();else if(this.data.set("praisedTimes",o+1),this.data.get("isPc")&&this.data.get("isHuabu")&&this.dispatch("Event:logEvent",{type:"b",fm:"beha",extra:{clk_region:"hudong"}}),u||("like"===r?this.data.set("likeNum",s-1):"like"===t&&this.data.set("likeNum",s+1)),"like"!==r&&"degrade"!==r||this.doPraise(r,!0,e),r!==t){var p=e.target;this.nextTick((function(){if(n.doPraise(t,!1,e),"degrade"===t&&!n.data.get("notShowPopup")){var a=n.getDownIconLocation(p),i=On().conversation.feedbackPop;null==i||i.emit(kw({id:c,title:l,content:d,url:n.data.get("url"),isGenPc:n.data.get("isGenPc"),feDislikeKey:n.data.get("feDislikeKey")},a))}n.data.set("status",t),n.dispatch("send-ubclog",{type:"click",value:"like_unlike",extra:kw({action:"like"===t?"like_set":"unlike_set"},n.data.get("graphCreationLog"))})}))}else this.data.set("status",null),this.dispatch("send-ubclog",{type:"click",value:"like_unlike",extra:kw({action:"like"===r?"like_unset":"unlike_unset"},this.data.get("graphCreationLog"))})},doPraise:function(t,e,n){var a=this,i=this.data.get(),o=i.feLikeType,r=i.feLikeKey,s=i.feDislikeKey,c=i.changeField,l="ps_"+encodeURI(this.data.get("url"));"like"===t&&r?l=r:"degrade"===t&&s&&(l=s);var d="https://ext.baidu.com/api/like/v1/"+t+"/receive?",u=e?"cancel":"add",p="callback_"+t+"_"+u,h=this.data.get("reqParams");if(d+=Ot(kw({sfrom:c?"search":"search_topone",source:c?"search_aisearch":"search_topone",appname:"baiduapp",type:o,callback:p,ext:'{"search_query": "'+this.data.get("word")+'"}',rtype:9,op_type:u,id:l},h)),this.data.set("isPraising",!0),fetch(d,{method:"get",mode:"no-cors",credentials:"include"}).then((function(t){a.data.set("isPraising",!1)})).catch((function(){a.data.set("isPraising",!1)})),this.data.get("useCardSendLog")){var f={type:"b",fm:"beha",action:t+"_"+u,extra:this.data.get("isBless")?{module_type:"hudong"}:{},target:null==n?void 0:n.target};this.data.get("isDataFlyWheel")&&(f.extra.interactKey=l),this.dispatch("send-log",f)}},showFrequencyLimit:function(){this.data.get("isPc")?this.dispatch("UI:showToast",{content:Sw}):e.Toast.show({message:Sw})},getDownIconLocation:function(t){var e={left:0,top:0,bottom:0};if(t){var n=t.getBoundingClientRect();e.left=Math.round(n.left),e.bottom=Math.round(n.bottom),e.top=Math.round(n.top)}return e}}),Iw={};Iw=Object.assign(Iw,{praiseWrapper:"praise-wrapper_bxg2u_1","praise-wrapper":"praise-wrapper_bxg2u_1",btnWrapper:"btn-wrapper_bxg2u_10","btn-wrapper":"btn-wrapper_bxg2u_10",btnCsaitabWrapper:"btn-csaitab-wrapper_bxg2u_18","btn-csaitab-wrapper":"btn-csaitab-wrapper_bxg2u_18",btnGroup:"btn-group_bxg2u_22","btn-group":"btn-group_bxg2u_22",active:"active_bxg2u_32",expIcon:"exp-icon_bxg2u_35","exp-icon":"exp-icon_bxg2u_35",fillIcon:"fill-icon_bxg2u_35","fill-icon":"fill-icon_bxg2u_35",lineIcon:"line-icon_bxg2u_38","line-icon":"line-icon_bxg2u_38",useful:"useful_bxg2u_41",nouseful:"nouseful_bxg2u_44",expText:"exp-text_bxg2u_60","exp-text":"exp-text_bxg2u_60",num:"num_bxg2u_72",divider:"divider_bxg2u_79",praiseUnderline:"praise-underline_bxg2u_111","praise-underline":"praise-underline_bxg2u_111",praiseCsaitabWrapper:"praise-csaitab-wrapper_bxg2u_153","praise-csaitab-wrapper":"praise-csaitab-wrapper_bxg2u_153",useWiseStyle:"use-wise-style_bxg2u_160","use-wise-style":"use-wise-style_bxg2u_160",useGenPcStyle:"use-gen-pc-style_bxg2u_160","use-gen-pc-style":"use-gen-pc-style_bxg2u_160"}),xw.template="\n    <div style=\"--color: {{color || '#6e4bfaff'}}\">\n        <div\n            class=\"\n                {{$style['praise-wrapper']}}\n                {{isChatSearch ? $style['praise-csaitab-wrapper'] : ''}}\n                {{useWiseStyle ? $style['use-wise-style'] : ''}}\n                {{isHuabu && isPc ? $style['use-gen-pc-style'] : ''}}\n            \"\n            rl-type=\"stop\"\n        >\n            <div class=\"{{$style['btn-wrapper']}} {{isChatSearch ? $style['btn-csaitab-wrapper'] : ''}}\">\n                <div\n                    data-module=\"zan\"\n                    class=\"{{$style['btn-group']}} {{$style.useful}} {{status === 'like' ? $style['active'] : ''}}\"\n                    on-click=\"handlePraise('like', $event)\"\n                >\n                    <cos-icon\n                        name=\"thumbs-up-fill\"\n                        class=\"{{$style['exp-icon']}} {{$style['fill-icon']}}\"\n                    />\n                    <cos-icon\n                        name=\"thumbs-up\"\n                        class=\"{{$style['exp-icon']}} {{$style['line-icon']}}\"\n                    />\n                    <div class=\"{{isPc && isHuabu ? $style['praise-underline']: ''}}\">\n                        <span class=\"{{$style['exp-text']}} cos-font-medium\" s-if=\"!likeTxtDisable && !isChatSearch\">有用</span>\n                        <span\n                            s-if=\"{{praiseNumStr && !likeTxtDisable && !isChatSearch}}\"\n                            class=\"{{$style.num}} cos-font-medium\"\n                        >\n                            {{ praiseNumStr }}\n                        </span>\n                    </div>\n                </div>\n                <div\n                    data-module=\"cai\"\n                    class=\"{{$style['btn-group']}} {{$style.nouseful}} {{status === 'degrade' ? $style['active'] : ''}}\"\n                    on-click=\"handlePraise('degrade', $event)\"\n                >\n                    <cos-icon\n                        name=\"thumbs-down-fill\"\n                        class=\"{{$style['exp-icon']}} {{$style['fill-icon']}}\"\n                    />\n                    <cos-icon\n                        name=\"thumbs-down\"\n                        class=\"{{$style['exp-icon']}} {{$style['line-icon']}}\"\n                    />\n                    <span s-if=\"{{uselessShow}}\" class=\"{{$style['exp-text']}} cos-font-medium\">没用</span>\n                </div>\n            </div>\n        </div>\n    </div>\n";var Tw="function"==typeof xw?xw.prototype.initData||Cw:xw.initData||Cw;function Cw(){return{$style:Iw}}function Lw(){return Object.assign({},Tw.call(this),{$style:Iw})}function Pw(){return Pw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pw.apply(this,Array.from(arguments))}"function"==typeof xw?xw.prototype.initData=Lw:xw.initData=Lw;var Dw=a.defineComponent({components:{"cos-icon":e.Icon},initData:function(){return{tplInfo:{},isPc:!1,graphCreationLog:{},isNaElder:!1}},attached:function(){this.dispatch("send-ubclog",{type:"show",value:"copy"}),this.dispatch("send-midlog",{cst:2,clk_extra:{t:1}}),this.data.get("isPc")||this.checkIsElder()},copyText:function(t){var n=this.data.get("getCopyTarget");if("function"==typeof n){var a=n();if(a){var i="*[disable-copy]",o="";if(a.querySelector&&a.querySelector(i)){var r=a.cloneNode(!0),s=r.querySelectorAll(i);Array.from(s).forEach((function(t){t.remove()})),r.style.background="transparent",document.body.appendChild(r),o=r.innerText.trim(),document.body.removeChild(r)}else o=a.innerText;this.fire("click-log","copy"),this.dispatch("send-log",{type:"b",fm:"beha",target:t.target,extra:Pw({clk_region:"function"},this.data.get("graphCreationLog"))});var c=this.data.get("isPc"),l=this.data.get("isNaElder")&&!c?4e3:2e3;Ed(o).then((function(t){e.Toast.show({message:"复制成功",duration:l})})).catch((function(t){var n="复制失败";c?e.Toast.error({message:n,duration:l}):e.Toast.show({message:n,duration:l})}))}}},checkIsElder:function(){var t=this;o&&o.canIUse("elder.getElderConfig")&&o.elder.getElderConfig({success:function(e){var n;0===e.status&&t.data.set("isNaElder",!!(null==e||null==(n=e.data)?void 0:n.isElderMode))}})}}),Aw={};Aw=Object.assign(Aw,{copy:"copy_1xp8t_1",icon:"icon_1xp8t_4",copyText:"copy-text_1xp8t_19","copy-text":"copy-text_1xp8t_19",text:"text_1xp8t_24"}),Dw.template='\n    <div>\n        <div\n            data-module="copy"\n            class="cos-row copy-container {{$style.copy}} {{$style.copyDark}} {{!copyTxtDisable ? $style.copyText : \'\'}}"\n            on-click="copyText"\n        >\n            <cos-icon class="{{$style.icon}}" name="copy" />\n            <span s-if="{{!copyTxtDisable}}" class="{{$style.text}} cos-font-medium">复制</span>\n        </div>\n    </div>\n';var Ew,Ow="function"==typeof Dw?Dw.prototype.initData||Rw:Dw.initData||Rw;function Rw(){return{$style:Aw}}function Nw(){return Object.assign({},Ow.call(this),{$style:Aw})}function qw(){return qw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},qw.apply(this,Array.from(arguments))}"function"==typeof Dw?Dw.prototype.initData=Nw:Dw.initData=Nw,function(t){t.REWRITE="重写",t.REDRAW="重画"}(Ew||(Ew={}));var Mw=a.defineComponent({components:{"cos-icon":e.Icon},computed:{text:function(){var t=this.data.get("replaceText");return t||"重新回答"},realShowExt:function(){return JSON.stringify(qw({type:"show",value:"change"},this.data.get("logExtData")))},ubcClickLog:function(){return JSON.stringify({type:"click",value:"change",ubcExt:qw({},this.data.get("logExtData"))})}},initData:function(){return{tplInfo:{},popupData:{content:[]},replaceText:"重新回答",replaceIcon:"exchange",isPreventLog:!1,forceShowReplaceText:!1,dispatchedClickEvents:["send-log"],isBless:!1,logExtData:{},isFixedWidth:!1,rank:0,isPc:!1}},attached:function(){this.onClickReplace=_n(this.onClick.bind(this),300,{leading:!0,trailing:!1}),this.data.get("isPreventLog")||(this.dispatch("send-ubclog",{type:"show",value:"change"}),this.dispatch("send-midlog",{cst:2,clk_extra:{t:4}}))},onClick:function(t){var e=this;if(this.data.get("isPc"))return this.fire("click-log","change"),void ti().emit({params:{location_id:"generate_"+this.data.get("rank"),function_type:"card_function_regenerate",location_type:"answer_card"}});var n={type:"b",fm:"beha",extra:{clk_region:"function"},target:t.target};this.data.get("isBless")&&(n.extra.module_type="hudong",n.action="rewrite");var a=this.data.get("dispatchedClickEvents")||[];(null==a?void 0:a.length)&&a.forEach((function(t){e.dispatch(t,n)})),this.fire("click",{e:t})}}),jw={};jw=Object.assign(jw,{replace:"replace_1qbf7_1",icon:"icon_1qbf7_4",text:"text_1qbf7_10",iconGray:"icon-gray_1qbf7_14","icon-gray":"icon-gray_1qbf7_14",fixedWidth:"fixed-width_1qbf7_17","fixed-width":"fixed-width_1qbf7_17"}),Mw.template='\n    <div>\n        <div\n            data-module="change"\n            data-show-area\n            data-show-ext="{{realShowExt}}"\n            data-click-log="{{ubcClickLog}}"\n            class="cos-row {{$style.replace}} {{isGray ? $style[\'icon-gray\'] : \'\'}} {{isFixedWidth ? $style[\'fixed-width\'] : \'\'}}"\n            on-click="onClickReplace"\n        >\n            <cos-icon class="{{$style.icon}}" name="{{replaceIcon}}" />\n            <span\n                class="{{$style.text}} cos-font-medium writing-one-more"\n            >{{text}}</span>\n        </div>\n    </div>\n';var Bw="function"==typeof Mw?Mw.prototype.initData||Hw:Mw.initData||Hw;function Hw(){return{$style:jw}}function $w(){return Object.assign({},Bw.call(this),{$style:jw})}"function"==typeof Mw?Mw.prototype.initData=$w:Mw.initData=$w;var Uw=a.defineComponent({components:{"cos-icon":e.Icon},initData:function(){return{cid:"",isShowEditTxt:!1}},attached:function(){this.dispatch("send-ubclog",{type:"show",value:"edit"})},handleEdit:function(t){this.fire("edit-click"),this.dispatch("send-log",{type:"b",fm:"beha",target:t.target})}}),Fw={};Fw=Object.assign(Fw,{edit:"edit_yxeie_1",icon:"icon_yxeie_1",text:"text_yxeie_7",editText:"edit-text_yxeie_15","edit-text":"edit-text_yxeie_15"}),Uw.template='\n    <div\n        data-module="edit"\n        data-cid="{{cid}}"\n        class="{{$style[\'edit\']}} {{isShowEditTxt ? $style.editText : \'\'}}"\n        on-click="handleEdit"\n    >\n        <cos-icon class="{{$style[\'icon\']}}" name="input" />\n        <span s-if="{{isShowEditTxt}}" class="{{$style.text}} cos-font-medium">编辑</span>\n    </div>\n';var Gw="function"==typeof Uw?Uw.prototype.initData||Ww:Uw.initData||Ww;function Ww(){return{$style:Fw}}function zw(){return Object.assign({},Gw.call(this),{$style:Fw})}function Qw(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Jw(){return Jw=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Jw.apply(this,Array.from(arguments))}function Vw(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof Uw?Uw.prototype.initData=zw:Uw.initData=zw;var Kw=a.defineComponent({cryptoJS:null,components:{"sc-icon":e.Icon},initData:function(){return{tplInfo:{},downloadUrl:"",isPc:!1,graphCreationLog:{},downloadParams:{sk:"etdh47hd78ehr4vd530ch378d83jtb3u",ak:"B3YhqQYhgQ67HgTssGsQy8KmsP"}}},attached:function(){var e=this;this.data.get("isPc")||new Promise((function(e,n){t(["./crypto.pc.DUESVqs9"],e,n)})).then((function(t){return t.index})).then((function(t){e.cryptoJS=t})),this.dispatch("send-ubclog",{type:"show",value:"download"}),this.dispatch("send-midlog",{cst:2,clk_extra:{t:1}})},downloadText:function(t){return(e=function(){var e,n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y;return Vw(this,(function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,ws()];case 1:return b.sent(),[3,3];case 2:return b.sent(),[2,Bn().emit({text:"登录失败，请稍后再试"})];case 3:return navigator.onLine?(this.fire("click-log","download"),this.dispatch("send-log",{type:"b",fm:"beha",target:t.target,extra:Jw({clk_region:"function"},this.data.get("graphCreationLog"))}),"function"!=typeof(a=this.data.get("getDownloadTarget"))?[2]:(i=a())?(o=i.innerText,r=this.data.get("isPc"),s=yt(Je.getState("query"))||"文档",r?(c=new Blob([o],{type:"text/plain"}),l=URL.createObjectURL(c),(d=document.createElement("a")).href=l,d.download=s,d.click(),[2]):(u=String(Date.now()),p=this.data.get("downloadParams"),h=p.ak,f=p.sk,g=(null==(e=this.cryptoJS)?void 0:e.MD5(o+f+u))||"",m=g.toString(null==(n=this.cryptoJS)?void 0:n.enc.Hex),v=this.data.get("downloadUrl"),y=this.data.get("tplInfo").query,fetch(v,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",credentials:"include",body:Mt.params({fileType:"txt",content:o,signature:m,timestamp:u,ak:h})}).then((function(t){return t.json()})).then((function(t){if(0===t.errno){var e=t.data.fileUrl;On().conversation.clickDownload.emit({downloadUrl:e,fileName:"AI助手-"+y})}})),[2])):[2]):[2,Bn().emit({text:"网络异常，请稍后再试"})]}}))},function(){var t=this,n=Array.from(arguments);return new Promise((function(a,i){var o=e.apply(t,n);function r(t){Qw(o,a,i,r,s,"next",t)}function s(t){Qw(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var e}}),Xw={};Xw=Object.assign(Xw,{download:"download_1hyxh_1",icon:"icon_1hyxh_4",downloadText:"download-text_1hyxh_19","download-text":"download-text_1hyxh_19",text:"text_1hyxh_24"}),Kw.template='\n    <div>\n        <div\n            data-module="download"\n            class="cos-row download-container {{$style.download}} {{$style.downloadDark}} {{!downloadTxtDisable ? $style.downloadText : \'\'}}"\n            on-click="downloadText"\n        >\n            <sc-icon class="{{$style.icon}}" name="download" />\n            <span class="{{$style.text}} cos-font-medium">下载</span>\n        </div>\n    </div>\n';var Yw="function"==typeof Kw?Kw.prototype.initData||Zw:Kw.initData||Zw;function Zw(){return{$style:Xw}}function t_(){return Object.assign({},Yw.call(this),{$style:Xw})}"function"==typeof Kw?Kw.prototype.initData=t_:Kw.initData=t_;var e_=a.defineComponent({components:{"cos-icon":e.Icon},computed:{},initData:function(){return{rank:1}},onClick:function(t){o.canIUse("boxx.share.doShare")&&o.share.doShare({shareCallback:'{ "status": "0", "data": {"status": "0"} }',shareData:{banner:void 0,command:void 0,content:"来百度AI与DeepSeek畅聊，开启搜索新体验 “分享”",iconUrl:"https://gips0.baidu.com/it/u=483087451,3949153003&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f73_73",linkUrl:kn(this.data.get("rank")),mediaType:"all",title:"来百度AI与DeepSeek畅聊，开启搜索新体验 “分享”",type:"url"}})}}),n_={};n_=Object.assign(n_,{share:"share_lx4u6_1",icon:"icon_lx4u6_4",text:"text_lx4u6_10"}),e_.template='\n    <div>\n        <div\n            class="cos-row {{$style.share}}"\n            on-click="onClick"\n        >\n            <cos-icon class="{{$style.icon}}" name="share1" />\n            <span class="{{$style.text}} cos-font-medium">分享</span>\n        </div>\n    </div>\n';var a_="function"==typeof e_?e_.prototype.initData||i_:e_.initData||i_;function i_(){return{$style:n_}}function o_(){return Object.assign({},a_.call(this),{$style:n_})}function r_(){return r_=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},r_.apply(this,Array.from(arguments))}"function"==typeof e_?e_.prototype.initData=o_:e_.initData=o_;var s_=a.defineComponent({components:{"wd-praise":xw,copy:Dw,replace:Mw,"wd-tts-player":kb,edit:Uw,download:Kw,share:e_},computed:{ubcShowLog:function(){var t=this.data.get("logExtParams");return JSON.stringify(r_({type:"show",value:"hudong"},t))}},initData:function(){return{praise:{},comment:{},tplInfo:{},logExtParams:{},ttsUrl:"",ttsPaused:!0,useWiseStyle:!1,useCardSendLog:!1,isWendaIndex:!1,hudongTtsUrl:"",graphCreationLog:{},realShowData:{},isDataFlyWheel:!1,showTts:!1,ttsApiFrom:"h5",isPreventLog:!1,forceShowReplaceText:!0,layoutReverse:!1,dispatchedReplaceClickEvents:["send-log"],isNeedTtsAnimation:!1,agentInfo:{},isBless:!1,isShowEdit:!1,cid:"",isShowEditTxt:!1,itemPosition:"",logExtData:{},isShowDownload:!1,isPc:!1,rank:0,isDeepSeekPage:ct()}},attached:function(){var t=this.data.get("agentInfo"),e=this.data.get("logExtData"),n=null==e?void 0:e.scene_1st,a="text"===(null==e?void 0:e.scene),i="text_work"===n,o="text_short"===n&&"text_net"===(null==e?void 0:e.scene_2nd),r="text_short"===n&&"text_stc"===(null==e?void 0:e.scene_2nd);!t&&a&&(i||o||r)&&this.data.assign({isShowCopy:!0,isShowReplace:!0,praise:r_({},this.data.get("praise"),{disable:!0}),copyTxtDisable:!1,replaceText:"重答"}),this.data.set("isNetorStc",o||r)},onReplace:function(t){if(this.data.get("isDeepSeekPage")){Ar({query:this.data.get("tplInfo").query,extParams:{sa:"re_dl_reans",is_rebuild:1}}).catch((function(t){console.error(t)}))}else this.fire("replace",t)},onEditClick:function(t){this.fire("edit-click",t)},ttsChange:function(t){this.data.set("ttsPaused",null==t?void 0:t.paused)},ttsClick:function(t){t.preventDefault(),t.stopPropagation();var e=this.ref("ttsPlayer");e&&e.clickAudio(t)},handleInteractClickLog:function(t){this.fire("click-log",t)}}),c_={};c_=Object.assign(c_,{interactWrapper:"interact-wrapper_14ve5_9","interact-wrapper":"interact-wrapper_14ve5_9",opacityAnimation:"opacityAnimation_14ve5_1",copyRefreshArea:"copy-refresh-area_14ve5_18","copy-refresh-area":"copy-refresh-area_14ve5_18",copyRefreshAreaBetween:"copy-refresh-area-between_14ve5_22","copy-refresh-area-between":"copy-refresh-area-between_14ve5_22",copyRefreshAreaCenter:"copy-refresh-area-center_14ve5_27","copy-refresh-area-center":"copy-refresh-area-center_14ve5_27",downloadArea:"download-area_14ve5_30","download-area":"download-area_14ve5_30",downloadReplace:"download-replace_14ve5_33","download-replace":"download-replace_14ve5_33",downloadCopy:"download-copy_14ve5_36","download-copy":"download-copy_14ve5_36",textReplaceCopy:"text-replace-copy_14ve5_42","text-replace-copy":"text-replace-copy_14ve5_42",editCopy:"edit-copy_14ve5_45","edit-copy":"edit-copy_14ve5_45",zuowenEditCopy:"zuowen-edit-copy_14ve5_57","zuowen-edit-copy":"zuowen-edit-copy_14ve5_57",interactEnd:"interact-end_14ve5_66","interact-end":"interact-end_14ve5_66",interactReverse:"interact-reverse_14ve5_69","interact-reverse":"interact-reverse_14ve5_69",ttsChatWrapper:"tts-chat-wrapper_14ve5_72","tts-chat-wrapper":"tts-chat-wrapper_14ve5_72",spread:"spread_14ve5_1",fold:"fold_14ve5_1",ttsChatGuide:"tts-chat-guide_14ve5_97","tts-chat-guide":"tts-chat-guide_14ve5_97",fontSpread:"fontSpread_14ve5_1",fontFold:"fontFold_14ve5_1",ttsPlayer:"tts-player_14ve5_120","tts-player":"tts-player_14ve5_120",ttsAgentPlayer:"tts-agent-player_14ve5_125","tts-agent-player":"tts-agent-player_14ve5_125",ttsWrapper:"tts-wrapper_14ve5_136","tts-wrapper":"tts-wrapper_14ve5_136",ttsText:"tts-text_14ve5_151","tts-text":"tts-text_14ve5_151",ttsTextColor:"tts-text-color_14ve5_155","tts-text-color":"tts-text-color_14ve5_155",ttsPlaying:"tts-playing_14ve5_158","tts-playing":"tts-playing_14ve5_158",ttsPlayingGen:"tts-playing-gen_14ve5_161","tts-playing-gen":"tts-playing-gen_14ve5_161"}),s_.template='\n    <div\n        class="\n            {{$style[\'interact-wrapper\']}}\n            {{isDeepSeekPage ? $style[\'interact-wrapper-ds\'] : \'\'}}\n            {{\n                tplInfo && isPc && !useWiseStyle && !isHuabu\n                || (isChatSearch && !isShowCopy && !isShowTts && !isShowReplace)\n                    ? $style[\'interact-end\']\n                    : \'\'\n            }}\n            {{(isChatSearch && isShowCopy) || layoutReverse ? $style[\'interact-reverse\'] : \'\'}}\n        "\n        s-bind="{{realShowData}}"\n    >\n        \x3c!-- 三合互动&简搜播报样式 --\x3e\n        <div s-if="{{isChatSearch && !isShowCopy && isShowTts && !isPc}}">\n            <div class="{{$style[\'tts-chat-wrapper\']}}">\n                <wd-tts-player\n                    s-ref="ttsPlayer"\n                    class="{{$style[\'tts-agent-player\']}}"\n                    text="{{ttsText}}"\n                    voice-api="{{ttsUrl || hudongTtsUrl}}"\n                    is-chat-search="{{isChatSearch}}"\n                    use-card-send-log="{{useCardSendLog}}"\n                    graph-creation-log="{{graphCreationLog}}"\n                    tts-api-from="{{ttsApiFrom}}"\n                    setype="{{setype}}"\n                    agent-info="{{agentInfo}}"\n                />\n                <div s-if="isNeedTtsAnimation" class="{{$style[\'tts-chat-guide\']}}">个性语音播报，快来试试～</div>\n            </div>\n        </div>\n        <wd-praise\n            s-if="{{!praise.disable && !isPc}}"\n            url="{{praise.url}}"\n            color="{{praise.color}}"\n            like-num="{{praise.likeNum || 0}}"\n            like-txt-disable="{{praise.likeTxtDisable}}"\n            fe-like-key="{{praise.feLikeKey}}"\n            fe-dislike-key="{{praise.feDislikeKey}}"\n            fe-like-type="{{praise.feLikeType}}"\n            word="{{praise.word}}"\n            status="{{praise.status}}"\n            feedback-id="{{praise.feedbackId}}"\n            feedback-title="{{praise.feedbackTitle}}"\n            feedback-content-list="{{praise.feedbackContentList}}"\n            feedback-tips-fixed="{{praise.feedbackTipsFixed}}"\n            feedback-show-input="{{praise.feedbackShowInput}}"\n            feedback-custom-theme="{{praise.feedbackCustomTheme}}"\n            req-params="{{praise.reqParams}}"\n            use-wise-style="{{useWiseStyle}}"\n            use-card-send-log="{{useCardSendLog}}"\n            is-data-fly-wheel="{{isDataFlyWheel}}"\n            tpl-info="{{tplInfo}}"\n            is-wenda-index="{{isWendaIndex}}"\n            is-gen-pc="{{praise.isGenPc}}"\n            show-divider="{{praise.showDivider}}"\n            change-field="{{praise.changeField}}"\n            is-chat-search="{{isChatSearch}}"\n            graph-creation-log="{{graphCreationLog}}"\n            is-huabu="{{isHuabu}}"\n            is-pc="{{isPc}}"\n            setype="{{setype}}"\n            is-bless="{{isBless}}"\n            is-prevent-log="{{isPreventLog}}"\n        />\n\n        \x3c!-- 只有deepseek独立页展示分享按钮 --\x3e\n        \x3c!-- <share\n            s-if="{{isShowShare}}"\n            rank="{{rank}}"\n        /> --\x3e\n        \x3c!-- 目前仅文创方向使用重写/复制 --\x3e\n        <div\n            s-if="{{isShowCopy || isShowReplace}}"\n            class="{{!praise.disable ? $style[\'copy-refresh-area\'] : $style[\'copy-refresh-area-between\']}}\n                {{itemPosition === \'center\' ? $style[\'copy-refresh-area-center\'] : \'\'}} cos-row\n                {{isShowDownload ? $style[\'download-area\'] : \'\'}}\n                {{isNetorStc ?  $style[\'text-replace-copy\'] : \'\'}}\n            "\n            data-show-area\n            data-show-ext="{{ubcShowLog}}"\n        >\n            <fragment s-if="{{!isShowDownload}}">\n                <div\n                    class="\n                        {{isShowEdit ? $style[\'edit-copy\'] : \'\'}}\n                        {{isShowEdit && isShowEditTxt ? $style[\'zuowen-edit-copy\'] : \'\'}}\n                    "\n                >\n                    <edit\n                        s-if="{{isShowEdit}}"\n                        cid="{{cid}}"\n                        is-show-edit-txt="{{isShowEditTxt}}"\n                        class="cos-space-mr-lg"\n                        on-edit-click="onEditClick"\n                    />\n                    <copy\n                        s-if="{{isShowCopy}}"\n                        get-copy-target="{{getCopyTarget}}"\n                        copy-txt-disable="{{copyTxtDisable || isShowEdit}}"\n                        tpl-info="{{tplInfo}}"\n                        graph-creation-log="{{graphCreationLog}}"\n                    />\n                </div>\n                <replace\n                    s-if="{{isShowReplace}}"\n                    class="{{\n                        isShowCopy\n                            ? isChatSearch\n                                ? \'\'\n                                : \'cos-space-ml-md\'\n                            : \'\'\n                    }}"\n                    is-chat-search="{{isChatSearch}}"\n                    is-gray="{{replaceGray}}"\n                    graph-creation-log="{{graphCreationLog}}"\n                    replace-text="{{replaceText}}"\n                    replace-icon="{{replaceIcon}}"\n                    setype="{{setype}}"\n                    is-prevent-log="{{isPreventLog}}"\n                    force-show-replace-text="{{forceShowReplaceText}}"\n                    dispatched-click-events="{{dispatchedReplaceClickEvents}}"\n                    is-bless="{{isBless}}"\n                    log-ext-data="{{logExtData}}"\n                    on-click="onReplace"\n                />\n            </fragment>\n            \x3c!-- 文创办公下载场景 --\x3e\n            <fragment s-else>\n                <replace\n                    s-if="{{isShowReplace}}"\n                    class="{{$style[\'download-replace\']}}"\n                    is-fixed-width\n                    is-chat-search="{{isChatSearch}}"\n                    is-gray="{{replaceGray}}"\n                    graph-creation-log="{{graphCreationLog}}"\n                    replace-text="{{replaceText}}"\n                    replace-icon="{{replaceIcon}}"\n                    setype="{{setype}}"\n                    is-prevent-log="{{isPreventLog}}"\n                    force-show-replace-text="{{forceShowReplaceText}}"\n                    dispatched-click-events="{{dispatchedReplaceClickEvents}}"\n                    is-bless="{{isBless}}"\n                    is-pc="{{isPc}}"\n                    rank="{{rank}}"\n                    on-click="onReplace"\n                    on-click-log="handleInteractClickLog"\n                />\n                <div class="{{$style[\'download-copy\']}}">\n                    <download\n                        class="{{isPc ? \'cos-space-ml-xs\' : \'cos-space-mr-xs\'}}"\n                        get-download-target="{{getCopyTarget}}"\n                        download-url="{{downloadUrl}}"\n                        tpl-info="{{tplInfo}}"\n                        is-pc="{{isPc}}"\n                        on-click-log="handleInteractClickLog"\n                    />\n                    <copy\n                        s-if="{{isShowCopy}}"\n                        get-copy-target="{{getCopyTarget}}"\n                        copy-txt-disable="{{copyTxtDisable || isShowEdit}}"\n                        tpl-info="{{tplInfo}}"\n                        is-pc="{{isPc}}"\n                        graph-creation-log="{{graphCreationLog}}"\n                        on-click-log="handleInteractClickLog"\n                    />\n                </div>\n            </fragment>\n        </div>\n\n        <div\n            s-if="{{((!isChatSearch && hudongTtsUrl) || (isPc && isHuabu) || showTts) && !isDeepSeekPage}}"\n            data-module="broadcast"\n            rl-type="stop"\n            class="{{$style[\'tts-wrapper\']}}"\n            on-click="ttsClick"\n        >\n            <wd-tts-player\n                text="{{ttsText}}"\n                s-ref="ttsPlayer"\n                voice-api="{{hudongTtsUrl || ttsUrl}}"\n                on-change="ttsChange"\n                graph-creation-log="{{graphCreationLog}}"\n                use-card-send-log="{{useCardSendLog}}"\n                is-huabu="{{isHuabu}}"\n                tts-api-from="{{ttsApiFrom}}"\n                is-pc="{{isPc}}"\n                tpl-info="{{tplInfo}}"\n            />\n            <span\n                class="\n                    {{$style[\'tts-text\']}}\n                    cos-font-medium\n                    {{ttsPaused\n                        ? \'\'\n                        : isPc && isHuabu ? $style[\'tts-playing-gen\'] : $style[\'tts-playing\']}}\n                "\n            >播报</span>\n        </div>\n    </div>\n';var l_="function"==typeof s_?s_.prototype.initData||d_:s_.initData||d_;function d_(){return{$style:c_}}function u_(){return Object.assign({},l_.call(this),{$style:c_})}"function"==typeof s_?s_.prototype.initData=u_:s_.initData=u_;var p_=a.defineComponent({components:{},computed:{stateText:function(){return"retry"===this.data.get("state")?"重新回答":"停止回答"}},attached:function(){this.dispatch("send-ubclog",{type:"show",value:"stop"}),this.dispatch("send-midlog",{cst:2,clk_extra:{t:2}}),this.onClickBtn=_n(this.onClick.bind(this),300,{leading:!0,trailing:!1})},initData:function(){return{state:"stop",sceneTheme:!1}},onClick:function(t){var e=this.data.get("state");this.fire("click",e),"stop"===e&&this.dispatch("send-ubclog",{type:"show",value:"rewrite"}),this.dispatch("send-log",{type:"b",fm:"beha",extra:{clk_region:"function"},target:t.target})}}),h_={};h_=Object.assign(h_,{statusbox:"statusbox_pplkr_1",stop:"stop_pplkr_6",img:"img_pplkr_20",stateText:"state-text_pplkr_29","state-text":"state-text_pplkr_29"}),p_.template="\n    \x3c!-- 停止生成按钮 --\x3e\n    \x3c!-- answer-generate-state-button class 用来在外层通过css控制样式，而不是js --\x3e\n    \x3c!-- 用 js 会使逻辑更加复杂 --\x3e\n    <div data-module=\"{{state === 'retry' ? 'rewrite' : 'stop'}}\" class=\"answer-generate-state-button\">\n        <div class=\"{{$style.statusbox}}\">\n            <div class=\"{{$style.stop}} {{sceneTheme ? 'spring-theme-stop' : ''}}\" on-click=\"onClickBtn\">\n                <span class=\"{{$style['state-text']}}\">{{stateText}}</span>\n            </div>\n        </div>\n    </div>\n";var f_="function"==typeof p_?p_.prototype.initData||g_:p_.initData||g_;function g_(){return{$style:h_}}function m_(){return Object.assign({},f_.call(this),{$style:h_})}"function"==typeof p_?p_.prototype.initData=m_:p_.initData=m_;var v_=a.defineComponent({components:{"dqa-interact":s_,"reference-wrapper":Hb,"state-button":p_},computed:{realShowData:function(){var t,e=null==(t=this.data.get("interactData"))?void 0:t.replaceText,n="sge_spring"===this.data.get("setype");return n&&("重写"===e?e="rewrite":"重画"===e&&(e="redraw")),n&&e?{"data-show":"hudong","data-show-ext":JSON.stringify({hudong_name:["zan","cai",e]})}:{}},isPc:function(){return"pc"===rt()}},initData:function(){return{isShowReference:!1,interactData:{},referList:null,isChatSearch:!1,isShowInteract:!1,replaceGray:!1,isShowSug:!1,suglist:null,isShowButton:!1,theme:{},fallbackAskShow:!1,logExtParams:{},isNeedTtsAnimation:!1,agentInfo:{},isBless:!1,layoutReverse:!1,isPc:!1,tplInfo:{},cid:"",logExtData:{},rank:0}},attached:function(){this.showPauseInconButton()},showPauseInconButton:function(){var t=this.data.get("isShowButton");sa().emit({isShowButton:t})},onReplace:function(t){this.fire("replace",t)},onSugClick:function(t){this.fire("sug-click",t)},onStateButtonClick:function(t){this.fire("button-click",{state:t,isInteractClick:!1,value:""})},onInteractButtonLog:function(t){this.fire("button-click",{state:"",isInteractClick:!0,value:t})},onEditClick:function(){this.fire("edit-click")}}),y_={};y_=Object.assign(y_,{interact:"interact_elmdc_1",interactCsaitab:"interact-csaitab_elmdc_8","interact-csaitab":"interact-csaitab_elmdc_8",footerDownload:"footer-download_elmdc_12","footer-download":"footer-download_elmdc_12",interactRefer:"interact-refer_elmdc_16","interact-refer":"interact-refer_elmdc_16"}),v_.template='\n    <div class="{{interactData.isShowDownload ? $style[\'footer-download\'] : \'\'}}">\n        \x3c!-- 溯源区 --\x3e\n        <reference-wrapper\n            s-if="{{isShowReference && referList}}"\n            is-chat-search="{{isChatSearch}}"\n            is-show-download="{{interactData.isShowDownload}}"\n            refer-list="{{referList}}"\n            log-ext-params="{{logExtParams}}"\n            tplInfo="{{tplInfo}}"\n        />\n        \x3c!-- 互动区 --\x3e\n        <dqa-interact\n            s-ref="interact"\n            s-if="{{isShowInteract}}"\n            s-bind="{{interactData}}"\n            get-copy-target="{{getCopyTarget}}"\n            class="\n                {{$style[\'interact\']}}\n                {{isChatSearch ? $style[\'interact-csaitab\'] : \'\'}}\n                {{isShowReference && referList ? $style[\'interact-refer\'] : \'\'}}\n            "\n            on-replace="onReplace"\n            is-chat-search="{{isChatSearch}}"\n            layout-reverse="{{layoutReverse}}"\n            agent-info="{{agentInfo}}"\n            tts-text="{{ttsText}}"\n            is-need-tts-animation="{{isNeedTtsAnimation}}"\n            replace-gray="{{replaceGray}}"\n            graph-creation-log="{{graphCreationLog}}"\n            setype="{{setype}}"\n            is-bless="{{isBless}}"\n            rank="{{rank}}"\n            is-pc="{{isPc}}"\n            real-show-data="{{realShowData}}"\n            cid="{{cid}}"\n            is-prevent-log="{{setype === \'sge_spring\'}}"\n            log-ext-data="{{logExtData}}"\n            log-ext-params="{{logExtParams}}"\n            on-edit-click="onEditClick"\n            on-click-log="onInteractButtonLog"\n            tplInfo="{{tplInfo}}"\n        />\n        \x3c!-- 停止生成/重新回答按钮 --\x3e\n        <state-button\n            s-if="{{isShowButton && !isPc}}"\n            state="{{btnState}}"\n            scene-theme="{{theme.scene}}"\n            on-click="onStateButtonClick"\n            class="{{fallbackAskShow ? \'\' : $style[\'state-button\']}}"\n        />\n    </div>\n';var b_="function"==typeof v_?v_.prototype.initData||w_:v_.initData||w_;function w_(){return{$style:y_}}function __(){return Object.assign({},b_.call(this),{$style:y_})}function k_(){return k_=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},k_.apply(this,Array.from(arguments))}"function"==typeof v_?v_.prototype.initData=__:v_.initData=__;var S_=["markdown-yiyan","markdown-hamburg","markdown"],x_=["imageGroup"],I_="data-has-agent",T_=a.defineComponent({linkReg:/\[(.*?)\]\((.*?)\)/g,isAiAskReady:!1,components:{"ai-entry":rb,loading:Nv,"cos-icon":e.Icon,"cs-container":sb,"dqa-searching-steps":e.SearchingSteps,"cos-avatar":e.Avatar,"ds-thinking":cf},messages:{"ai-entry:render-finished":function(t){var e;this.renderFinished(null==(e=t.value)?void 0:e.type)},"ai-ask-back:input-send":function(t){var e,n=this.data.get("askBackSelectCount");this.dispatch("chat:launch-search",{word:(null==t||null==(e=t.value)?void 0:e.targetStr)||"",event:"ai-ask-back:input-send",askBackSelectCount:n,sa:"re_dl_reply"})},"ai-question-closely:click":function(t){var e,n,a=this.data.get("isHaveQuestion");this.dispatch("chat:launch-search",{word:(null==t||null==(n=t.value)||null==(e=n.data)?void 0:e.text)||"",event:"ai-question-closely:click",isHaveQuestion:a,sa:"re_dl_prob"})},"ai-input:input-send":function(t){var e,n,a=this.data.get("isHaveQuestion");this.dispatch("chat:launch-search",{word:(null==t||null==(n=t.value)||null==(e=n.data)?void 0:e.text)||"",event:"ai-input:input-send",isHaveQuestion:a,sa:"re_dl_input"})},"ai-markdown-editor:btn-click":function(t){var e=this,n=t.value,a=n.actionType,i=n.text,r=n.target,s=n.event,c=n.author,l=n.receiver,d=n.id,u=n.originText,p=n.isRisk,h=n.hasTextContentChanged,f=n.diyUrl,g={actionType:a,text:i,target:r||(null==s?void 0:s.target),id:d,receiver:l,author:c,originText:u,isRisk:p,hasTextContentChanged:h};if("cancle"===a||"recipient"===a||"from"===a||"edit"===a||"image"===a&&1===p)this.sendSpringLog(g);else{if("copy"===a)return this.sendSpringLog(g),void this.copyText(i);var m=this.data.get("entryRef");this.handleRiskCheck(t.value).then((function(t){try{var n;null==(n=e.ref(m))||n.handleComponent("ai-markdown-editor","changeEditStatus",{isDanger:null==t?void 0:t.is_danger,id:d})}catch(t){}var a;if((g.isRisk=t.is_danger,e.sendSpringLog(g),!t.is_danger)&&((null==(a=Je.getState("agentInfo"))?void 0:a.agentName)&&(Je.dispatch("update",{agentInfo:{}}),jn().emit({word:"",invokeKeyboard:0})),f)){var i=t.diyParams||"",r=i?f+"&"+i:f;return void(o.canIUse("search.open")?o.search.open({url:r,notShowLandingTopBar:0,isContainer:"1",statusBarStyle:2,config:'{"immersed":1,"hideBack":1,"background":"#09090A"}'}):window.open(r,"_blank"))}})).catch((function(){try{var t;null==(t=e.ref(m))||t.handleComponent("ai-markdown-editor","changeEditStatus",{isDanger:0,id:d})}catch(t){}}))}},"ai-image-with-thumbnail:jump-diy-page":function(t){var e=t.value.url,n=this.data.get("commonData.chatParams"),a=this.data.get("tplInfo.lid")||"",i=this.data.get("cid")||"",r=this.data.get("oriLid")||"",s={chat_token:$r(""),lid:a,cid:i,ori_lid:r,sge_lid:n.sge_lid};e=Nt(e,Mt.params(s)),o.canIUse("search.open")?o.search.open({url:e,notShowLandingTopBar:0,isContainer:"1",statusBarStyle:2,config:'{"immersed":1,"hideBack":1,"background":"#09090A"}'}):window.open(e,"_blank")},"ai-image-with-thumbnail:update":function(t){var e=this,n=t.value,a=n.id,i=n.updateTemplateListApi,o=this.data.get("entryRef"),r=this.data.get("cid")||"",s=this.data.get("oriLid")||"",c=Nt(i,Mt.params({msgId:r,sessionId:s}));i&&fetch(c,{method:"get",mode:"cors",credentials:"include"}).then((function(t){return t.json()})).then((function(t){setTimeout((function(){var n,i;null==(i=e.ref(o))||i.handleComponent("image-with-thumbnail","updateTemplateList",{id:a,templateList:null==t||null==(n=t.data)?void 0:n.templateList})}),200)})).catch((function(t){var n;null==(n=e.ref(o))||n.handleComponent("image-with-thumbnail","updateTemplateList",{id:a,templateList:null})}))},"writing:cancel-edit":function(t){var e;if(null==(e=t.value)?void 0:e.showDialog){var n=On().conversation.dialogPop;null==n||n.emit({cid:this.data.get("cid"),id:"ai_index_"+this.data.get("rank")})}else this.dispatch("writing:cancel-edit",{})},"writing:copy":function(t){var e=t.value.text;this.copyText(e)},"pic-loading:set-height":function(t){if(t.value){this.data.set("picMinHeight",t.value);var e=this.ref(this.data.get("entryRef"));e&&e.el&&(e.el.style.minHeight=t.value+"px")}},"pic-loading:listen-pic-load":function(t){var e=this;this.nextTick((function(){var t=e.el.querySelector(".marklang-img");t&&(t.onload=t.onerror=t.onabort=function(){t.onload=t.onerror=t.onabort=null,e.data.set("picMinHeight",0)})}))}},computed:{aiLogoBg:function(){var t=(this.data.get("theme")||{}).aiLogoBg;return t||"https://psstatic.cdn.bcebos.com/basics/aichat/ai-icon-bg-4_1703229976000.png"},isPicIntent:function(){var t=this.data.get("intentionType")||"",e=this.data.get("intentionTypeMap"),n=this.data.get("hasNoTextComponent");return t===(null==e?void 0:e.PIC)||n},overviewType:function(){if(!this.data.get("agentInfo.agentName"))return Je.getState("singleOverviewType")},ubcShowLog:function(){var t,e;return JSON.stringify({type:"show",value:"dialog_agent",agent_id:null==(t=this.data.get("agentInfo"))?void 0:t.agentId,agent_name:null==(e=this.data.get("agentInfo"))?void 0:e.agentName})},ubcClickLog:function(){var t,e;return JSON.stringify({type:"click",value:"dialog_agent",ubcExt:{agent_id:null==(t=this.data.get("agentInfo"))?void 0:t.agentId,agent_name:null==(e=this.data.get("agentInfo"))?void 0:e.agentName}})},isShowSpecialIcon:function(){var t=this.data.get("agentInfo"),e=this.data.get("authorityInfo");return!(!(null==t?void 0:t.agentName)&&!(null==e?void 0:e.title))}},initData:function(){return{generatingSuffix:'<span data-safe-html class="chat-answer-typing-loading"></span>',index:0,currentIndex:0,setectedAskTagNum:0,isFinished:!1,isHaveQuestion:!1,askBackSelectCount:0,typingSpeed:10,theme:{},guideWord:"",autoHeight:!1,cid:"",agentInfo:null,entryRef:"ai-entry"+Date.now(),intentionType:"",intentionTypeMap:{},rank:1,bgProps:null,answerIndex:0,searchingStepsData:{},searchingStepsStartTime:0,showSteps:!1,isWaiting:!0,isPc:"pc"===rt(),agentBoxAbsolute:!1,blockIndex:0,logExtParams:{},generationPrompt:"",transitionPrompt:"",blessStyle:"",isExtension:ft(),dsUsedModel:{},hasSetDsLabel:!1,askUsedModel:{}}},created:function(){var t,e,n=Je.getState("agentInfo"),a=this.data.get("overviewType");(this.data.set("agentInfo",n),(null==n?void 0:n.agentName)||"2"!==a&&"3"!==a)||this.el&&(null==(e=fn(this.el,'[class^="index_answer-container"]'))||null==(t=e.classList)||t.add(Wt))},listenAiWriting:null,attached:function(){var t=this;this.setPrompt();var e=this.getAgentLogInfo(),n=e.value,a=e.agentSearchId,i=e.agentName;this.watch("searchingStepsData",(function(e){var o,r=t.data.get("searchingStepsStartTime"),s=t.data.get("transitionPrompt");if(null==e||null==(o=e.steps)?void 0:o.length){var c;if(s&&(e.steps[0].title=s),t.data.get("overviewType"))null==(c=t.ref("loading"))||c.updateLoading(e);else t.data.set("showSteps",!0);r||(t.data.set("searchingStepsStartTime",(new Date).getTime()),t.dispatch("send-ubclog",{type:"show",value:n,extra:{agent_id:a,agent_name:i}}))}else if(r){var l=(new Date).getTime();t.data.set("searchingStepsStartTime",0),t.dispatch("send-ubclog",{ubcId:17630,value:n,extra:{starttime:r+"",endtime:l+"",duration:l-r+"",agent_id:a,agent_name:i}}),t.dispatch("overview:send-perf")}})),this.watch("isWaiting",(function(t){var e;!t&&(null==(e=Je.getState("agentInfo"))?void 0:e.agentSearchId)&&Yn().emit(100)})),this.watch("sseStatus",(function(e){!e&&t.setPrompt()}));var o=On().conversation.dialogClick,r=this.data.get("entryRef");this.listenAiWriting=function(e){var n;void 0===e&&(e={}),null==(n=t.ref(r))||n.handleComponent("ai-writing","changeEditStatus",e)},o.on(this.listenAiWriting),ka().emit(),this.listenAgentShow()},answerBoxDom:null,setAgentDataInAnswerBox:function(){this.answerBoxDom&&pn(this.answerBoxDom,I_,"true")},removeAgentDataInAnswerBox:function(){this.answerBoxDom&&pn(this.answerBoxDom,I_,null)},listenAgentShow:function(){var t=this;this.answerBoxDom=fn(this.el,Qt,null),this.data.get("isShowSpecialIcon")&&this.setAgentDataInAnswerBox(),this.watch("isShowSpecialIcon",(function(e){e?t.setAgentDataInAnswerBox():t.removeAgentDataInAnswerBox()}))},disposed:function(){(this.removeAgentDataInAnswerBox(),this.answerBoxDom=null,this.listenAiWriting)&&(On().conversation.dialogClick.off(this.listenAiWriting),this.listenAiWriting=null)},setPrompt:function(){"sge_spring"===this.data.get("commonData.chatParams.setype")&&this.data.set("generationPrompt","正在奋笔疾书")},goToAgent:function(t,n){var a,i;if(this.data.get("isExtension"))e.Toast.info({message:"请到网页版使用",duration:2e3});else{if("pc"===rt()){var o,r,s=rs((null==(o=n.jumpUrl)?void 0:o.h5)||(null==(r=n.jump_url)?void 0:r.h5));if(s){var c=k_({},n,{realUrl:s});ca().emit(c)}}var l=(null==(a=n.jumpUrl)?void 0:a.zbios)||(null==(i=n.jump_url)?void 0:i.zbios);if(l){var d=os(l,{_baiduboxapp:{sysExt:{sessionId:JSON.stringify({hudongExtLog:{lid:this.data.get("commonData.tplInfo.lid")}})}}});this.dispatch("send-log",{cyc:1,action:"agent_head",target:t.target}),Ad(d)}}},getAgentLogInfo:function(){var t=Je.getState("agentInfo")||{};return{value:t.agentSearchId?"agent-loading":"loading",agentSearchId:t.agentSearchId,agentName:t.agentName}},startWaiting:function(){var t;this.data.set("isFinished",!1),this.data.set("isHaveQuestion",!1),this.data.set("isWaiting",!0),this.data.set("showSteps",!1),this.data.set("agentBoxAbsolute",!1);var e=this.data.get("entryRef");null==(t=this.ref(e))||t.startWaiting()},startGenerating:function(){var t;if(this.el){var e,n=fn(this.el,"."+Wt);null==n||null==(e=n.classList)||e.remove(Wt)}var a=this.data.get("entryRef");this.data.set("isWaiting",!1),null==(t=this.ref(a))||t.startGenerating()},pushBlock:function(t){var e,n,a,i,o,r,s,c;if(t&&t.generator){var l=this.data.get("overviewType"),d=dn(".cosd-markdown",this.el),u=d[d.length-1],p=un(".marklang",this.el);"2"!==l&&"3"!==l||!u||!p||u.className.includes(Gt)||"UL"!==(null==(e=p.lastElementChild)?void 0:e.tagName)||u.classList.add(Gt);var h=this.data.get("hasSetDsLabel"),f=t.generator,g=null==t||null==(a=t.agentInfo)||null==(n=a.agentMeta)?void 0:n[0],m=f.usedModel||{};if(f.switchModel){var v=new $i(Je),y=new Qi(Je),b=f.switchModel,w=v.getCurrentModel();if(w.modelName!==b){v.handleChangeUsedModelStatus(b,{});var _=Je.getState("modelList").find((function(t){return t.id===w.modelName}));y.handleSelectModel(_)}y.handleSelectModel({id:b})}if(h||(Je.dispatch("update",{dsUsedModel:m}),this.data.set("dsUsedModel",m),this.data.set("hasSetDsLabel",!0)),"markdownEditor"!==f.component&&"markdown"!==f.component||!(null==(i=f.data)?void 0:i.value)||!(null==(o=f.data)?void 0:o.isGuideWord)){var k=this.data.get("blockIndex"),S=this.data.get("entryRef"),x=null==(r=this.ref(S))?void 0:r.isMarkdownCmpt(f),I=null==(s=this.ref(S))?void 0:s.isBlockNotForRender(f);!x&&I||this.data.set("blockIndex",++k),this.generatorHandle(f,g,k),f.component&&x_.includes(f.component)&&this.data.set("hasNoTextComponent",!0),f.data&&f.data.style&&this.data.set("blessStyle",f.data.style),null==(c=this.ref(S))||c.pushBlock(f)}else this.data.set("guideWord",f.data.value)}},clear:function(){var t;this.data.set("guideWord","");var e=this.data.get("entryRef");null==(t=this.ref(e))||t.clear(),this.data.set("emptyWord","")},stop:function(t,e){var n;if("separate-bub"===t||t&&e){this.data.set("isWaiting",!1),"userAbort"===t&&this.data.set("agentBoxAbsolute",!1),this.data.set("blockIndex",0);var a=this.data.get("entryRef");null==(n=this.ref(a))||n.stop(t,e)}},generatorHandle:function(t,e,n){var a=this;if(t.needClearHistory&&this.data.set("needClearHistory",!0),null==t?void 0:t.data){(null==e?void 0:e.pluginInfo)&&Oo(e);var i,o,r=this.data.get("commonData.lid");if("markdown"===t.component||"markdown-yiyan"===t.component||"askBack"===t.component||"markdownEditor"===t.component)t.data.askBackId=r,t.data.editorStyle=this.data.get("commonData.editorStyle"),null==(o=t.data)||null==(i=o.value)||i.replace(this.linkReg,(function(t,e){a.dispatch("send-ubclog",{type:"show",value:"wz_link",extra:{info:e}})}));if("imageWithThumbnail"===t.component&&(t.data.showRetry=!0),"sge_spring"===(this.data.get("commonData.chatParams")||{}).setype&&("input"===t.component||"askBack"===t.component?(t.data.type="primary",t.data.emptyDisabled=!0,t.data.initBtnIsFocus=!0,t.data.showLoading=!1,t.data.jumpTypes=["multiSearch"],t.data.sendText="写祝福",t.data.btnText="写祝福",t.data.inputIcon="&#xe721",t.data.primarySendText="写祝福"):"questionClosely"===t.component&&(t.data.hideAskItem=!0,t.data.jumpTypes=["multiSearch"],this.data.set("isHaveQuestion",!0))),e&&e.logo&&e.agentName&&this.data.set("agentInfo",e),(e=this.data.get("agentInfo"))&&e.agentName&&e.logo&&!this.data.get("agentBoxAbsolute")&&1===n&&S_.includes(t.component)){var s;this.data.assign({agentBoxAbsolute:!0});var c=null==(s=t.data)?void 0:s.value,l=/^#+\s/.test(c)?"<br/>\n"+c:c;t.data.value=this.getAtAgentMarkdown(e)+l}}},getAtAgentMarkdown:function(t){var e,n;if(!t)return"";var a=this.data.get("isPc")?null==(e=t.jumpUrl)?void 0:e.h5:null==(n=t.jumpUrl)?void 0:n.zbios;return"["+t.agentName+"]("+a+'){type="agent" src="'+t.logo+'"} '},renderFinished:function(t){var e,n,a,i=dn(".cosd-markdown",this.el),o=i[i.length-1];o&&o.classList.remove(Gt),this.data.set("isFinished",!0),this.entryEmptyHandler(),this.referShowLog();var r=this.ref(this.data.get("entryRef"));(null==r||null==(n=r.el)||null==(e=n.style)?void 0:e.minHeight)&&(r.el.style.minHeight="auto");var s=Rd(null==r?void 0:r.el,null==(a=this.data.get("agentInfo"))?void 0:a.agentName);this.fire("render-finished",{ttsText:s,answerIndex:this.data.get("answerIndex"),type:t})},referShowLog:function(){var t,e=this,n=this.data.get("entryRef"),a=null==(t=this.ref(n))?void 0:t.el;if(a){var i=dn(".cosd-citation",a);i.forEach((function(t,n){var a,o,r;(null==(a=t.parentElement)?void 0:a.nextElementSibling)!==(null==(o=i[n+1])?void 0:o.parentElement)&&e.dispatch("send-ubclog",{type:"show",value:"subscript",extra:{is_his:"0",info_rank:null==(r=t.getElementsByClassName("cosd-citation-citationId")[0])?void 0:r.innerText}})}))}},entryEmptyHandler:function(){var t=this;this.data.get("hideAlaStyle")||setTimeout((function(){var e=t.data.get("entryRef"),n=t.ref(e),a=null==n?void 0:n.el,i=t.data.get("isPicIntent");(!i&&!(null==a?void 0:a.innerText)||i&&!(null==a?void 0:a.innerHTML))&&(t.data.get("needClearHistory")?t.data.set("emptyWord","😩对不起，我还没有学会这个问题，可以换个话题再问问我，我将尽力为你回答~"):t.data.set("emptyWord","抱歉，出了点小问题，请稍后重试。"),t.fire("empty",{ttsText:t.data.get("emptyWord")}))}),100)},markdownInnerShowEvent:function(){po()},handleRenderFinished:function(t){this.dispatch("pack-render-finished",t)},handleUbcLogEvent:function(t){this.dispatch("send-ubclog",t)},handleActionLogEvent:function(t){var e,n,a=this.data.get("commonData.chatParams"),i=a.setype,o=void 0===i?"":i,r=a.scene,s=void 0===r?"":r,c=this.data.get("commonData.tplInfo"),l=this.data.get("logExtParams")||{},d=this.data.get("commonData.isChatSearch");if("sge_spring"===o||d){var u=this.data.get("rank"),p=this.data.get("oriLid");t.ext=Object.assign({},t.ext,k_({re_rank:String(u),ori_lid:p,setype:o,scene:s,lid:c.lid,cid:this.data.get("cid")},l))}var h="",f=(null==o?void 0:o.startsWith("sge"))||!1,g="csaitab"===o;f&&"askBack"===(null==t?void 0:t.component)?h="invokesge":g&&"askBack"===(null==t?void 0:t.component)&&(h="invokecsaitab");var m=this.data.get("entryRef");qd(t,c,{action:h,launchMultiSearch:f||g},(null==(e=t.ext)?void 0:e.target)||(null==(n=this.ref(m))?void 0:n.el))},sendSpringLog:function(t){var e=t.actionType,n=t.text,a=t.target,i=t.id,o=t.isRisk,r=t.area;if(this.data.get("isPc")){ld({type:"click",value:e,ubcExt:k_({},this.data.get("logExtData"))},this.data.get("tplInfo"),a)}else{this.data.get("commonData.chatParams");var s={type:"b",action:e,extra:{module_type:"content"},target:a};switch(e){case"copy":s.extra.copy_content=n;break;case"cancle":s.extra.content_order=i;break;case"edit":s.extra.content_order=i,"content"!==r&&(s.extra.is_interact=1);break;case"image":s.cyc=1,s.type="na",s.action=void 0,s.extra.content_order=i,s.extra.is_risk=o||0}this.dispatch("send-log",s)}},handleCopy:function(t){var e,n={type:"b",action:"copy",fm:"beha",target:null==(e=t.event)?void 0:e.target};this.data.get("isPc")&&(n.ubcExt=this.data.get("logExtData"),n.type="click",n.value="copy"),this.dispatch("send-log",n),this.copyText(t.text)},copyText:function(t){Ed(t).then((function(){e.Toast.show({message:"复制成功"})})).catch((function(){e.Toast.show({message:"复制失败"})}))},handleRiskCheck:function(t){if("more"===t.strategy)return new Promise((function(t){t({isDanger:0})}));var e=this.data.get("commonData.chatParams"),n=this.data.get("commonData.riskcheckApi"),a=this.data.get("blessStyle");return function(t,e){return new Promise((function(n,a){fetch(t,{method:"post",mode:"cors",credentials:"include",body:JSON.stringify(e)}).then((function(t){return t.json()})).then((function(t){n(null==t?void 0:t.data)})).catch((function(t){a(null==t?void 0:t.data)}))}))}(n,{sge_lid:e.sge_lid,query:t.query,type:"spring_edit",token:$r(t.query),ori_content:t.originText,fix_content:t.text,author:t.author,receiver:t.receiver,ori_lid:this.data.get("oriLid")||"",lid:this.data.get("tplInfo.lid")||"",cid:this.data.get("cid"),acrostic:"1"===a?1:0})},handleComponentAll:function(){var t=this,e=this.data.get("entryRef");return new Promise((function(n){t.ref(e)?t.ref(e).handleComponentAll("getAsyncApiParams").then((function(t){var e=t&&t.reduce((function(t,e){return t.concat(e)}),[]);n(e||[{}])})):n([{}])}))}}),C_={};C_=Object.assign(C_,{flashAnimation:"flashAnimation_14raa_1",aiEntry:"ai-entry_14raa_24","ai-entry":"ai-entry_14raa_24",entryMinHeight:"entry-min-height_14raa_101","entry-min-height":"entry-min-height_14raa_101",emptyWord:"empty-word_14raa_109","empty-word":"empty-word_14raa_109",aiEntryTheme:"ai-entry-theme_14raa_117","ai-entry-theme":"ai-entry-theme_14raa_117",fusionAladdin:"fusion-aladdin_14raa_130","fusion-aladdin":"fusion-aladdin_14raa_130",aiIconBox:"ai-icon-box_14raa_133","ai-icon-box":"ai-icon-box_14raa_133",agentBoxAbsolute:"agent-box-absolute_14raa_151","agent-box-absolute":"agent-box-absolute_14raa_151",authorityIconBox:"authority-icon-box_14raa_178","authority-icon-box":"authority-icon-box_14raa_178",authorityIcon:"authority-icon_14raa_178","authority-icon":"authority-icon_14raa_178",aiIconBoxWrapper:"ai-icon-box-wrapper_14raa_192","ai-icon-box-wrapper":"ai-icon-box-wrapper_14raa_192",aiEntryBox:"ai-entry-box_14raa_195","ai-entry-box":"ai-entry-box_14raa_195",aiIconBoxBlock:"ai-icon-box-block_14raa_198","ai-icon-box-block":"ai-icon-box-block_14raa_198",aiIndexAiIconAni:"ai-index-ai-icon-ani_14raa_233","ai-index-ai-icon-ani":"ai-index-ai-icon-ani_14raa_233",iconBgAnimation:"iconBgAnimation_14raa_1",aiIndexAgentIconWrapper:"ai-index-agent-icon-wrapper_14raa_259","ai-index-agent-icon-wrapper":"ai-index-agent-icon-wrapper_14raa_259",aiIndexAgentText:"ai-index-agent-text_14raa_265","ai-index-agent-text":"ai-index-agent-text_14raa_265",aiIndexAgentIcon:"ai-index-agent-icon_14raa_259","ai-index-agent-icon":"ai-index-agent-icon_14raa_259",agentAvatarWrapper:"agent-avatar-wrapper_14raa_293","agent-avatar-wrapper":"agent-avatar-wrapper_14raa_293",searchingSteps:"searching-steps_14raa_332","searching-steps":"searching-steps_14raa_332",emptyPicMinHeight:"empty-pic-min-height_14raa_336","empty-pic-min-height":"empty-pic-min-height_14raa_336"}),T_.template='\n    <cs-container\n        bg-props="{{bgProps}}"\n        log-ext-data="{{logExtData}}"\n    >\n        <slot name="header"></slot>\n        <div\n            class="{{isFinished ? \'ai-index-no-animation-icon\' : \'ai-index-animation-icon\'}}\n            {{autoHeight ? $style[\'no-entry-min-height\'] : $style[\'entry-min-height\']}}\n            {{picMinHeight ? $style[\'empty-pic-min-height\'] : \'\'}}\n            markdown-typing-all\n            "\n            style="{{picMinHeight ? \'--pic-min-height:\' + picMinHeight + \'px;\' : \'\'}}"\n        >\n            \x3c!-- agent的logo --\x3e\n            <div\n                s-if="agentInfo && agentInfo.logo && agentInfo.agentName"\n                id="agent-icon"\n                class="{{$style[\'ai-icon-box\']}} {{$style[\'ai-icon-box-wrapper\']}} {{agentBoxAbsolute ? $style[\'agent-box-absolute\'] : \'\'}}"\n                on-click="goToAgent($event, agentInfo)"\n            >\n                <div\n                    class="{{$style[\'ai-index-agent-icon-wrapper\']}}"\n                    style="margin-bottom: {{isWaiting ? \'.14rem\' : \'0\' }}"\n                    need-click-log\n                    data-click-log="{{ubcClickLog}}"\n                    data-show-area\n                    data-show-ext="{{ubcShowLog}}"\n                >\n                    <div class="{{$style[\'ai-index-agent-icon\']}}">\n                        <cos-avatar\n                            class="{{$style[\'agent-avatar-wrapper\']}}"\n                            src="{{agentInfo.logo}}"\n                            size="sm"\n                        />\n                    </div>\n                    <div class="{{$style[\'ai-index-agent-text\']}}">\n                        {{ agentInfo.agentName }}\n                    </div>\n                </div>\n            </div>\n            \x3c!-- 空白兜底 --\x3e\n            <div\n                s-else-if="guideWord || emptyWord"\n            >\n                <p>\n                    <span s-if="guideWord">{{ guideWord }}</span>\n                    <div s-elif="emptyWord" class="{{$style[\'empty-word\']}}">{{ emptyWord }}</div>\n                </p>\n            </div>\n            \x3c!-- 存在智能体回答失败走ai助手兜底回答的情况，导致智能体与权威标重叠，决定隐藏权威标 --\x3e\n            <div\n                s-if="authorityInfo && authorityInfo.title && !agentInfo.agentName"\n                class="{{$style[\'authority-icon-box\']}}"\n            >\n                <cos-icon\n                    class="{{$style[\'authority-icon\']}}"\n                    name="authority"\n                />\n                <div class="{{$style[\'authority-text\']}} c-fwb">\n                    {{ authorityInfo.title }}\n                </div>\n            </div>\n            \x3c!-- 画布 --\x3e\n            <div class="{{$style[\'ai-entry-box\']}}">\n                <ai-entry\n                    class="{{$style[\'ai-entry\']}}\n                        {{theme && theme.scene ? $style[\'ai-entry-theme\'] : \'\'}}\n                        {{commonData.isAlaHat && commonData.chatAlaType === 2 ? $style[\'fusion-aladdin\'] : \'\'}}"\n                    s-ref="{{entryRef}}"\n                    blocks="{{blocks}}"\n                    question="{{question}}"\n                    rank="{{rank}}"\n                    render-mode="{{isGenerate ? \'only-csr\' : \'ssr\'}}"\n                    context="{{ {\n                        tplInfo: commonData.tplInfo,\n                        scene: \'chat-search\',\n                        app: \'bdbox\',\n                        theme: theme,\n                        editorParams: commonData.editorParams,\n                        isSse: true\n                    } }}"\n                    cid="{{cid}}"\n                    typing-speed="{{typingSpeed}}"\n                    on-action-log-event="handleActionLogEvent"\n                    on-ubc-log-event="handleUbcLogEvent"\n                    on-markdown-inner-show-event="markdownInnerShowEvent"\n                    on-copy="handleCopy"\n                    on-fragment-render-finished="handleRenderFinished"\n                    generating-suffix="{{generatingSuffix}}"\n                    answer-index="{{answerIndex}}"\n                    tplInfo="{{commonData.tplInfo}}"\n                    agentInfo="{{agentInfo}}"\n                    ask-used-model="{{askUsedModel}}"\n                >\n                    <loading\n                        s-if="!hideAlaStyle"\n                        slot="idle"\n                        sse-status="1"\n                        overview-type="{{overviewType}}"\n                        appearance="steps"\n                        generation-prompt="{{generationPrompt}}"\n                    />\n                    <dqa-searching-steps\n                        s-if="!hideAlaStyle && showSteps"\n                        s-ref="searchingStep"\n                        slot="waiting"\n                        s-bind="searchingStepsData"\n                        class="cos-dqa {{$style[\'searching-steps\']}}"\n                    />\n                    <loading\n                        s-if="!hideAlaStyle && !showSteps"\n                        s-ref="loading"\n                        slot="waiting"\n                        sse-status="1"\n                        overview-type="{{overviewType}}"\n                        appearance="steps"\n                        generation-prompt="{{generationPrompt}}"\n                    />\n                </ai-entry>\n            </div>\n        </div>\n        <slot name="footer"></slot>\n    </cs-container>\n';var L_="function"==typeof T_?T_.prototype.initData||P_:T_.initData||P_;function P_(){return{$style:C_}}function D_(){return Object.assign({},L_.call(this),{$style:C_})}"function"==typeof T_?T_.prototype.initData=D_:T_.initData=D_;var A_=a.defineComponent({dialogPop:null,dialogClick:null,components:{"cos-dialog":e.Dialog},initData:function(){return{showDialog:!1,id:"",cid:"",checked:!1}},listenDialogPop:null,attached:function(){var t,e=this;this.handleRadioClick=_n(this.handleRadioClick,300);var n=On();this.dialogPop=n.conversation.dialogPop,this.dialogClick=n.conversation.dialogClick,this.listenDialogPop=function(t){void 0===t&&(t={}),t.id&&t.id===e.data.get("id")&&(e.data.set("showDialog",!0),e.data.set("cid",t.cid))},null==(t=this.dialogPop)||t.on(this.listenDialogPop)},disposed:function(){var t;this.listenDialogPop&&(null==(t=this.dialogPop)||t.off(this.listenDialogPop),this.listenDialogPop=null)},handleOk:function(){var t;this.data.set("showDialog",!1),null==(t=this.dialogClick)||t.emit({cid:this.data.get("cid"),action:"edit",status:"ok"})},handleCancel:function(){var t;this.data.set("showDialog",!1),null==(t=this.dialogClick)||t.emit({cid:this.data.get("cid"),status:"cancel"})},handleRadioClick:function(){var t,e=this.data.get("checked");this.ref("radio").checked=!e,this.data.set("checked",!e),null==(t=localStorage)||t.setItem("writingEditQuitNoTips",e?"0":"1")}}),E_={};E_=Object.assign(E_,{noticeRadioGroup:"notice-radio-group_evik9_1","notice-radio-group":"notice-radio-group_evik9_1",noticeRadio:"notice-radio_evik9_1","notice-radio":"notice-radio_evik9_1"}),A_.template='\n    <div>\n        <cos-dialog\n            open="{=showDialog=}"\n            title="取消后将不保留您更改的内容"\n            ok-text="继续取消"\n            cancel-text="再想想"\n            on-ok="handleOk"\n            on-cancel="handleCancel"\n        >\n            <div\n                class="{{$style[\'notice-radio-group\']}}"\n            >\n                <input\n                    s-ref="radio"\n                    type="radio"\n                    value="dewey"\n                    class="{{$style[\'notice-radio\']}}"\n                    on-click="handleRadioClick"\n                />\n                <span on-click="handleRadioClick">下次不再提醒</span>\n            </div>\n        </cos-dialog>\n    </div>\n';var O_="function"==typeof A_?A_.prototype.initData||R_:A_.initData||R_;function R_(){return{$style:E_}}function N_(){return Object.assign({},O_.call(this),{$style:E_})}"function"==typeof A_?A_.prototype.initData=N_:A_.initData=N_;var q_=a.defineComponent({components:{"cos-icon":e.Icon},computed:{ubcFeedbackClickLog:function(){return JSON.stringify({type:"click",value:"card_hover_menu",ubcExt:{button:"feedback"}})},ubcDeleteClickLog:function(){return JSON.stringify({type:"click",value:"card_hover_menu",ubcExt:{button:"delete"}})},ubcRegenerateClickLog:function(){return JSON.stringify({type:"click",value:"card_hover_menu",ubcExt:{button:"reply"}})},ubcCopyClickLog:function(){return JSON.stringify({type:"click",value:"card_hover_menu",ubcExt:{button:"copy"}})},realShowExt:function(){return JSON.stringify({type:"show",value:"card_hover_menu",ubcExt:{button:"realShowExt"}})}},initData:function(){return{latestRank:1,rank:1,getCopyTarget:{},status:"GENERATING",type:"generate",hasMd:!1,isPc:"pc"===rt()}},attached:function(){this.data.get("isPc")&&this.setScrollPagePadding()},setScrollPagePadding:function(){document.querySelector('[class*="index_scroll-content"]').style.paddingBottom="15px"},updateMenu:function(t){this.data.set("showDelete",t.showDelete)},menuClick:function(t){var e=this.data.get("type");ti().emit({params:{location_id:e+"_"+this.data.get("rank"),function_type:t,location_type:"generate"===e?"answer_card":"query_card"}})},copy:function(){var t,n=this.data.get("getCopyTarget");if("function"==typeof n){var a=n(this.data.get("currentAnswerIndex"));if(a){var i="*[disable-copy]",o="",r=null==a||null==(t=a.querySelector("*[data-copy]"))?void 0:t.getAttribute("data-copy");if(a.querySelector&&a.querySelector(i)){var s=a.cloneNode(!0),c=s.querySelectorAll(i);Array.from(c).forEach((function(t){t.remove()})),s.style.background="transparent",document.body.appendChild(s),o=r||s.innerText.trim(),document.body.removeChild(s)}else o=r||a.innerText;Ed(o).then((function(){e.Toast.success({message:"复制成功"})})).catch((function(){e.Toast.error({message:"复制失败"})}))}}}}),M_={};M_=Object.assign(M_,{menu:"menu_a8aem_1",menuText:"menu-text_a8aem_6","menu-text":"menu-text_a8aem_6",menuItem:"menu-item_a8aem_21","menu-item":"menu-item_a8aem_21",icon:"icon_a8aem_29",copy:"copy_a8aem_40"}),q_.template='\n    <div class="cs-answer-hover-menu" data-show-area>\n        <div\n            s-if="status === \'COMPLETE\'"\n            class="{{$style[\'menu\']}} cs-answer-hover-menu-container"\n            data-show-ext="{{realShowExt}}"\n            need-click-log\n            data-click-log="{{ubcMenuClickLog}}"\n        >\n            <span\n                s-if="{{type === \'generate\'}}"\n                class="{{$style[\'menu-item\']}}"\n                data-click-log="{{ubcFeedbackClickLog}}"\n            >\n                <cos-icon\n                    name="errors"\n                    class="{{$style[\'icon\']}} {{$style[\'copy\']}}"\n                    on-click="native:menuClick(\'card_function_report_feedback\')"\n                />\n                <span class="{{$style[\'menu-text\']}}">反馈</span>\n            </span>\n\n            <span\n                s-if="showDelete"\n                class="{{$style[\'menu-item\']}}"\n                data-click-log="{{ubcDeleteClickLog}}"\n            >\n                <cos-icon\n                    name="bin"\n                    class="{{$style[\'icon\']}}"\n                    on-click="native:menuClick(\'card_function_delete\')"\n                />\n                <span class="{{$style[\'menu-text\']}}">删除</span>\n            </span>\n\n            <span\n                s-if="{{type === \'generate\' && rank === latestRank}}"\n                class="{{$style[\'menu-item\']}}"\n                data-click-log="{{ubcRegenerateClickLog}}"\n            >\n                <cos-icon\n                    name="exchange"\n                    class="{{$style[\'icon\']}}"\n                    on-click="native:menuClick(\'card_function_regenerate\')"\n                />\n                <span class="{{$style[\'menu-text\']}}">重答</span>\n            </span>\n\n            <span\n                class="{{$style[\'menu-item\']}}"\n                data-click-log="{{ubcCopyClickLog}}"\n            >\n                <cos-icon\n                    name="copy"\n                    class="{{$style[\'icon\']}}"\n                    on-click="native:copy"\n                />\n                <span class="{{$style[\'menu-text\']}}">复制</span>\n            </span>\n        </div>\n    </div>\n';var j_="function"==typeof q_?q_.prototype.initData||B_:q_.initData||B_;function B_(){return{$style:M_}}function H_(){return Object.assign({},j_.call(this),{$style:M_})}function $_(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function U_(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof q_?q_.prototype.initData=H_:q_.initData=H_;var F_=St.connect(Je,{imageQuery:"imageQuery"})(a.defineComponent({trimWhitespace:"all",components:{"cos-icon":e.Icon},computed:{btnText:function(){var t=this.data.get("status");return 0===t?"去验证年龄":1===t?"查看身份信息":void 0}},initData:function(){return{btnText:"",hasClickVerify:!1,verifyUrl:"https://wappass.baidu.com/v6/realName?tpl=&adapter=3&hideFinish=1&client=&clientfrom=&u&okU=",questionNumber:0}},attached:function(){var t,e=this,n=this.data.get("rank"),a=this.data.get("imageQuery"),i=null==a||null==(t=a[n])?void 0:t.rectIndex;this.data.set("questionNumber",i),document.addEventListener("visibilitychange",(function(){return e.handleVisibilityChange()})),this.dispatch("send-ubclog",{type:"show",value:this.data.get("status")?"verify_identity":"verify_age",extra:{question_number:i}})},goVerify:function(){this.dispatch("send-ubclog",{type:"click",value:this.data.get("status")?"verify_identity":"verify_age",extra:{question_number:this.data.get("questionNumber")}}),this.data.set("hasClickVerify",!0)},fetch:function(t){return(e=function(){return U_(this,(function(e){switch(e.label){case 0:return[4,fetch(t,{method:"post",credentials:"include"})];case 1:return[2,e.sent().json()]}}))},function(){var t=this,n=Array.from(arguments);return new Promise((function(a,i){var o=e.apply(t,n);function r(t){$_(o,a,i,r,s,"next",t)}function s(t){$_(o,a,i,r,s,"throw",t)}r(void 0)}))})();var e},handleVisibilityChange:function(){var t=this;!document.hidden&&this.data.get("hasClickVerify")&&(this.data.set("hasClickVerify",!1),this.fetch("https://graph.baidu.com/api/zyb/auth").then((function(e){!e||0!==e.errno&&1001!==e.errno||t.dispatch("chat:retry","")})))}})),G_={};G_=Object.assign(G_,{verify:"verify_t6kb2_1",verifyBtn:"verify-btn_t6kb2_5","verify-btn":"verify-btn_t6kb2_5",verifyBtnIcon:"verify-btn-icon_t6kb2_17","verify-btn-icon":"verify-btn-icon_t6kb2_17"}),F_.template='\n    <div class="{{$style.verify}}">\n        <div\n            s-is="{{verifyUrl ? \'a\' : \'div\'}}"\n            href="{{verifyUrl}}"\n        >\n            <span class="{{$style[\'verify-btn\']}} cos-rounded-sm" on-click="goVerify">\n                <cos-icon\n                    name="social-security"\n                    class="{{$style[\'verify-btn-icon\']}}"\n                />\n                {{ btnText }}\n            </span>\n        </div>\n    </div>\n';var W_="function"==typeof F_?F_.prototype.initData||z_:F_.initData||z_;function z_(){return{$style:G_}}function Q_(){return Object.assign({},W_.call(this),{$style:G_})}function J_(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function V_(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof F_?F_.prototype.initData=Q_:F_.initData=Q_;var K_="com.baidu.searchbox.chatsearch.aicall.notifyEvent."+En,X_="call_input";function Y_(){var t;return t=function(t){var e,n,a,i,r,s;return V_(this,(function(c){return ut()?(e=function(t){var e,n,a=Je.getState("phoneParams");return(null==a||null==(n=a.reqInfo)||null==(e=n.businessParams)?void 0:e.interactionInfo)&&(a.reqInfo.businessParams.interactionInfo.sa=t,a.reqInfo.businessParams.interactionInfo.re_rank=String(+Je.getState("rank")),a.reqInfo.businessParams.interactionInfo.enterType=Je.getState("enterType")),(null==a?void 0:a.reqInfo)&&(a.reqInfo.sessionId=Je.getState("oriLid"),a.reqInfo.source=t===X_?"interactionInputBar":"interactionTab",a.reqInfo.headerParams={source:"wise_csaitab"}),a&&(a.logInfo={ext:{call_page_from:t===X_?1:2,figure_type:"3"},source:"3841000010001000"}),a}(t),n=e.ttsInfo,a=e.asrInfo,i=e.reqInfo,r=e.metaInfo,s=e.logInfo,o.canIUse("aiCall.open")&&o.aiCall.open({ttsInfo:n,asrInfo:a,reqInfo:i,metaInfo:r,logInfo:s,callbackAction:K_,success:function(t){Jn().emit(),function(t){if(o.canIUse("event.on")&&window){var e="aiTelCallBack"+ +new Date;window[e]=function(e,n){t&&t(JSON.parse(n))},o.event.on({action:K_,jscallback:e})}}(ek)},fail:function(t){}}),[2]):[2]}))},Y_=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){J_(o,a,i,r,s,"next",t)}function s(t){J_(o,a,i,r,s,"throw",t)}r(void 0)}))},Y_.apply(this,Array.from(arguments))}function Z_(t){!function(t){oa().emit(!0),Rr({data:{from:"chat_search",sge_lid:(Je.getState("chatParams")||{}).sge_lid,token:$r(),pn:0,rn:t.turnCount+1,search_before_lid:Je.getState("lid"),cur_ori_lid:t.sessionId,req_type:3,landingPageSwitch:Je.getState("landingPageSwitch"),landingPage:ct()?"deepseek":"aitab"}},{appendRender:!0,isAiCall:!0},"behind")}(t),o.canIUse("event.off")&&o.event.off({action:K_})}function tk(t){var e,n={},a=null==t?void 0:t.costs;Object.keys(null!=a?a:{}).forEach((function(t){var e=a[t];n[t]="number"!=typeof e?Number(e):e})),null==t||(null==(e=t.labels)||delete e.query),function(t,e){Je.getState("isDev")||tn.sendPerf({group:"aicall",info:t,dim:e})}(n,t.labels)}function ek(t){switch(t.type){case"close":Z_(t.data);break;case"performanceInfo":tk(t.data)}}var nk=a.defineComponent({trimWhitespace:"all",initData:function(){return{}},computed:{realShowExt:function(){return JSON.stringify({type:"show",value:"ai_call_real",ori_lid:""+this.data.get("oriLid"),agent_id:""+this.data.get("agentInfo.agentSearchId"),agent_name:""+this.data.get("agentInfo.agentName"),figure_type:""+this.data.get("agentInfo.telParams.figureType")})}},attached:function(){this.handleAgentTelLog=wn(this.handleAgentTelLog,1e3,{leading:!0,trailing:!1}),this.dispatch("send-ubclog",{type:"show",value:"ai_call",extra:{figure_type:""+this.data.get("agentInfo.telParams.figureType")}})},handleAgentTelLog:function(t){var e=this.data.get("type");(t||"ai-tel"===e)&&(this.dispatch("send-ubclog",{type:"click",value:"ai_call",extra:{figure_type:""+this.data.get("agentInfo.telParams.figureType")}}),"ai-tel"!==e?Ad(t):function(t){Y_.apply(this,Array.from(arguments))}("call_prob"))}}),ak={};ak=Object.assign(ak,{agentTel:"agent-tel_82o66_1","agent-tel":"agent-tel_82o66_1",agentTelIcon:"agent-tel-icon_82o66_27","agent-tel-icon":"agent-tel-icon_82o66_27",agentTelText:"agent-tel-text_82o66_37","agent-tel-text":"agent-tel-text_82o66_37"}),nk.template='\n    <div\n        class="{{$style[\'agent-tel\']}}"\n        data-show-ext="{{realShowExt}}"\n        need-show-log="true"\n        data-show-area\n        on-click="handleAgentTelLog(agentInfo.telUrl)"\n    >\n        <span class="{{$style[\'agent-tel-icon\']}}"></span>\n        <span class="{{$style[\'agent-tel-text\']}}">给我打电话</span>\n    </div>\n';var ik="function"==typeof nk?nk.prototype.initData||ok:nk.initData||ok;function ok(){return{$style:ak}}function rk(){return Object.assign({},ik.call(this),{$style:ak})}function sk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function ck(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function lk(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){ck(o,a,i,r,s,"next",t)}function s(t){ck(o,a,i,r,s,"throw",t)}r(void 0)}))}}function dk(){return dk=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},dk.apply(this,Array.from(arguments))}function uk(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sk(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pk(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof nk?nk.prototype.initData=rk:nk.initData=rk;var hk,fk,gk,mk={askBack:1,input:1,questionClosely:1},vk={yiyan:{userAbort:"好的，停下来了，有问题再问我。",other:"抱歉，出了点小问题，请稍后重试。",netError:"抱歉，似乎没接收到你的消息，检查下网络后再继续吧。"},deepseek:{userAbort:"抱歉，服务繁忙，请稍后再试。",other:"抱歉，服务繁忙，请稍后再试。",netError:"抱歉，服务繁忙，请稍后再试。"}},yk={PIC:"pic"};!function(t){t.STOP="stop",t.RETRY="retry"}(hk||(hk={})),function(t){t.REBUILD="rebuild",t.APPEND="append"}(fk||(fk={})),function(t){t.AGENT_TEL="agent-tel",t.AI_TEL="ai-tel",t.ADULT_CHECK="adult-check"}(gk||(gk={}));var bk,wk="interact:replace-click",_k=a.defineComponent({rebuildTimes:0,agentRankMax:{},currInteractData:null,components:{"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"wd-feedback-pop":hw,header:hb,footer:v_,"c-ai-container":T_,interact:s_,"wd-tts-player":kb,"agent-tel":nk,"ai-tel":nk,"adult-check":F_,"dialog-pop":A_,"hover-menu":q_},messages:(bk={"UI:showToast":function(t){var n;e.Toast.show({message:null==t||null==(n=t.value)?void 0:n.content})},"chat:launch-search":function(t){this.launchSearch(t.value||{})},"ai-image-with-thumbnail:retry":function(){this.onReplace(!0)}},bk[wk]=function(t){var e=t.value;e.extra=Object.assign({},e.extra||{},{morecreate_num:this.rebuildTimes+1}),this.dispatch("send-log",e)},bk["chat:retry"]=function(t){this.data.set("attachBtnShow",!1),this.data.set("attachBtn",null),this.retry()},bk["image-query-tab:click"]=function(t){this.data.set("attachBtnShow",!1),this.data.set("attachBtn",null);var e=t.value,n=this.data.get("rank"),a=Je.getState("imageQuery");a[n].rectIndex=e,Je.dispatch("update",{imageQuery:dk({},a)}),this.retry(),this.dispatch("image-query-tab:click-log",{ubcId:"17132",page:"resultpage",type:"click",value:"change_question_number",extra:{question_number:e}})},bk["writing:cancel-edit"]=function(){this.data.set("hideSwiperIndicator",!1),this.data.set("disbaleTouchAction",!1),this.data.set("hideFooter",!1),this.data.set("borderActiveIndex",-1)},bk["update-agent-info"]=function(t){var e=null==t?void 0:t.value;e&&this.updateAgentInfo(e)},bk["overview:send-perf"]=function(){var t=this;this.monitor&&this.nextTick((function(){var e=t.data.get("overviewBlockFirstTokenDur");t.monitor.setMonitorData("overviewBlockFirstTokenDur",e)}))},bk["pack-render-finished"]=function(t){this.data.set("completedPack",t.value),this.data.set("completedPackIndex",this.data.get("completedPackIndex")+1)},bk),computed:{isIosDakeMode:function(){return this.data.get("commonData").isIOS&&navigator.userAgent.toLowerCase().includes("theme/dark")},isAllowAction:function(){var t=this.data.get("currentIndex"),e=this.data.get("currentAnswerIndex"),n=this.data.get("answerList["+t+"]["+e+"].isLoading"),a=this.data.get("answerList["+t+"]["+e+"].stateBtnType");return!n||"retry"===a},themeColorStyle:function(){var t="#6e4bfa",e="#292080",n=["#FFFFF4","#FFFDFA"];return{"--theme-color":t,"--theme-color-light":t,"--theme-color-bg":t,"--theme-color-bg-light":t,"--theme-color-border":t+"99","--theme-logo":"url("+"https://gips3.baidu.com/it/u=3154978027,2545641559&fm=3028&app=3028&f=PNG&fmt=auto&q=97&size=f54_54"+")","--theme-logo-bg":"url("+"https://gips2.baidu.com/it/u=2546181581,921105335&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f540_540"+")","--theme-color-stroke":"#DCD7FB"+"33","--theme-color-mask":"linear-gradient(180deg, "+n[0]+"00 68.72%, "+n[1]+" 82.38%)","--theme-color-dark":e,"--theme-color-bg-light-dark":e+"0A","--theme-color-loading-dark":e+"1F","--theme-color-loading1-dark":e+"00"}},isSge:function(){var t=this.data.get("commonData").chatParams,e=void 0===t?{}:t;return e.chat_samples&&e.chat_samples.indexOf("sge_")>=0||e.setype&&"csaitab"!==e.setype},deleteParams:function(){var t=this.data.get("sessionId"),e=this.data.get("deleteQidList");return JSON.stringify({sessionId:t,deleteQidList:e})},hideStateButton:function(){var t=this.data.get("baseData.sample.variables");return!!t&&("1"===t.HIDE_STOP||!(this.data.get("agentInfo.agentName")||this.data.get("isPc")||"2"!==t.SINGLE_LINE_OVERVIEW&&"3"!==t.SINGLE_LINE_OVERVIEW))},abortText:function(){var t=Je.getState("usedModel")||{},e=this.data.get("abortServerText");return dk({},vk["DeepSeek-R1"===(null==t?void 0:t.modelName)?"deepseek":"yiyan"],{server:e})}},initData:function(){var t,e,n=this;return{prefetchUrlList:[],fallbackAskData:[],commonData:{},graphCreationLog:{},answerList:[[{isLoading:!0,isStateBtnShow:!1,autoHeight:!1,stateBtnType:"stop",blocks:[]}]],titleData:{},imageInfo:{},getCopyTarget:function(t){var e,a=n.data.get("currentIndex"),i=void 0===t?n.data.get("currentAnswerIndex"):t,o=null==(e=n.ref("ai-container-"+a+"-"+i))?void 0:e.el;return null==o?void 0:o.querySelector(".marklang, .ai-entry")},currentIndex:0,currentAnswerIndex:0,hasSendToChatSearch:!1,hasHitNotice:!1,noticeText:"",hasSendGenerateStart:!1,hasSendGenerateComplete:!1,abortServerText:"",supText:"",tabName:"",mainHallTask:{},typingSpeed:30,isAnnotation:!1,isDataFlyWheel:!1,springStyle:"",generateKey:"",generateParams:{},cids:[[]],agentInfo:null,hasShowTtsAnimationAgent:[],showAgentTel:!1,isRebuild:!1,generateDataList:[],baseData:{},searchingStepsData:{},overviewBlockFirstTokenDur:0,latestRank:1,rank:1,rebuildMode:"rebuild",canAppendMore:!0,seperateInteract:{show:!1,interactData:{}},replaceClickEvent:wk,agentId:[],resultIntentionTypeMap:yk,resultIntentionType:"",dangerCheckTime:0,startTime:0,replaceLimitText:"达到上限了，让我们换个话题吧",layoutReverse:!1,isBless:!1,typingSwitch:!0,downloadEnable:!0,ttsTextList:[],longPressTtsText:"",isSidebarUpdate:!1,shareParams:"",sessionId:"",deleteQidList:[],swiperPosDisable:!1,showDialog:!1,hideSwiperIndicator:!1,disbaleTouchAction:!1,hideFooter:!1,borderActiveIndex:-1,conversationLogId:"",hasSendError:!1,isPc:!1,feedbackFormData:{},isShowPcInteract:!1,logExtData:{},logExtParams:{},sectionId:1,pushedPackIndex:0,cacheList:[],completedPackIndex:0,isRight:"1"===(null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.AI_TAB_RIGHT),isExtension:ft(),askUsedModel:{}}},created:function(){var t,e=Je.getState("agentInfo");!this.data.get("agentInfo.agentName")&&!this.data.get("agentId").length&&e&&e.agentName&&(this.data.set("agentInfo",Je.getState("agentInfo")),this.data.set("agentId",[null==(t=Je.getState("agentInfo"))?void 0:t.agentSearchId]))},listenLongPressHandler:null,listenDialogClick:null,attached:function(){var t=this,e=this.data.get("currentIndex"),n=this.data.get("currentAnswerIndex"),a=this.data.get("answerList["+e+"]["+n+"].isLoading"),i=this.data.get("commonData.isIOS"),o=this.data.get("generateKey"),r="";if(o){var s=(window.generateParamsMap||{})[o]||{};this.data.set("generateParams",s),delete window.generateParamsMap[o],r=s.text}this.data.set("supText",r),this.data.set("tabName",window.sgeSpringTab||""),this.data.set("isPc","pc"===rt()),this.data.set("isAndroid",Ga),this.sseInit(a),this.listenInit(),this.data.set("tti",+new Date),this.handleAgentTelLog=wn(this.handleAgentTelLog,1e3,{leading:!0,trailing:!1}),this.listenDialogClick=function(e){void 0===e&&(e={});var n=e.cid,a=e.status,i=t.data.get("currentIndex")||0,o=t.data.get("currentAnswerIndex")||0;n===t.data.get("cids["+i+"]["+o+"]")&&"ok"===a&&(t.data.set("hideSwiperIndicator",!1),t.data.set("disbaleTouchAction",!1),t.data.set("hideFooter",!1),t.data.set("borderActiveIndex",-1))},this.data.set("downloadEnable",!(i&&Fi(Ui(),"13.56")<0)),this.listenLongPressHandler=Ob(this,"generate"),On().conversation.dialogClick.on(this.listenDialogClick),this.watch("commonData.defaultInteractData.isShowCopy",(function(n){for(var a=t.data.get("answerList["+e+"]"),i=t.data.get("interactiveArea")||{},o=0;o<(null==a?void 0:a.length);o++)void 0===i.isShowCopy&&t.data.set("answerList["+e+"]["+o+"].interactData.data.isShowCopy",n),void 0===i.isShowReplace&&!i.isShowEditTxt&&t.data.set("answerList["+e+"]["+o+"].interactData.data.isShowReplace",n)})),this.canAllowTouchMove=wn(this.canAllowTouchMove,500,{leading:!0,trailing:!1})},listenBeforeLaunchConversation:null,listenImageQuerySelectedChange:null,listenUserAbort:null,listenHideAiCallHistory:null,listenBubAsyncClick:null,listenDangerCheckTime:null,listenMenuHasDelete:null,listenInit:function(){var t=this;this.listenBeforeLaunchConversation=function(){t.dispatch("dqa-steps-finished",!0),t.stopGenerate(!1,"userAbort"),t.hideAiCallBtn()},Hn().on(this.listenBeforeLaunchConversation),this.listenImageQuerySelectedChange=function(e){var n=e.rank,a=e.rectIndex,i=e.rectList,o=e.imageInfo;if(n===t.data.get("rank")){var r=Je.getState("imageQuery");r[n].rectIndex=a,r[n].rectList=i,r[n].imageInfo=o,Je.dispatch("update",{imageQuery:dk({},r)}),t.retry()}},$n().on(this.listenImageQuerySelectedChange),this.listenUserAbort=function(){t.stopGenerate(!1,"userAbort")},Fn().on(this.listenUserAbort),Jn().on(this.listenUserAbort),this.listenHideAiCallHistory=function(){t.hideAiCallBtn()},Qn().on(this.listenHideAiCallHistory),this.listenDangerCheckTime=function(e){t.monitor&&t.monitor.setMonitorData("dangerCheckTime",e)},this.watch("dangerCheckTime",this.listenDangerCheckTime),this.listenBubAsyncClick=function(e){e.rank===t.data.get("rank")&&t.handleBubAsyncClick(e)},On().conversation.asyncBubClick.on(this.listenBubAsyncClick),this.listenMenuHasDelete=function(){for(var e=0;e<t.data.get("answerList["+t.data.get("currentIndex")+"]").length;e++){var n;t.ref("menu-"+e)&&t.ref("menu-"+e).updateMenu({showDelete:null==(n=t.data.get("deleteQidList"))?void 0:n.length})}},this.el.addEventListener("mouseenter",this.listenMenuHasDelete)},onEditClick:function(t,e){km()||(this.data.set("borderActiveIndex",e),this.data.set("hideSwiperIndicator",!0),this.data.set("disbaleTouchAction",!0),this.data.set("hideFooter",!0))},handleBubAsyncClick:function(t){var n=this,a=t||{},i=a.asyncApi,o=a.url,r=this.data.get("currentIndex"),s=this.data.get("answerList["+r+"]"),c=[];e.Toast.show({message:"正在上墙",type:"refresh",animationDuration:1e3,duration:8e3}),s.forEach((function(t,e){c.push(n.ref("ai-container-"+r+"-"+e).handleComponentAll())}));var l=!1;Promise.all(c).then((function(t){var n=t&&t.reduce((function(t,e){return t.concat(e)}),[])[0]||{},a=new URLSearchParams;Object.keys(n).forEach((function(t){a.append(t,JSON.stringify(n[t]))})),i&&fetch(i,{method:"post",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a}).then((function(t){return t.json()})).then((function(t){if(e.Toast.hide(),l=0===(null==t?void 0:t.errno),0!==(null==t?void 0:t.errno))throw new Error})).catch((function(t){e.Toast.show({message:"上墙失败"})})).finally((function(){o&&l&&Nd(l?o+"&isShare="+l:o)}))}))},aiContainerWaiting:function(){var t=this.data.get("currentIndex"),e=this.data.get("currentAnswerIndex");this.data.set("answerList["+t+"]["+e+"].isFinished",!1),this.ref("ai-container-"+t+"-"+e).startWaiting()},aiContainerGenerating:function(){var t,e=this.data.get("currentIndex"),n=this.data.get("currentAnswerIndex");null==(t=this.ref("ai-container-"+e+"-"+n))||t.startGenerating()},aiContainerPushBlock:function(t){var e,n,a,i=this.data.get("currentIndex"),o=this.data.get("currentAnswerIndex");(null==t||null==(n=t.generator)||null==(e=n.data)?void 0:e.bgProps)&&this.data.set("answerList["+i+"]["+o+"].bgProps",t.generator.data.bgProps),null==(a=this.ref("ai-container-"+i+"-"+o))||a.pushBlock(t),this.data.set("pushedPackIndex",this.data.get("pushedPackIndex")+1),this.data.set("pushedPack",t)},aiContainerStop:function(t,e){var n,a=this.data.get("currentIndex"),i=this.data.get("currentAnswerIndex");sa().emit({isShowButton:!1}),Mr(),null==(n=this.ref("ai-container-"+a+"-"+i))||n.stop(t,e)},aiContainerClear:function(){var t=this.data.get("currentIndex"),e=this.data.get("currentAnswerIndex");if(this.data.get("isSeparateBub")){for(var n=0;n<this.data.get("answerList["+t+"].length");n++){var a;null==(a=this.ref("ai-container-"+t+"-"+n))||a.clear()}this.data.set("answerList["+t+"]",[]),this.data.set("currentAnswerIndex",0),this.data.set("isSeparateBub",!1)}else{var i;null==(i=this.ref("ai-container-"+t+"-"+e))||i.clear()}},handleMonitor:function(){var t=this.data.get("baseData"),e=t.query,n=t.lid,a=this.data.get("rank"),i=this.data.get("oriLid"),o=this.data.get("commonData.tplInfo"),r=this.data.get("currentIndex"),s=this.data.get("currentAnswerIndex"),c=this.data.get("answerList["+r+"]["+s+"].isGenerate"),l=this.data.get("typingSpeed"),d=this.data.get("commonData.chatParams")||{},u={ori_lid:i,rank:a,lid:n,query:e,isGenerate:c,typingSpeed:l,aiContainerEl:this.ref("ai-container-"+r+"-"+s)&&this.ref("ai-container-"+r+"-"+s).el&&this.ref("ai-container-"+r+"-"+s).el.querySelector(".marklang, .ai-entry")};this.monitor=new ww({params:u,platform:"wise",card:o.tplname,dim:{setype:d.setype}}),this.monitor.setMonitorData("tti",this.data.get("tti"))},onEmpty:function(t){this.data.set("ttsText",t.ttsText||""),this.monitor.setMonitorData("aiContainerEmpty",1)},onRenderFinished:function(t){var e,n=this,a=this.data.get("commonData"),i=t.ttsText,o=t.answerIndex,r=t.type,s=localStorage.getItem("hasShowTtsAnimationAgent")&&JSON.parse(localStorage.getItem("hasShowTtsAnimationAgent")||"")||[],c=this.data.get("agentInfo"),l=null==c?void 0:c.agentId,d=this.data.get("currentIndex"),u=this.data.get("currentAnswerIndex");if(s.includes(l)?this.data.set("isNeedTtsAnimation",!1):i&&2===a.chatSearch&&l&&(null==c?void 0:c.speechId)&&(this.data.set("isNeedTtsAnimation",!0),s.push(l),localStorage.setItem("hasShowTtsAnimationAgent",JSON.stringify(s))),this.data.set("ttsText",i),this.data.set("answerList["+d+"]["+o+"].isFinished",!0),this.data.set("ttsTextList["+d+"]["+o+"]",i),"separate-bub"!==r){var p=this.data.get("isPc");if((null==c?void 0:c.isUpperBox)&&!p){var h="@"+c.agentName;c.startIndex=0,c.endIndex=h.length-1,jn().emit(dk({word:h,agentInfo:us(c),invokeKeyboard:0},Wa&&Fi(Ui(),"13.55")<0?{forceUpperBox:!0}:{}))}this.monitor.setMonitorData("finishedTime",+new Date),this.monitor&&this.monitor.stopListen(),this.data.get("answerList["+d+"]["+u+"].sseStatus")===vh.COMPLETE&&this.completeHandle();var f=this.data.get("generateAnswer");vp.triggerEvent("onTypingFinished",{round_index:this.data.get("rank"),isHistory:this.data.get("isHistory"),data:{functional:{},messages:f&&(null==(e=f[d])?void 0:e.data)||[]},api:{sendUbcLog:function(t){n.dispatch("send-ubclog",t)}}}),this.dispatch("show-capsule"),this.dispatch("send-ubclog",{type:"show",value:"ai_chat_over",extra:{is_rebuild:this.data.get("isRebuild")?"1":"0"}}),this.sendStatusToClient("generateComplete")}},launchSearch:function(t){var n=t.word,a=t.event;t.askBackSelectCount,t.isHaveQuestion;var i,o=t.sa,r=t.extra;if(n&&a){var s=this.data.get("commonData.chatParams")||{},c=this.data.get("baseData"),l={};r&&r.text&&(l={style:this.data.get("springStyle"),content:r.text,author:r.author,receiver:r.receiver,acrosticText:r.acrosticText,req_type:r.req_type||"1",actionLid:c.lid,template:r.template}),Ar({query:n,extParams:{word:n,sa:o+"_"+this.data.get("commonData.tplInfo").srcid,setype:s.setype||"sge",actiontype:r&&r.actionType?r.actionType:"",agent_id:(null==(i=this.data.get("agentId"))?void 0:i[0])||"",agent_p:JSON.stringify(l),aitab_ct:r.aitab_ct||""}}).catch((function(t){if(!t||"string"!=typeof t)throw t;e.Toast.show({message:t})}))}},sseInit:function(t){var n=this;this.sseDataCopy=new _w(this.el,e.Toast),this.addAnswer(!0),this.nextTick((function(){n.handleMonitor(),n.getAnswer()}))},appendAnswer:function(){var t=this.data.get(),e=t.currentIndex;t.typingSwitch,this.data.push("answerList["+e+"]",{isLoading:!0,isStateBtnShow:!0,interactData:{},suggestionData:{data:{}},referenceList:[],sseStatus:void 0,stateBtnType:"stop",isGenerate:!0,generator:{},suggestion:{},antiFlag:!1,isFinished:!1,isHint:!1,isComplete:!1,hideInteract:!1});var n=this.data.get("answerList");this.data.set("currentAnswerIndex",n[e].length-1)},addAnswer:function(t){void 0===t&&(t=!1),t&&this.data.set("answerList",[]),!t&&this.dispatch("add-answer"),this.data.push("answerList",[{isLoading:!0,isStateBtnShow:!0,autoHeight:!1,interactData:{},suggestionData:{data:{}},referenceList:[],sseStatus:void 0,stateBtnType:"stop",isGenerate:!0,generator:{},suggestion:{},antiFlag:!1,isFinished:!1,isHint:!1,isComplete:!1}]),!t&&this.data.push("cids",[]);var e=this.data.get("answerList");this.data.set("currentIndex",e.length-1),this.data.set("currentAnswerIndex",0),this.data.assign({sectionId:1,cacheList:[],pushedPackIndex:0,pushedPack:void 0,completedPackIndex:0,completedPack:void 0,lastCompletedPackIndex:0,isSeparateBub:!1})},handleMessageData:function(t){var e,n,a,i,o,r,s,c,l,d=this,u=this.data.get("currentIndex"),p=this.data.get("currentAnswerIndex"),h=this.data.get("answerList["+u+"]["+p+"].sseStatus"),f="pc"===rt();if(h!==vh.ABORT){var g=t.content,m=void 0===g?{}:g,v=t.options,y=void 0===v?{}:v,b=t.type,w=void 0===b?"":b,_=t.functional,k=void 0===_?{}:_;if("baseData"!==w){var S,x,I=this.data.get("shareParams");if(m.shareId&&!I&&this.data.set("shareParams",JSON.stringify({shareId:m.shareId})),null==m||null==(n=m.generator)||null==(e=n.data)?void 0:e.typing)this.data.set("typingSwitch","0"!==(null==m||null==(x=m.generator)||null==(S=x.data)?void 0:S.typing));if(null==k?void 0:k.feedback)this.data.set("feedbackFormData",null==k?void 0:k.feedback);else{if(vp.triggerEvent("onMessage",{round_index:this.data.get("rank"),isHistory:this.data.get("isHistory"),agentInfo:{agentId:null==(a=this.data.get("agentInfo"))?void 0:a.agentId,agentSearchId:null==(i=this.data.get("agentInfo"))?void 0:i.agentSearchId,agentName:null==(o=this.data.get("agentInfo"))?void 0:o.agentName},data:m,api:{sendUbcLog:function(t){d.dispatch("send-ubclog",t)}}}),y.speedInfo&&(null==(r=y.speedInfo)?void 0:r.labels)&&(null==(s=y.speedInfo)?void 0:s.costs)){var T=t.options.speedInfo||{};this.dispatch("update-perf-info",{dim:T.labels}),this.monitor.setMonitorData("serverSpeed",T)}if(y.endTurn)f&&oi().emit({type:kp.SSE_STOP}),this.onCompleteProcess(t,vh.COMPLETE),this.sseDataCopy.addSseData(t,vh.COMPLETE);else if(w&&"generator"!==w)this.onAbortProcess(t,vh.ABORT),this.sseDataCopy.addSseData(t,vh.ABORT);else{var C,L;if(this.onGeneratingProcess(t,vh.GENERATING),!this.monitor.monitorInfo.generatingStartTime){var P=+new Date;this.monitor.setMonitorData("generatingStartTime",P),this.dispatch("generate-start",{generatingStartTime:P}),this.data.set("startGenerateTime",P),Aa({type:"click",value:"answer_card",ext:{re_rank:String(this.data.get("rank")),a_lid:this.data.get("baseData.apagelid"),lid:this.data.get("baseData.lid"),ori_lid:this.data.get("oriLid"),setype:"csaitab"}})}this.monitor.setModelName(null==(L=t.content)||null==(C=L.generator)?void 0:C.component),this.sseDataCopy.addSseData(t,vh.GENERATING)}(null==m||null==(c=m.generator)?void 0:c.hideAlaCard)&&(this.dispatch("hide-ala-card"),this.data.set("commonData.isAlaHat",!1)),(null==m||null==(l=m.generator)?void 0:l.isFinished)&&this.handleContentFinished()}}}},dataCacheHandler:function(t){var e=this;if(!this.dataCache){this.dataCache=[];var n=this.data.get("currentIndex"),a=this.data.get("currentAnswerIndex");this.watch("answerList["+n+"]["+a+"].isComplete",(function(t){var n;t&&(null==(n=e.dataCache)||n.forEach((function(t){e.handleMessageData(t)})),e.dataCache=void 0)}))}this.dataCache.push(t)},deleteParamsCollect:function(t){if(t.qid&&t.sessionId){var e=this.data.get("sessionId"),n=this.data.get("deleteQidList");e||this.data.set("sessionId",t.sessionId),n.includes(t.qid)||this.data.push("deleteQidList",t.qid)}},getAnswer:function(t){var e,n,a=this;this.aiContainerWaiting();var i=this.data.get("currentIndex"),o=this.data.get("generateAnswer");o&&(null==(n=o[i])||null==(e=n.data)||e.forEach((function(t){a.handleMessageData(t)}))),this.watchAnswer()},watchAnswer:function(){var t=this;this.watch("generateAnswer",(function(e,n){var a=n.oldValue,i=n.newValue,o=t.data.get("currentIndex");t.data.get("currentAnswerIndex");var r=o,s=i[r],c=a[r]||{data:[]};if(s.data&&c.data&&s.data.length>c.data.length){var l=s.data.slice(c.data.length);t.nextTick((function(){for(var e,n=uk(l);!(e=n()).done;){var a=e.value;t.handleMessageData(a)}}))}var d=e[r].perfData;if(d){var u,p=+new Date,h=t.data.get("startTime")||0,f=(null==d||null==(u=d.packageIntervalList)?void 0:u.length)?d.packageIntervalList[0].time-d.openToFirstPackage-d.fetchToOpen:0,g=(null==d?void 0:d.totalPackagesNum)||0,m=(null==d?void 0:d.lostPackages)||0;t.monitor.setMonitorData({fetchEndTime:p,startTime:h,sseRequestStart:f,lostPackages:m,allPackageCount:g})}}))},setSseStatus:function(t){this.dispatch("update-chat-status",t);var e=this.data.get("currentIndex"),n=this.data.get("currentAnswerIndex");this.data.set("answerList["+e+"]["+n+"].sseStatus",t)},onOpenProcess:function(t,e){this.setSseStatus(e)},onWaitingProcess:function(t,e){this.setSseStatus(e),this.aiContainerWaiting()},onGeneratingProcess:function(t,e){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w;this.setSseStatus(e),this.data.get("commonData.chatSearch");var _=t.content,k=t.options,S=void 0===k?{}:k,x=this.data.get("currentIndex")||0,I=this.data.get("currentAnswerIndex")||0,T=this.data.get("oriLid");this.data.set("cids["+x+"]["+I+"]",S.qid),this.data.set("commonData.editorParams.extLogParams.cid",S.qid);var C,L=null==(i=t.content)||null==(a=i.agentInfo)||null==(n=a.agentMeta)?void 0:n[0];(L&&(this.data.set("agentInfo",L),L.telUrl&&L.agentId&&this.data.set("attachBtn",{type:"agent-tel",agentInfo:L,oriLid:T})),L)&&(ii(null==(C=this.data.get("baseData"))?void 0:C.query,L),this.data.set("isSidebarUpdate",!0));this.deleteParamsCollect(S);var P,D,A,E,O,R=null==(r=t.content)||null==(o=r.generator)?void 0:o.attachBtn;(R&&this.data.set("attachBtn",R),"operate-capsule"===(null==(c=t.content)||null==(s=c.generator)?void 0:s.component))&&(null==(O=On())||null==(E=O.conversation)||null==(A=E.operateCapsulesDataInterflow)||A.emit(null==(D=t.content)||null==(P=D.generator)?void 0:P.data));"writing"===(null==(d=t.content)||null==(l=d.generator)?void 0:l.component)&&this.data.set("answerList["+x+"]["+I+"].isWritingScene",!0);var N=null==(p=t.content)||null==(u=p.generator)?void 0:u.authorityInfo;N&&N.title&&this.data.set("authorityInfo",N),this.dispatch("cid-update",{cid:S.qid||"",index:x,answerIndex:I});var q=_.generator,M=void 0===q?{}:q;this.sendStatusToClient("generateStart"),(null==_||null==(h=_.agentInfo)?void 0:h.agent_id)&&this.data.set("agentId",_.agentInfo.agent_id),(null==M?void 0:M.rebuildMode)&&this.data.set("rebuildMode",M.rebuildMode),(null==M?void 0:M.resultIntentionType)&&this.data.set("resultIntentionType",M.resultIntentionType),"text"===(null==M||null==(f=M.logExt)?void 0:f.scene)&&(M.data&&(M.data.logExtData=dk({},M.logExt)),this.data.set("commonData.isComposition",!0));var j=null==_||null==(g=_.agentInfo)?void 0:g.log_ext;if(j&&"text_short"===j.scene_1st&&"text_bless"===j.scene_2nd&&(this.data.set("isBless",!0),this.data.set("layoutReverse",!0),this.data.set("commonData.defaultInteractData.isShowCopy",!1),this.data.set("commonData.defaultInteractData.isShowTts",!1),this.data.set("commonData.defaultInteractData.isShowReplace",!0),this.dispatch("update-log-ext",dk({},j)),lt()&&this.data.set("commonData.isComposition",!0)),0!==Object.keys(M).length){var B=(null==M?void 0:M.logExt)||{};this.logDataUpdate(B),this.data.set("logExtParams",B)}if((null==M?void 0:M.isRebuildEnd)&&this.data.set("canAppendMore",!1),(null==M||null==(m=M.data)?void 0:m.value)&&(this.monitor&&this.monitor.initListener(),this.monitor.setMonitorData({lastPack:M.data.value})),mk[M.component]&&this.data.set("answerList["+x+"]["+I+"].existAskback",!0),"dict3S"===(null==M||null==(v=M.notice)?void 0:v.noticeStyleType)){this.data.set("hasHitNotice",!0),this.data.set("noticeText",M.notice.noticeText||"内容涉及违规不做进一步回答，您可以向我问一些其他的问题，我会尽力帮您解决的。"),this.dispatch("send-ubclog",{type:"show",value:"cont_wrong",extra:{wrong_type:"命中风控"}})}if("1"===(null==M||null==(y=M.data)?void 0:y.style)&&(this.data.set("commonData.editorParams.style","1"),this.data.set("springStyle","1"),M.data.textStyle="1"),this.addBottomArea(_,x,I),(null==(b=M.interactiveArea)?void 0:b.isHideInteractiveArea)&&(!M.sectionId||M.sectionId<2)&&this.data.set("answerList["+x+"]["+I+"].hideInteract",!0),(null==(w=M.data)?void 0:w.isHideStateBtn)&&(!M.sectionId||M.sectionId<2)&&this.data.set("answerList["+x+"]["+I+"].isStateBtnShow",!1),this.handleChatSearchGeneratingProcess(S,_,x),M.needClearHistory){var H=this.data.get("rank");this.data.set("clearHistoryMode",!0),Mn().emit({rank:H,type:"delete-rank-show-toast"})}},sendStatusToClient:function(t){return lk((function(){var e,n,a,i,o,r;return pk(this,(function(s){switch(s.label){case 0:return e=this.data.get("hasSendGenerateStart"),n=this.data.get("hasSendGenerateComplete"),a=this.data.get("hasSendError"),"generateStart"===t&&e||"generateComplete"===t&&(!e||n||a)?[2]:(i={query:this.data.get("baseData.query"),lid:this.data.get("baseData.lid"),conversationLogId:this.data.get("conversationLogId"),perfInfo:{fe_stage:{},fe_ext:{}},chatNum:this.data.get("rank"),widgetGuide:0},"generateStart"===t?(i.perfInfo.generating_start_time=""+Date.now(),this.data.set("hasSendGenerateStart",!0)):(i.perfInfo.generating_complete_time=""+Date.now(),this.data.set("hasSendGenerateComplete",!0)),"generateComplete"!==t?[3,2]:[4,ah()]);case 1:o=s.sent(),r=this.data.get("rank"),o&&1===r&&(i.widgetGuide=1),s.label=2;case 2:return On().conversation[t].emit(i),[2]}}))})).apply(this)},sendErrorToClient:function(t,e){var n;if(void 0===e&&(e=""),"userAbort"!==t){this.data.set("hasSendError",!0);var a="error"===t?1:5;null==(n=On().conversation.errorOccur)||n.emit({query:this.data.get("baseData.query"),lid:this.data.get("baseData.lid"),conversationLogId:this.data.get("conversationLogId"),perfInfo:{fe_error_code:a,error_info:e,fe_stage:{},fe_ext:{}},chatNum:this.data.get("rank")})}},logDataUpdate:function(t){t&&this.dispatch("update-log-ext",dk({},t))},handleChatSearchGeneratingProcess:function(t,e,n){var a;this.aiContainerGenerating(),this.data.push("cacheList",e);var i=e.suggestion,o=e.generator,r=void 0===o?{}:o,s=e.hints,c=void 0===s?{}:s;if(c.parts&&Array.isArray(c.parts)&&c.parts.length>0){var l=this.data.get("currentIndex"),d=this.data.get("currentAnswerIndex"),u=this.data.get("abortText");if(this.data.set("answerList["+l+"]["+d+"].isHint",!0),this.data.set("abortServerText",c.parts[0].text||u.other),this.dispatch("send-ubclog",{type:"show",value:"cont_wrong",extra:{wrong_type:"命中风控"}}),"kunlunHint"===c.parts[0].type&&this.data.get("isPc"))return wr(this.data.get("baseData").query);di().emit({curBlock:r,hints:c,rank:this.data.get("rank")})}if(null==(a=this.data.get("commonData.chatParams"))||a.setype,r.data&&(r.data.cid=t.qid),"imageWithThumbnail"===r.component&&r.data){r.data.showRetry=!0;var p=this.data.get("commonData.tplInfo"),h=p.lid,f=p.srcid,g=p.tplname,m=p.order;r.data.source="",r.data.logExt={lid:h,srcid:f,tplname:g,order:m,sa:"re_bless_share"},r.data.downloadEnable=this.data.get("downloadEnable"),this.data.set("layoutReverse",!1),this.data.set("commonData.defaultInteractData.isShowReplace",!1)}"markdownEditor"===r.component&&r.data&&(r.data.noChangeNeedCheckRisk=!0,r.data.hasBorderLayer=!0);var v=this.data.get("latestRank"),y=this.data.get("rank");if(mk[r.component])v===y&&this.aiContainerPushBlock(e);else if(0!==Object.keys(r).length&&!i){var b,w=e.generator.sectionId;(null==e||null==(b=e.generator)?void 0:b.sectionId)||this.data.get("isSeparateBub")?w&&w===this.data.get("sectionId")&&this.data.get("pushedPackIndex")===this.data.get("cacheList.length")-1?this.aiContainerPushBlock(e):w&&this.separateBubble(e,n):this.aiContainerPushBlock(e)}},separateBubble:function(t,e){var n,a,i=this,o=t.generator.sectionId;this.data.set("isSeparateBub",!0);var r=this.data.get(),s=r.completedPackIndex,c=r.pushedPackIndex,l=r.cacheList;r.currentAnswerIndex,s>=c&&o!==(null==(a=l[s-1])||null==(n=a.generator)?void 0:n.sectionId)&&!this.data.get("inSeperating")&&this.setSeperateBubAndAddAnswer(e,t,o),!this.data.get("startWatchIndex")&&this.watch("completedPackIndex",(function(t){var e,n,a,o;if(i.data.set("startWatchIndex",!0),i.data.get("completedPack.isFinished")&&i.setSseStatus(vh.COMPLETE),!(i.data.get("lastCompletedPackIndex")>=t)){i.data.set("lastCompletedPackIndex",t);var r=i.data.get("cacheList"),s=null==(n=r[t-1])||null==(e=n.generator)?void 0:e.sectionId,c=null==(o=r[t])||null==(a=o.generator)?void 0:a.sectionId;s+1===c?i.setSeperateBubAndAddAnswer(i.data.get("currentIndex"),r[t],c):r[t]&&i.data.get("pushedPackIndex")<=t&&(s===c||!c)&&(i.addBottomArea(r[t],i.data.get("currentIndex"),i.data.get("currentAnswerIndex")),i.aiContainerPushBlock(r[t]))}}))},setSeperateBubAndAddAnswer:function(t,e,n){var a=this;this.data.set("sectionId",n),this.data.set("inSeperating",!0);var i=this.data.get("currentAnswerIndex");this.data.merge("answerList["+t+"]["+i+"]",{isLoading:!1,isStateBtnShow:!1}),this.aiContainerStop("separate-bub",""),this.data.set("answerList["+t+"]["+i+"].isFinished",!0),this.setSseStatus(vh.COMPLETE),this.appendAnswer(),this.nextTick((function(){var n,i,o,r;a.aiContainerGenerating(),a.addBottomArea(e,t,a.data.get("currentAnswerIndex")),a.aiContainerPushBlock(e),(null==(i=e.generator)||null==(n=i.interactiveArea)?void 0:n.isHideInteractiveArea)&&a.data.set("answerList["+a.data.get("currentIndex")+"]["+a.data.get("currentAnswerIndex")+"].hideInteract",!0),(null==(r=e.generator)||null==(o=r.data)?void 0:o.isHideStateBtn)&&a.data.set("answerList["+a.data.get("currentIndex")+"]["+a.data.get("currentAnswerIndex")+"].isStateBtnShow",!1),a.data.set("inSeperating",!1)}))},addBottomArea:function(t,e,n){t.suggestion;var a=t.generator,i=void 0===a?{}:a,o=t.alaCards,r=void 0===o?{}:o;if("reference"===i.component){var s,c=null==(s=i.data)?void 0:s.referenceList;c&&this.data.set("answerList["+e+"]["+n+"].referenceList",c)}if(i.interactiveArea||r.interactiveArea){var l,d=i.interactiveArea||r.interactiveArea,u=this.data.get("rank");d.dislikeOptions.text||d.dislikeOptions.alaCards;var p=this.currInteractData||this.data.get("commonData.defaultInteractData"),h={data:dk({},p,{praise:dk({},p.praise,{feLikeKey:d.feLikeKey,feDislikeKey:d.feDislikeKey,feLikeType:d.feLikeType,feedbackId:"ai_index_"+u,disable:d.likeDisable||(null==(l=p.praise)?void 0:l.disable)}),replaceText:d.replaceText||p.replaceText,replaceIcon:d.replaceIcon||p.replaceIcon,copyTxtDisable:!(d.isShowCopyTxt||!p.copyTxtDisable),swiperPosDisable:d.swiperPosDisable||p.swiperPosDisable,isShowReplace:d.isShowReplace||p.isShowReplace,isShowEditTxt:d.isShowEditTxt||p.isShowEditTxt,isShowCopy:!d.copyDisable&&(d.isShowCopy||p.isShowCopy),itemPosition:d.itemPosition||p.itemPosition,isShowTts:!d.ttsDisable&&(d.isShowTts||p.isShowTts),isShowDownload:d.isShowDownload||p.isShowDownload,downloadUrl:d.downloadUrl||p.downloadUrl})};this.data.get("answerList["+e+"]["+n+"]").isWritingScene&&(h.data.isShowEdit=!0,h.data.replaceIcon="rewrite",h.data.isShowReplace=!h.data.isShowEditTxt&&h.data.isShowReplace),this.data.set("swiperPosDisable",h.data.swiperPosDisable),this.data.get("resultIntentionType")===yk.PIC&&(h.data.isShowReplace=!1,h.data.isShowCopy=!1,h.data.isShowTts=!1),this.data.set("answerList["+e+"]["+n+"].interactData",h),this.currInteractData=h.data,(d.isShowPcInteract||d.isShowDownload)&&this.data.set("isShowPcInteract",!0),this.data.set("interactiveArea",d)}},onCompleteProcess:function(t,e,n){t.options;var a,i=this.data.get("currentIndex"),o=this.data.get("currentAnswerIndex"),r=this.data.get("answerList["+i+"]["+o+"].sseStatus");this.data.get("isSidebarUpdate")||ii(null==(a=this.data.get("baseData"))?void 0:a.query);r!==vh.ABORT&&(this.setSseStatus(e),this.data.get("answerList["+i+"]["+o+"].isFinished")&&this.completeHandle())},completeHandle:function(){var t,e=this,n=this.data.get("currentIndex"),a=this.data.get("currentAnswerIndex"),i=this.data.get("startGenerateTime"),o=this.data.get("answerList["+n+"]["+a+"].sseStatus");this.data.get("commonData.isAlaHat"),this.data.get("answerList["+n+"]["+a+"].isHint");var r=this.ref("ai-container-"+n+"-"+a);o!==vh.ABORT&&this.nextTick((function(){e.sseEnd()})),this.monitor.sendPerf(),!this.data.get("hasSendEnd")&&+i&&Aa({ubcId:"17630",type:"click",value:"content_create_end",ext:{re_rank:String(this.data.get("rank")),a_lid:this.data.get("baseData.apagelid"),lid:this.data.get("baseData.lid"),ori_lid:this.data.get("oriLid"),setype:"csaitab",starttime:String(i),endtime:String(Date.now()),duration:String(Date.now()-i),height:String(Math.floor((null==r||null==(t=r.el)?void 0:t.getBoundingClientRect().height)||0))}}),this.data.get("hasSendEnd")||this.data.get("feedbackFormData").title&&aa().emit({feedbackFormData:this.data.get("feedbackFormData"),rank:this.data.get("rank")}),Ls(),Cs(),this.data.set("hasSendEnd",!0)},sendFinishedToMain:function(){return lk((function(){var t,e,n,a,i;return pk(this,(function(o){return t=this,n=this.data.get("rank"),a=this.data.get("currentIndex"),this.data.get("currentAnswerIndex"),i=this.data.get("generateAnswer"),Nn().emit({rank:n,generateEle:this.el,isHistory:this.data.get("isHistory"),data:{functional:{},messages:i&&(null==(e=i[a])?void 0:e.data)||[]},api:{sendUbcLog:function(e){t.dispatch("send-ubclog",e)}}}),[2]}))})).apply(this)},onAbortProcess:function(t,e,n){var a,i,o,r,s,c=t.type,l=t.error,d=void 0===l?{}:l;t.errorStr={msg:null==(a=d.message)?void 0:a.toString(),stack:null==(i=d.stack)?void 0:i.toString()},null==(r=this.chatSearch)||null==(o=r.getEventBusInstance().conversation.abortProcess)||o.emit(),this.stopGenerate(!1,c),this.sendErrorToClient(c,null==(s=d.message)?void 0:s.toString())},stopGenerate:function(t,e){var n,a=this;void 0===e&&(e="");var i=this.data.get("currentIndex"),o=this.data.get("currentAnswerIndex"),r=this.data.get("abortText"),s=this.data.get("startGenerateTime"),c=this.data.get("answerList["+i+"]["+o+"].isHint"),l=this.data.get("answerList["+i+"]["+o+"].sseStatus"),d=this.data.get("answerList["+i+"]["+o+"].isComplete"),u=this.ref("ai-container-"+i+"-"+o),p=null==u?void 0:u.ref("searchingStep");if(l!==vh.ABORT&&!d){if(oi().emit({type:kp.SSE_STOP}),p&&Yn().emit((null==p||null==(n=p.el)?void 0:n.offsetHeight)||0),this.data.set("answerList["+i+"]["+o+"].sseStatus",vh.ABORT),this.data.set("answerList["+i+"]["+o+"].stateBtnType","retry"),this.dispatch("update-chat-status",Ei.ABORT),this.data.assign({sectionId:1,cacheList:[],pushedPackIndex:0,pushedPack:void 0,completedPackIndex:0,completedPack:void 0,lastCompletedPackIndex:0,isSeparateBub:!1}),"error"===e)return this.aiContainerStop("other",r.netError),this.monitor.setMonitorData("netError",1),void this.dispatch("send-ubclog",{type:"show",value:"cont_wrong",extra:{wrong_type:"网络异常"}});var h,f,g;if("userAbort"===e&&!c)return this.aiContainerStop("user-abort",r.userAbort),!this.data.get("hasSendEnd")&&+s&&Aa({ubcId:"17630",type:"click",value:"content_create_stop",ext:{re_rank:String(this.data.get("rank")),a_lid:this.data.get("baseData.apagelid"),lid:this.data.get("baseData.lid"),ori_lid:this.data.get("oriLid"),setype:"csaitab",starttime:String(s),endtime:String(Date.now()),duration:String(Date.now()-s),height:String(Math.floor((null==u||null==(h=u.el)?void 0:h.getBoundingClientRect().height)||0))}}),this.data.set("hasSendEnd",!0),this.cancelLastGeneration(),Cs(),void(null==(g=On().conversation.stopConversation)||g.emit({agentId:null==(f=this.data.get("agentInfo"))?void 0:f.agentId,sessionId:this.data.get("sessionId"),lid:this.data.get("baseData.lid")}));if("dangerCheckFail"!==e&&"isSeparateBub"!==e){var m=c?r.server:r.other;setTimeout((function(){a.aiContainerStop("other",m),sa().emit({isShowButton:!0})}),100)}}},sseEnd:function(){var t=this,e=this.data.get("currentIndex"),n=this.data.get("currentAnswerIndex"),a=this.data.get("commonData.isAlaHat"),i=this.data.get("isPc");if(this.data.get("answerList["+e+"]["+n+"].isHint")){var o=this.data.get("abortText");return this.aiContainerStop("hint",o.server),this.data.set("answerList["+e+"]["+n+"].stateBtnType","retry"),i&&Yn().emit(48),void(i&&this.data.get("clearHistoryMode")&&this.data.merge("answerList["+e+"]["+n+"]",{isStateBtnShow:!1}))}if(a){var r,s,c=(null==(r=this.ref("footer-wrap-"+e+"-"+n))?void 0:r.offsetHeight)||0;null==(s=Yn())||s.emit(c+30),this.data.set("answerList["+e+"]["+n+"].autoHeight",!0)}var l=this.data.get("answerList["+e+"]["+n+"].interactData")||{},d=this.data.get("commonData.defaultInteractData"),u=this.data.get("rank");l.data||this.data.set("answerList["+e+"]["+n+"].interactData",{data:dk({},d,{praise:dk({},d.praise,{feedbackId:"ai_index_"+u})})}),i&&sa().emit(!1),this.data.merge("answerList["+e+"]["+n+"]",{isLoading:!1,isStateBtnShow:!1});var p=this.data.get("agentInfo");p&&p.agentId&&this.updateAgentRankMax(p.agentId,u),this.handleAttachBtnShow(),this.nextTick((function(){2===t.data.get("commonData.chatSearch")&&t.sendFinishedToMain(),t.data.set("answerList["+e+"]["+n+"].isComplete",!0)}))},listenAgentTelHide:null,listenAdultCheckHide:null,handleAttachBtnShow:function(){var t=this,e=this.data.get("attachBtn"),n=this.data.get("commonData");if(e&&2===n.chatSearch)if("ai-tel"===e.type){e.oriLid=this.data.get("oriLid"),this.data.set("attachBtnShow",!0);var a=e.callback_info,i=new URL(a.callback_url);i.searchParams.append("token",a.token),i.searchParams.append("cuid",a.cuid),fetch(i.toString(),{method:"get",mode:"cors",credentials:"include"})}else if("agent-tel"===e.type){var o,r,s=this.data.get("agentInfo");null==(o=Zn())||o.emit({agentId:s.agentId}),Fi(Ui(),"13.54.5")>=0&&this.data.set("attachBtnShow",!0),this.listenAgentTelHide=function(e){if(e.agentId===s.agentId&&t.data.get("attachBtnShow")){var n=t.ref("attachBtn").offsetHeight;t.data.set("attachBtnShow",!1),t.nextTick((function(){Yn().emit(-1*n)}))}},null==(r=Zn())||r.on(this.listenAgentTelHide)}else if("adult-check"===e.type){var c;ta().emit(),this.data.set("attachBtnShow",!0),this.listenAdultCheckHide=function(){var e=t.ref("attachBtn").offsetHeight;t.data.set("attachBtnShow",!1),t.nextTick((function(){Yn().emit(-1*e)}))},null==(c=ta())||c.on(this.listenAdultCheckHide)}},updateAgentRankMax:function(t,e){(!this.agentRankMax.hasOwnProperty(t)||e>this.agentRankMax[t])&&(this.agentRankMax[t]=e)},updateAgentInfo:function(t){Je.dispatch("update",{agentInfo:dk({},Je.getState("agentInfo")||{},{agentParams:dk({actionLid:this.data.get("baseData").lid},t)})})},handleAgentTelLog:function(t){t&&(this.dispatch("send-ubclog",{type:"click",value:"ai_call"}),Ad(t))},onStateButtonClick:function(t){var e=t.state,n=void 0===e?"":e,a=t.isInteractClick,i=void 0!==a&&a,o=t.value,r=void 0===o?"":o;if(this.dataCache=void 0,"pc"===rt()){var s=this.data.get("logExtParams")||{},c="17630";"text"===s.scene&&"text_work"===s.scene_1st&&(c="17132"),Aa({ubcId:c,type:"click",value:i?r:"retry"===n?"rewrite":n,ext:dk({re_rank:String(this.data.get("rank")),a_lid:this.data.get("baseData.apagelid"),lid:this.data.get("baseData.lid"),ori_lid:this.data.get("oriLid"),setype:"csaitab"},s)})}!i&&n&&("retry"===n?(this.data.set("isRebuild",!0),this.retry()):(this.dispatch("dqa-steps-finished",!0),this.stopGenerate(!1,"userAbort")))},getSseRequestParams:function(t){void 0===t&&(t={});var e=this.data.get("baseData.chatFallbackReqBody"),n={};e&&(n=JSON.parse(e));var a=t.isRetry,i=t.isReplace;t.rebuildIndex;var o=t.blockCmpt,r=!(!a&&!i),s={message:{isRebuild:r,content:{agentInfo:{agent_id:this.data.get("agentId")||[]},extData:dk({},r?{aicc:""}:{})}}};return s.message.searchInfo=dk({chatParams:{chat_token:this.getToken()}},i?{lid:this.data.get("baseData.lid"),ori_lid:this.data.get("oriLid")}:{},{blockCmpt:o}),n=Ua(n,s)},cancelLastGeneration:function(){return lk((function(){var t;return pk(this,(function(e){return[2,cs({agentId:null==(t=this.data.get("agentInfo"))?void 0:t.agentId,sessionId:this.data.get("sessionId")||this.data.get("oriLid"),lid:this.data.get("baseData.lid")})]}))})).apply(this)},retry:function(){return lk((function(){var t,e,n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v;return pk(this,(function(y){switch(y.label){case 0:for(t=this,this.dispatch("update-chat-status",Ei.WAITING),this.dispatch("generate-retry"),this.monitor.setMonitorData("isRetry",!0),n=this.data.get("currentIndex"),a=this.data.get("currentAnswerIndex"),this.data.get("baseData"),this.data.set("answerList["+n+"]["+a+"].stateBtnType","stop"),i=a;i>0;i--)this.data.pop("answerList["+n+"]");return this.data.set("currentAnswerIndex",0),this.aiContainerClear(),this.updateNeedScroll(),this.clearAnswer(),this.sseDataCopy.clearSseData(),this.currInteractData=null,o=this.data.get("generateAnswer["+n+"].id"),r=this.data.get("rank"),s=Je.getState("imageQuery"),c="",l={},d={},u=Je.getState("blockCmptList")[this.data.get("oriLid")]||[],s&&s[r]?(p=s[r],h=p.imageInfo,f=p.rectIndex,g=p.rectList,m=p.imageUpload,c="SSE",m||(l={message:{query:bt({image_b64:h.imageB64,ext:dk({},h,{rectIndex:f,rectList:g,actionType:"CHANGE_QUESTION",viscate:"question"})},"IMAGE"),searchInfo:{lid:Je.getState("imageQueryLid")[r]}}})):(c="SSE",v={isRetry:!0,blockCmpt:u},l=this.getSseRequestParams(v)),l.message&&(l.message.searchInfo=l.message.searchInfo||{},l.message.searchInfo.chatParams=l.message.searchInfo.chatParams||{},l.message.searchInfo.chatParams.chat_token=this.getToken()),[4,this.cancelLastGeneration()];case 1:return y.sent(),null==(e=Kn())||e.emit({qid:r,aid:o,requestType:c,sseExtraData:l,extraData:d}),this.data.set("hasSendEnd",!1),this.nextTick((function(){t.aiContainerWaiting()})),[2]}}))})).apply(this)},clearAnswer:function(){var t=this.data.get("currentIndex"),e=this.data.get("currentAnswerIndex");this.data.set("answerList["+t+"]["+e+"]",{isLoading:!0,isStateBtnShow:!0,interactData:{},suggestionData:{data:{}},referenceList:[],sseStatus:void 0,stateBtnType:"stop",isGenerate:!0,generator:{},suggestion:{},antiFlag:!1,isFinished:!1,isHint:!1,isComplete:!1})},updateNeedScroll:function(){var t=this;this.nextTick((function(){var e;(e=t.el)&&e.getBoundingClientRect().top<0&&e.scrollIntoView&&e.scrollIntoView({block:"start",behavior:"smooth"})}))},getToken:function(){var t=this.data.get("baseData");return $r(t.connectPreQuery?t.connectPreQuery+" "+t.query:t.query)},handleSwiperChange:function(t){var e=(t||{}).index,n=void 0===e?0:e;this.dispatch("send-log",{type:"scroll",action:"slideslip",target:this.el});var a=this.data.get("answerList");this.data.set("currentIndex",n),this.data.set("currentAnswerIndex",a[n].length-1)},canAllowTouchMove:function(t){var e,n=null==t||null==(e=t.target)?void 0:e.closest(".cos-swiper"),a=this.data.get(),i=a.isAllowAction,o=a.disbaleTouchAction,r=a.commonData;if(n&&(null==r?void 0:r.isComposition)){var s,c;if(!(null==(c=t.target)||null==(s=c.classList)?void 0:s.contains("writing-one-more"))&&i&&!o)return void n.classList.remove("no-scroll");n.classList.add("no-scroll")}},setSeperateReplaceVisibility:function(t){void 0===t&&(t=!0),this.data.merge("seperateInteract.interactData",{isShowReplace:t})},handleInteractAction:function(){this.currInteractData=null,this.dispatch("update-chat-status",Ei.WAITING),this.data.get("isPc")?ti().emit({params:{location_id:"generate_"+this.data.get("rank"),function_type:"card_function_regenerate",location_type:"answer_card"}}):this.onReplace()},judgeLastAnswerHasComplete:function(){var t=this.data.get("answerList"),e=this.data.get("currentIndex"),n=this.data.get("currentAnswerIndex");return!t[e][n].isStateBtnShow},onAppend:function(){var t;this.setSeperateReplaceVisibility(!1),this.judgeLastAnswerHasComplete()?this.appendAnswer():(this.aiContainerClear(),this.clearAnswer());var e=this.data.get("rank");null==(t=Xn())||t.emit({qid:e,requestType:"SSE",sseExtraData:this.getSseRequestParams({isReplace:!0,rebuildIndex:++this.rebuildTimes})})},onReplace:function(t){var n=this;if(void 0===t&&(t=!1),this.data.get("answerList").length>=5){var a=this.data.get("replaceLimitText");return e.Toast.show({message:a}),void this.dispatch("send-ubclog",{type:"show",value:"generate_most"})}if(this.dispatch("generate-replace"),this.monitor.setMonitorData("isRetry",!0),this.sseDataCopy.clearSseData(),t){var i;this.aiContainerClear(),this.updateNeedScroll(),this.clearAnswer();var o=this.data.get("currentIndex"),r=this.data.get("generateAnswer["+o+"].id"),s=this.data.get("rank");null==(i=Kn())||i.emit({qid:s,aid:r,requestType:"SSE",sseExtraData:this.getSseRequestParams({isReplace:!0})})}else{var c,l=this.data.get("rank");null==(c=Xn())||c.emit({qid:l,requestType:"SSE",sseExtraData:this.getSseRequestParams({isReplace:!0})}),this.addAnswer(),setTimeout((function(){n.ref("swiper").scrollToIndex(n.data.get("currentIndex"),"auto"),n.updateNeedScroll()}),200)}this.nextTick((function(){n.aiContainerWaiting()}))},handleFallBackAskSend:function(){this.fallbackAskBackHasSend=!0},hideAiCallBtn:function(){var t=this.data.get("attachBtnShow"),e="ai-tel"===this.data.get("attachBtn.type");t&&e&&(this.data.set("attachBtnShow",!1),this.data.set("attachBtn",null))},handleContentFinished:function(){2===this.data.get("commonData.chatSearch")&&qn().emit()},disposed:function(){var t,e;(this.listenLongPressHandler&&ti().off(this.listenLongPressHandler),this.listenLongPressHandler=null,this.listenBeforeLaunchConversation&&(Hn().off(this.listenBeforeLaunchConversation),this.listenBeforeLaunchConversation=null),this.listenImageQuerySelectedChange&&($n().off(this.listenImageQuerySelectedChange),this.listenImageQuerySelectedChange=null),this.listenUserAbort&&(Fn().off(this.listenUserAbort),Jn().off(this.listenUserAbort),this.listenUserAbort=null),this.listenHideAiCallHistory&&(Qn().off(this.listenHideAiCallHistory),this.listenHideAiCallHistory=null),this.listenBubAsyncClick&&(On().conversation.asyncBubClick.off(this.listenBubAsyncClick),this.listenBubAsyncClick=null),this.listenDialogClick&&(On().conversation.dialogClick.off(this.listenDialogClick),this.listenDialogClick=null),this.listenAgentTelHide)&&(null==(t=Zn())||t.off(this.listenAgentTelHide),this.listenAgentTelHide=null);this.listenAdultCheckHide&&(null==(e=ta())||e.off(this.listenAdultCheckHide),this.listenAdultCheckHide=null)}}),kk={carousel:"carousel_wv73f_8"},Sk={},xk={bgHeader:"bg-header_1tkh5_1","bg-header":"bg-header_1tkh5_1",borderLayer:"border-layer_1tkh5_8","border-layer":"border-layer_1tkh5_8"},Ik={};Ik=Object.assign(Ik,{followQuestionRight:"follow-question-right_1v2p9_1","follow-question-right":"follow-question-right_1v2p9_1",hideItem:"hide-item_1v2p9_30","hide-item":"hide-item_1v2p9_30",contentBox:"content-box_1v2p9_34","content-box":"content-box_1v2p9_34",aladdin:"aladdin_1v2p9_45",chatQueryFadeOut:"chatQueryFadeOut_1v2p9_1",indicatorMargin:"indicator-margin_1v2p9_57","indicator-margin":"indicator-margin_1v2p9_57",containerNoPadding:"container-no-padding_1v2p9_60","container-no-padding":"container-no-padding_1v2p9_60",containerIndependenPadding:"container-independen-padding_1v2p9_64","container-independen-padding":"container-independen-padding_1v2p9_64",alaHat:"ala-hat_1v2p9_68","ala-hat":"ala-hat_1v2p9_68",itemAiContainer:"item-ai-container_1v2p9_82","item-ai-container":"item-ai-container_1v2p9_82",chatSearchAnswerShow:"chatSearchAnswerShow_1v2p9_1",containerBorderActive:"container-border-active_1v2p9_85","container-border-active":"container-border-active_1v2p9_85",attachBtn:"attach-btn_1v2p9_92","attach-btn":"attach-btn_1v2p9_92",adultBtnWrapper:"adult-btn-wrapper_1v2p9_95","adult-btn-wrapper":"adult-btn-wrapper_1v2p9_95"}),_k.template='\n    <div class="\n        chat-search-answer-generate\n        {{isBless ? \'theme-custome-container\' : \'\'}}\n    "\n        style="{{isBless ? themeColorStyle : \'\'}}"\n        data-share="{{shareParams}}"\n        data-delete="{{deleteParams}}"\n    >\n        <cos-swiper\n            styles="{{$swiper}}"\n            style="--indicator-color: {{commonData.indicatorColor}};"\n            s-ref="swiper"\n            type="page"\n            snap-align="center"\n            snap-stop="always"\n            on-change="handleSwiperChange"\n            on-scroll="native:canAllowTouchMove"\n            on-touchmove="native:canAllowTouchMove"\n            indicator="{{commonData.isComposition && !hideSwiperIndicator ? \'center\' : \'\'}}"\n            class="{{commonData.isComposition ? (isAllowAction && !disbaleTouchAction ? \'\' : \'no-scroll\') : \'\'}}"\n        >\n            <cos-swiper-item\n                styles="{{$swiperItem}}"\n                s-for="answer, index in answerList"\n                s-ref="{{\'swiperItem-\' + index}}"\n                width="100%"\n                class="{{index !== currentIndex ? $style[\'hide-item\'] : \'\'}} generate-swiper-item"\n            >\n                \x3c!-- content --\x3e\n                <div\n                    s-ref="{{\'container-\' + index}}"\n                    class="cs-answer-container {{$style[\'item-container\']}}"\n                    data-status="{{\n                        answerList[currentIndex]\n                        && answerList[currentIndex][currentAnswerIndex]\n                        && answerList[currentIndex][currentAnswerIndex].isFinished ? \'COMPLETE\' : \'GENERATING\'\n                    }}"\n                >\n                    <div class="chat-search-answer-generate-item" s-for="currentAnswer, currentAnswerIndex in answer" bubble-rank="{{currentAnswerIndex}}">\n                        \x3c!-- 简搜和A页使用画布组件 --\x3e\n                        \x3c!-- 祝福语背景图会被识别导致弹窗错误，前端暂时屏蔽，后续考虑组件侧优化 --\x3e\n                        <c-ai-container\n                            s-ref="{{\'ai-container-\' + index + \'-\' + currentAnswerIndex}}"\n                            common-data="{{commonData}}"\n                            bg-props="{{currentAnswer.bgProps || commonData.bgProps}}"\n                            agentInfo="{{agentInfo}}"\n                            blocks="{{currentAnswer.blocks}}"\n                            auto-height="{{currentAnswer.autoHeight}}"\n                            tplInfo="{{tplInfo}}"\n                            is-generate="{{currentAnswer.isGenerate}}"\n                            index="{{index}}"\n                            current-index="{{currentIndex}}"\n                            theme="{{commonData.theme}}"\n                            typing-speed="{{typingSpeed}}"\n                            chat-info="{{chatInfo}}"\n                            cid="{{cids[index][currentAnswerIndex]}}"\n                            intention-type="{{resultIntentionType}}"\n                            intention-type-map="{{resultIntentionTypeMap}}"\n                            authorityInfo="{{authorityInfo}}"\n                            agentId="{{agentId}}"\n                            question="{{question}}"\n                            rank="{{rank}}"\n                            answer-index="{{currentAnswerIndex}}"\n                            searching-steps-data="{{searchingStepsData}}"\n                            log-ext-data="{{logExtData}}"\n                            sse-status="{{currentAnswer.sseStatus}}"\n                            class="\n                            {{\n                                answerList.length > 1 && (currentAnswerIndex === answer.length - 1)\n                                ? $style[\'indicator-margin\']\n                                : \'\'\n                            }}\n                            {{commonData.isAlaHat ? $style[\'ala-hat\'] : \'\'}}\n                            {{borderActiveIndex === currentAnswerIndex ? $style[\'container-border-active\'] : \'\'}}\n                            {{$style[\'item-ai-container\']}}\n                            "\n                            on-render-finished="onRenderFinished"\n                            on-empty="onEmpty"\n                            ori-lid="{{oriLid}}"\n                            log-ext-params="{{logExtParams}}"\n                            ask-used-model="{{askUsedModel}}"\n                        >\n                            \x3c!-- 头部 --\x3e\n                            <header\n                                slot="header"\n                                is-show-pos="{{!swiperPosDisable && answerList.length > 1}}"\n                                current-index="{{index + 1}}"\n                                length="{{answerList.length}}"\n                                rank="{{rank}}"\n                                is-history="{{isHistory}}"\n                            ></header>\n\n                            \x3c!-- 底部区域 --\x3e\n                            <div\n                                slot="footer"\n                                s-show="{{!isExtension && !hideFooter}}"\n                                s-ref="{{\'footer-wrap-\' + index + \'-\' + currentAnswerIndex}}"\n                                data-ucfg="{{commonData.dataUcfg}}"\n                                style="width: 100%"\n                            >\n                                <footer\n                                    s-ref="{{\'footer-\' + currentAnswerIndex}}"\n                                    is-show-reference="{{\n                                        currentAnswer.referenceList\n                                        && currentAnswer.referenceList.length\n                                        && !currentAnswer.isLoading\n                                        && (!commonData.isAlaHat || commonData.isComposition)\n                                    }}"\n                                    is-chat-search="{{commonData.isChatSearch}}"\n                                    refer-list="{{currentAnswer.referenceList}}"\n                                    is-show-interact="{{\n                                        currentAnswer.interactData\n                                        && !currentAnswer.isLoading\n                                        && (!commonData.isAlaHat || commonData.isComposition)\n                                        && !currentAnswer.hideInteract\n                                        && (!isPc || isShowPcInteract)\n                                    }}"\n                                    interact-data="{{currentAnswer.interactData && currentAnswer.interactData.data}}"\n                                    get-copy-target="{{getCopyTarget}}"\n                                    tts-text="{{ttsTextList && ttsTextList[index] && ttsTextList[index][currentAnswerIndex]}}"\n                                    agent-info="{{agentInfo}}"\n                                    is-need-tts-animation="{{isNeedTtsAnimation}}"\n                                    replace-gray="{{answerList.length === 5 && commonData.isComposition}}"\n                                    graph-creation-log="{{graphCreationLog}}"\n                                    is-show-button="{{currentAnswer.isStateBtnShow && !hideStateButton}}"\n                                    btn-state="{{currentAnswer.stateBtnType}}"\n                                    theme="{{commonData.theme}}"\n                                    setype="{{commonData.chatParams && commonData.chatParams.setype}}"\n                                    fallback-ask-show="{{currentAnswer.fallbackAskShow}}"\n                                    is-bless="{{isBless}}"\n                                    is-pc="{{isPc}}"\n                                    rank="{{rank}}"\n                                    layout-reverse="{{layoutReverse}}"\n                                    is-need-tts-animation="{{isNeedTtsAnimation}}"\n                                    cid="{{cids[index][currentAnswerIndex]}}"\n                                    log-ext-data="{{logExtData}}"\n                                    on-replace="handleInteractAction"\n                                    on-button-click="onStateButtonClick"\n                                    on-edit-click="onEditClick(index, currentAnswerIndex)"\n                                    tplInfo="{{commonData.tplInfo}}"\n                                    log-ext-params="{{logExtParams}}"\n                                ></footer>\n                            </div>\n                        </c-ai-container>\n\n                        \x3c!-- 风控场景 --\x3e\n                        <notic-bar\n                            s-if="commonData.isChatSearch && hasHitNotice"\n                            notice-text="{{noticeText}}"\n                        />\n                        \x3c!-- pc hover菜单 --\x3e\n                        <hover-menu\n                            s-if="isPc"\n                            s-ref="{{\'menu-\' + currentAnswerIndex}}"\n                            rank="{{rank}}"\n                            latest-rank="{{latestRank}}"\n                            type="generate"\n                            current-answer-index="{{currentAnswerIndex}}"\n                            get-copy-target="{{getCopyTarget}}"\n                            status="{{\n                                answerList[currentIndex]\n                                && answerList[currentIndex][currentAnswerIndex]\n                                && answerList[currentIndex][currentAnswerIndex].isFinished ? \'COMPLETE\' : \'GENERATING\'\n                            }}"\n                        />\n                    </div>\n                </div>\n            </cos-swiper-item>\n        </cos-swiper>\n        \x3c!-- 三合互动&&存在agent或AI助手的电话信息 --\x3e\n        <div class="{{$style[\'attach-btn\']}} {{isRight ? $style[\'follow-question-right\'] : \'\'}}" s-ref="attachBtn">\n            <div s-if="attachBtnShow" class="{{$style[\'adult-btn-wrapper\']}}">\n                <div\n                    s-is="attachBtn.type"\n                    s-bind="attachBtn"\n                    rank="{{rank}}"\n                >\n                </div>\n            </div>\n        </div>\n        \x3c!-- 点踩 弹窗 --\x3e\n        <wd-feedback-pop\n            id="{{\'ai_index_\' + rank}}"\n            color="{{commonData.defaultInteractData.praise.color}}"\n            feedback-show-input="{{isAnnotation}}"\n            feedback-custom-theme="{{commonData.chatParams && commonData.chatParams.setype === \'sge_spring\'}}"\n            is-data-fly-wheel="{{isDataFlyWheel}}"\n            use-card-send-log="{{true}}"\n        />\n        \x3c!-- 长按菜单语音播报功能，仅播报不展现 --\x3e\n        <wd-tts-player\n            s-show="false"\n            text="{{longPressTtsText}}"\n            s-ref="ttsPlayer"\n            tts-api-from="csaitab"\n        />\n        <dialog-pop\n            id="{{\'ai_index_\' + rank}}"\n        />\n    </div>\n';var Tk="function"==typeof _k?_k.prototype.initData||Ck:_k.initData||Ck;function Ck(){return{$style:Ik,$swiper:kk,$swiperItem:Sk,$aladdin:xk}}function Lk(){return Object.assign({},Tk.call(this),{$style:Ik,$swiper:kk,$swiperItem:Sk,$aladdin:xk})}function Pk(){return Pk=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pk.apply(this,Array.from(arguments))}"function"==typeof _k?_k.prototype.initData=Lk:_k.initData=Lk;var Dk=function(){function t(t){this.currentIndex=0,this.steps=[],this.enableFinish=!0,this.firstInLastStep=!0,this.duration=1600,this.reflex=t}var e=t.prototype;return e.setDuration=function(t){t&&(this.duration=t)},e.pushData=function(t){if(t){var e=t.currentIndex,n=t.steps,a=void 0===n?[]:n,i=a.length||this.steps.length||1;e<this.currentIndex||(this.currentIndex=e,this.steps=a.length?a:this.steps,e>=i?(this.currentIndex=999,this.validStepsOver({steps:this.steps,currentIndex:999})):e===i-1?this.handleLastStep(t):e===i-2?this.handleSecondStep(t):this.reflex(t))}},e.handleSecondStep=function(t){var e=this;this.reflex(t),this.second2LastTimer||(this.second2LastTimer=setTimeout((function(){e.pushData(Pk({},t,{currentIndex:t.currentIndex+1}))}),this.duration))},e.handleLastStep=function(t){var e=this;this.second2LastTimer&&clearTimeout(this.second2LastTimer),this.reflex(t),this.firstInLastStep&&(this.firstInLastStep=!1,this.enableFinish=!1,this.lastTimer=setTimeout((function(){e.enableFinish=!0,e.validStepsOver(t)}),400))},e.validStepsOver=function(t){this.enableFinish&&999===this.currentIndex&&this.reflex(Pk({},t,{currentIndex:this.currentIndex}))},e.resetState=function(){this.second2LastTimer&&clearTimeout(this.second2LastTimer),this.second2LastTimer=null,this.lastTimer&&clearTimeout(this.lastTimer),this.lastTimer=null,this.currentIndex=0,this.steps=[],this.enableFinish=!0,this.firstInLastStep=!0},t}();function Ak(){return Ak=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ak.apply(this,Array.from(arguments))}var Ek={praise:{feLikeKey:"mockkey",feDislikeKey:"mockkey",feLikeType:"mock",feedbackContentList:[["答非所问","回答有误"],["信息过时","没有帮助"],["存在偏见","内容违法"]],feedbackTitle:"请选择遇到的问题",likeTxtDisable:!0,word:"",feedbackId:"ai_index_",feedbackCustom:!0,isGenPc:!0,showDivider:!0},isChatSearch:!0,isShowCopy:!1,isShowReplace:!1,isShowTts:!0,replaceText:"",replaceIcon:"exchange",commentDisable:!0,useCardSendLog:!0,useWiseStyle:!0,copyTxtDisable:!0,isShowEditTxt:!1,tplInfo:{},hudongTtsUrl:"",ttsApiFrom:"csaitab"},Ok=a.defineComponent({messages:{"send-log":function(t){this.sendLog(t.value)},"send-ubclog":function(t){this.sendUbcLog(t.value)},"send-broadcast-ubclog":function(t){this.sendUbcLog(Ak({ubcId:"17630",page:"broadcast"},t.value))},"image-query-tab:show-log":function(t){this.sendUbcLog(Ak({},t.value))},"image-query-tab:click-log":function(t){this.sendUbcLog(Ak({},t.value))},"cid-update":function(t){var e=null==t?void 0:t.value,n=e.index,a=void 0===n?0:n,i=e.cid,o=void 0===i?"":i,r=e.answerIndex,s=void 0===r?0:r,c=this.data.get("cids");c[a]||(c[a]=[]),c[a][s]=o,this.data.set("cids["+a+"]["+s+"]",o)},"update-log-ext":function(t){var e=null==t?void 0:t.value;if(e){var n=this.data.get("logExtData");this.data.set("logExtData",Ak({},n,e))}},"dqa-steps-finished":function(t){this.searchingStepsFinished(null==t?void 0:t.value)}},components:{generate:_k},initData:function(){return{data:{answerList:[],commonData:{defaultInteractData:Ek,indicatorColor:"#6e4bfaff",chatSearch:2,isChatSearch:!0,chatParams:{},isAndroid:Ga,isIOS:Wa,isBaiduApp:!0,ubcPublic:"",isSkeletonShow:!1,isStateBtnShow:!0,isAlaHat:!1,sseQuery:"",isComposition:!1,bgProps:{image:""},tplInfo:{srcid:"52567",order:-1,lid:"",tplname:"nonala_chat",query:""},editorParams:{riskcheckApi:"",chatParams:{},isBaiduMainApp:!0,isLogin:!0,extLogParams:{}}}},cids:[[]],generateAnswer:[],dangerCheckTime:0,rank:1,baseData:{},latestRank:1,preChatParms:{},startTime:0,logExtData:{},searchingStepsData:{},overviewBlockFirstTokenDur:0,askUsedModel:{}}},computed:{"data.commonData.tplInfo.lid":function(){return this.data.get("baseData.lid")},"data.commonData.tplInfo.query":function(){return this.data.get("baseData.query")},"data.commonData.chatParams":function(){return this.data.get("baseData.chatParams")},"data.commonData.riskcheckApi":function(){return this.data.get("baseData.riskcheckApi")},"data.commonData.editorParams.riskcheckApi":function(){return this.data.get("baseData.riskcheckApi")},"data.commonData.editorParams.chatParams":function(){return this.data.get("baseData.chatParams")},"data.commonData.isComposition":function(){return"1"===this.data.get("baseData.chatParams.isComposition")},"data.commonData.defaultInteractData.isShowCopy":function(){return"1"===this.data.get("baseData.chatParams.isComposition")},"data.commonData.defaultInteractData.isShowReplace":function(){return"1"===this.data.get("baseData.chatParams.isComposition")},"data.commonData.isAlaHat":function(){return this.data.get("baseData.chatParams.is_ala_hat")},"data.commonData.defaultInteractData.praise.word":function(){return this.data.get("baseData.query")}},attached:function(){var t=this;this.linkClickListen(),this.searchingStepsHandle=new Dk(this.searchingStepsDataChange.bind(this)),fh.listen((function(e){e.rank===t.data.get("rank")&&(e.isAgent&&t.searchingStepsHandle.setDuration(1e4),t.searchingStepsHandle.pushData(e.data))}))},linkClickListen:function(){var t,e=this,n=null==(t=this.ref("generate"))?void 0:t.el;null==n||n.addEventListener("click",(function(t){"span"===t.target.tagName.toLowerCase()&&t.target.closest("a")&&e.sendLog({xpath:"a(wz_link)",extra:{info:t.target.innerText},type:"l"})}))},sendLog:function(t){var e,n=this.ref("generate"),a=(null==n?void 0:n.data.get("currentIndex"))||0,i=(null==n?void 0:n.data.get("currentAnswerIndex"))||0,o=this.data.get("data.commonData"),r=o.tplInfo,s=void 0===r?{}:r,c=o.chatParams,l=void 0===c?{}:c,d=s.lid,u=this.data.get("oriLid"),p=this.data.get("rank"),h=this.data.get("conversationLogId")||"",f=l.setype,g=void 0===f?"csaitab":f,m=this.data.get("logExtData")||{},v=this.data.get("cids")||[];t.extra||(t.extra={}),t.extra.lid=d,t.extra.ori_lid=u,t.extra.re_rank=p.toString(),t.extra.ctse_id=h,t.extra.setype=g,t.extra.cid=(null==v||null==(e=v[a])?void 0:e[i])||"",Object.assign(t.extra,m);var y=Ak({},t,{extra:t.extra,ori_lid:u,index:a+1});delete y.target,ld(y,s,t.target)},sendUbcLog:function(t){var e=this;if(t){var n="stop"===t.value?5e3:0;setTimeout((function(){var n=t.type,a=void 0===n?"show":n,i=t.value,o=void 0===i?"":i,r=t.extra,s=void 0===r?{}:r,c=e.ref("generate"),l=((null==c?void 0:c.data.get("currentIndex"))||0)+1,d=e.data.get("data.commonData"),u=d.tplInfo,p=void 0===u?{}:u,h=d.chatParams,f=void 0===h?{}:h,g=p.lid,m=e.data.get("commonData.isComposition"),v=e.data.get("oriLid"),y=e.data.get("rank"),b=e.data.get("conversationLogId")||"",w=f.setype,_=void 0===w?"csaitab":w,k=(null==c?void 0:c.data.get("logExtData"))||{},S=k.scene,x=void 0===S?"":S,I=k.scene_1st,T=void 0===I?"":I,C=k.scene_2nd,L=void 0===C?"":C,P=(null==c?void 0:c.data.get("agentInfo"))||{},D={};if(m){var A=e.data.get("baseData.chatParams.generateInfo");D={artlen:A.artlen,arttype:A.arttype,contype:A.contype,iscreate:A.iscreate}}var E={a_lid:Je.getState("apagelid")};Aa({ubcId:t.ubcId,page:t.page,type:a,value:o,source:"active",ext:Ak({ctse_id:b,lid:g,ori_lid:v,re_rank:y.toString(),setype:_,scene:x,scene_1st:T,scene_2nd:L,index:l,agent_name:P.agentName,agent_id:P.agentSearchId},e.data.get("data.commonData.ubcPublic"),s,D,E)},p)}),n)}},sendLoadingLog:function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=Je.getState("agentInfo")||{},a=n.agentSearchId,i=n.agentName,o=a?"agent-loading":"loading";this.sendUbcLog(Ak({value:o,extra:Ak({agent_id:a,agent_name:i},e)},t))},searchingStepsDataChange:function(t){var e,n=this,a=t||{},i=a.currentIndex,o=a.steps;if(999===i)return this.nextTick((function(){n.searchingStepsFinished(!1)}));this.dispatch("update-generate-status",{status:String(i),title:null==o||null==(e=o[i])?void 0:e.title}),this.data.set("searchingStepsData.currentIndex",i),this.data.set("searchingStepsData.steps",o),this.dispatch("toggle-searching-steps-promise",{isClear:!1,promise:new Promise((function(t){gh.push(t)}))})},searchingStepsFinished:function(t){var e,n,a=this;gh.resolveAll(t),null==(e=this.searchingStepsHandle)||e.resetState(),this.data.set("searchingStepsData",{currentIndex:0,steps:[]}),Promise.resolve().then((function(){a.dispatch("toggle-searching-steps-promise",{isClear:!0})})),null==(n=Yn())||n.emit(65)}});Ok.template='\n    <generate\n        s-ref="generate"\n        s-bind="{{data}}"\n        generate-answer="{{generateAnswer}}"\n        question="{{question}}"\n        danger-check-time="{{dangerCheckTime}}"\n        start-time="{{startTime}}"\n        rank="{{rank}}"\n        oriLid="{{oriLid}}"\n        base-data="{{baseData}}"\n        searching-steps-data="{{searchingStepsData}}"\n        latest-rank="{{latestRank}}"\n        pre-chat-parms="{{preChatParms}}"\n        is-history="{{isHistory}}"\n        conversation-log-id="{{conversationLogId}}"\n        log-ext-data="{{logExtData}}"\n        overview-block-first-token-dur="{{overviewBlockFirstTokenDur}}"\n        ask-used-model="{{askUsedModel}}"\n    />\n';var Rk=St.connect(Je,{loadingParams:"loadingParams"})(a.defineComponent({template:'\n    <div>\n        <div s-if="status === \'IDLE\'" class="cs-loading">\n            <div class="cs-loading-skeleton">\n                <div class="cs-loading-skeleton-contain">\n                    <div class="cs-loading-icon">\n                        <img class="cs-loading-icon-ani" src="{{loadingParams.backgroundImg}}"/>\n                    </div>\n                    <div class="cs-loading-tips">{{loadingParams.text}}</div>\n                    <div class="cs-loading-skeleton-index cs-loading-skeleton-loader-1">\n                        <div class="loading-bar"></div>\n                    </div>\n                    <div class="cs-loading-skeleton-index cs-loading-skeleton-loader-2">\n                        <div class="loading-bar"></div>\n                    </div>\n                    <div class="cs-loading-skeleton-index cs-loading-skeleton-loader-3">\n                        <div class="loading-bar"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- 只有异常情况才展示，当用户主动取消，也就是abortType !== \'userAbort\'的时候不展示。 --\x3e\n        <div s-else-if="status === \'ABORT\' && abortType !== \'userAbort\'" class="cs-error">\n            <div class="cs-error-wrap-text">😫 抱歉，出了点小问题，请稍后重试</div>\n            <div class="cs-error-wrap-btn">\n                <i class="refresh-icon cu-icon">&#xe788;</i>\n                <span>重新回答</span>\n            </div>\n        </div>\n    </div>\n    ',components:{},initData:function(){return{status:"IDLE",abortType:""}}}));function Nk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function qk(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Mk(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){qk(o,a,i,r,s,"next",t)}function s(t){qk(o,a,i,r,s,"throw",t)}r(void 0)}))}}function jk(){return jk=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},jk.apply(this,Array.from(arguments))}function Bk(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Nk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nk(t,e):void 0}}(t))||e){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hk(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var $k=St.connect(Je,{user:"user",query:"query",oriLid:"oriLid",chatParams:"chatParams",conversationLogId:"conversationLogId",latestRank:"curRankInfo.rank",preChatParms:"preChatParms",modelList:"modelList",qaPairIdDiff:"qaPairIdDiff"})(a.defineComponent({template:'\n    <div class="{{isHistory ? \'history-answer-box\' : \'answer-box\'}}\n            {{!chatGenerate || addHistoryCardMarginTop ? \'answer-generate-none\' : \'\'}}\n            {{showNoResult ? \'no-result-show\' : \'\'}}\n            {{isPc && !hideExtraBottom && !isHistory && latestRank === currentRank ? \'last-answer-box\' : \'\'}}"\n        data-click-log="{{baseClickLogStr}}"\n        data-time-log="{{baseTimeLogStr}}"\n        data-show-log="{{baseShowLogStr}}"\n        data-base-data="{{baseDataStr}}"\n    >\n        <answer-history\n            s-if="isHistory"\n            rank="{{currentRank}}"\n            question="{{question}}"\n            blocksList="{{answer.blocksList}}"\n            hints="{{answer.hints}}"\n            isSeparateBub="{{answer.isSeparateBub}}"\n            independenBlocks="{{answer.independenBlocks}}"\n            shareParams="{{answer.shareParams}}"\n            deleteParams="{{answer.deleteParams}}"\n            aiEntryStyle="{{answer.aiEntryStyle}}"\n            initShowHistory="{{answer.initShowHistory}}"\n            isAiCall="{{answer.isAiCall}}"\n            tplInfo="{{tplInfo}}"\n        />\n        <answer-generate\n            s-elif="chatGenerate && answer.length > 0"\n            s-ref="answer-generate"\n            generate-answer="{{generateSection.answer}}"\n            danger-check-time="{{dangerCheckTime}}"\n            rank="{{currentRank}}"\n            question="{{question}}"\n            start-time="{{startTime}}"\n            ori-lid="{{oriLid}}"\n            base-data="{{baseData}}"\n            conversation-log-id="{{curConversationLogId}}"\n            latest-rank="{{latestRank}}"\n            pre-chat-parms="{{preChatParms}}"\n            is-history="{{isHistory}}"\n            image-query-lid="{{imageQueryLid}}"\n            sample="{{sample}}"\n            overview-block-first-token-dur="{{overviewBlockFirstTokenDur}}"\n            ask-used-model="{{requestParams.message.searchInfo.usedModel}}"\n            class="{{isFirstRankHideQuery ? \'answer-generator-hide-query\' : \'\'}}"\n        />\n\n        \x3c!--bca-disable--\x3e\n        <div\n            s-if="(cardSection && cardSection.show) || isHistory"\n            class="answer-search\n                {{cardSection.data ? \'answer-search-box\' : \'\'}}\n                {{isHistory && (!answer.blocksList || !answer.blocksList.length) ? \'answer-search-no-generate\' : \'\'}}\n            "\n            s-ref="htmlDom"\n        >\n            <template s-if="!isPc">{{answer.cardHtml | raw}}</template>\n        </div>\n        \x3c!--bca-enable--\x3e\n\n        \x3c!--人脉卡--\x3e\n        <answer-recommend\n            s-if="{{agentRecommendList}}"\n            s-ref="answer-recommend"\n            typing-end="{{typingEnd}}"\n            agent-recommend-list="{{agentRecommendList}}"\n            generate-answer="{{generateSection.answer}}"\n            question="{{question}}"\n            is-history="{{isHistory}}"\n        />\n        <feedback-form\n            s-if="feedbackForm.showCard && typingEnd"\n            feedbackFormData="{{feedbackForm.feedbackFormData}}"\n            product="{{feedbackForm.productData}}"\n            on-closeCard="closeCard"\n        />\n        <chat-guide\n            s-if="askSection.show && currentRank === 1 && hitGuideDown"\n            guide-word="{{guideWord}}"\n            agent-list="{{agentList}}"\n            hit-guide-down="{{true}}"\n        />\n        \x3c!-- 引导提醒组件 --\x3e\n        <answer-tips\n            rank="{{currentRank}}"\n            latest-rank="{{latestRank}}"\n        />\n        <answer-ask\n            s-if="askSection.show"\n            rank="{{currentRank}}"\n            base-data="{{baseData}}"\n            latest-rank="{{latestRank}}"\n            cur-agent-info="{{curAgentInfo}}"\n        />\n         \x3c!-- 胶囊气泡，仅端内互动出 --\x3e\n        <capsules\n            s-if="!isPc\n                && showCapsule\n                && haveCapsuleData\n                && !isDeepSeekPage\n                && !haveMultiModel\n            "\n            s-bind="{{shortcutsData}}"\n            base-data="{{baseData}}"\n            tplInfo="{{tplInfo}}"\n        />\n        <no-result s-if="showNoResult" />\n        <chat-danger query-is-danger="{{queryIsDanger}}" rank="{{currentRank}}" />\n    </div>',components:{"chat-loading":Rk,"chat-danger":xi,"answer-generate":Ok,"answer-ask":aw,"answer-history":Vb,"no-result":bh,"chat-guide":qu,"feedback-form":cw,capsules:pu,"answer-recommend":Hp,"answer-tips":sh},initData:function(){var t,e;return{answer:[{answer:{answerData:[],status:"IDLE"}}],question:{question:""},currentRank:0,isHistory:!1,perfInfo:{},baseData:{lid:"",chatGenerate:!0,chatFallbackReqBody:"",chatParams:{setype:"csaitab"},chatSearch:2,riskcheckApi:"",longword:"",queryIsDanger:0,promKey:"",logCommonInfo:{},sample:Je.getState("sample"),user:{isUserLogin:0},query:""},searchingStepsPackOver:!0,searchingStepsPackOverTimeStart:0,overviewBlockFirstTokenDur:0,generateSection:{need:!1,answer:[]},cardSection:{show:!1,data:""},askSection:{show:!1},baseClickLog:{lid:"",extra:{lid:"",re_rank:"1",ori_lid:"",cid:""}},baseTimeLog:{},playClickLog:{ala_clk:"ai_index_1_0_10_o",order:1,clk_info:{srcid:"52567",tplname:"ai_index",type:"b",action:"play",index:1}},requestUrl:"",requestParams:{},abortType:"",showNoResult:!1,existAnswer:!1,rebuildMode:Bt.REBUILD,hasSendPageComplete:{perf:!1,invoke:!1},requestStart:0,requestEnd:0,agentInfo:null,chatGenerate:!0,queryIsDanger:0,startTime:0,severPerfInfo:{},hideAlaCard:!1,guideWord:Je.getState("guideWord"),agentList:Je.getState("agentList"),hitGuideDown:!1,searchingStepsPromise:null,curConversationLogId:"",isPc:"pc"===rt(),hideExtraBottom:!1,hasStartBottomAlign:!1,closeBottomAlign:!1,feedbackForm:{showCard:!1,feedbackFormData:{},productData:{},recommendWordList:[]},typingEnd:!1,sceneLogExt:{scene:"",scene_1st:"",scene_2nd:""},shortcutsData:{},showCapsule:!1,curAgentInfo:{},agentRecommendList:null,isAiCall:!1,separateBub:!1,stopNotAbortSse:!1,upWard:!1,isBtmAlignSample:"1"===(null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.CHANGE_BOTTOM_ALIGN)||"pc"===rt()||ct(),observer:null,isDeepSeekPage:ct()}},computed:{haveMultiModel:function(){var t=this.data.get("modelList");return Array.isArray(t)&&t.length>0},haveCapsuleData:function(){var t=this.data.get("shortcutsData")||{capsuleData:[]},e=(null==t?void 0:t.capsuleData)||[];return Array.isArray(e)&&e.length>0},baseDataStr:function(){return JSON.stringify(this.data.get("baseData"))},baseClickLogStr:function(){var t=this.data.get("baseClickLog"),e=this.data.get("sceneLogExt"),n=jk({},t,{extra:jk({},t.extra,{scene:null==e?void 0:e.scene,scene_1st:null==e?void 0:e.scene_1st,scene_2nd:null==e?void 0:e.scene_2nd})});return JSON.stringify(n)},baseTimeLogStr:function(){return JSON.stringify(this.data.get("baseTimeLog"))},baseShowLogStr:function(){var t=this.data.get("sceneLogExt"),e=Je.getState("agentInfo");if(this.data.get("isHistory")){var n,a=this.data.get("answer.blocksList");e=null==(n=(a&&a[0]?a[0]:[])[0])?void 0:n.agentInfo}var i={agent_id:null==e?void 0:e.agentSearchId,agent_name:null==e?void 0:e.agentName,scene:null==t?void 0:t.scene,scene_1st:null==t?void 0:t.scene_1st,scene_2nd:null==t?void 0:t.scene_2nd};return JSON.stringify(i)},playClickLogStr:function(){return JSON.stringify(this.data.get("playClickLog"))},dangerCheckTime:function(){return this.data.get("perfInfo.dangerCheck.duration")},addHistoryCardMarginTop:function(){var t,e=this.data.get("isHistory"),n=this.data.get("answer");return e&&!(null==n||null==(t=n.blocksList)?void 0:t.length)},tplInfo:function(){var t=this.data.get("baseData");return{srcid:"52567",order:-1,lid:t.lid,tplname:"nonala_chat",query:t.query}},isFirstRankHideQuery:function(){return Je.getState("firstRankHideQuery")},currentRank:function(){var t=this.data.get("qaPairIdDiff");return this.data.get("qaPairId")+t}},messages:{"add-answer":function(){this.data.set("separateBub",!1)},"component-show":function(t){var e=Je.getState("oriLid"),n=Je.getState("blockCmptList"),a=n[e],i=t.value.name;a&&!a.includes(i)?a.push(i):n[e]=[i],Je.dispatch("update",{blockCmptList:n})},"update-perf-info":function(t){this.data.merge("severPerfInfo",t.value)},"generate-start":function(t){this.data.merge("severPerfInfo",t.value)},"hide-ala-card":function(){this.data.set("hideAlaCard",!0)},"toggle-searching-steps-promise":function(t){t.value.isClear?this.data.set("searchingStepsPromise",null):this.data.set("searchingStepsPromise",t.value.promise)},"generate-retry":function(){this.data.get("latestRank")===this.data.get("currentRank")&&(this.data.set("hasStartBottomAlign",!1),this.data.set("closeBottomAlign",!1)),this.data.set("typingEnd",!1)},"update-chat-status":function(t){this.setChatStatus(null==t?void 0:t.value)},"update-generate-status":function(t){var e=(null==t?void 0:t.value)||{},n=e.status,a=e.title;this.updateGenerateInfo(n,a)},"generate-replace":function(){this.data.get("latestRank")===this.data.get("currentRank")&&(this.data.set("hasStartBottomAlign",!1),this.data.set("closeBottomAlign",!1)),this.data.set("typingEnd",!1),ga().emit({rank:this.data.get("currentRank"),disabled:!0})},"show-capsule":function(){var t;this.data.set("showCapsule",!0),(null==(t=this.data.get("shortcutsData").capsuleData)?void 0:t.length)&&(ua().emit({rank:this.data.get("currentRank")}),ei().emit({hide:1}))},"open-half-screen":function(t){var e,n,a,i=this;vp.triggerEvent("onOpenDrawer",{round_index:this.data.get("currentRank"),isHistory:this.data.get("isHistory"),agentInfo:{agentInfo:{agentId:null==(e=this.data.get("curAgentInfo"))?void 0:e.agentId,agentSearchId:null==(n=this.data.get("curAgentInfo"))?void 0:n.agentSearchId,agentName:null==(a=this.data.get("curAgentInfo"))?void 0:a.agentName}},data:(null==t?void 0:t.value)||{},api:{sendUbcLog:function(t){i.dispatch("send-ubclog",t)}}})}},attached:function(){var t,e,n=this;this.updateGenerateInfo(Oi.THINKING,"正在思考"),setTimeout((function(){var t=un('style[data-css-module="markdown"]',document.head),e=un('style[data-css-module="markdown"]');if(!t&&e){var n=e.cloneNode(!0);document.head.appendChild(n)}}),0);var a=this.data.get("isHistory");if(vp.triggerEvent("onQuestionStart",{round_index:this.data.get("currentRank"),isHistory:a,data:{functional:{}},api:{sendUbcLog:function(t){n.dispatch("send-ubclog",t)}}}),a){var i=this.data.get("answer").isAiCall,o=Je.getState("isShowHello");if(this.data.set("isAiCall",i),this.historyCardProcess(),this.data.get("isPc")&&Je.dispatch("update",{hasPullHistory:!0}),i||o){var r=this.data.get("answer.historyAskMessage[0]"),s=this.data.get("answer.blocksList[0]");r&&s&&this.handleHistoryAskData(r,s)}}else{this.data.set("startTime",Je.getState("startTimeList")[this.data.get("currentRank")]),this.listenInit(),this.processAnswer(),this.handleCardSectionVisible(),this.cardEventListener(),this.sendNAMessageToServer(),this.watchContentChange(),this.watchContentFinished(),this.data.set("hitGuideDown","2"===(null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.AGENT_SUG));var c=this.data.get("conversationLogId");this.data.set("curConversationLogId",c),this.updateCurAgentInfo()}},listenInit:function(){var t=this;this.listenNewChatHideCapsule=function(){var e=t.data.get("observer");e&&(e.disconnect(),t.data.set("observer",null));var n=Je.getState("agentInfo");(null==n?void 0:n.agentName)||t.data.get("showCapsule")&&t.processCapsules()},Hn().on(this.listenNewChatHideCapsule),this.listenDeleteAgent=function(e){var n,a,i=Je.getState("agentInfo")||{},o=((null==(n=e.params)?void 0:n.agentInfo)||{}).agentSearchId||(null==(a=e.params)?void 0:a.agentSearchId)||"";i.agentSearchId===o&&Je.dispatch("update",{agentInfo:{}}),t.data.get("showCapsule")&&t.processCapsules()},Xa().on(this.listenDeleteAgent),this.listenCapsuleShow=function(e){var n=e.rank;n&&n!==t.data.get("currentRank")&&t.data.get("showCapsule")&&(ei().emit({hide:0}),t.data.set("showCapsule",!1))},ua().on(this.listenCapsuleShow),this.listenAgentChange=function(){t.data.get("showCapsule")&&t.processCapsules()},da().on(this.listenAgentChange),this.listenOpenNewContext=function(){t.data.get("showCapsule")&&t.processCapsules()},Fn().on(this.listenOpenNewContext),this.listenStopToBottomAlign=function(){t.data.set("closeBottomAlign",!0),qr()},ha().on(this.listenStopToBottomAlign),this.listenAiCallHistory=function(){t.data.get("showCapsule")&&t.processCapsules()},Qn().on(this.listenAiCallHistory)},updateCurAgentInfo:function(){var t,e,n=Je.getState("agentInfo");null==n||(null==(t=n.agentParams)||delete t.isQ2c),null==n||(null==(e=n.agentParams)||delete e.content_build_id),Je.dispatch("update",{agentInfo:n}),this.data.set("curAgentInfo",Je.getState("agentInfo"))},processCapsules:function(){var t,e,n;(null==(e=this.data.get("shortcutsData"))||null==(t=e.capsuleData)?void 0:t.length)>0&&"agent"===(null==(n=this.data.get("shortcutsData").capsuleData[0])?void 0:n.type)||this.data.get("showCapsule")&&(ei().emit({hide:0}),this.data.set("showCapsule",!1))},cardEventListener:function(){var t=this,e=this.data.get("currentRank");On().conversation.askDataSend.on((function(e){var n=e.generator,a=e.options;t.sendAskData(n,a)}),{when:function(t){var n;return void 0===t&&(t={}),(null==t||null==(n=t.options)?void 0:n.rank)===e}}),Hn().on((function(){t.data.set("hideExtraBottom",!0),t.updateFeedbackForm({showCard:!1,feedbackFormData:{},productData:{}})})),Fn().on((function(){return t.data.set("hideExtraBottom",!0)}));var n=this;aa().on(Mk((function(t){var e,a,i,o,r,s;return Hk(this,(function(c){return e=t.isAction,a=t.rank,i=t.action,o=t.feedbackFormData,r=t.actionName,s=void 0===r?"大盘随机":r,n.handleFeedbackForm({isAction:e,rank:a,action:i,feedbackFormData:o,actionName:s}),[2]}))}))),Nn().on((function(e){if(e.rank===t.data.get("currentRank")){var n=t.ref("answer-generate"),a=(null==n?void 0:n.el.innerText)||"";t.data.set("feedbackForm.productData.data.extrastring.desc26",(null==a?void 0:a.length)>1e3?a.substring(0,1e3):a),t.data.set("typingEnd",!0)}Mr(),setTimeout((function(){var e=t.data.get("observer");e&&(e.disconnect(),t.data.set("observer",null)),qr()}),3e3)}))},processAnswer:function(){var t=this.data.get("answer");this.handleAnswer(t,{oldValue:[{answer:{answerData:[],status:"IDLE"}}],newValue:t}),this.listenAnswer()},listenAnswer:function(){var t=this,e=this;this.watch("answer",Mk((function(t,n){var a,i;return Hk(this,(function(o){return a=n.oldValue,i=n.newValue,e.handleAnswer(t,{oldValue:a,newValue:i}),[2]}))}))),this.watch("upWard",(function(e){(e||!e&&1==+t.data.get("currentRank"))&&t.data.get("isBtmAlignSample")&&setTimeout((function(){!function(t){_r.changeBottomAlign(t)}(t.data.get("isPc"))}),2e3)}))},handleAnswer:function(t,e){var n=e.oldValue,a=e.newValue;return Mk((function(){var e,i,o,r,s,c,l,d,u,p,h,f,g,m,v;return Hk(this,(function(y){for(i=function(i){if(a[i]&&n[i]){var r=a[i].answer.answerData,s=n[i].answer.answerData;if(r.length>s.length){var c=r.slice(s.length);e.data.get("generateSection.answer["+i+"]")||e.data.set("generateSection.answer["+i+"]",{data:[],id:a[i].id,status:a[i].status,perfData:{}}),e.data.set("generateSection.answer["+i+"].status",a[i].answer.status),e.nextTick((function(){for(var t,e=Bk(c);!(t=e()).done;){var n=t.value;o.handlePacks(n,i)}}))}}t[i].answer.perfData&&e.data.set("generateSection.answer["+i+"].perfData",t[i].answer.perfData)},o=this,t&&(null==(s=t[0])||null==(r=s.answer)?void 0:r.answerData)&&(null==(l=t[0])||null==(c=l.answer)?void 0:c.answerData.length)&&!this.data.get("requestEnd")&&this.data.set("requestEnd",+new Date),d=0;d<a.length;d++)e=this,i(d);return(u=a[0])&&"ABORT"===u.answer.status&&(p=u.answer.answerData,h=p[p.length-1].type,this.data.set("abortType",h)),u&&"COMPLETE"===u.answer.status&&(!this.data.get("requestStart")&&this.data.set("requestStart",null==(m=t[t.length-1])||null==(g=m.answer)||null==(f=g.perfData)?void 0:f.requestStartTime),v=this,this.nextTick(Mk((function(){var t,e,n;return Hk(this,(function(a){switch(a.label){case 0:return(t=Sr("prerenderConfirmPromise"))?[4,t]:[3,2];case 1:a.sent(),a.label=2;case 2:return v.existCard()||v.data.get("existAnswer")||(v.data.set("chatGenerate",v.data.get("baseData.chatGenerate")),(n=v.ref("answer-generate")&&v.ref("answer-generate").el)&&(null==(e=Yn())||e.emit(n.offsetHeight-81)),v.data.set("showNoResult",!0)),v.data.set("queryIsDanger",v.data.get("baseData.queryIsDanger")),[2]}}))})))),[2]}))})).apply(this)},handleSearchingStepsPack:function(t){var e,n,a,i,o,r,s=null==(n=t.content)||null==(e=n.generator)?void 0:e.component;if(!(null==t||null==(a=t.functional)?void 0:a.feedback))if("searchingSteps"===s)fh.emit(jk({},null==(i=t.content)?void 0:i.generator,{rank:this.data.get("currentRank"),isAgent:!!(null==(r=t.content)||null==(o=r.agentInfo)?void 0:o.agentMeta)})),this.data.set("searchingStepsPackOver",!1);else if(!this.data.get("searchingStepsPackOver")){var c;this.data.set("searchingStepsPackOver",!0),this.data.set("searchingStepsPackOverTimeStart",(new Date).getTime()),fh.emit({component:"searchingSteps",data:{currentIndex:999},rank:this.data.get("currentRank")}),null==(c=this.ref("answer-generate"))||c.searchingStepsFinished(!1)}},sendNAMessageToServer:function(){var t=this;On().container.imageGuidanceShow.on((function(){if(!t.showPhotoSearchGuideInfo&&t.photoSearchGuideInfo){var e=t.ref("answer-generate");null==e||e.sendUbcLog({type:"show",value:"guide_pic"}),t.showPhotoSearchGuideInfo=!0;var n=new URL(t.photoSearchGuideInfo.callback_url);n.searchParams.append("token",t.photoSearchGuideInfo.token),n.searchParams.append("cuid",t.photoSearchGuideInfo.cuid),fetch(n.toString(),{method:"get",mode:"cors",credentials:"include"})}}))},handleFunctionalPack:function(t){var e,n;if(Fi(Ui(),"13.66")<0){var a,i,o=null==(i=t.functional)||null==(a=i.inputConfig)?void 0:a.photoSearchGuideInfo;o&&(this.photoSearchGuideInfo=o,On().conversation.showImageGuidance.emit())}else{var r,s=null==(r=t.functional)?void 0:r.inputConfig;s&&(s.photoSearchGuideInfo&&(this.photoSearchGuideInfo=s.photoSearchGuideInfo),On().conversation.sendInputConfig.emit(s))}var c=null==(e=t.functional)?void 0:e.question_guide;if(c){var l=this.data.get("currentRank");On().component.questionGuide.emit({rank:l,params:{questionGuideInfo:c}})}(null==(n=t.functional)?void 0:n.chatSearchTips)&&ga().emit({rank:this.data.get("currentRank"),tipsData:t.functional.chatSearchTips})},handleLogExtPack:function(t){var e,n,a=null==(n=t.content)||null==(e=n.generator)?void 0:e.logExt;a&&this.data.set("sceneLogExt",a)},handleAlaHat:function(t){var e,n,a,i,o,r;"markdown"===(null==(n=t.content)||null==(e=n.generator)?void 0:e.component)&&(null==(i=t.content)||null==(a=i.generator)?void 0:a.is_ala_hat)&&this.data.merge("baseData",{chatParams:{is_ala_hat:1}}),(null==(r=t.content)||null==(o=r.generator)?void 0:o.isComposition)&&this.data.merge("baseData",{chatParams:{isComposition:"1"}})},getAiFeedbackQuery:function(t){var e,n=null==t||null==(e=t.content)?void 0:e.generator;(null==n?void 0:n.queryIntent)&&this.data.set("baseData.queryIntent",n.queryIntent),(null==n?void 0:n.queryIndustry)&&this.data.set("baseData.queryIndustry",n.queryIndustry),(null==n?void 0:n.queryIntent)&&(null==n?void 0:n.queryIndustry)&&Je.dispatch("update",{queryIntent:n.queryIntent,queryIndustry:n.queryIndustry})},aiTabWeatherExperiment:function(t){var e;if(!this.data.get("isPc")&&!this.data.get("isPc")){var n=null==(e=t.content)?void 0:e.generator,a="aiTabWeatherExperiment";if(n&&n.data&&["questionClosely","agentRec"].includes(n.component)&&n[a]&&(n.data[a]=n[a],"agentRec"===n.component)){var i=n.data||{},o=i.value,r=void 0===o?[]:o,s=i.guideWord,c=void 0===s?"":s,l=r.filter((function(t){return ye(t)})).map((function(t){return jk({},t,{span:8,startIndex:0,endIndex:t.agentName?t.agentName.length:-1})}));Je.dispatch("update",{agentList:l,guideWord:c})}}},agentRecommendDataHandle:function(t){var e,n=this,a=null==(e=t.content)?void 0:e.generator;if(a&&a.data){var i=a.data.agentRecommendList;Nn().on((function(t){t.rank===n.data.get("currentRank")&&i&&n.data.set("agentRecommendList",i)}))}},handleMindMapShow:function(t){var e,n,a=null==t||null==(e=t.content)?void 0:e.generator,i=null==a?void 0:a.needClearMindMap,o=null==a?void 0:a.needClearHistory;if(i||o)return Je.dispatch("update",{showMindMap:!1});var r=null==a||null==(n=a.data)?void 0:n.state,s="mindMap"===(null==a?void 0:a.component),c=r&&r!==_p.NO_MIND_MAP;s&&c&&!Je.getState("showMindMap")&&Je.dispatch("update",{showMindMap:!0})},handlePacks:function(t,e){return Mk((function(){var n,a,i,o,r,s,c,l,d,u,p,h,f,g,m,v,y,b,w,_,k,S,x,I,T,C,L,P,D,A,E,O,R,N,q,M,j,B,H,$,U,F,G,W,z,Q,J,V,K;return Hk(this,(function(X){switch(X.label){case 0:return v=null==t||null==(a=t.content)||null==(n=a.generator)?void 0:n.data,y="pc"===rt(),"progress"!==(null==t||null==(o=t.content)||null==(i=o.generator)?void 0:i.component)||y?(v&&!Object.keys(v).length&&(t.content.generator.data.isEmptyPack=!0),y&&this.handleMindMapShow(t),"ppt-viewer"===(null==t||null==(s=t.content)||null==(r=s.generator)?void 0:r.component)&&li().emit({value:null==t||null==(_=t.content)||null==(w=_.generator)||null==(b=w.data)?void 0:b.value}),"mindMap"===(null==t||null==(l=t.content)||null==(c=l.generator)?void 0:c.component)?(oi().emit({type:kp.SET_DATA,data:null==t||null==(k=t.content)?void 0:k.generator.data}),[2]):(this.aiTabWeatherExperiment(t),this.agentRecommendDataHandle(t),this.handleSearchingStepsPack(t),this.handleFunctionalPack(t),this.handleLogExtPack(t),this.handleAlaHat(t),this.getAiFeedbackQuery(t),void 0!==(null==t||null==(u=t.content)||null==(d=u.generator)?void 0:d.isSafe)&&1!=+(null==t||null==(h=t.content)||null==(p=h.generator)?void 0:p.isSafe)&&(S=this.data.get("currentRank"),Ia().emit({rank:S})),(x=null==(m=t.content)||null==(g=m.agentInfo)||null==(f=g.agentMeta)?void 0:f[0])&&this.data.set("curAgentInfo",x),"baseData"!==t.type?[3,1]:0!==e||this.data.get("isPc")?[2]:(I=t.content,this.data.merge("baseData",I),this.data.merge("baseData",I),this.data.get("baseData.riskcheckApi")||(T=this.data.get("chatParams.sse_host"),this.data.set("baseData.riskcheckApi",(T||Ht)+$t.riskcheck)),I.chatHitKunlun===yr?(wr(yt(this.data.get("query"))),[2]):(this.updateData(),C=Je.getState("agentInfo"),L={latest_rank:Je.getState("rank")||"0",latest_lid:I.lid||"0",lid:I.lid||"0",apagelid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),setype:"csaitab",pd:"csaitab",agent_id:C.agentId,agent_name:C.agentName,sa:Je.getState("sa"),srcid:Je.getState("srcid")||"",extForMerge:{csaitab_lid:I.lid||"0",searchid:Je.getState("apagelid")||"",tplname:Je.getState("tplname")||"",srcid:Je.getState("srcid")||"",order:Je.getState("order")||""},extlog:{a_order:Je.getState("order")||""}},On().conversation.resultLog.emit(L),[3,7])))):(ya().emit({rank:this.data.get("currentRank"),content:v}),this.data.set("closeBottomAlign",!0),qr(),[2]);case 1:return"card"!==t.type?[3,2]:0!==e?[2]:(function(t,e){Ap.apply(this,Array.from(arguments))}(t.content,this),[3,7]);case 2:return E=this.data.get("latestRank"),O=this.data.get("currentRank"),this.handleTextCreateSeperateBub(t),"pc"===rt()?(q=Je.getState("connectPreQuery"),M=null==(R=t.options)?void 0:R.qid,O>=E&&(!this.data.get("baseData.query")&&this.data.set("baseData.query",yt(this.data.get("query"))),q&&!this.data.get("baseData.connectPreQuery")&&this.data.set("baseData.connectPreQuery",q),this.data.set("baseData.lid",M),Je.dispatch("update",{rank:this.data.get("currentRank"),sa:"",connectPreQuery:"",hideAlaCard:!1}),M&&Je.dispatch("update",{lid:M}),Fo(M||""),this.updateCurRankInfo(M),M&&this.data.set("baseClickLog.ubcExt",{lid:M,re_rank:O.toString()})),this.data.get("baseData.apagelid")||this.data.set("baseData.apagelid",Je.getState("apagelid")),this.data.get("oriLid")||(this.data.set("oriLid",M),Je.dispatch("update",{oriLid:M||""})),(null==(j=Je.getState("subSession"))?void 0:j.oriLid)||Je.dispatch("update",{subSession:jk({},j,{oriLid:M||""})}),B=Je.getState("agentInfo"),H=this.data.get("baseClickLog.extra"),this.data.merge("baseClickLog.extra",jk({lid:null==(N=t.options)?void 0:N.qid,re_rank:this.data.get("currentRank"),ori_lid:Je.getState("oriLid")},B.agentName&&!H.agent_name?{agent_name:B.agentName}:{},B.agentSearchId&&!H.agent_id?{agent_id:B.agentSearchId}:{}))):(O>=E&&Je.dispatch("update",{rank:this.data.get("currentRank")}),G=this.data.get("hasStartBottomAlign"),W=this.data.get("closeBottomAlign"),(null==(F=t.content)||null==(U=F.generator)||null==($=U.data)?void 0:$.closeBottomAlign)&&(W=!0,this.data.set("closeBottomAlign",!0),qr()),this.data.get("isBtmAlignSample")||G||W||(this.data.set("hasStartBottomAlign",!0),Nr())),z=Sr("prerenderConfirmPromise"),t.content&&t.content.generator&&this.data.set("existAnswer",!0),"reference"===(null==(D=t.content)||null==(P=D.generator)?void 0:P.component)&&(null==(Q=this.ref("answer-generate"))||Q.sendUbcLog({type:"show",value:"sitereach"})),z?[4,z]:[3,4];case 3:X.sent(),X.label=4;case 4:return(J=this.data.get("searchingStepsPromise"))?[4,J]:[3,6];case 5:if(X.sent())return[2];(V=this.data.get("searchingStepsPackOverTimeStart"))&&(this.data.set("overviewBlockFirstTokenDur",(new Date).getTime()-V),this.data.set("searchingStepsPackOverTimeStart",0)),X.label=6;case 6:this.handlerAskData(t,e),this.handleCapsuleData(t,e),this.handlerMockAiService(t),Z=this,(et=null==(Y=t)||null==(tt=Y.content)?void 0:tt.generator)&&"ala-card"===et.component&&et.data.value&&Z.data.set("cardSection.data",et.data),function(t,e){var n,a,i,o,r;if("wise"===rt()&&"ala-card"===(null==t||null==(a=t.content)||null==(n=a.generator)?void 0:n.component)){var s=document.createElement("div"),c=JSON.parse(null==t||null==(r=t.content)||null==(o=r.generator)||null==(i=o.data)?void 0:i.value).singCardContent;s.innerHTML=c,e.currentPageRootDom=s,e.data.set("cardSection.data",c)}}(t,this),this.data.push("generateSection.answer["+e+"].data",t),(K=Je.getState("imageQueryLid")[O])&&(Je.dispatch("update",{lid:K}),this.data.set("baseData.lid",K)),(null==(A=t.options)?void 0:A.qid)&&this.data.set("baseClickLog.extra.cid",t.options.qid),X.label=7;case 7:return[2]}var Y,Z,tt,et}))})).apply(this)},handleTextCreateSeperateBub:function(t){var e,n,a,i,o,r,s,c=null==(e=t.content)?void 0:e.generator,l=["markdownEditor","imageWithThumbnail"].includes((null==c?void 0:c.component)||"");(1===(null==c||null==(n=c.data)?void 0:n.isIndependenGuide)&&(!c.sectionId||c.sectionId<=1)?(c.data.isIndependenGuide=void 0,c.sectionId=1,c.interactiveArea={isHideInteractiveArea:!0,swiperPosDisable:!0,dislikeOptions:{}},this.data.set("separateBub",!0),(null==c?void 0:c.data)&&(c.data.isHideStateBtn=!0)):this.data.get("separateBub")&&c&&(c.sectionId=2,l&&(c.interactiveArea=jk({isHideInteractiveArea:!0,dislikeOptions:{}},c.interactiveArea||{}),(null==c?void 0:c.data)&&(c.data.isHideStateBtn=!0))),(null==c||null==(a=c.data)?void 0:a.backgroundImage)||(null==c||null==(i=c.data)?void 0:i.bgLinearGradient))&&(c.data.bgProps={backgroundImage:(null==c||null==(o=c.data)?void 0:o.backgroundImage)||"",backgroundImageDark:(null==c||null==(r=c.data)?void 0:r.backgroundImageDark)||"",bgLinearGradient:(null==c||null==(s=c.data)?void 0:s.bgLinearGradient)||""})},handlerMockAiService:function(t){var e,n,a,i,o;if("service"===(null==(n=t.content)||null==(e=n.generator)?void 0:e.component)){var r=(null==(a=t.content)?void 0:a.generator.data)||{},s=r.componentForUIJSON&&r.componentForUIJSON[0];s&&Object.assign(r,jk({url:(null==(i=s.linkInfo)?void 0:i.href)||(null==(o=s.link)?void 0:o.url),src:s.logo,title:s.title,subTitle:s.caption,button:{text:s.actionText}},s.official?{titleIcon:"https://psstatic.cdn.bcebos.com/basics/chat/official_1716531768000.svg"}:{}))}},handleHistoryAskData:function(t,e){var n,a=Je.getState("rank"),i=this.data.get("currentRank"),o=null==(n=e[0])?void 0:n.agentInfo;if(a===i){t&&this.handlerAskData(null==t?void 0:t.data,0),this.data.set("askSection.show",!0);var r=Je.getState("agentInfo");Object.keys(r).length>0?this.data.set("curAgentInfo",r):(this.data.set("curAgentInfo",o),this.data.set("curAgentInfo",o))}},handleCapsuleData:function(t){var e,n,a,i;if("capsule"===(null==(n=t.content)||null==(e=n.generator)?void 0:e.component)||"shortcuts"===(null==(i=t.content)||null==(a=i.generator)?void 0:a.component)){var o,r,s,c,l=null==t||null==(r=t.content)||null==(o=r.generator)?void 0:o.data;(this.data.get("showCapsule")||this.existCard())&&(this.data.set("showCapsule",!0),ua().emit({data:l,rank:this.data.get("currentRank")}),ei().emit({hide:1})),(null==(c=t.content)||null==(s=c.generator)?void 0:s.data)&&this.data.set("shortcutsData",{label:null==l?void 0:l.label,capsuleData:(null==l?void 0:l.value)||(null==l?void 0:l.items)})}},handlerAskData:function(t,e){var n,a,i,o,r=this.data.get("agentInfo"),s=null==(a=t.content)||null==(n=a.generator)?void 0:n.component;if(null==(o=t.content)||null==(i=o.agentInfo)?void 0:i.log_ext){var c,l,d=null==(l=t.content)||null==(c=l.agentInfo)?void 0:c.log_ext;"text"===d.scene&&"text_short"===d.scene_1st&&"text_bless"===d.scene_2nd&&this.data.set("agentInfo",t.content.agentInfo)}if((null==r?void 0:r.log_ext)&&s&&(r.log_ext.groupStyle="imageWithThumbnail"===s?"image":"markdownEditor"===s?"text":r.log_ext.groupStyle,this.data.set("agentInfo",r)),t.content&&t.content.generator){var u=t.content.generator,p=u.rebuildMode;p&&this.data.set("rebuildMode",p),p||(p=this.data.get("rebuildMode"));var h=Je.getState("imageQuery"),f=this.data.get("currentRank");if("askBack"===u.component||"questionClosely"===u.component||"input"===u.component){if("questionClosely"===u.component&&this.data.set("recommendWordList",u.data.recommendWord),"input"!==u.component&&(0===e||p===Bt.APPEND)){var g=this.data.get("agentInfo");u.agentInfo=g;var m=p===Bt.APPEND||h[f];this.sendAskData(u,{allowMultiUpdate:m})}u.component=""}Je.getState("agentRecData")&&(this.sendAskData(Je.getState("agentRecData")),Je.dispatch("update",{agentRecData:null}))}},sendAskData:function(t,e){void 0===e&&(e={});var n=On().conversation.askDataInterflow;if(n){var a=this.data.get("currentRank"),i=JSON.parse(JSON.stringify(t)),o=this.data.get("baseData");i.actionLid=o.lid,n.emit({rank:a,params:jk({generator:i},e)}),this.data.get("baseData.chatGenerate")||this.data.set("askSection.show",!0)}},updateData:function(){var t=this.data.get("baseData"),e=yt(this.data.get("query"));this.data.set("baseClickLog.lid",t.lid);var n=t.logCommonInfo||{},a=n.actionInfo||{},i=n.timeInfo||{},o=Je.getState("agentInfo"),r=this.data.get("baseClickLog.extra");this.data.set("baseClickLog.clk_info",a.clkInfo||{}),this.data.merge("baseClickLog.extra",jk({},a.extra||{},{lid:t.lid,re_rank:this.data.get("currentRank"),ori_lid:Je.getState("oriLid")},o.agentName&&!r.agent_name?{agent_name:o.agentName}:{},o.agentSearchId&&!r.agent_id?{agent_id:o.agentSearchId}:{})),this.data.set("baseClickLog.w",JSON.stringify("0_10_"+t.query)),this.data.set("baseTimeLog",i.card||{});var s=this.data.get("chatParams"),c=this.data.get("latestRank");this.data.get("currentRank")>=c&&(Je.dispatch("update",{lid:t.lid,rank:this.data.get("currentRank"),query:t.query,preQuery:e,chatParams:jk({},s,t.chatParams),preChatParms:s,sa:"",connectPreQuery:"",hideAlaCard:!1}),Fo(t.lid),this.updateCurRankInfo(t.lid)),t.user&&t.user.isUserLogin&&bs(!0),this.data.get("oriLid")||(On().conversation.sendSessionId.emit({sessionId:t.lid}),Je.dispatch("update",{oriLid:t.lid}));var l=Je.getState("subSession");(null==l?void 0:l.oriLid)||Je.dispatch("update",{subSession:jk({},l,{oriLid:t.lid||""})}),no(),function(t){if(!isNaN(t)&&"number"==typeof t)for(var e=document.querySelector("body"),n=e.className.split(" "),a=0;a<n.length;a++)if(/^font-size-[0-9]+(\\.?[0-9]+)?$/.test(n[a])){n[a]=Vl(t),e.style.setProperty("--font-size-scale",t.toString()),e.className=n.join(" ");break}}(+t.fontSizeScale||1),this.sendPageComplete({perfInfo:{baseDataTime:String(Date.now())}},"invoke")},isAnswerExposed:function(){var t,e,n=this.data.get("isPc")?null==_r||null==(t=_r.containerDom)?void 0:t.getBoundingClientRect().bottom:window.innerHeight;return((null==(e=this.el)?void 0:e.getBoundingClientRect().bottom)||0)<=n},answerFullShowLog:function(){var t=this.ref("answer-generate");null==t||t.sendUbcLog({type:"show",value:"satisfy_all"})},handleCardSectionVisible:function(){var t=this;On().conversation.cardTypingComplete.on((function(e){var n=e.rank,a=e.data,i=e.api,o=e.isHistory,r=t.data.get(),s=r.currentRank,c=r.hideAlaCard;if(s===n){!c&&t.data.set("cardSection.show",!0),t.nextTick((function(){t.data.set("askSection.show",!0),t.data.get("agentRecommendList")&&t.data.set("askSection.show",!1)}));var l=45;t.data.get("closeBottomAlign")&&(l=window.innerHeight),function(t,e){if(t){var n=t.getBoundingClientRect(),a=document.documentElement.clientHeight,i=n.top+n.height-a;i>e&&la().emit({hideHeight:"pc"===rt()?i:e})}}(t.el,l);var d=t.ref("answer-generate");if(function(t,e){if(t&&e){var n=t.getBoundingClientRect(),a=document.documentElement.clientHeight,i=n.top+n.height-a;n.height>=a&&e.sendUbcLog({type:"show",value:"over_screen"}),i>0&&e.sendUbcLog({type:"show",value:"stop_keep_bottom"})}}(t.el,d),vp.triggerEvent("onAnwserEnd",{round_index:n,isHistory:o,data:a,api:i,components:{answerComponent:t}}),t.isAnswerExposed())t.answerFullShowLog();else{var u=function(){t.isAnswerExposed()&&(t.answerFullShowLog(),_r.offScroll(u))};_r.onScroll(u)}}})),this.watch("cardSection.show",(function(e){var n=t.data.get("cardSection"),a=+new Date+"";e&&t.nextTick((function(){t.data.get("isPc")&&n.data?Ju.render("card",n.data,t.ref("htmlDom")).then((function(){var e={generatingStartTime:t.data.get("severPerfInfo.generatingStartTime")+""};t.sendPageComplete({perfInfo:e},"perf")})):t.existCard()&&Rp().then((function(){t.data.set("closeBottomAlign",!0),qr(),window.chatSearchContainer&&window.chatSearchContainer.renderCard&&window.chatSearchContainer.renderCard(t.ref("htmlDom"),n.data,t.currentPageRootDom,{rank:t.data.get("currentRank")}).then((function(e){e.renderStart=a,e.requestStart=t.data.get("requestStart"),e.requestEnd=t.data.get("requestEnd"),t.data.set("cardPerf",e);var n=jk({generatingStartTime:t.data.get("severPerfInfo.generatingStartTime")+""},e);t.sendPageComplete({perfInfo:n},"perf")}))}))}))}))},sendPageComplete:function(t,e){if(void 0===t&&(t={}),void 0===e&&(e="perf"),!(this.data.get("hasSendPageComplete.perf")&&"perf"===e||this.data.get("hasSendPageComplete.invoke")&&"invoke"===e||this.data.get("hasSendPageComplete.perf")&&this.data.get("hasSendPageComplete.invoke"))){var n=this.data.get("severPerfInfo.dim"),a=this.data.get("baseData"),i=jk({lid:a.lid,query:a.query,oriLid:Je.getState("oriLid"),chatNum:Je.getState("rank"),perfInfo:{},startTimeList:Je.getState("startTimeList"),naInjectTime:Je.getState("naInjectTime")},t);ai(Je.getState("conversationLogId"),i,e,n),this.data.set("hasSendPageComplete."+e,!0)}},existCard:function(){return!(!this.data.get("cardSection.data")||!this.currentPageRootDom)&&!(!this.currentPageRootDom.querySelector(".se-page-bd")||!this.currentPageRootDom.querySelectorAll('.c-result:not([tpl=ai_index]):not([tpl="ai_ask"])').length)},historyCardProcess:function(){var t=this;if(!ft()){var e=this.ref("htmlDom");if(this.data.get("isPc")){var n=this.data.get("answer.cardHtml");n?Ju.render("card",{value:n},this.ref("htmlDom")):this.watch("answer.cardHtml",(function(){Ju.render("card",{value:n},t.ref("htmlDom"))}))}else{var a=null==e?void 0:e.querySelector(Vt);Rp().then((function(){a&&window.chatSearchContainer&&window.chatSearchContainer.renderCard&&window.chatSearchContainer.renderCard(e,"",e,{rank:t.data.get("currentRank"),hasRendered:!0})}))}}},closeCard:function(){this.updateFeedbackForm({showCard:!1,feedbackFormData:{},productData:{}})},updateFeedbackForm:function(t){var e=t.showCard,n=t.feedbackFormData,a=t.productData;this.data.set("feedbackForm.showCard",e),this.data.set("feedbackForm.feedbackFormData",n),this.data.set("feedbackForm.productData",a)},updateCurRankInfo:function(t){Je.dispatch("update",{curRankInfo:jk({},Je.getState("curRankInfo"),{rank:this.data.get("currentRank"),lid:t,oriLid:Je.getState("oriLid")||t})})},handleFeedbackForm:function(t){return Mk((function(){var e,n,a,i,o,r,s,c,l,d;return Hk(this,(function(u){switch(u.label){case 0:if(e=t.isAction,n=t.rank,a=t.action,i=t.feedbackFormData,o=t.actionName,r=localStorage.getItem(Sp),s={rank:n,actionName:o,baseData:this.data.get("baseData"),recommendWordList:this.data.get("recommendWordList")},this.updateFeedbackForm({showCard:!1,feedbackFormData:{},productData:{}}),!ut()||!gs()||this.data.get("currentRank")!==n)return[2];if(r&&Date.now()<Number(r))return[2];if(!e)return[3,5];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,xp(a)];case 2:return(c=u.sent())?(l=Tp(jk({product:c.product},s)),localStorage.setItem(Sp,(Date.now()+1728e5).toString()),this.updateFeedbackForm({showCard:!0,feedbackFormData:c,productData:l}),[3,4]):[2];case 3:return u.sent(),[3,4];case 4:return[3,6];case 5:d=Tp(jk({product:i.product},s)),localStorage.setItem(Sp,(Date.now()+1728e5).toString()),this.updateFeedbackForm({showCard:!0,feedbackFormData:i,productData:d}),u.label=6;case 6:return ga().emit({rank:this.data.get("currentRank"),disabled:!0}),[2]}}))})).apply(this)},setChatStatus:function(t){var e=this.data.get("currentRank")>=Je.getState("rank")?"":"_OLD";Je.dispatch("update",{chatStatus:""+t+e});var n="";switch(t){case Ei.COMPLETE:n=Oi.COMPLETE;break;case Ei.GENERATING:n=Oi.GENERATING;break;case Ei.WAITING:n=Oi.THINKING}this.updateGenerateInfo(n)},updateGenerateInfo:function(t){ct()||this.data.get("currentRank")>=Je.getState("rank")&&Je.dispatch("update",{generateStatus:t})},watchContentChange:function(){var t=this.data.get("isHistory"),e=this.data.get("isBtmAlignSample"),n=this.data.get("isPc");if(e&&!t){var a=new IntersectionObserver((function(t){t.forEach((function(t){var e=t.boundingClientRect,n=t.rootBounds;n&&e&&e.bottom>=n.bottom-1&&t.isIntersecting&&la().emit({hideHeight:700,showButton:!0})}))}),{root:n?document.getElementById("conversation-flow-container"):null,rootMargin:"0px 0px 10px 0px",threshold:[0,.1,.25,.75,1]});a.observe(this.el),this.data.set("observer",a)}},watchContentFinished:function(){var t=this;this.data.get("isPc")&&qn().on((function(){!t.data.get("hideAlaCard")&&t.data.set("cardSection.show",!0)}))},listenNewChatHideCapsule:null,listenDeleteAgent:null,listenAgentChange:null,listenCapsuleShow:null,listenOpenNewContext:null,listenStopToBottomAlign:null,listenAiCallHistory:null,disposed:function(){this.listenNewChatHideCapsule&&Fn().off(this.listenNewChatHideCapsule),this.listenDeleteAgent&&Xa().off(this.listenDeleteAgent),this.listenAgentChange&&da().off(this.listenAgentChange),this.listenCapsuleShow&&ua().off(this.listenCapsuleShow),this.listenOpenNewContext&&Fn().off(this.listenOpenNewContext),this.listenStopToBottomAlign&&ha().off(this.listenStopToBottomAlign),this.listenAiCallHistory&&Qn().off(this.listenAiCallHistory),this.listenNewChatHideCapsule=null,this.listenDeleteAgent=null,this.listenAgentChange=null,this.listenCapsuleShow=null,this.listenOpenNewContext=null,this.listenStopToBottomAlign=null,this.listenAiCallHistory=null}}));function Uk(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Fk(){return Fk=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Fk.apply(this,Array.from(arguments))}function Gk(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Wk=St.connect(Je,{topRank:"topRank"})(a.defineComponent({trimWhitespace:"all",components:{"answer-timestamp":Di,"hover-menu":q_},initData:function(){var t=this;return{showMoreBtnOnce:!1,delay:!1,noAnimation:!1,question:{},answer:{},agentInfo:{},agentQuestion:{},showTip:!1,isHistory:!1,initShowHistory:!1,getCopyTarget:function(){return t.ref("agentQuestion")||t.ref("question")},isPc:"pc"===rt(),isLastQuestion:!1,lid:"",questionList:[],isHistoryPageClient:Jo()}},computed:{currentRank:function(){var t=Je.getState("qaPairIdDiff");return this.data.get("qaPairId")+t},agentInfoStr:function(){var t=this.data.get("agentInfo");return JSON.stringify(t)},rank:function(){return this.data.get("currentRank")},realQuery:function(){var t=this.data.get("agentQuestion");return t&&this.data.get("agentQuestion.keyword")?t.prefix+t.suffix:this.data.get("question").question},realShowExt:function(){return JSON.stringify({type:"show",value:"change_render",ori_lid:Je.getState("oriLid"),lid:this.data.get("lid"),re_rank:String(this.data.get("rank")),setype:"csaitab",query:this.data.get("realQuery")})},formattedQuestion:function(){var t;return gl((null==(t=this.data.get("question"))?void 0:t.question)||"")}},inited:function(){var t=this.data.get("question.question"),e=Je.getState("truncQueryIndexRange");e.length&&(t=t.slice(e[0],e[1]),this.data.set("question.question",t),Je.dispatch("update",{truncQueryIndexRange:[]}))},created:function(){var t=Je.getState("agentInfo"),e=Je.getState("showRiskTip"),n=this.data.get("isHistory");n||Je.dispatch("update",{chatStatus:Ei.WAITING}),n||e||!t||"20a8"!==t.agentSearchId||(this.data.set("showTip",!0),Je.dispatch("update",{showRiskTip:!0}))},listenLongPressHandler:null,attached:function(){var t,e=this,n=this.data.get("isHistory"),a=null;n?a=this.data.get("agentInfo"):(a=Je.getState("agentInfo"),this.data.set("agentInfo",a));var i=this.data.get("question.question");if(a&&a.agentName){(-1===i.indexOf("@"+a.agentName)||this.data.get("isPc")||Je.getState("isWiseNewCsaitab"))&&(i=ps(a,i));var o=ts(i,a.startIndex||0,a.endIndex||a.agentName.length);this.data.set("agentQuestion",o)}(this.listenLongPressHandler=Ob(this,"question"),this.el.addEventListener("mouseenter",(function(){var t,n=null==(t=e.el.closest(".cs-rank-container[rank]").querySelector("[data-delete]"))?void 0:t.getAttribute("data-delete");if(n){var a,i=JSON.parse(n);e.ref("menu")&&e.ref("menu").updateMenu({showDelete:null==i||null==(a=i.deleteQidList)?void 0:a.length})}})),n)||function(t){if(ut()){var e=JSON.stringify({targetId:Ts,category:0,text:t}),n=encodeURIComponent(e),a="im_callback_"+ +new Date,i="baiduboxapp://message/updateSessionWithCommand?params="+n+"&callback="+a;window[a]=function(){},Is(i)}}(this.data.get("question.question"));var r=Je.getState("csextdata"),s={};try{s=JSON.parse(r)}catch(t){s={}}var c=s.query_text_type||"",l=this.data.get("question").text_type||"",d=Je.getState("sample"),u="1"===(null==d||null==(t=d.variables)?void 0:t.AGENT_UQUICK_CHANGE),p=s.functionType||"";this.data.set("hintQuickChange",u),"latex"===c||"latex"===l?(this.handleMathJax(),c&&(delete s.query_text_type,Je.dispatch("update",{csextdata:JSON.stringify(s)}))):u&&this.nextTick((function(){e.watchShow()})),"numerologyForm"===p&&(delete s.functionType,Je.dispatch("update",{csextdata:JSON.stringify(s)}))},watchShow:function(){var t=this,e=un("#conversation-flow-content"),n=this.data.get("isHistory");this.bodyObserver=new MutationObserver((function(){var a,i=dn(".cs-rank-container",e);i.length&&(un(".cs-question-bubble",i[i.length-1])===t.ref("questionBubble")?t.data.get("isLastQuestion")||(t.data.get("realQuery")&&t.data.set("isLastQuestion",!0),!t.data.get("lid")&&!n&&t.data.set("lid",Je.getState("lid")),t.nextTick((function(){po()}))):(t.data.set("isLastQuestion",!1),a=t.ref("questionBubble"),lo.deleteTransDom(a)))})),e&&this.bodyObserver&&this.bodyObserver.observe(e,{childList:!0,subtree:!0,characterData:!0})},disposed:function(){this.listenLongPressHandler&&ti().off(this.listenLongPressHandler),this.listenLongPressHandler=null,this.questionObsever&&this.questionObsever.disconnect(),this.bodyObserver&&this.bodyObserver.disconnect()},handleClick:function(){var t,e=this,n=this.data.get("agentInfo"),a={word:this.data.get("question.question").trim(),type:"query"};if(n&&n.agentId&&n.agentName){a.agentInfo=us(n);var i=a.word;"pc"!==rt()&&-1===i.indexOf("@"+n.agentName)&&(a.word=ps(n,i))}var o=this.data.get("questionList");if(o.length>0){var r=null,s=null;o.forEach((function(t){var e,n,a=null==(n=t.data)||null==(e=n.question)?void 0:e.question;a&&("file"===t.type?r=a:"image"===t.type&&(s=Array.isArray(a)?a[0]:a))})),r&&(a.file=r),s&&(a.image=s)}this.data.get("isPc")||jn().emit(a);var c={};this.data.get("hintQuickChange")&&(ha().emit(),setTimeout((function(){e.scrollToTop()}),300),c={is_query_render:this.data.get("isLastQuestion")?"1":"0",ori_lid:Je.getState("oriLid"),lid:this.data.get("lid"),re_rank:String(this.data.get("rank")),setype:"csaitab",query:this.data.get("realQuery")}),Aa({type:"click",value:"query_clk",curLid:null==(t=this.data.get("answer").baseData)?void 0:t.lid,sessionId:Je.getState("sessionId"),rank:this.data.get("question.currentRank"),ext:Fk({agent_id:n.agentId,agent_name:n.agentName},c)})},scrollToTop:function(){var t=this;Dr({element:this.ref("questionBubble"),block:"start",margin:8,behavior:"instant"}),this.data.get("isPc")&&setTimeout((function(){Dr({element:t.ref("questionBubble"),block:"start",margin:8,behavior:"instant"})}),50)},loadJs:function(t){var e=this;return new Promise((function(n,a){if(e.mathScript)n();else{var i=document.getElementsByTagName("script")[0],o=document.createElement("script");o.src=t,o.async=!0,o.id="math-jax-script",i.parentNode.insertBefore(o,i),o.onload=function(){o=null,e.mathScript=document.getElementById("math-jax-script"),n(o)},o.onerror=function(t){o=null,a(t)}}}))},handleMathJax:function(){return(t=function(){var t,e;return Gk(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.loadJs("//yy-s.zuoyebang.cc/static/mathjax_274_for-test/MathJax.js?config=update190725-1")];case 1:return n.sent(),e=this.el,[4,null==(t=window.MathJax)?void 0:t.Hub.Queue(["Typeset",window.MathJax.Hub,e])];case 2:case 3:return n.sent(),[3,4];case 4:return[2]}}))},function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Uk(o,a,i,r,s,"next",t)}function s(t){Uk(o,a,i,r,s,"throw",t)}r(void 0)}))}).apply(this);var t},handleLinkClick:function(t){null==t||t.stopPropagation()}})),zk={swiperBlock:"swiper-block_1a2le_1","swiper-block":"swiper-block_1a2le_1"},Qk={};Qk=Object.assign(Qk,{questionBlock:"question-block_1fesy_1","question-block":"question-block_1fesy_1",questionLineBreak:"question-line-break_1fesy_5","question-line-break":"question-line-break_1fesy_5",latestQuestion:"latest-question_1fesy_9","latest-question":"latest-question_1fesy_9",timestampMargin:"timestamp-margin_1fesy_16","timestamp-margin":"timestamp-margin_1fesy_16",topQueryMargin:"top-query-margin_1fesy_19","top-query-margin":"top-query-margin_1fesy_19",agentText:"agent-text_1fesy_22","agent-text":"agent-text_1fesy_22",aiAgentIcon:"ai-agent-icon_1fesy_26","ai-agent-icon":"ai-agent-icon_1fesy_26",questionBubbleAgent:"question-bubble-agent_1fesy_33","question-bubble-agent":"question-bubble-agent_1fesy_33",timestamp:"timestamp_1fesy_16",riskTip:"risk-tip_1fesy_39","risk-tip":"risk-tip_1fesy_39"}),Wk.template='\n    <div\n        s-if="{{\n            isHistory || (question.showQuestion && (question.question || (agentQuestion && agentQuestion.keyword)))\n        }}"\n        class="cs-rank {{currentRank === topRank && +question.hisRank !== 1? $style[\'top-query-margin\'] : \'\'}}"\n        rank="{{question.currentRank}}"\n        data-agent="{{agentInfoStr}}"\n        data-query="{{question.question}}"\n    >\n        <div s-if="showTip" class="{{$style[\'risk-tip\']}} cos-space-mb-xs">\n            内容由AI生成，仅供参考\n        </div>\n        \x3c!-- 历史会话页面不展示时间戳 --\x3e\n        <answer-timestamp\n            s-if="+question.hisRank === 1 && !initShowHistory && !isPc && !isHistoryPageClient"\n            timestamp="{{question.createTime}}"\n            class="{{$style[\'timestamp\']}} {{currentRank === topRank ? $style[\'timestamp-margin\'] : \'\'}}"\n        />\n        <div\n            s-ref="questionBubble"\n            data-show-area\n            need-show-log="{{isLastQuestion ? \'true\' : \'false\'}}"\n            data-show-ext="{{realShowExt}}"\n            class="cs-question-bubble cs-bubble"\n        >\n            <div\n                s-if="agentQuestion && agentQuestion.keyword"\n                class="\n                    {{$style[\'question-block\']}}\n                    {{$swperClass.swiperBlock}}\n                    {{delay ? $style[\'cs-bubble-delay\'] : \'\'}}\n                    {{showMoreBtnOnce ? \' cs-bubble-reduce\' : \'\'}}\n                    {{noAnimation ? \'cs-bubble-no-animation\' : \'\'}}\n                    c-fwb\n                "\n                on-click="handleClick"\n            >\n                <span class="{{$style[\'agent-text\']}}">\n                    <span class="{{!isPc ? $style[\'latest-question\'] : \'\'}}">{{ agentQuestion.prefix }}</span>\n                </span>\n                <span class="cs-bubble-agent">\n                    <span class="{{$style[\'agent-text\']}} cos-font-medium">{{ agentQuestion.keyword }}</span>\n                </span>\n                <span\n                    s-ref="agentQuestion"\n                    class="cs-question-text\n                        {{!isPc ? $style[\'latest-question\'] : \'\'}}\n                        {{$style[\'question-line-break\']}}\n                    "\n                >\n                    {{ agentQuestion.suffix }}\n                </span>\n            </div>\n            <div\n                s-else\n                s-ref="agentQuestion"\n                class="\n                    {{$style[\'question-block\']}}\n                    {{$swperClass.swiperBlock}}\n                    {{delay ? $style[\'cs-bubble-delay\'] : \'\'}}\n                    {{showMoreBtnOnce ? \' cs-bubble-reduce\' : \'\'}}\n                    {{noAnimation ? \'cs-bubble-no-animation\' : \'\'}}\n                    c-fwb\n                "\n                on-click="handleClick"\n            >\n                <span class="cs-question-pure-text {{!isPc ? $style[\'latest-question\'] : \'\'}}">\n                    <template s-for="item in formattedQuestion">\n                        <a\n                            s-if="{{item.type === \'link\'}}"\n                            href="{{item.content}}"\n                            target="_blank"\n                            rel="noopener"\n                            on-click="handleLinkClick"\n                        >\n                            {{ item.content }}\n                        </a>\n                        <span\n                            s-else\n                            class="{{$style[\'question-line-break\']}}"\n                        >{{ item.content }}</span>\n                    </template>\n\n                </span>\n            </div>\n            <hover-menu\n                s-if="isPc"\n                s-ref="menu"\n                rank="{{rank}}"\n                type="question"\n                get-copy-target="{{getCopyTarget}}"\n                status="COMPLETE"\n            />\n        </div>\n    </div>\n';var Jk="function"==typeof Wk?Wk.prototype.initData||Vk:Wk.initData||Vk;function Vk(){return{$style:Qk,$swperClass:zk}}function Kk(){return Object.assign({},Jk.call(this),{$style:Qk,$swperClass:zk})}function Xk(t,e){return Xk=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xk(t,e)}"function"==typeof Wk?Wk.prototype.initData=Kk:Wk.initData=Kk;var Yk=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).listenImageQueryTabClicked=null,e.listenImageQuerySelectedChange=null,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xk(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{imageUrl:"",rectList:[],queryHeight:0,rectIndex:0}},n.created=function(){var t=this;this.listenImageQueryTabClicked=function(e){var n=e.index,a=e.rank;t.data.get("rank")===a&&t.data.set("rectIndex",n)},Un().on(this.listenImageQueryTabClicked),this.listenImageQuerySelectedChange=function(e){var n=e.rank,a=e.rectIndex,i=e.rectList;t.data.get("rank")===n&&(t.data.set("rectIndex",a),t.data.set("rectList",i))},$n().on(this.listenImageQuerySelectedChange)},n.disposed=function(){this.listenImageQueryTabClicked&&(Un().off(this.listenImageQueryTabClicked),this.listenImageQueryTabClicked=null),this.listenImageQuerySelectedChange&&($n().off(this.listenImageQuerySelectedChange),this.listenImageQuerySelectedChange=null)},n.attached=function(){var t=this;this.judgeNumberLeft(),this.watch("rectIndex",(function(){t.nextTick((function(){t.judgeNumberLeft()}))}))},n.judgeNumberLeft=function(){var t=this.data.get("rectIndex"),e=this.ref("number"+t),n=this.ref("box"+t).getBoundingClientRect().left;e.getBoundingClientRect().left<n&&(e.style.right="unset")},e}(a.Component);Yk.filters={formatBoxStyle:function(t){var e=this.data.get("imgContainWidth"),n=this.data.get("imgContainHeight");return"width: "+t.width*e+"px; height: "+t.height*n+"px; top: "+t.top*n+"px; left: "+t.left*e+"px"},formatCornerStyle:function(t,e){var n=this.data.get("imgContainWidth"),a=this.data.get("imgContainHeight"),i=this.data.get("queryHeight"),o=t.left*n,r=t.width*n,s=t.top*a,c=o+r-12+2,l=o-2,d=s-2,u=(a-i)/2,p=s+t.height*a-12+2;return c>n-12&&c<=n&&(c=n-12),l<0&&l>=-12&&(l=0),d>=u-5&&d<u+5&&(d=u+5),p>i-15+u&&p<=i+u&&(p=i-15+u),"lt"===e?"top: "+d+"px; left: "+l+"px;":"rt"===e?"top: "+d+"px; left: "+c+"px;":"lb"===e?"top: "+p+"px; left: "+l+"px;":"rb"===e?"top: "+p+"px; left: "+c+"px;":void 0}};var Zk={};Zk=Object.assign(Zk,{imageQueryGraphMask:"image-query-graph-mask_15t3i_1","image-query-graph-mask":"image-query-graph-mask_15t3i_1",imageQueryGraphBox:"image-query-graph-box_15t3i_9","image-query-graph-box":"image-query-graph-box_15t3i_9",imageQueryGraphBoxImg:"image-query-graph-box-img_15t3i_16","image-query-graph-box-img":"image-query-graph-box-img_15t3i_16",imageQueryGraphBoxNumber:"image-query-graph-box-number_15t3i_19","image-query-graph-box-number":"image-query-graph-box-number_15t3i_19",imageQueryGraphBoxPoint:"image-query-graph-box-point_15t3i_38","image-query-graph-box-point":"image-query-graph-box-point_15t3i_38",imageQueryGraphBoxPointLt:"image-query-graph-box-point-lt_15t3i_45","image-query-graph-box-point-lt":"image-query-graph-box-point-lt_15t3i_45",imageQueryGraphBoxPointLb:"image-query-graph-box-point-lb_15t3i_48","image-query-graph-box-point-lb":"image-query-graph-box-point-lb_15t3i_48",imageQueryGraphBoxPointRt:"image-query-graph-box-point-rt_15t3i_51","image-query-graph-box-point-rt":"image-query-graph-box-point-rt_15t3i_51",imageQueryGraphBoxPointRb:"image-query-graph-box-point-rb_15t3i_54","image-query-graph-box-point-rb":"image-query-graph-box-point-rb_15t3i_54",imageQueryGraphBoxQuestion:"image-query-graph-box-question_15t3i_57","image-query-graph-box-question":"image-query-graph-box-question_15t3i_57"}),Yk.template="\n    <div class=\"{{$style['image-query-graph-mask']}}\">\n    <fragment s-for=\"item, index in rectList\">\n        <fragment s-if=\"index === rectIndex\">\n            <div\n                s-ref=\"{{'box' + index}}\"\n                class=\"{{$style['image-query-graph-box']}} image-query-graph-box\"\n                style=\"{{item | formatBoxStyle}}\"\n            >\n                <img\n                    s-if=\"imageUrl\"\n                    class=\"{{$style['image-query-graph-box-img']}}\"\n                    src=\"{{imageUrl}}\"\n                    style=\"width: {{imgContainWidth + 'px'}}; height: {{imgContainHeight + 'px'}}; top: {{-item.top * imgContainHeight + 'px'}}; left: {{-item.left * imgContainWidth + 'px'}}\"\n                />\n                <div s-ref=\"{{'number' + index}}\" class=\"{{$style['image-query-graph-box-number']}} image-query-graph-box-number\">\n                    <span>{{index + 1}}</span>\n                </div>\n            </div>\n            <div class=\"{{$style['image-query-graph-box-point']}} {{$style['image-query-graph-box-point-lt']}}\" style=\"{{item | formatCornerStyle('lt')}}\"></div>\n            <div class=\"{{$style['image-query-graph-box-point']}} {{$style['image-query-graph-box-point-rt']}}\" style=\"{{item | formatCornerStyle('rt')}}\"></div>\n            <div class=\"{{$style['image-query-graph-box-point']}} {{$style['image-query-graph-box-point-lb']}}\" style=\"{{item | formatCornerStyle('lb')}}\"></div>\n            <div class=\"{{$style['image-query-graph-box-point']}} {{$style['image-query-graph-box-point-rb']}}\" style=\"{{item | formatCornerStyle('rb')}}\"></div>\n        </fragment>\n        <div\n            class=\"{{$style['image-query-graph-box-question']}}\"\n            style=\"{{item | formatBoxStyle}}\"\n        ></div>\n    </fragment>\n";var tS="function"==typeof Yk?Yk.prototype.initData||eS:Yk.initData||eS;function eS(){return{$style:Zk}}function nS(){return Object.assign({},tS.call(this),{$style:Zk})}function aS(t,e){return aS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},aS(t,e)}"function"==typeof Yk?Yk.prototype.initData=nS:Yk.initData=nS;var iS=265.5,oS=236,rS=177,sS=177,cS=1.5,lS=.75,dS=1,uS=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aS(t,e)}(e,t);var n=e.prototype;return n.created=function(){var t=this.data.get("width")/this.data.get("height"),e=this.calcImgContain(t),n=e.queryWidth,a=e.queryHeight,i=e.imgWidth,o=e.imgHeight;e.imgTop,e.imgLeft;var r=e.centerStyle;this.data.set("queryHeight",a),this.data.set("containStyle","width: "+n+"px; height: "+a+"px"),this.data.set("imgStyle","width: "+i+"px; height: "+o+"px;"+(r||"")),this.data.set("imgContainHeight",o),this.data.set("imgContainWidth",i)},n.initData=function(){return{showLoading:!1,showError:!1,showQuery:!0,showImage:!0,showRetry:!1,containStyle:"width: auto; height: auto",imgStyle:"width: auto; height: auto",imgContainHeight:0,imgContainWidth:0}},n.attached=function(){this.dispatch("image-query-box:show-log",{ubcId:"17132",page:"resultpage",type:"show",value:"question_result"})},n.calcImgContain=function(t){void 0===t&&(t=1);return t>cS?{queryWidth:iS,queryHeight:sS,imgHeight:sS,imgWidth:sS*t,imgLeft:(sS*t-iS)/2,imgTop:0,centerStyle:"position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%)"}:t>dS&&t<=cS?{queryWidth:iS,queryHeight:iS/t,imgHeight:iS/t,imgWidth:iS,imgLeft:0,imgTop:0}:t<dS&&t>=lS?{queryWidth:oS*t,queryHeight:oS,imgWidth:oS*t,imgHeight:oS,imgLeft:0,imgTop:0}:t<lS?{queryWidth:rS,queryHeight:oS,imgWidth:rS,imgHeight:rS/t,imgTop:(rS/t-oS)/2,imgLeft:0,centerStyle:"position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%)"}:{queryWidth:iS,queryHeight:oS,imgWidth:iS,imgHeight:oS,imgTop:0,imgLeft:0}},n.handleImgLoadError=function(){this.handleImgError(!0),this.data.set("showRetry",!0)},n.handleImgError=function(t){void 0===t&&(t=!1),this.data.set("showLoading",!1),this.data.set("showQuery",!0),t||(this.data.set("showImage",!1),this.data.set("showError",!0))},n.handleImgQueryClick=function(){var t=this.data.get("realImageUrl");this.dispatch("image-query-question:click",t)},n.handleRetry=function(){ea().emit()},e}(a.Component);uS.components={mask:Yk},uS.computed={shouldShowImageQueryMask:function(){var t=this.data.get("ext")||this.data.get("historyQuery").ext,e=this.data.get("imgContainHeight"),n=this.data.get("imgContainWidth");return t&&t.rectList&&t.rectList.length&&e&&n},realImageUrl:function(){var t=this.data.get("isHistory"),e=this.data.get("historyQuery"),n=this.data.get("imageUrl"),a=this.data.get("imageB64");return t?null==e?void 0:e.imageUrl:n||a},realRectIndex:function(){var t,e=this.data.get("isHistory"),n=this.data.get("historyQuery"),a=this.data.get("ext");return e?(null==n?void 0:n.rectIndex)?n.rectIndex:null==n||null==(t=n.ext)?void 0:t.rectIndex:null==a?void 0:a.rectIndex},realRectList:function(){var t,e=this.data.get("isHistory"),n=this.data.get("historyQuery"),a=this.data.get("ext");return e?(null==n?void 0:n.rectList)?n.rectList:null==n||null==(t=n.ext)?void 0:t.rectList:null==a?void 0:a.rectList}};var pS={};pS=Object.assign(pS,{imageQueryContain:"image-query-contain_accfk_1","image-query-contain":"image-query-contain_accfk_1",imageQueryTool:"image-query-tool_accfk_7","image-query-tool":"image-query-tool_accfk_7",imageQueryImgWrapper:"image-query-img-wrapper_accfk_17","image-query-img-wrapper":"image-query-img-wrapper_accfk_17",imageQueryImgWrapperShow:"image-query-img-wrapper-show_accfk_29","image-query-img-wrapper-show":"image-query-img-wrapper-show_accfk_29",chatBubbleFadeOut:"chatBubbleFadeOut_accfk_1",imageQueryImgContain:"image-query-img-contain_accfk_32","image-query-img-contain":"image-query-img-contain_accfk_32",imageQueryImg:"image-query-img_accfk_17","image-query-img":"image-query-img_accfk_17",imageQueryLoadingContain:"image-query-loading-contain_accfk_39","image-query-loading-contain":"image-query-loading-contain_accfk_39",imageQueryLoading:"image-query-loading_accfk_39","image-query-loading":"image-query-loading_accfk_39",rotateAni:"rotateAni_accfk_1",imageQueryError:"image-query-error_accfk_57","image-query-error":"image-query-error_accfk_57",imageQueryErrorImg:"image-query-error-img_accfk_68","image-query-error-img":"image-query-error-img_accfk_68",imageQueryRetry:"image-query-retry_accfk_74","image-query-retry":"image-query-retry_accfk_74",imageQueryRetryIcon:"image-query-retry-icon_accfk_77","image-query-retry-icon":"image-query-retry-icon_accfk_77"}),uS.template='\n    <div class="{{$style[\'image-query-contain\']}}">\n        <div class="{{$style[\'image-query-tool\']}}">\n            <div s-show="showRetry"\n                class="{{$style[\'image-query-retry\']}}"\n                on-click="handleRetry">\n                <i class="{{$style[\'image-query-retry-icon\']}} cu-icon">&#xe61e;</i>\n            </div>\n        </div>\n        <div class="{{$style[\'image-query-img-wrapper\']}} {{showQuery ? $style[\'image-query-img-wrapper-show\'] : \'\'}}"\n            s-ref="contain"\n            style="{{containStyle}}"\n            on-click="handleImgQueryClick"\n            data-no-na-dialog="true"\n        >\n            <div s-ref="img"\n                s-show="showImage"\n                class="{{$style[\'image-query-img-contain\']}}"\n                style="{{imgStyle}}">\n                <img class="{{$style[\'image-query-img\']}}"\n                    src="{{realImageUrl}}"\n                    on-error="handleImgLoadError($event)"/>\n                <mask\n                    s-if="shouldShowImageQueryMask"\n                    queryHeight="{{queryHeight}}"\n                    imgContainHeight="{{imgContainHeight}}"\n                    imgContainWidth="{{imgContainWidth}}"\n                    imageUrl="{{realImageUrl}}"\n                    rank="{{rank}}"\n                    rectList="{{realRectList}}"\n                    rectIndex="{{realRectIndex}}"/>\n            </div>\n            <div s-show="showLoading" class="{{$style[\'image-query-loading-contain\']}}">\n                <div class="{{$style[\'image-query-loading\']}}"></div>\n            </div>\n            <div s-show="showError" class="{{$style[\'image-query-error\']}}">\n                <div class="{{$style[\'image-query-error-img\']}}"></div>\n                <div class="cos-space-mt-xxs cos-color-text-slim cos-text-body">无法展示</div>\n            </div>\n        </div>\n    </div>\n';var hS,fS="function"==typeof uS?uS.prototype.initData||gS:uS.initData||gS;function gS(){return{$style:pS}}function mS(){return Object.assign({},fS.call(this),{$style:pS})}function vS(){return vS=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},vS.apply(this,Array.from(arguments))}"function"==typeof uS?uS.prototype.initData=mS:uS.initData=mS,function(t){t[t.UNACTIVE=0]="UNACTIVE",t[t.ACTIVE=1]="ACTIVE",t[t.EXPIRED=2]="EXPIRED"}(hS||(hS={}));var yS=St.connect(Je,{topRank:"topRank",qaPairIdDiff:"qaPairIdDiff"})(a.defineComponent({components:{"image-query":uS,"image-group":hp},initData:function(){return{type:"image",question:{},isHistory:!1,isFinished:!1,invalidBgUrl:"pc"===rt()?"https://psstatic.cdn.bcebos.com/basics/chat/pc-image-invalid_1734763307000.png":"https://psstatic.cdn.bcebos.com/basics/chat/wise-image-invalid_1734763300000.png"}},computed:{singleImage:function(){var t,e=this.data.get("question.question");return e?(Array.isArray(e)||(e=[e]),1===e.length&&((null==(t=e[0].ext)?void 0:t.rectList)||e[0].rectList)?e[0]:null):null},valid:function(){var t,e=this.data.get("question.question");return!!e&&(Array.isArray(e)?2!==(null==(t=e[0])?void 0:t.imageStatus):2!==e.imageStatus)},currentRank:function(){var t=Je.getState("qaPairIdDiff");return this.data.get("qaPairId")+t}},messages:{"image-query-question:click":function(t){var e,n=this.data.get("isHistory"),a=this.data.get("question"),i=null==a||null==(e=a.question[0])?void 0:e.imageInfo;if(!n&&i){var o=Je.getState("imageQuery")||{},r=this.data.get("currentRank");i&&(i.srcp="csaitab_photoquestions"),i.imageType="QUESTION",i.params={rank:r},o[r]&&(i.rectList=o[r].rectList,i.rectIndex=o[r].rectIndex),On().conversation.showImageEdit.emit(i);var s=Je.getState("oriLid"),c=r+"",l=Je.getState("lid");Aa({ubcId:"17132",page:"resultpage",type:"click",value:"question_result",ext:{ctse_id:Je.getState("conversationLogId"),ori_lid:s,lid:l,re_rank:c,setype:"csaitab"}})}else wh(t.value,0,"question_query")},"image-query-box:show-log":function(t){var e=Je.getState("oriLid"),n=Je.getState("rank")+"",a=Je.getState("lid");Aa(vS({},t.value,{ext:{ori_lid:e,lid:a,re_rank:n,setype:"csaitab"}}))}},created:function(){var t=Je.getState("agentInfo"),e=Je.getState("showRiskTip");this.data.get("isHistory")||e||!t||"20a8"!==t.agentSearchId||(this.data.set("showTip",!0),Je.dispatch("update",{showRiskTip:!0}))},listenUpdateImageQuery:null,attached:function(){var t=this,e=this.data.get("type"),n=this.data.get("question.question[0].imageInfo"),a=n||{},i=a.imageB64,o=a.sign,r=a.token,s=a.rectList,c=void 0===s?[]:s,l=a.rectIndex,d=void 0===l?0:l,u=a.bigSign;if("image"===e){var p=Je.getState("imageQuery"),h=this.data.get("currentRank");p[h]=n?{rectList:c,rectIndex:d,imageInfo:{imageB64:i,sign:o,token:r,bigSign:u}}:{imageUpload:!0},Je.dispatch("update",{imageQuery:vS({},p)})}var f=this.getImageGroup();this.data.set("imageGroup",f),this.data.get("isHistory")||(this.listenUpdateImageQuery=function(e){t.data.get("currentIndex")!==e.index||t.data.get("isFinished")||(t.data.set("isFinished",!0),"abort"!==e.action?t.updateImageQuery(e.query):t.abortImageQuery())},pa().on(this.listenUpdateImageQuery))},disposed:function(){this.listenUpdateImageQuery&&(pa().off(this.listenUpdateImageQuery),this.listenUpdateImageQuery=null)},getImageGroup:function(){var t,e=this.data.get("question.question");return e?(Array.isArray(e)||(e=[e]),this.data.set("currentIndex",null==(t=e[0])?void 0:t.index),e.map((function(t){return{src:t.imageUrl?t.imageUrl:t.imageB64,status:t.status||"success"}}))):[]},updateImageQuery:function(t){if(t&&Array.isArray(t)&&0!==t.length){var e=t.map((function(t){return{src:t.imageUrl,status:t.status}}));this.data.set("imageGroup",e)}},abortImageQuery:function(){var t=this.data.get("imageGroup"),e=[];t.forEach((function(t){e.push(vS({},t,{status:"error"}))})),this.data.set("imageGroup",e)},handlePreviewImage:function(t){wh(t.urls,+t.current,"question_query")}})),bS={};bS=Object.assign(bS,{topQueryMargin:"top-query-margin_8h14r_1","top-query-margin":"top-query-margin_8h14r_1",imageWrapper:"image-wrapper_8h14r_4","image-wrapper":"image-wrapper_8h14r_4",invalidImage:"invalid-image_8h14r_14","invalid-image":"invalid-image_8h14r_14",invalidImageBg:"invalid-image-bg_8h14r_19","invalid-image-bg":"invalid-image-bg_8h14r_19"}),yS.template='\n    <div\n        class="cs-rank {{currentRank === topRank && +question.hisRank !== 1? $style[\'top-query-margin\'] : \'\'}}"\n        rank="{{question.currentRank}}"\n        data-share-disabled="1"\n    >\n        <div>\n            <div\n                s-if="!valid"\n                class="{{$style[\'invalid-image\']}}"\n            >\n                <img\n                    class="{{$style[\'invalid-image-bg\']}}"\n                    src="{{invalidBgUrl}}"/>\n            </div>\n            <image-query\n                s-else-if="singleImage"\n                s-bind="singleImage"\n                is-history="{{isHistory}}"\n                rank="{{currentRank}}"\n                history-query={{singleImage}} />\n            <image-group\n                s-else\n                class="{{$style[\'image-wrapper\']}}"\n                image-group="{{imageGroup}}"\n                on-preview-image="handlePreviewImage"\n            />\n        </div>\n    </div>\n';var wS,_S="function"==typeof yS?yS.prototype.initData||kS:yS.initData||kS;function kS(){return{$style:bS}}function SS(){return Object.assign({},_S.call(this),{$style:bS})}"function"==typeof yS?yS.prototype.initData=SS:yS.initData=SS,function(t){t[t.UNACTIVE=0]="UNACTIVE",t[t.ACTIVE=1]="ACTIVE",t[t.EXPIRED=2]="EXPIRED"}(wS||(wS={}));var xS=a.defineComponent({components:{"cos-icon":e.Icon},initData:function(){return{fileName:"",fileUrl:"",filePath:"",fileSize:"",fileStatus:0,fileType:"",isExtension:ft()}},computed:{_fileType:function(){var t=this.data.get("fileType");if(t)return Ec(t);var e=this.data.get("fileName");return e?Ec(e.split(".").pop()):""},_fileIconUrl:function(){var t=this.data.get("_fileType");return(this.data.get("_valid")?de:ue)[t]||""},_fileSize:function(){var t=this.data.get("fileSize");return t?Nc(t):""},_valid:function(){var t=this.data.get("fileStatus");return void 0!==t&&t!==wS.EXPIRED}},downloadFile:function(){var t=this.data.get("_valid"),e=this.data.get("fileUrl");if(t&&e){var n=e.replace(/^https?:\/\//,"//");e&&window.open(this.data.get("isExtension")?e:n,"_blank")}}}),IS={};IS=Object.assign(IS,{fileBox:"file-box_zbikv_1","file-box":"file-box_zbikv_1",fileFail:"file-fail_zbikv_13","file-fail":"file-fail_zbikv_13",fileIcon:"file-icon_zbikv_16","file-icon":"file-icon_zbikv_16",fileInfo:"file-info_zbikv_20","file-info":"file-info_zbikv_20",fileName:"file-name_zbikv_28","file-name":"file-name_zbikv_28",fileType:"file-type_zbikv_32","file-type":"file-type_zbikv_32",fileHint:"file-hint_zbikv_38","file-hint":"file-hint_zbikv_38",fileHintIcon:"file-hint-icon_zbikv_44","file-hint-icon":"file-hint-icon_zbikv_44"}),xS.template='\n    <div\n            class="\n                {{$style[\'file-box\']}}\n                {{_valid ? \'\' : $style[\'file-fail\']}}\n            "\n            on-click="downloadFile"\n    >\n        <img\n                class="{{$style[\'file-icon\']}}"\n                src="{{_fileIconUrl}}"\n        />\n        <div class="{{$style[\'file-info\']}}">\n            <p class="{{$style[\'file-name\']}} cos-line-clamp-1">{{fileName}}</p>\n            <p\n                s-if="!_valid"\n                class="{{$style[\'file-hint\']}}"\n            >\n                <cos-icon\n                    class="{{$style[\'file-hint-icon\']}}"\n                    name="info-circle-fill"\n                />\n                <span>该文件已失效</span>\n            </p>\n            <p s-else>\n                <span class="{{$style[\'file-type\']}}">{{_fileType}}</span><span>{{_fileSize}}</span>\n            </p>\n        </div>\n    </div>\n';var TS="function"==typeof xS?xS.prototype.initData||CS:xS.initData||CS;function CS(){return{$style:IS}}function LS(){return Object.assign({},TS.call(this),{$style:IS})}"function"==typeof xS?xS.prototype.initData=LS:xS.initData=LS;var PS=a.defineComponent({components:{"file-box":xS},initData:function(){return{type:"file",question:{},isHistory:!1,isFinished:!1}},listenHitResponseRisk:null,attached:function(){var t=this;this.data.get();var e=this.data.get("isHistory"),n=Je.getState("qaPairIdDiff"),a=this.data.get("qaPairId")+n;this.listenHitResponseRisk=function(e){a===e.rank&&t.data.set("question.question.fileStatus",wS.EXPIRED)},!e&&Ia().on(this.listenHitResponseRisk)},disposed:function(){this.listenHitResponseRisk&&(Ia().off(this.listenHitResponseRisk),this.listenHitResponseRisk=null)}}),DS={};DS=Object.assign(DS,{fileWrapper:"file-wrapper_1d87y_1","file-wrapper":"file-wrapper_1d87y_1"}),PS.template='\n    <div\n        s-if="{{question.question}}"\n        class="cs-rank"\n        rank="{{question.currentRank}}"\n        data-share-disabled="1"\n    >\n        <file-box\n            class="{{$style[\'file-wrapper\']}}"\n            file-name="{{question.question.fileName}}"\n            file-url="{{question.question.fileUrl}}"\n            file-size="{{question.question.fileSize}}"\n            file-status="{{question.question.fileStatus}}"\n        ></file-box>\n\n    </div>\n';var AS="function"==typeof PS?PS.prototype.initData||ES:PS.initData||ES;function ES(){return{$style:DS}}function OS(){return Object.assign({},AS.call(this),{$style:DS})}function RS(){return RS=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},RS.apply(this,Array.from(arguments))}"function"==typeof PS?PS.prototype.initData=OS:PS.initData=OS;var NS=St.connect(Je,{user:"user"})(a.defineComponent({trimWhitespace:"all",template:'\n    <div\n        class="agent-greeting-container"\n        s-ref="agent-greeting"\n    >\n        <div class="greeting-container">\n            <div class=\'cs-guide-header\'>\n            </div>\n            <div on-click="goToAgent($event, agentInfo)">\n                <div class="avatar-container">\n                    <img\n                        class="avatar"\n                        src="{{agentInfo.logo}}"\n                    />\n                </div>\n                <span\n                    class="agent-name"\n                    on-click="goToAgent($event, agentInfo)"\n                >\n                    {{agentInfo.agentName}}\n                </span>\n                <span class="agent-desc">\n                    {{agentInfo.description}}\n                </span>\n            </div>\n        </div>\n        <div class="rec-container" data-show-area>\n            <ai-ask-entrance\n                s-if="!isNewConversationLaunched"\n                s-ref="askComponent"\n                s-bind="{{questionCloselyData}}"\n                sa="{{sa}}"\n                isAgentGreeting="{{true}}"\n            />\n        </div>\n    </div>\n    ',components:{"ai-ask-entrance":jd},initData:function(){return{isNewConversationLaunched:!1,sa:"",agentInfo:{agentId:"",agentName:"",desc:"",guides:[]},scrollTop:!1,isExtension:ft()}},computed:{questionCloselyData:function(){var t=this.data.get("agentInfo");return{askComponentData:{component:"questionClosely",data:{recommendWord:(t.guides||[]).map((function(t){return{text:t}})),type:"primary",emptyDisabled:!0,isSingleCol:"1",jumpTypes:["multiSearch"],hideAskItem:!0,context:{app:"bdbox",scene:"chat-search"},toChatSearch:!0,componentArea:"agent_guide_switch"},sa:this.data.get("sa"),agentInfo:t}}}},goToAgent:function(t,n){var a,i;if(this.data.get("isExtension"))e.Toast.info({message:"请到网页版使用",duration:2e3});else{if("pc"===rt()){var o,r,s=rs((null==(o=n.jumpUrl)?void 0:o.h5)||(null==(r=n.jump_url)?void 0:r.h5));if(s){var c=RS({},n,{realUrl:s});ca().emit(c)}}var l=(null==(a=n.jumpUrl)?void 0:a.zbios)||(null==(i=n.jump_url)?void 0:i.zbios);if(l){var d=os(l,{});this.dispatch("send-log",{cyc:1,action:"agent_head",target:t.target}),Ad(d)}}},handleNewConversation:function(){Yn().emit(this.el.offsetHeight),this.data.set("isNewConversationLaunched",!0)},listenNewConversation:null,attached:function(){var t=this,e=this.data.get("agentInfo"),n=this.data.get("agentInfo"),a=n.agentSearchId,i=n.agentName,o=n.guides,r=void 0===o?[]:o,s="pc"===rt();gs()&&jn().emit({word:s?"":"@"+i,agentInfo:RS({startIndex:0,endIndex:i.length},us(e)),noClear:!0,invokeKeyboard:0}),Je.dispatch("update",{agentInfo:RS({},e,{startIndex:0,endIndex:i.length})}),this.data.get("scrollTop")&&setTimeout((function(){Dr({element:t.el,block:"start"})}),100),Aa({rank:Je.getState("rank"),type:"show",value:"agent_guide",ext:{agent_id:a,agent_name:i,valueInfo:r.map((function(t,e){return{guide_pos:e+1,guide_info:t}}))}}),this.listenNewConversation=function(){t.handleNewConversation()},Hn().on(this.listenNewConversation),Fn().on(this.listenNewConversation),Gn().on(this.listenNewConversation)},disposed:function(){this.listenNewConversation&&(Hn().off(this.listenNewConversation),Fn().off(this.listenNewConversation),Gn().off(this.listenNewConversation),this.listenNewConversation=null)}})),qS=a.defineComponent({template:"",initData:function(){return{title:"AI 智能回答，开启搜索新体验！",iconUrl:"https://gips1.baidu.com/it/u=142336869,1631836133&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f102_102"}},popupHandler:null,created:function(){var t=this;this.popupHandler=function(e){t.showPopup(e)},na().on(this.popupHandler)},detached:function(){this.popupHandler&&(na().off(this.popupHandler),this.popupHandler=null)},showPopup:function(t){void 0===t&&(t={});var n=this.data.get("title"),a=this.data.get("iconUrl"),i=t.shareUrl,o=t.query,r=t.rank,s=t.type;i?new e.index_pc$1({options:{title:n,content:o,iconUrl:a,linkUrl:i},success:function(){"generate"===s&&r===Je.getState("rank")&&aa().emit({isAction:!0,rank:r,action:2,actionName:"分享"})}}).show():Bn().emit({text:"当前内容暂不支持分享"})}}),MS=a.defineComponent({template:"",initData:function(){return{toastText:"",type:""}},botToastHandler:null,created:function(){var t=this;this.botToastHandler=function(e){t.showToast(e)},Bn().on(this.botToastHandler)},detached:function(){this.botToastHandler&&(Bn().off(this.botToastHandler),this.botToastHandler=null)},showToast:function(t){if(t&&t.text&&t.type){var n={message:t.text};switch(t.type){case"info":e.Toast.info(n);break;case"success":e.Toast.success(n);break;case"warn":e.Toast.warn(n);break;case"error":e.Toast.error(n)}}}}),jS=a.defineComponent({template:'\n        <div class="chat-dialog-container">\n            <cos-dialog\n                open="{=visible=}"\n                title="{{title}}"\n                type="{{type}}"\n                on-ok="handleOk"\n                on-close="handleClose"\n                on-cancel="handleCancel"\n                headless="{{headless}}"\n            >\n                <div class="chat-dialog-content">{{content}}</div>\n            </cos-dialog>\n        </div>\n    ',components:{"cos-dialog":e.Dialog},initData:function(){return{visible:!1,title:"",headless:!1,content:""}},dialogHandler:null,created:function(){var t=this;this.dialogHandler=function(e){t.dialogShow(e)},ia().on(this.dialogHandler)},disposed:function(){this.dialogHandler&&(ia().off(this.dialogHandler),this.dialogHandler=null)},handleOk:function(){this.data.set("visible",!1),"function"==typeof this.confirm&&this.confirm()},handleCancel:function(){this.data.set("visible",!1)},dialogShow:function(t){void 0===t&&(t={});var e=t.title,n=t.content,a=t.confirm,i=t.type,o=!e;(n||e)&&(this.data.set("visible",!0),this.data.set("title",e),this.data.set("content",n),this.data.set("type",i),this.data.set("headless",o),this.confirm=a)}});function BS(t,e){return BS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},BS(t,e)}var HS=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).listenShowLoading=null,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&BS(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{show:!1}},n.attached=function(){var t=this;this.listenShowLoading=function(e){t.data.set("show",e)},oa().on(this.listenShowLoading)},n.disposed=function(){oa().off(this.listenShowLoading)},e}(a.Component);HS.trimWhitespace="all",HS.components={"cos-loading":e.Loading};var $S={};$S=Object.assign($S,{csLoading:"cs-loading_15but_1","cs-loading":"cs-loading_15but_1"}),HS.template='\n    <div>\n        <cos-loading\n            s-if="show"\n            class="{{$style[\'cs-loading\']}}"\n        />\n    </div>\n';var US="function"==typeof HS?HS.prototype.initData||FS:HS.initData||FS;function FS(){return{$style:$S}}function GS(){return Object.assign({},US.call(this),{$style:$S})}"function"==typeof HS?HS.prototype.initData=GS:HS.initData=GS;var WS=a.defineComponent({initData:function(){return{afxUrl:"",ratio:0,gifHeight:0,isShow:!1,hasPlay:!1,loop:!0}},detached:function(){var t,e,n,a=this.data.get("timer");a&&clearTimeout(a),this.timer&&cancelAnimationFrame(this.timer),null==(t=this.gl)||t.deleteTexture(this.videoTexture),null==(e=this.gl)||e.deleteBuffer(this.posBuffer),this.gl&&(this.gl=null);var i=this.ref("canvas");null==i||null==(n=i.parentNode)||n.removeChild(i)},attached:function(){var t=this,e=navigator.userAgent.toLowerCase(),n=!1;if(this.data.get("afxUrl")&&(function(t){return/BDBoxEngine/i.test(t)||/baiduboxapp/.test(t)||/bdapp/.test(t)}(e)||function(t){var e=/^Mozilla\/(\d*?(\.\d*?)*?) \(Linux; Android (\d*?(\.\d*?)*?); .*?\) AppleWebKit\/(\d*?(\.\d*?)*?) \(KHTML, like Gecko\) Chrome\/(\d*?(\.\d*?)*?) Mobile Safari\/(\d*?(\.\d*?)*?)$/.test(t),n=/^Mozilla\/(\d*?(\.\d*?)*?) \(iPhone; CPU iPhone OS (\d*?(_\d*?)*?) like Mac OS X\) AppleWebKit\/(\d*?(\.\d*?)*?) \(KHTML, like Gecko\) CriOS\/(\d*?(\.\d*?)*?) Mobile\/(.*?) Safari\/(\d*?(\.\d*?)*?)$/.test(t);return e||n}(e)||function(t){return t.indexOf("applewebkit")>-1&&t.indexOf("mobile")>-1&&t.indexOf("safari")>-1&&-1===t.indexOf("linux")&&-1===t.indexOf("android")&&-1===t.indexOf("chrome")&&-1===t.indexOf("ios")&&-1===t.indexOf("browser")}(e))&&(n=!0),function(t){return/(iPhone|iPod|iPad)/gi.test(t)}(e)){var a=/(iphone\sos)\s([\d_]+)/.exec(e),i=a&&a[2]?a[2].split("_"):[];i&&i[0]&&+i[0]<11&&(n=!1)}this.data.set("isShow",n),n&&this.nextTick((function(){t.data.get("afxUrl")&&t.initVideo()}))},initVideo:function(){var t=this,e=this.ref("video");e.muted=!0,e.pause(),e.oncanplay=function(){t.data.get("hasPlay")||(e.play(),t.initAfx(e),t.data.set("hasPlay",!0),t.fire("canPlay"))},e.oncanplaythrough=function(){t.data.get("hasPlay")||(e.play(),t.initAfx(e),t.data.set("hasPlay",!0),t.fire("canPlay"))},e.onloadeddata=function(){t.data.get("hasPlay")||(e.play(),t.fire("canPlay"),t.initAfx(e),t.data.set("hasPlay",!0),t.fire("canPlay"))},e.onended=function(){t.fire("ended")},+this.data.get("loop")&&(e.onpause=function(){e.play()})},replayVideo:function(){var t=this.ref("video");t.currentTime=0,t.play()},initAfx:function(t){var e=this,n=this.ref("canvas"),a=window.innerHeight;t.videoWidth&&t.videoHeight?(n.width=t.videoWidth/2,n.height=t.videoHeight):(n.height=a*parseInt(this.data.get("gifHeight"),10)/100,n.width=n.height*parseFloat(this.data.get("ratio")));var i=n.getContext("webgl");if(this.gl=i,i){i.viewport(0,0,n.width,n.height),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);var o=this.createVertexBuffer(i,[-1,-1,1,-1,-1,1,1,1]);this.posBuffer=o;var r=this.createProgram(i,"attribute vec2 position;\n        varying vec2 v_Texcoord;\n        void main() {\n            v_Texcoord = (position + 1.0) * 0.5;\n            gl_Position = vec4(position, 0.0, 1.0);\n        }","precision highp float;\n        uniform sampler2D tex;\n        varying vec2 v_Texcoord;\n        void main() {\n            // 取右边画面像素\n            vec3 rgb = texture2D(tex, v_Texcoord * vec2(0.5, 1.0) + vec2(0.5, 0.0)).rgb;\n            // 取左边画面像素\n            float a = texture2D(tex, v_Texcoord * vec2(0.5, 1.0)).r;\n            gl_FragColor = vec4(rgb, a);\n        }");i.useProgram(r),this.setVertexBuffer(i,r,"position",o,2);var s=this.createImageTexture(i);this.videoTexture=s;var c=i.getUniformLocation(r,"tex");i.uniform1i(c,0);var l=function(){i.bindBuffer(i.ARRAY_BUFFER,o),i.bindTexture(i.TEXTURE_2D,s),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.drawArrays(i.TRIANGLE_STRIP,0,4),e.timer=requestAnimationFrame(l)};this.timer=requestAnimationFrame(l)}},createProgram:function(t,e,n){var a=t.createShader(t.VERTEX_SHADER),i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,e),t.shaderSource(i,n),t.compileShader(a),t.compileShader(i),[a,i].forEach((function(e){if(!t.getShaderParameter(e,t.COMPILE_STATUS))return null}));var o=t.createProgram();return t.attachShader(o,a),t.attachShader(o,i),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS),o},setVertexBuffer:function(t,e,n,a,i){t.bindBuffer(t.ARRAY_BUFFER,a);var o=t.getAttribLocation(e,n);t.enableVertexAttribArray(o),t.vertexAttribPointer(o,i,t.FLOAT,!1,0,0)},createVertexBuffer:function(t,e){var n=t.createBuffer();return e&&this.updateVertexBuffer(t,n,e),n},updateVertexBuffer:function(t,e,n){var a,i;t.bindBuffer(t.ARRAY_BUFFER,e),a=n,(null!=(i=Array)&&"undefined"!=typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](a):a instanceof i)&&window.Float32Array&&(n=new Float32Array(n)),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},createImageTexture:function(t,e){var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),e&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.bindTexture(t.TEXTURE_2D,null),n}}),zS={};zS=Object.assign(zS,{gifCanvas:"gif-canvas_1lr2r_1","gif-canvas":"gif-canvas_1lr2r_1",hideImg:"hide-img_1lr2r_8","hide-img":"hide-img_1lr2r_8"}),WS.template='\n    <div>\n        <video\n            s-if="isShow"\n            s-ref="video"\n            src="{{afxUrl}}"\n            auto-rotate="{{false}}"\n            autoplay\n            playsinline\n            x5-playsinline\n            webkit-playsinline\n            t7-video-player-type="inline"\n            crossorigin="anonymous"\n            style="display: none; width: 100%; position: absolute; z-index: -1;"\n            loop="{{loop}}"\n        >\n        </video>\n        <canvas\n            s-ref="canvas"\n            class="{{$style.gifCanvas}}"\n        >\n        </canvas>\n    </div>\n';var QS="function"==typeof WS?WS.prototype.initData||JS:WS.initData||JS;function JS(){return{$style:zS}}function VS(){return Object.assign({},QS.call(this),{$style:zS})}function KS(t){var e;if("string"==typeof t)try{e=JSON.parse(t)}catch(t){e={}}else e=t||{};return e}function XS(){return XS=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},XS.apply(this,Array.from(arguments))}"function"==typeof WS?WS.prototype.initData=VS:WS.initData=VS;var YS="aoyunhui",ZS="资源加载中，请稍后重试",tx="弹窗调用失败",ex="gk2024_popup_task_red_packet_",nx="gk2024_popup_abnormal_reward_",ax="red_packet",ix="red_packet_text",ox="red_packet_close",rx=a.defineComponent({capsulesAniTimer:0,components:{"cos-icon":e.Icon,"cos-image":e.Image,"cos-swiper":e.Swiper,"cos-swiper-item":e.SwiperItem,"cos-toast":e.Toast,"c-afx-video":WS},computed:{stepArray:function(){var t=this.data.get("step"),e=this.data.get("stepImg"),n=this.data.get("stepUnlockImg"),a=this.data.get("stepSelectedImg"),i=this.data.get("specialStep"),o=this.data.get("specialStepImg"),r=this.data.get("specialStepUnlockImg"),s=this.data.get("specialStepSelectedImg"),c=this.data.get("currStep"),l=function(t){return t<c},d=function(t){return t===c},u=function(i){return function(e){return e>=t}(i)?l(i)?r:d(i)?s:o:l(i)?n:d(i)?a:e};return Array.from({length:t+i}).map((function(t,e){return u(e)}))}},attached:function(){this.dataHandle(),this.stepHandle(),this.talosEventHandle()},initData:function(){return{step:0,stepImg:"",stepUnlockImg:"",stepSelectedImg:"",specialStep:0,specialStepImg:"",specialStepUnlockImg:"",specialStepSelectedImg:"",recommendWord:[],titleImg:"",background:"",tip:"",completeApi:"",registerApi:"",nextRoundParams:null,jumpUrl:"",isShow:!0,currStep:0,showLoading:!0,showTip:!1,closeToast:"还有红包未领取，确认离开吗",showCloseToast:!0,showScheduleAni:!1,showCapsuleAni:!0,currRankFromNa:!1,currActSence:""}},listenOperateCapsulesDataInterflow:null,dataHandle:function(){var t=this,e=On().conversation.operateCapsulesDataInterflow;this.listenOperateCapsulesDataInterflow=function(e){var n=e.recommendWord,a=void 0===n?[]:n,i=t.data.get(),o=i.showLoading,r=i.background;if(i.isShow&&!r&&t.setBodyPadding(),a&&a.length)t.data.set("recommendWord",a),t.data.set("showLoading",!1),t.layerLogHandle("show",ax,{packet_content:a.map((function(t){return t.text}))});else{var s,c,l=KS(Je.getState("csextdata"));1===(null==l||null==(s=l.operationPlatform)?void 0:s.firstPackage)&&Je.dispatch("update",{csextdata:JSON.stringify({operationPlatform:XS({},l.operationPlatform,{firstPackage:0})})}),t.data.set("currActSence",null==l||null==(c=l.operationPlatform)?void 0:c.act),t.data.set("step",e.step),t.data.set("stepImg",e.stepImg),t.data.set("stepUnlockImg",e.stepUnlockImg),t.data.set("stepSelectedImg",e.stepSelectedImg),t.data.set("specialStep",e.specialStep),t.data.set("specialStepImg",e.specialStepImg),t.data.set("specialStepUnlockImg",e.specialStepUnlockImg),t.data.set("specialStepSelectedImg",e.specialStepSelectedImg),t.data.set("titleImg",e.titleImg),t.data.set("background",e.background),t.data.set("tip",e.tip),t.data.set("completeApi",e.completeApi),t.data.set("registerApi",e.registerApi),t.data.set("nextRoundParams",e.nextRoundParams),t.data.set("jumpUrl",e.jumpUrl),t.layerLogHandle("show",ax)}t.data.set("showTip",!o&&!a.length)},e&&e.on(this.listenOperateCapsulesDataInterflow)},setBodyPadding:function(t){void 0===t&&(t=!0);var e=getComputedStyle(document.body),n=parseFloat(e.paddingBottom)||0,a=t?n+158:n-158;document.body.style.paddingBottom=a+"px"},scheduleAniEndedHandle:function(){this.data.set("showScheduleAni",!1)},detachedHandle:function(){this.data.set("isShow",!1),this.setBodyPadding(!1),this.unRigsterTalosEvent(),clearTimeout(this.capsulesAniTimer),this.data.set("showScheduleAni",!1),this.data.set("showCapsuleAni",!1)},closeHandle:function(){var t=this.data.get(),n=t.closeToast;if(t.showCloseToast)return e.Toast.show({message:n,position:"bottom"}),void this.data.set("showCloseToast",!1);this.layerLogHandle("click",ox),this.detachedHandle()},invokeInputHandle:function(){jn().emit({word:"",invokeKeyboard:1})},capsulesAniCanPlayHandle:function(){var t=this,e=this.data.get("showCapsuleAni");!this.capsulesAniTimer&&e&&(this.capsulesAniTimer=setTimeout((function(){t.data.set("showCapsuleAni",!1)}),3e3))},capsuleClickHandle:function(t){this.layerLogHandle("click",ix,{content:t}),Ar({query:t})},layerLogHandle:function(t,e,n){Aa({ubcId:"17132",type:t,value:e,ext:XS({},n,{ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),re_rank:Je.getState("rank"),agent_id:Je.getState("agentInfo").agentId})})},talosLogHandle:function(t,e){Aa({ubcId:"17676",type:t,value:"",page:"common_operate",ext:{action_name:e,pos_id:"4295_4300_"}})},showPopupHandle:function(t,n){var a=this;void 0===t&&(t=!0),void 0===n&&(n={});var i=t?"c-agent-feedback":"c-agent-reward";if(o.canIUse("talos.showWindow")){var r={bundle:{mainBizName:"box.rnplugin.searchmanifest",bundleName:"EggPopup",version:"1.0.164.1"},naParams:{showType:"fullscreen",bgClosable:0,bgColor:{normal:"#000000-0.8",dark:"#000000-0.8"},animation:{contentShow:{scale:{start:1,end:1,curve:[.41,.05,.1,1],time:200}},contentHide:{scale:{start:1,end:1,curve:[.41,.05,.1,1],time:200}}},leaveNotShowWindow:1},bizParams:{popup:{type:"c-agent-reward"},popupName:"MktFindRedpacket",popupParams:{componentName:i,componentData:XS({},n,{uuid:t?"1":"0"})}}};o.talos.showWindow(XS({},r,{success:function(){a.talosLogHandle("element_show",(t?nx:ex)+"show")},fail:function(t){var n=KS(t);10001==+(null==n?void 0:n.status)?e.Toast.show({message:ZS}):e.Toast.show({message:tx})}}))}else e.Toast.show({message:tx})},taskApiHandle:function(t,e){var n=this;!function(t){var e=t.url,n=t.success,a=t.fail,i="jsonpCallback"+ +new Date+Math.round(1e3*Math.random()),o=document.createElement("script"),r=setTimeout((function(){o.onerror("JSONP request timeout")}),2e4);o.onerror=function(){document.body.removeChild(o),delete window[i],a(new Error("JSONP request failed"))},o.onload=function(){clearTimeout(r)},window[i]=function(t){clearTimeout(r),document.body.removeChild(o),delete window[i],n(t)};var s=Nt(e,Mt.params({callback:i}));o.src=s,document.body.appendChild(o)}({url:t,success:function(t){if(0===+(null==t?void 0:t.status))return e(t);n.showPopupHandle()},fail:function(t){n.showPopupHandle()}})},taskCompeleteHandle:function(){var t=this,e=this.data.get("completeApi");this.taskApiHandle(e,(function(){var e=t.data.get(),n=e.currActSence,a=e.step,i=e.specialStep,o=e.registerApi,r=n===YS?{source:"agent",bg:"https://gips0.baidu.com/it/u=1996389903,2860529362&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f1242_1428",title:"https://gips2.baidu.com/it/u=3079154271,3193657443&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f1242_150",btn1:{bg:"https://gips2.baidu.com/it/u=2254050010,2611925001&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f381_183"},type:o?1:0,num:"",numSuffix:""}:{source:"agent",type:o?1:0,num:a+i};t.showPopupHandle(!1,r)}))},getZid:function(){return new Promise((function(t,e){o.canIUse("account.getZid")?o.account.getZid({v:0,jsParams:"",success:function(e){var n;t((null==e||null==(n=e.data)?void 0:n.zid)||"")},fail:function(){e("")}}):e("")}))},registerTalosEvent:function(t){if(o.canIUse("event.on")&&window){var e="talosGlobalFuncName"+ +new Date;window[e]=function(e,n){t&&t(e,n)},o.event.on({action:"com.baidu.channel.search.popwindow",allowDuplicate:"false",jscallback:e})}},unRigsterTalosEvent:function(){o.canIUse("event.off")&&o.event.off({action:"com.baidu.channel.search.popwindow"})},jumpToActivity:function(){var t=this.data.get("jumpUrl")||"";o.canIUse("search.open")?this.nextTick((function(){o.search.open({url:t,newbrowser:1,forbidautorotate:1,notShowLandingTopBar:1,bottomBarType:"4",landingPageType:"mailuo"})})):window.location.href=t},taskRoload:function(){var t=this;this.getZid().then((function(e){var n=Nt(t.data.get("registerApi"),Mt.params({zid:e}));t.taskApiHandle(n,(function(){var e=t.data.get("nextRoundParams")||{};Je.dispatch("update",{csextdata:(null==e?void 0:e.csextdata)||"",agentInfo:null==e?void 0:e.agentInfo}),t.data.set("currStep",0),t.data.set("showTip",!1),t.data.set("showLoading",!0),t.data.set("recommendWord",[]),t.data.set("completeApi",""),t.data.set("registerApi",""),t.data.set("step",0),t.data.set("specialStep",0),t.nextTick((function(){Ar({query:e.query})}))}))})).catch((function(){t.showPopupHandle()}))},listenBeforeLaunchConversation:null,listenCardTypingComplete:null,stepHandle:function(){var t=this;this.listenBeforeLaunchConversation=function(e){var n=e.fromNa,a=void 0!==n&&n;t.data.set("currRankFromNa",a)},Hn().on(this.listenBeforeLaunchConversation),this.listenCardTypingComplete=function(){var e=t.data.get(),n=e.currStep,a=e.step,i=e.specialStep,o=e.currRankFromNa;(n<a||o&&n<i+a)&&(t.data.set("currStep",n+1),!t.data.get("showScheduleAni")&&t.data.set("showScheduleAni",!0),n+1===i+a&&t.taskCompeleteHandle())},Nn().on(this.listenCardTypingComplete)},disposed:function(){this.listenOperateCapsulesDataInterflow&&(On().conversation.operateCapsulesDataInterflow.off(this.listenOperateCapsulesDataInterflow),this.listenOperateCapsulesDataInterflow=null);this.listenBeforeLaunchConversation&&(Hn().off(this.listenBeforeLaunchConversation),this.listenBeforeLaunchConversation=null),this.listenCardTypingComplete&&(Nn().off(this.listenCardTypingComplete),this.listenCardTypingComplete=null)},talosEventHandle:function(){var t=this;this.registerTalosEvent((function(e,n){var a=KS(n),i=null==a?void 0:a.type,o=!!(null==a?void 0:a.uuid);switch(i){case"btn-click":t.talosLogHandle("click",nx+"click"),t.jumpToActivity();break;case"back_activity":t.talosLogHandle("click",ex+"to_open_click"),t.jumpToActivity();break;case"next_search":t.talosLogHandle("click",ex+"more_click"),t.taskRoload();break;case"close":t.talosLogHandle("click",(o?nx:ex)+"close")}}))}}),sx={};sx=Object.assign(sx,{operateLayer:"operate-layer_f54h6_1","operate-layer":"operate-layer_f54h6_1",operateLayerClose:"operate-layer-close_f54h6_17","operate-layer-close":"operate-layer-close_f54h6_17",layerSchedule:"layer-schedule_f54h6_28","layer-schedule":"layer-schedule_f54h6_28",scheduleAfx:"schedule-afx_f54h6_31","schedule-afx":"schedule-afx_f54h6_31",scheduleTips:"schedule-tips_f54h6_40","schedule-tips":"schedule-tips_f54h6_40",scheduleTitle:"schedule-title_f54h6_48","schedule-title":"schedule-title_f54h6_48",scheduleProgress:"schedule-progress_f54h6_52","schedule-progress":"schedule-progress_f54h6_52",progressNumber:"progress-number_f54h6_56","progress-number":"progress-number_f54h6_56",layerClose:"layer-close_f54h6_63","layer-close":"layer-close_f54h6_63",scheduleStep:"schedule-step_f54h6_68","schedule-step":"schedule-step_f54h6_68",stepImg:"step-img_f54h6_73","step-img":"step-img_f54h6_73",capsule:"capsule_f54h6_78",capsuleTip:"capsule-tip_f54h6_87","capsule-tip":"capsule-tip_f54h6_87",capsuleLoading:"capsule-loading_f54h6_88","capsule-loading":"capsule-loading_f54h6_88",tipText:"tip-text_f54h6_91","tip-text":"tip-text_f54h6_91",layerCapsules:"layer-capsules_f54h6_109","layer-capsules":"layer-capsules_f54h6_109",capsuleAfx:"capsule-afx_f54h6_129","capsule-afx":"capsule-afx_f54h6_129"}),rx.template='\n    <div\n        class="{{$style[\'operate-layer\']}} {{(isShow && background) ? \'\' : $style[\'operate-layer-close\']}}"\n        style="background-image: url({{background}});"\n    >\n        \x3c!-- 进度面板 --\x3e\n        <div class="{{$style[\'layer-schedule\']}}">\n            <c-afx-video\n                s-if="showScheduleAni"\n                class="{{$style[\'schedule-afx\']}}"\n                afx-url="https://psstatic.cdn.bcebos.com/basics/yunying/ok_1715000516000.mp4"\n                loop="{{false}}"\n                on-ended="scheduleAniEndedHandle"\n            />\n            <div class="{{$style[\'schedule-tips\']}}">\n                <cos-image\n                    s-if="titleImg"\n                    class="{{$style[\'schedule-title\']}}"\n                    src="{{titleImg}}"\n                />\n                <div class="{{$style[\'schedule-progress\']}} cos-font-medium cos-space-ml-xl">\n                    已完成<span class="{{$style[\'progress-number\']}}">{{currStep}}</span>次\n                </div>\n                <div class="{{$style[\'layer-close\']}} cos-space-ml-3xl" on-click="closeHandle">\n                    <cos-icon name="close" />\n                </div>\n            </div>\n            <div class="{{$style[\'schedule-step\']}}">\n                <cos-image\n                    s-for="src in stepArray"\n                    class="{{$style[\'step-img\']}}"\n                    src="{{src}}"\n                />\n            </div>\n        </div>\n        <div class="cos-space-mt-xxs">\n            \x3c!-- 胶囊气泡loading态 --\x3e\n            <div s-if="showLoading" class="{{$style[\'capsule-loading\']}}">\n                <div class="{{$style[\'tip-text\']}} {{$style[\'capsule\']}} cos-font-medium cos-rounded-lg">\n                    智能体回答中，请等待\n                </div>\n            </div>\n            \x3c!-- 兜底文案提示词 --\x3e\n            <div s-elif="currStep >= step || showTip" class="{{$style[\'capsule-tip\']}}" on-click="invokeInputHandle">\n                <div class="{{$style[\'tip-text\']}} {{$style[\'capsule\']}} cos-font-medium cos-rounded-lg">\n                    {{tip}}\n                </div>\n            </div>\n            \x3c!-- 胶囊气泡 --\x3e\n            <div s-elif="recommendWord.length" class="{{$style[\'layer-capsules\']}}">\n                <cos-swiper>\n                    <cos-swiper-item s-for="item in recommendWord">\n                        <div\n                            class="{{$style[\'capsule\']}} cos-font-medium cos-rounded-lg"\n                            on-click="capsuleClickHandle(item.text)"\n                        >\n                            {{item.text}}\n                        </div>\n                    </cos-swiper-item>\n                </cos-swiper>\n                \x3c!-- 胶囊气泡提示动画 --\x3e\n                <c-afx-video\n                    s-if="showCapsuleAni"\n                    class="{{$style[\'capsule-afx\']}}"\n                    afx-url="https://psstatic.cdn.bcebos.com/operation/agent_increase/afx_1721291028000.mp4"\n                    on-canPlay="capsulesAniCanPlayHandle"\n                />\n            </div>\n        </div>\n    </div>\n';var cx="function"==typeof rx?rx.prototype.initData||lx:rx.initData||lx;function lx(){return{$style:sx}}function dx(){return Object.assign({},cx.call(this),{$style:sx})}function ux(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function px(){return px=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},px.apply(this,Array.from(arguments))}function hx(t,e){return hx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},hx(t,e)}"function"==typeof rx?rx.prototype.initData=dx:rx.initData=dx;var fx=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).halfListenStatus={},e.prefetchedUrls=[],e.chatEvents={onQuestionStart:function(t){e.willPrefetchUrls=new Set},onMessage:function(t){if("pc"!==rt()){var n=t.data,a=(null==n?void 0:n.generator)||{},i=a.component,o=a.data,r=void 0===o?{}:o,s=(null==r?void 0:r.value)||(null==r?void 0:r.items);if("shortcuts"===i)(null==s?void 0:s.length)&&s.forEach((function(t){if("drawer"===t.type){var n=qt(t.options.url,{actionId:En,_agentParams:JSON.stringify({sence:"drawer"})});e.updateHalfScreenUrl(n)}}))}},onTypingFinished:function(t){},onAnwserEnd:function(t){e.preloadUrlList(t)},onOpenDrawer:function(t){if("pc"!==rt()){var n=t.data,a=t.round_index,i=n||{},o=i.url,r=i.board_from;o&&(e.halfListenStatus[a]||(e.halfListenStatus[a]=!0,e.listenHalfScreenEvent(a,t.api.sendUbcLog),On().container.halfScreenOpened.on(e.sendHalfScreenLog.bind(ux(e),a,t.api.sendUbcLog)),On().container.halfScreenClosed.on(e.sendHalfScreenLog.bind(ux(e),a,t.api.sendUbcLog))),On().conversation.openHalfScreen.emit(px({},n,{board_ext:JSON.stringify({board_from:r,rank:a}),url:qt(o,{actionId:En,_agentParams:JSON.stringify({sence:"drawer"}),_aitabRank:a})})))}else e.api.showToast({text:"能力正在建设中，请到百度APP体验完整功能~",type:"info"})}},e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hx(t,e)}(e,t);var n=e.prototype;return n.updateHalfScreenUrl=function(t){-1===this.prefetchedUrls.indexOf(t)&&this.willPrefetchUrls.add(t)},n.preloadUrlList=function(t){var e=this.willPrefetchUrls;e.size&&this.prefetchUrlInfoList(e)},n.listenHalfScreenEvent=function(t,e){o.canIUse("event.on")&&o.event.on({action:"com.baidu.searchbox.chatsearch.halfscreen.notifyEvent."+En,jscallback:this.halfScreenEvent.bind(this,t,e)})},n.halfScreenEvent=function(t,e,n,a){var i=this;try{var o=a&&JSON.parse(a).data,r=o.name,s=o.params,c=o.url,l=o._aitabRank,d=this.api.getLatestRoundInfo();if(t===+l){var u=s.close_type,p=s.query,h=s.ext,f={params:{board_url:c,board_ext:JSON.stringify({rank:t}),close_type:u}};if("conversation"===r)h&&this.api.setAgentInfo(px({},this.api.getAgentInfo(),{agentParams:px({actionLid:d.lid},h)})),this.sendHalfScreenLog(t,e,f,!0),"string"==typeof p?this.api.launchConversation({query:p}):p.forEach((function(t){if("TEXT"===t.type){var e=t.data.text;i.api.launchConversation({query:e.query})}}))}}catch(t){console.error(t)}},n.sendHalfScreenLog=function(t,e,n,a){try{var i=(null==n?void 0:n.params)||{},o=i.board_url,r=i.board_ext,s=i.close_type,c=r&&JSON.parse(r),l=c.board_from;(+t==+c.rank||a)&&o&&e({type:s?"click":"show",value:s?"half_board_close":l?"half_board":"half_board_msg",extra:{board_url:o,board_from:l,close_type:s}})}catch(t){console.error(t)}},n.prefetchUrlInfoList=function(t){if(za||!t||!t.size){var e=Array.from(t);this.prefetchedUrls=this.prefetchedUrls.concat(e);var n=document.body||document.getElementsByTagName("body")[0];if(Ga)for(var a=0;a<e.length;a++){var i=document.createElement("link");i.rel="prerender",i.href=t[a],Ga&&n.appendChild(i)}if(Wa&&o.canIUse("search.landingPagePrefetch")){var r=e.map((function(t){return{prefetchType:1,prefetchInfo:{url:t},ext:{}}}));o.search.landingPagePrefetch({data:r})}}},e}(a.Component);fx.template="\n        <div>\n\n        </div>\n    ",fx.components={},fx.dependencies=["api"];var gx=yp(fx);function mx(t,e){return mx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},mx(t,e)}var vx=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mx(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{isDeepSeekPage:ct(),isHarmony:dt(),scale:1,topSpace:+Je.getState("topBarHeight")/window.devicePixelRatio+12,title:"DeepSeek-R1",deepseekLogo:"https://gips0.baidu.com/it/u=4155985737,1209176462&fm=3028&app=3028&f=PNG&fmt=auto&q=75&size=f72_72"}},n.attached=function(){var t=this;this.data.get("isHarmony")&&(this.observer=new ResizeObserver((function(){var e,n=parseFloat(null==(e=getComputedStyle(document.documentElement))?void 0:e.fontSize);t.data.set("scale",n/100)})),this.observer.observe(document.documentElement))},n.disposed=function(){this.observer&&(this.observer.disconnect(),this.observer=null)},e}(a.Component);function yx(t,e){return yx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yx(t,e)}vx.template='\n        <div class="chat-search-page-header">\n            <div s-if="isDeepSeekPage" class="chat-search-page-header-container">\n                <img class="chat-search-page-header-logo" src="{{deepseekLogo}}" />\n                <div class="chat-search-page-header-title">{{title}}</div>\n            </div>\n            <div\n                s-else-if="isHarmony" style="{{\'padding-top:\' + topSpace + \'px;\'}}"\n                class="chat-search-page-header-container"\n            >\n                <div class="chat-search-harmony-header-logo" style="{{\'transform: scale(\' + scale + \');\'}}" />\n            </div>\n        </div>\n    ';var bx=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yx(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{isDeepSeekPage:ct(),isHarmony:dt()}},n.attached=function(){},e}(a.Component);bx.template='\n        <div>\n            <chat-page-header s-if="isDeepSeekPage || isHarmony" />\n            <chat-history-tips\n                isPulldownLoading="{{true}}"\n            />\n            <chat-share-popup />\n            <chat-toast />\n            <chat-dialog />\n            <chat-loading />\n            \x3c!-- 运营浮层 --\x3e\n            <chat-operate-capsules />\n\n            <chat-drawer />\n        </div>\n    ',bx.components={"chat-history-tips":lr,"chat-share-popup":qS,"chat-toast":MS,"chat-dialog":jS,"chat-loading":HS,"chat-operate-capsules":rx,"chat-drawer":gx,"chat-page-header":vx};var wx=!1,_x=!1;function kx(){var t=0,e=0;if(wx){var n=document.getElementById("conversation-flow-container");if(!n)return;var a=n.scrollHeight,i=n.scrollTop;t=n.clientHeight,e=a-Math.abs(i)-t}else{var o=document.documentElement.getBoundingClientRect();t=document.documentElement.clientHeight,e=o.height-Math.abs(o.top)-t}return{clientHeight:t,docuHideBottom:e}}function Sx(t){void 0===t&&(t=!1),wx=t;var e=_n((function(){!function(t){var e,n;void 0===t&&(t=!1);var a=kx(),i="1"===(null==(n=Je.getState("sample"))||null==(e=n.variables)?void 0:e.CHANGE_BOTTOM_ALIGN)||t||ct();if(a&&!_x){var o=a.docuHideBottom>a.clientHeight;i?jr(50)&&(la().emit({hideHeight:a.clientHeight,showButton:!0}),qr()):o&&la().emit({hideHeight:a.clientHeight})}}(t)}),200);setTimeout((function(){var n=t?document.getElementById("conversation-flow-container"):window;null==n||n.addEventListener("scroll",e)}),500)}Hn().on((function(){_x=!0,setTimeout((function(){_x=!1}),4e3)}));var xx="pc"===rt(),Ix=a.defineComponent({template:'\n        <div\n            s-if="showScrollToBottomBtn"\n            class="{{hasCapsules && \'cs-move-up\'}} cs-scroll-to-bottom-btn"\n            on-click="onClick"\n            style="{{bottomStyle}}"\n        >\n            <cos-icon name="arrow-down" />\n        </div>\n    ',components:{"cos-icon":e.Icon},initData:function(){var t,e;return{isPc:xx,showScrollToBottomBtn:!1,hasCapsules:!1,isBtmAlignSample:"1"===(null==(e=Je.getState("sample"))||null==(t=e.variables)?void 0:t.CHANGE_BOTTOM_ALIGN)||xx||ct(),inputIsOpening:!1,bottomStyle:ct()||dt()?"bottom:"+(mt(119)+18)+"px":""}},listenCapsuleShow:null,attached:function(){var t=this;this.listenShowBtn(),this.onClick=_n(this.onBtnClick.bind(this),1e3),Sx(xx),this.listenCapsuleShow=function(){t.data.set("hasCapsules",!0)},ua().on(this.listenCapsuleShow)},listenGoToBottom:null,listenShowBtn:function(){var t=this;this.listenGoToBottom=function(e){var n=e.hideHeight,a=e.showButton,i=t.data.get("showScrollToBottomBtn");t.data.get("isBtmAlignSample")&&!a||!n||n<0||i||(t.data.set("hasCapsules",!!un(".cs-capsules")),t.data.set("showScrollToBottomBtn",!0),t.listenScrollHideBtn(n))},la().on(this.listenGoToBottom)},disposed:function(){this.listenCapsuleShow&&(ua().off(this.listenCapsuleShow),this.listenCapsuleShow=null),this.listenGoToBottom&&(la().off(this.listenGoToBottom),this.listenGoToBottom=null)},listenScrollHideBtn:function(t){var e=this,n=void 0;n=_n((function(){var a=kx();if(e.data.get("isBtmAlignSample")){if(jr(50))return;return e.data.set("showScrollToBottomBtn",!1),void e.removeScrollListener(n)}(null==a?void 0:a.docuHideBottom)<=t&&(e.data.set("showScrollToBottomBtn",!1),e.removeScrollListener(n))}),100),this.addScrollListener(n)},onBtnClick:function(){var t,e=this.data.get("isBtmAlignSample"),n=kx(),a=(null==n?void 0:n.docuHideBottom)>2*(null==n?void 0:n.clientHeight)||e?"instant":"smooth";t=a,_r.scrollToBottom(t),e&&Nr(),Aa({type:"click",value:"locate"})},addScrollListener:function(t){var e=this.data.get("isPc")?document.getElementById("conversation-flow-container"):window;null==e||e.addEventListener("scroll",t)},removeScrollListener:function(t){var e=this.data.get("isPc")?document.getElementById("conversation-flow-container"):window;null==e||e.removeEventListener("scroll",t)}}),Tx=a.defineComponent({template:'\n        <div s-if="open">\n            <div class="cs-bottom-tips-tooltip">\n                <div class="cs-tooltip-content">{{content}}</div>\n                <div class="cs-tooltip-arrow"></div>\n            </div>\n        </div>\n    ',initData:function(){return{open:!1,content:"点击体验DeepSeek-R1满血版"}},attached:function(){this.listenOpenChange()},timer:null,listenTouchStart:null,listenOpenChange:function(){var t=this;this.watch("open",(function(e){e&&(t.timer=setTimeout((function(){t.data.set("open",!1),t.listenTouchStart&&window.removeEventListener("touchstart",t.listenTouchStart),t.listenTouchStart=null,t.timer=null}),3e3),t.listenTouchStart=function(){t.data.get("open")&&(t.data.set("open",!1),window.removeEventListener("touchstart",t.listenTouchStart),Va().off(t.listenTouchStart),clearTimeout(t.timer),t.listenTouchStart=null,t.timer=null)},window.addEventListener("touchstart",t.listenTouchStart),Va().on(t.listenTouchStart))}))},disposed:function(){this.listenTouchStart&&(window.removeEventListener("touchstart",this.listenTouchStart),Va().off(this.listenTouchStart),clearTimeout(this.timer),this.listenTouchStart=null)}}),Cx="CHAT_SEARCH_BOTTOM_TIPS_COUNT",Lx=a.defineComponent({template:'\n    <div class="cs-footer">\n        <back-to-generate  s-if="!isPc"/>\n        \x3c!-- 阿拉丁卡片的反馈弹窗依赖dom --\x3e\n        <div class="se-page-ft"></div>\n        <div style="height: {{placeholder}}px"></div>\n        <bottom-tips\n            s-if="!isPc"\n            open="{{bottomTipsOpen}}"\n        />\n    </div>',components:{"back-to-generate":Ix,"bottom-tips":Tx},initData:function(){return{isPc:"pc"===rt(),placeholder:mt(dt()?74:119)}},computed:{},listenWiseInputFocus:null,attached:function(){var t=this;this.bottomTipsHandler(),this.listenWiseInputFocus=function(e){var n=mt(e.height);t.data.set("placeholder",e.focus?n-(gt()?18:0):n)},La().on(this.listenWiseInputFocus)},listenShowBottomTips:null,bottomTipsHandler:function(){var t=this;this.listenShowBottomTips=function(){t.computeShowBottomTips()},Ca().on(this.listenShowBottomTips)},disposed:function(){this.listenWiseInputFocus&&La().off(this.listenWiseInputFocus),this.listenShowBottomTips&&Ca().off(this.listenShowBottomTips)},computeShowBottomTips:function(){var t=this;if(!this.data.get("isPc")&&!ct()&&window.localStorage){var e=Number(window.localStorage.getItem(Cx)||0);if(e>=1)return;window.localStorage.setItem(Cx,String(e+1)),setTimeout((function(){t.data.set("bottomTipsOpen",!0)}),500)}}});function Px(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function Dx(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){Px(o,a,i,r,s,"next",t)}function s(t){Px(o,a,i,r,s,"throw",t)}r(void 0)}))}}function Ax(t,e,n){return e&&function(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(t.prototype,e),t}function Ex(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Ox(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],a=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Rx=function(){function t(){this.isProcessing=!1,this.queue=[]}var e=t.prototype;return e.unshift=function(t){var e=this;return Dx((function(){var n,a;return Ex(this,(function(i){return a=Array.isArray(t)?t:[t],(n=e.queue).unshift.apply(n,[].concat(a)),e.start(),[2]}))}))()},e.shift=function(){return this.queue.shift()},e.pop=function(){return this.queue.pop()},e.splice=function(t,e){for(var n=Array.from(arguments).length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=Array.from(arguments)[i];var o;return void 0===e?this.queue.splice(t):(o=this.queue).splice.apply(o,[].concat([t,e],a))},e.clear=function(){this.queue=[],this.isProcessing=!1,this.curSetTimeout&&clearTimeout(this.curSetTimeout)},e.push=function(t){var e=this;return Dx((function(){var n,a;return Ex(this,(function(i){return a=Array.isArray(t)?t:[t],(n=e.queue).push.apply(n,[].concat(a)),e.start(),[2]}))}))()},e.start=function(){var t=this;return Dx((function(){var e;return Ex(this,(function(n){switch(n.label){case 0:if(e=function(){var e,n,a;return Ex(this,(function(i){switch(i.label){case 0:return(e=t.queue.shift())?(n=e.action,a=e.delay,n?[4,new Promise((function(e,i){n(),t.curSetTimeout=setTimeout((function(){e(!0)}),a)}))]:[3,2]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))},t.isProcessing||0===t.queue.length)return[2];t.isProcessing=!0,n.label=1;case 1:return t.queue.length>0?[5,Ox(e())]:[3,3];case 2:return n.sent(),[3,1];case 3:return t.isProcessing=!1,[2]}}))}))()},Ax(t,[{key:"length",get:function(){return this.queue.length}}]),t}();function Nx(){return Nx=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Nx.apply(this,Array.from(arguments))}function qx(t,e,n){var a=function(t){void 0===t&&(t=[]);return new Map(t.filter((function(t){return t.id})).map((function(t){return[t.id,t]})))}(t),i=[];return e.forEach((function(t){var e=a.get(t.id);a.delete(t.id),e?function(t,e){return["title"].some((function(n){return t[n]!==e[n]}))}(e,t)&&i.push({type:"update",itemInfo:Nx({},n,{item:t})}):i.push({type:"add",itemInfo:Nx({},n,{item:t})})})),a.forEach((function(t){i.push({type:"delete",itemInfo:Nx({},n,{item:t})})})),i}var Mx={add:0,update:100,delete:0,loading:1333,state:0},jx=function(){function t(t){this.queue=new Rx,this.MindMapComponent=t}var e=t.prototype;return e.doMindMapAction=function(t,e){switch(t){case kp.SET_DATA:this.setData(e);break;case kp.SSE_STOP:this.close()}},e.setData=function(t){var e=this.mindMap||{},n=e.items,a=void 0===n?[]:n,i=e.mindMapId,o=t||{},r=o.mindMapId,s=o.items,c=void 0===s?[]:s,l=i!==r;(null==t?void 0:t.state)===_p.NO_MIND_MAP?this.close():(l&&(this.reset(r),this.loading()),(null==t?void 0:t.state)===_p.COMPLETED&&(this.mindMap=t,this.renderItems(a,c,t)))},e.loading=function(){var t;null==(t=this.queue)||t.push(this.createLoadingQueueItem())},e.close=function(){var t,e;(null==(t=this.mindMap)?void 0:t.state)===_p.INIT&&(null==(e=this.MindMapComponent)||e.close())},e.reset=function(t){var e,n,a,i;null==(e=this.MindMapComponent)||e.reset(),this.mindMap={mindMapId:t,items:[],state:_p.INIT},null==(a=this.MindMapComponent)||null==(n=a.data)||n.set("mindMapId",t),null==(i=this.queue)||i.clear()},e.renderItems=function(t,e,n){var a,i=this.generateRenderQueue(t,e,n);null==(a=this.queue)||a.push(i)},e.generateRenderQueue=function(t,e,n){var a=this;return qx(t,e,n).map((function(t){return a.createQueueItem(t)}))},e.createQueueItem=function(t){var e=this;return{action:function(){return e.MindMapComponent.executeAction(t)},delay:null==Mx?void 0:Mx[null==t?void 0:t.type]}},e.createStateQueueItem=function(t){var e=this;return this.createQueueItem({type:"state",cb:function(){var n,a;return null==(a=e.MindMapComponent)||null==(n=a.data)?void 0:n.set("state",t)}})},e.createLoadingQueueItem=function(){return this.createQueueItem({type:"loading"})},t}();function Bx(t,e){return Bx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Bx(t,e)}var Hx=function(t){function e(){return t.apply(this,Array.from(arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bx(t,e)}(e,t),e.prototype.initData=function(){return{boxCount:3,animationDelay:400}},e}(a.Component);Hx.computed={boxes:function(){var t=this.data.get("boxCount");return new Array(t).fill(null)}};var $x={};$x=Object.assign($x,{skLoading:"sk-loading_x915f_1","sk-loading":"sk-loading_x915f_1",skLoadingGenerating:"sk-loading-generating_x915f_5","sk-loading-generating":"sk-loading-generating_x915f_5",box:"box_x915f_9",loadingBar:"loading-bar_x915f_31","loading-bar":"loading-bar_x915f_31",borealisBar:"borealisBar_x915f_1"}),Hx.template='\n    <div class="{{$style[\'sk-loading\']}}">\n        <span class="{{$style[\'sk-loading-generating\']}}" >\n            <span \n                s-for="item, index in boxes"\n                class="{{$style[\'box\']}}"\n            >\n                <span \n                    class="{{$style[\'loading-bar\']}}"\n                    style="animation-delay: {{index * animationDelay}}ms"\n                ></span>\n            </span>\n        </span>\n    </div>\n';var Ux="function"==typeof Hx?Hx.prototype.initData||Fx:Hx.initData||Fx;function Fx(){return{$style:$x}}function Gx(){return Object.assign({},Ux.call(this),{$style:$x})}function Wx(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}function zx(t,e){return zx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},zx(t,e)}"function"==typeof Hx?Hx.prototype.initData=Gx:Hx.initData=Gx;var Qx=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zx(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{text:"",lineClass:"",displayChars:[],indexDelay:.01,animationDuration:.16}},n.attached=function(){this.setDisplayChars(this.data.get("text")),this.checkEllipsis(),this.addWatchers()},n.addWatchers=function(){var t=this;this.watch("displayChars",(function(){t.checkEllipsis()})),this.watch("text",(function(e){t.setDisplayChars(e)}))},n.setDisplayChars=function(t){var e=this;this.data.set("displayChars",[]),this.nextTick((function(){e.data.set("displayChars",null==t?void 0:t.split(""))}))},n.checkEllipsis=function(){var t=this;this.nextTick((function(){var e=t.ref("textContainer");if(e){var n=e.scrollWidth>e.clientWidth;n&&t.fire("ellipsis",n)}}))},n.animateShow=function(){return{enter:function(t,e){var n,a,i=1e3*parseFloat((null==t||null==(n=t.style)?void 0:n.animationDelay)||"0.3"),o=1e3*parseFloat((null==t||null==(a=t.style)?void 0:a.animationDuration)||"0");function r(e){t.style.opacity=e+""}function s(){e(),t.style.opacity="1"}setTimeout((function(){!function(t,e,n,a){var i=performance.now();requestAnimationFrame((function o(r){var s=r-i,c=n(s/t);e(c),s<t?requestAnimationFrame(o):"function"==typeof a&&a()}))}(o,r,Wx,s)}),i)}}},e}(a.Component),Jx={};Jx=Object.assign(Jx,{writerContainer:"writer-container_1epry_1","writer-container":"writer-container_1epry_1",typewriterText:"typewriter-text_1epry_4","typewriter-text":"typewriter-text_1epry_4"}),Qx.template='\n    <div class="{{$style[\'writer-container\']}}">\n        <div\n            class="{{lineClass}}"\n            s-ref="textContainer"\n        >\n            <span\n                s-for="char, index in displayChars"\n                s-transition="animateShow(index)"\n                style="animation-delay: {{index * indexDelay}}s; animation-duration: {{animationDuration}}s;"\n                class="{{$style[\'typewriter-text\']}}"\n            >{{char}}</span>\n        </div>\n        <slot />\n    </div>\n';var Vx="function"==typeof Qx?Qx.prototype.initData||Kx:Qx.initData||Kx;function Kx(){return{$style:Jx}}function Xx(){return Object.assign({},Vx.call(this),{$style:Jx})}"function"==typeof Qx?Qx.prototype.initData=Xx:Qx.initData=Xx;var Yx="ai_chat_tour_showed_key",Zx={"mind-map-item":{key:"mind-map-item",content:"💡点击发起提问，探索更多",position:"bottom"}},tI=function(t){var e=t.key,n=function(){try{var t=localStorage.getItem(Yx);return t?JSON.parse(t):{}}catch(t){return{}}}();return!!(null==n?void 0:n[e])};function eI(t,e){return eI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},eI(t,e)}var nI=function(t){function n(){var n;return(n=t.apply(this,Array.from(arguments))||this).components={"cos-tooltip":e.Tooltip,"cos-icon":e.Icon},n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eI(t,e)}(n,t);var a=n.prototype;return a.initData=function(){var t=this;return{userInfo:{},open:!1,key:"",content:"",position:"",img:"",closeTime:5e3,pageScrollAction:function(){},getPopupContainer:function(){return t.el}}},a.created=function(){var t=this.data.get("key"),e=Zx[t];e&&this.data.assign(e)},a.attached=function(){var t=this.getPageContainer()||document.body;t&&(this.pageScrollAction=this.pageScroll.bind(this),t.addEventListener("scroll",this.pageScrollAction))},a.detached=function(){var t=this.getPageContainer();t&&t.removeEventListener("scroll",this.pageScrollAction)},a.open=function(){var t=this,e=this.data.get("key");tI({key:e})||(this.data.set("open",!0),this.nextTick((function(){t.data.set("animationOpen",!0)})),this.startCloseTimer(),function(t){var e=t.key;try{var n=localStorage.getItem(Yx),a=n?JSON.parse(n):{};a[e]=!0,localStorage.setItem(Yx,JSON.stringify(a))}catch(t){}}({key:e}))},a.close=function(){var t=this;this.data.set("animationClose",!0),this.nextTick((function(){t.data.set("open",!1)}))},a.startCloseTimer=function(){var t=this,e=this.data.get("closeTime");setTimeout((function(){t.data.get("open")&&t.close()}),e)},a.getPageContainer=function(){return document.getElementById("app-page")},a.pageScroll=function(t){var e=this.ref("tooltip");null==e.pagePositionChange||e.pagePositionChange.call(e)},n}(a.Component),aI={};aI=Object.assign(aI,{tour:"tour_q4z73_1",arrowVertical:"arrow-vertical_q4z73_11","arrow-vertical":"arrow-vertical_q4z73_11",arrowHorizontal:"arrow-horizontal_q4z73_15","arrow-horizontal":"arrow-horizontal_q4z73_15",content:"content_q4z73_65",open:"open_q4z73_71",close:"close_q4z73_81"}),nI.template='\n    <div>\n        <cos-tooltip\n            s-ref="tooltip"\n            trigger="custom"\n            open="{{open}}"\n            position="{{position}}"\n            bubbleClass="{{$style.tour}} {{animationOpen ? $style.open : \'\'}} {{animationClose ? $style.close : \'\'}}"\n            getPopupContainer="{{getPopupContainer}}"\n        >\n            <slot />\n            <template slot="content">\n                <div class="{{$style.content}}">{{content}}</div>\n            </template>\n        </cos-tooltip>\n    </div>\n';var iI="function"==typeof nI?nI.prototype.initData||oI:nI.initData||oI;function oI(){return{$style:aI}}function rI(){return Object.assign({},iI.call(this),{$style:aI})}function sI(t,e){return sI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},sI(t,e)}"function"==typeof nI?nI.prototype.initData=rI:nI.initData=rI;var cI=function(t){function n(){var n;return(n=t.apply(this,Array.from(arguments))||this).components={"cos-tooltip":e.Tooltip},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sI(t,e)}(n,t),n.prototype.initData=function(){return{text:"",show:!1,position:"top"}},n}(a.Component),lI={};lI=Object.assign(lI,{tour:"tour_1lh8j_1",arrowVertical:"arrow-vertical_1lh8j_8","arrow-vertical":"arrow-vertical_1lh8j_8",arrowHorizontal:"arrow-horizontal_1lh8j_12","arrow-horizontal":"arrow-horizontal_1lh8j_12",hide:"hide_1lh8j_62"}),cI.template='\n    <div>\n        <cos-tooltip\n            position="{{position}}"\n            bubbleClass="{{$style.tour}} {{show ? \'\' : $style.hide}}"\n            content="{{text}}"\n        >\n            <slot />\n        </cos-tooltip>\n    </div>\n';var dI="function"==typeof cI?cI.prototype.initData||uI:cI.initData||uI;function uI(){return{$style:lI}}function pI(){return Object.assign({},dI.call(this),{$style:lI})}function hI(){return hI=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},hI.apply(this,Array.from(arguments))}function fI(){return{enter_type:Je.getState("pcEnterType")||"ai_tab_url",setype:"csaitab",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),sa:Je.getState("oriSa"),re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid"),valueInfo:[{component_name:"mindMap"}],query:Je.getState("query")}}function gI(t){var e=t.mindMapList,n=t.item,a=t.index,i=t.actionType,o=function(t,e){for(var n=0,a=0,i=0;i<=t;i++){var o;1===(null==(o=e[i])?void 0:o.level)?(n++,a=0):a++}return{pos:n,subPos:a}}(a,e);return hI({},fI(),{action_type:i,idea_query:null==n?void 0:n.title,pos:String(o.pos),sub_pos:String(o.subPos),total_pos:String(a+1),total_num:String(e.length)})}function mI(){return mI=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},mI.apply(this,Array.from(arguments))}function vI(t,e){return vI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vI(t,e)}"function"==typeof cI?cI.prototype.initData=pI:cI.initData=pI;var yI=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vI(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{item:{},isEllipsis:!1}},n.openTour=function(){var t=this.ref("tour");t&&t.open()},n.closeTour=function(){var t=this.ref("tour");t&&t.close()},n.onEllipsis=function(){this.data.set("isEllipsis",!0);var t=this.ref("bubble");t&&(t.style.right="0px")},e}(a.Component);yI.components={writer:Qx,tour:nI,"hover-tip":cI},yI.computed={hasTitle:function(){return!!this.data.get("item.title")},ubcShowLog:function(){var t=gI({mindMapList:this.data.get("mindMapList"),item:this.data.get("item"),index:this.data.get("index"),actionType:this.data.get("actionType")});return JSON.stringify(mI({value:"idea_single"},t))}};var bI={};bI=Object.assign(bI,{mindMapItem:"mind-map-item_sflgq_1","mind-map-item":"mind-map-item_sflgq_1",level1:"level-1_sflgq_11","level-1":"level-1_sflgq_11",level2:"level-2_sflgq_18","level-2":"level-2_sflgq_18",mindMapItemContent:"mind-map-item-content_sflgq_21","mind-map-item-content":"mind-map-item-content_sflgq_21",starWrapper:"star-wrapper_sflgq_26","star-wrapper":"star-wrapper_sflgq_26",starRotate270:"star-rotate-270_sflgq_32","star-rotate-270":"star-rotate-270_sflgq_32",rotate270:"rotate270_sflgq_1",starRotate180:"star-rotate-180_sflgq_35","star-rotate-180":"star-rotate-180_sflgq_35",rotate180:"rotate180_sflgq_1",starIcon:"star-icon_sflgq_38","star-icon":"star-icon_sflgq_38",starIconDark:"star-icon-dark_sflgq_49","star-icon-dark":"star-icon-dark_sflgq_49",darker:"darker_sflgq_1",writerLine:"writer-line_sflgq_52","writer-line":"writer-line_sflgq_52",writerUnderline:"writer-underline_sflgq_56","writer-underline":"writer-underline_sflgq_56",writerBubble:"writer-bubble_sflgq_69","writer-bubble":"writer-bubble_sflgq_69",starHoverRotate180:"star-hover-rotate-180_sflgq_84","star-hover-rotate-180":"star-hover-rotate-180_sflgq_84",lighter:"lighter_sflgq_1",rotate90:"rotate90_sflgq_1"}),yI.template='\n    <div\n        class="{{$style[\'mind-map-item\']}} {{$style[\'level-\' + item.level]}}"\n    >\n        <div class="{{$style[\'mind-map-item-content\']}}">\n            <div\n                s-if="{{item.level !== 1}}"\n                class="{{$style[\'star-wrapper\']}}"\n            >\n                <div\n                    class="{{$style[\'star-rotate-270\']}} {{hasTitle ? $style[\'star-hover-rotate-180\'] : \'\'}}"\n                    style="animation-iteration-count: {{hasTitle ? \'1\' : \'infinite\'}};"\n                >\n                    <div class="{{$style[\'star-icon\']}} {{hasTitle ? $style[\'star-icon-dark\'] : \'\'}}"/>\n                </div>\n            </div>\n            <tour\n                s-ref="tour"\n                key="mind-map-item"\n            >\n                <hover-tip\n                    text="{{item.title}}"\n                    show="{{isEllipsis}}"\n                >\n                    <writer\n                        text="{{item.title}}"\n                        lineClass="{{$style[\'writer-line\']}} cos-line-clamp-1"\n                        on-ellipsis="onEllipsis"\n                    >\n                        <div class="{{$style[\'writer-underline\']}} cos-line-clamp-1">{{item.title}}</div>\n                        <div s-if="hasTitle" s-ref="bubble" class="{{$style[\'writer-bubble\']}}" />\n                    </writer>\n                </hover-tip>\n            </tour>\n        </div>\n        <div\n            data-show-area\n            s-if="hasTitle"\n        >\n            <div data-show-ext="{{ubcShowLog}}"></div>\n        </div>\n    </div>\n';var wI="function"==typeof yI?yI.prototype.initData||_I:yI.initData||_I;function _I(){return{$style:bI}}function kI(){return Object.assign({},wI.call(this),{$style:bI})}function SI(){return SI=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},SI.apply(this,Array.from(arguments))}function xI(t,e){return xI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},xI(t,e)}"function"==typeof yI?yI.prototype.initData=kI:yI.initData=kI;var II="loading-mind-map",TI=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).startTime=null,e.endTime=null,e.hasSentDurationLog=!1,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xI(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{mindMapList:[],state:_p.INIT,loadingMindMapItem:{id:II,title:"",level:2},actionType:"new_q",hasSendLog:!1,showMask:!1}},n.created=function(){this.mindMapDataTransfer=new jx(this)},n.attached=function(){this.addEventBusListeners(),this.addWatchers(),this.addMaskListener()},n.detached=function(){var t;null==(t=this.mindMapDataTransfer)||t.reset(),this.mindMapDataTransfer=null,this.removeMaskListener()},n.handleDurationLog=function(t){if(!this.hasSentDurationLog)if(this.startTime){if(t===_p.COMPLETED){this.hasSentDurationLog=!0;var e=Date.now(),n=e-this.startTime;this.sendDurationLog({startTime:this.startTime,endTime:e,duration:n})}}else this.startTime=Date.now()},n.addEventBusListeners=function(){var t=this;oi().on((function(e){var n,a=e.type,i=e.data;null==(n=t.mindMapDataTransfer)||n.doMindMapAction(a,i),t.handleDurationLog(null==i?void 0:i.state)}))},n.addWatchers=function(){var t=this;this.watch("state",(function(e){switch(e){case _p.INIT:t.data.set("actionType","refresh");break;case _p.COMPLETED:t.sendShowLog(),t.showTour(),t.deleteMindMap({item:t.data.get("loadingMindMapItem"),state:_p.COMPLETED})}})),Hn().on((function(){Je.getState("rank")<1||(t.sendShowLog(),t.data.set("hasSendLog",!1),t.data.get("mindMapList").length>0&&t.data.set("actionType","inherit"))})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&(t.sendShowLog(),t.data.get("state")!==_p.COMPLETED&&t.data.set("hasSendLog",!1))})),window.addEventListener("beforeunload",(function(){t.sendShowLog()}))},n.handleItemClick=function(t,e){this.sendClickLog(t,e),Ar({query:this.getMindMapQuery(t,"switch"),extParams:{sa:"idea_clk"}}),this.showTourItemRef&&(this.showTourItemRef.closeTour(),this.showTourItemRef=null),_c()},n.getMindMapQuery=function(t,e){var n={type:"MIND_MAP",data:{mindMap:SI({},t,{operateType:e,mindMapId:this.data.get("mindMapId")})}};return[{type:"TEXT",data:{text:{query:(null==t?void 0:t.searchTitle)||(null==t?void 0:t.title),text_type:""}}},n]},n.addMindMap=function(t){var e,n,a=t.item,i=t.state,o=this.data.get("mindMapList")||[],r=this.data.get("loadingMindMapItem"),s=(null==(n=this.mindMapDataTransfer)||null==(e=n.mindMap)?void 0:e.items)||[],c=o.filter((function(t){return(null==t?void 0:t.id)!==II})).concat(a),l=i===_p.COMPLETED,d=c.length===s.length,u=l&&d;this.data.assign({state:i,mindMapList:u?c:[].concat(c,[r])})},n.updateMindMap=function(t){var e=t.item,n=t.state,a=this.data.get("mindMapList").map((function(t){return t.id===e.id?SI({},t,e):t}));this.data.assign({mindMapList:a,state:n})},n.deleteMindMap=function(t){var e=t.item,n=t.state,a=this.data.get("mindMapList").filter((function(t){return t.id!==e.id}));this.data.assign({mindMapList:a,state:n})},n.reset=function(){this.data.set("mindMapList",[this.data.get("loadingMindMapItem")]),this.data.set("state",_p.INIT),this.startTime=null,this.hasSentDurationLog=!1},n.showTour=function(){var t=this.data.get("mindMapList").find((function(t){return 2===t.level}));if(t){var e=this.ref("mindMapItem-"+t.id);e&&(this.showTourItemRef=e,e.openTour())}},n.executeAction=function(t){var e=t.type,n=t.itemInfo,a=t.cb;switch(e){case"add":this.addMindMap(n);break;case"update":this.updateMindMap(n);break;case"delete":this.deleteMindMap(n)}null==a||a()},n.close=function(){Je.dispatch("update",{showMindMap:!1})},n.sendShowLog=function(){var t=0,e=0,n=this.data.get("mindMapList").map((function(n,a){return 1===n.level?(t++,e=0):e++,{idea_query:n.title,pos:String(t),sub_pos:String(e),total_pos:String(a+1)}}));0===n.length||this.data.get("hasSendLog")||(Aa({type:"show",value:"idea",ext:{enter_type:Je.getState("pcEnterType")||"ai_tab_url",setype:"csaitab",ori_lid:Je.getState("oriLid"),lid:Je.getState("lid"),sa:Je.getState("oriSa"),re_rank:String(Je.getState("rank")),a_lid:Je.getState("apagelid"),valueInfo:[{component_name:"mindMap",component_content:n}],query:Je.getState("query"),action_type:this.data.get("actionType")}}),this.data.set("hasSendLog",!0))},n.sendClickLog=function(t,e){Aa({type:"click",value:"idea",ext:gI({mindMapList:this.data.get("mindMapList"),item:t,index:e,actionType:this.data.get("actionType")})})},n.addMaskListener=function(){var t=this,e=this.ref("scroll-container"),n=this.ref("scroll-content");this.onScroll=function(){var n=e.scrollTop,a=e.scrollHeight;n+e.clientHeight>=a-1?t.data.set("showMask",!1):t.data.set("showMask",!0)},e.addEventListener("scroll",this.onScroll),window.ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(){var n=e.scrollTop,a=e.scrollHeight;n+e.clientHeight>=a-1?t.data.set("showMask",!1):t.data.set("showMask",!0)})),this.resizeObserver.observe(n))},n.sendDurationLog=function(t){var e=t.startTime,n=t.endTime,a=t.duration;Aa({ubcId:"17630",type:"show",value:"idea_create_time",ext:SI({},fI(),{starttime:String(e),endtime:String(n),duration:String(a)})})},n.removeMaskListener=function(){var t,e=this.ref("scroll-container");null==e||e.removeEventListener("scroll",this.onScroll),this.onScroll=null,null==(t=this.resizeObserver)||t.disconnect(),this.resizeObserver=null},e}(a.Component);TI.components={"sk-loading":Hx,item:yI},TI.computed={isLoading:function(){return this.data.get("state")===_p.INIT}};var CI={};CI=Object.assign(CI,{mindMap:"mind-map_fkjr0_1","mind-map":"mind-map_fkjr0_1",showMask:"show-mask_fkjr0_21","show-mask":"show-mask_fkjr0_21",mindMapHeader:"mind-map-header_fkjr0_24","mind-map-header":"mind-map-header_fkjr0_24",mindMapHeaderIcon:"mind-map-header-icon_fkjr0_33","mind-map-header-icon":"mind-map-header-icon_fkjr0_33",mindMapListWrapper:"mind-map-list-wrapper_fkjr0_39","mind-map-list-wrapper":"mind-map-list-wrapper_fkjr0_39",mindMapListContainer:"mind-map-list-container_fkjr0_46","mind-map-list-container":"mind-map-list-container_fkjr0_46",mindMapItemContainer:"mind-map-item-container_fkjr0_53","mind-map-item-container":"mind-map-item-container_fkjr0_53"}),TI.template='\n    <div \n        class="\n            {{$style[\'mind-map\']}}\n            {{showMask ? $style[\'show-mask\'] : \'\'}}\n        "\n    >\n        <div class="{{$style[\'mind-map-header\']}}">\n            <img\n                class="{{$style[\'mind-map-header-icon\']}}"\n                src="https://psstatic.cdn.bcebos.com/basics/aichat/思路_1734335685000.png"\n                alt=""\n            />\n            灵感探索\n        </div>\n        <div\n            s-ref="scroll-container"\n            class="{{$style[\'mind-map-list-wrapper\']}}"\n        >\n            <div\n                s-ref="scroll-content"\n                class="{{$style[\'mind-map-list-container\']}}"\n            >\n                \x3c!-- 大纲思路节点内容 --\x3e\n                <div\n                    class="{{$style[\'mind-map-item-container\']}}"\n                    s-ref="mindMapItemContainer"\n                >\n                    <sk-loading s-if="{{isLoading}}" />\n                    <template s-else>\n                        <template s-for="item, index in mindMapList">\n                            <item\n                                s-ref="mindMapItem-{{item.id}}"\n                                item="{{item}}"\n                                index="{{index}}"\n                                on-click="native:handleItemClick(item, index)"\n                                action-type="{{actionType}}"\n                                mind-map-list="{{mindMapList}}"\n                            />\n                        </template>\n                    </template>\n                </div>\n            </div>\n        </div>\n    </div>\n';var LI="function"==typeof TI?TI.prototype.initData||PI:TI.initData||PI;function PI(){return{$style:CI}}function DI(){return Object.assign({},LI.call(this),{$style:CI})}function AI(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function EI(){return EI=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},EI.apply(this,Array.from(arguments))}function OI(t,e){return OI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},OI(t,e)}function RI(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof TI?TI.prototype.initData=DI:TI.initData=DI;var NI,qI=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&OI(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{agentsList:[]}},n.handleAgentClick=function(t,e){return(n=function(){var n,a,i,o,r,s;return RI(this,(function(c){switch(c.label){case 0:return[4,ws()];case 1:return c.sent()?(n=t.agentId,a=t.agentParams,i=void 0===a?{}:a,o=t.text,r=EI({actionType:"launchConversation",agentId:n,agentSearchId:n,agentName:o,logo:null==t?void 0:t.icon,startIndex:0,endIndex:o.length},i),s=Je.getState("agentQuery")||Je.getState("query"),es(r,"agent_idea_"+(e+1)),as(r,s||""),[2]):[2]}}))},function(){var t=this,e=Array.from(arguments);return new Promise((function(a,i){var o=n.apply(t,e);function r(t){AI(o,a,i,r,s,"next",t)}function s(t){AI(o,a,i,r,s,"throw",t)}r(void 0)}))})();var n},n.getUbcShowLog=function(t,e){return JSON.stringify({value:"agent_idea",query:Je.getState("query"),agent_content:[{agent_id:null==t?void 0:t.agentId,agent_name:null==t?void 0:t.text,agent_pos:e+1}]})},n.getUbcClickLog=function(t,e){return JSON.stringify({value:"agent_idea",ubcExt:{query:Je.getState("query"),agent_content:[{agent_id:null==t?void 0:t.agentId,agent_name:null==t?void 0:t.text,agent_pos:e+1}]}})},e}(a.Component);function MI(t,e){return MI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},MI(t,e)}qI.template='\n        <div class="chat-agents-list">\n            <div class="chat-agents-list-title">\n                <img class="chat-agents-list-title-icon" src="https://psstatic.cdn.bcebos.com/basics/aichat/智能体_1734335690000.png" alt="" />\n                问问智能体\n            </div>\n            <div class="chat-agents-list-content">\n                <template s-for="agent, index in agentsList">\n                    <div \n                        class="chat-agents-list-item" \n                        on-click="handleAgentClick(agent, index)"\n                        data-show-area\n                        data-show-ext="{{getUbcShowLog(agent, index)}}"\n                        need-click-log\n                        data-click-log="{{getUbcClickLog(agent, index)}}"\n                    >\n                        <div class="chat-agents-list-item-left">\n                            <img class="chat-agents-list-item-avatar" src="{{agent.icon}}" alt="" />\n                            <div class="chat-agents-list-item-info">\n                                <div class="chat-agents-list-item-name cos-line-clamp-1">{{agent.text}}</div>\n                                <div class="chat-agents-list-item-desc cos-line-clamp-1">{{agent.agentParams.description}}</div>\n                            </div>\n                        </div>\n                        <div class="chat-agents-list-item-right">\n                            <div class="chat-agents-list-item-btn">提问</div>\n                        </div>\n                    </div>\n                </template>\n            </div>\n        </div>\n    ';var jI=St.connect(Je,{showMindMap:"showMindMap"})((NI=function(t){function e(){return t.apply(this,Array.from(arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&MI(t,e)}(e,t),e.prototype.initData=function(){return{agentsList:[],showAgentNum:2}},e}(a.Component),NI.template='\n        <div class="chat-right-bar">\n            <div class="mind-map-wrapper" style="{{LayoutStyles.topLayerStyle}}">\n                <mind-map />\n            </div>\n            <div\n                s-if="showDivider"\n                class="cos-divider"\n            />\n            <div class="agents-list-wrapper" style="{{LayoutStyles.bottomLayerStyle}}">\n                <agents-list agents-list="{{showAgentsList}}" />\n            </div>\n        </div>\n    ',NI.components={"agents-list":qI,"mind-map":TI},NI.computed={showDivider:function(){var t=this.data.get("showAgentsList")||[];return this.data.get("showMindMap")&&t.length>0},LayoutStyles:function(){var t=this.data.get("showAgentsList")||[],e=this.data.get("showMindMap"),n=function(t){var e,n=t.containerHeight,a=t.agentsListSize,i=t.showMindMap,o=t.dividerHeight,r="number"==typeof n?n+"vh":n,s=0===(e=a)?0:56+40*e+18*(e-1),c=i&&a>0;return{containerStyle:{height:r},topLayerStyle:{height:i?c?"calc("+r+" - "+(s+o)+"px)":"calc("+r+" - "+s+"px)":"0px",opacity:i?1:0,transition:"all 240ms ease-in-out"},bottomLayerStyle:{height:s+"px",opacity:0===a?0:1,transition:"all 360ms ease-in-out"},showDivider:c}}({containerHeight:"100%",agentsListSize:t.length,showMindMap:e,dividerHeight:.5});return n},showAgentsList:function(){return(this.data.get("agentsList")||[]).slice(0,this.data.get("showAgentNum"))}},NI)),BI="生成中，请耐心等待～",HI="生成完成，可前往文库编辑或下载文件",$I="https://now.bdstatic.com",UI="store/v2/d4f2bff/chat-search/30c07c9/",FI={js:[$I+"/"+UI+"chat-wenku.umd.9f2536f56808ffa1eb54.js"],css:[$I+"/"+UI+"chat-wenku.umd.9f2536f56808ffa1eb54.css"]},GI={},WI={};WI=Object.assign(WI,{nxtBtn:"nxt-btn_1g1og_1","nxt-btn":"nxt-btn_1g1og_1"}),GI.template='\n    <div class="{{$style[\'nxt-btn\']}}">\n        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path\n                d="M4.96491 0.892578L9.8056 5.73327C10.5566 6.48427 10.5566 7.7019 9.8056 8.45291L4.96491 13.2936L3.33313 11.6618L7.9021 7.09309L3.33313 2.52436L4.96491 0.892578Z"\n                fill="#333333"\n            />\n        </svg>\n    </div>\n';var zI="function"==typeof GI?GI.prototype.initData||QI:GI.initData||QI;function QI(){return{$style:WI}}function JI(){return Object.assign({},zI.call(this),{$style:WI})}"function"==typeof GI?GI.prototype.initData=JI:GI.initData=JI;var VI=St.connect(Je,{showWorkspaceType:"showWorkspaceType",workspaceData:"workspaceData"})(a.defineComponent({components:{"cos-icon":e.Icon,"cos-loading":e.Loading,"cos-button":e.Button,"nxt-btn":GI},initData:function(){return{renderPptKey:"",renderFinished:!1,editorMounted:!1,remainDownloadCount:0,vipStatus:0,loadingInstance:null,leftEnd:!1,rightEnd:!1,pptsInfo:{},pptEditors:{},pptThumbnails:{},pptIdx:{},sseLock:!1,hasPptDownload:!1}},computed:{canDownload:function(){var t=this.data.get("remainDownloadCount");return t>0||1===this.data.get("vipStatus")||this.data.get("hasPptDownload")||-1===t},headerText:function(){if(this.data.get("renderFinished"))return HI;var t=this.data.get("workspaceData.wenku.pptId"),e=this.data.get("pptsInfo")[t];return"static"===(null==e?void 0:e.renderType)?"":BI},curIdx:function(){var t=this.data.get("workspaceData.wenku.pptId");return this.data.get("pptIdx")[t]||0}},attached:function(){var t=this;this.loadAnimationInstance();var e,n=this.data.get("workspaceData.wenku.pptId"),a=this.data.get("pptsInfo")[n];this.data.set("hasPptDownload",null!=(e=null==a?void 0:a.isDownload)&&e),this.watch("pptsInfo",(function(e){var n,a=t.data.get("workspaceData.wenku.pptId"),i=e[a];t.data.set("hasPptDownload",null!=(n=null==i?void 0:i.isDownload)&&n),t.loadPptEditor(i,a)})),this.data.get("sdkLoaded")&&this.loadPptEditor(a,n),this.watch("sdkLoaded",(function(e){e&&t.loadPptEditor(a,n)}))},loadPptEditor:function(t,e){var n=this,a=this.data.get("sdkLoaded");if(t&&a){var i=by(e,t.renderType);this.data.get("pptEditors")[i]||"static"!==t.renderType||(this.data.set("editorMounted",!1),this.data.set("renderFinished",!1));var o=document.querySelectorAll(".ppt-preview-root-item"),r=yy(this.data.get("workspaceData.wenku.pptId"),t.renderType);o.forEach((function(t){t.style.display="none"}));var s=document.getElementById(r);s&&(s.style.display="block"),setTimeout((function(){window.require(["@baidu/chat-wenku"],(function(a){var i=a.createPPTEditor,o=yy(e,t.renderType),r=by(e,t.renderType),s=n.data.get("pptEditors")[r];if(!s){s=i({platform:"app",disableEditSlide:!0}),n.data.set("pptEditors."+r,s);var c=document.getElementById("ppteditor-preview"),l=document.createElement("div");l.id=o,l.classList.add("ppt-preview-root-item"),c.appendChild(l),s.app.mount("#"+o),window.naChangeThumbnailSlideWidth(200),null==s||s.on("EDITOR_SLIDE_RENDERED",(function(){if(e===n.data.get("workspaceData.wenku.pptId")&&!t.endTurn){var a=t.bdjson,i=n.data.get("pptIdx")[e];i<a.length?(s.addSlideByElement(a[i]),n.data.set("pptIdx."+e,i+1)):n.data.set("sseLock",!1)}})),null==s||s.on("EDITOR_CHECK_BDJSON_FINISH",(function(){n.data.set("renderFinished",!0),n.scrollToPptCover(),n.listenerHandleScroll=n.handleScroll.bind(n);var a=wy(yy(e,t.renderType));null==a||a.addEventListener("scroll",n.listenerHandleScroll)}))}s.pptUniqId=e,n.execRenderPpt(s,t),n.data.set("editorMounted",!0)}))}),300)}},scrollToPptCover:function(){var t=this.data.get("workspaceData.wenku.pptId"),e=this.data.get("pptsInfo")[t],n=wy(yy(t,e.renderType));if(e&&n){n.scrollLeft=0;var a=n.querySelector(".thumbnail-list .thumbnail-item");a&&a.click()}},execRenderPpt:function(t,e){"static"===e.renderType?this.renderPptSlidesStatic(t,e):this.renderPptSlidesSse(t,e)},renderPptSlidesStatic:function(t,e){var n=e.bdjson;t.setSlides([]),null==t||t.setBdjson(n),null==t||t.checkBdjson(n)},renderPptSlidesSse:function(t,e){var n=e.bdjson,a=this.data.get("curIdx"),i=this.data.get("workspaceData.wenku.pptId");0===a?(t.setBdjson(n),this.data.set("pptIdx."+i,n.length)):this.data.get("sseLock")||(t.addSlideByElement(n[a]),this.data.set("pptIdx."+i,a+1),this.data.set("sseLock",!0)),e.endTurn&&(this.data.set("pptIdx."+i,n.length),t.checkBdjson(n))},jumpToWenku:function(){if(this.data.get("renderFinished")){var t=this.data.get("workspaceData.wenku.pptId"),e=this.data.get("pptsInfo")[t];if(e&&e.docId){var n=vy(e.docId);window.open(n),Aa({type:"click",value:"ppt_go_wenku",page:"resultpage",ext:{enter_type:"home_tab",setype:"csaitab",area:"pptdesk",re_rank:Je.getState("rank"),a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}})}}},downloadPptHandler:function(){this.data.get("renderFinished")&&(this.data.get("canDownload")?(si().emit({pptUniqId:this.data.get("workspaceData.wenku.pptId")}),this.data.set("hasPptDownload",!0),this.ubcDownloadClickLog("ppt_download")):(this.ubcDownloadClickLog("ppt_charge_download"),this.fire("jump-to-wenku-vip")))},ubcDownloadClickLog:function(t){Aa({type:"click",value:t,page:"resultpage",ext:{enter_type:"home_tab",setype:"csaitab",area:"pptdesk",re_rank:Je.getState("rank"),a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}})},handlePrev:function(){var t=this.data.get("workspaceData.wenku.pptId"),e=wy(yy(t,this.data.get("pptsInfo")[t].renderType)),n=this.ref("pptEditorPreview"),a=(null==n?void 0:n.clientWidth)||200;if(e){var i=e.scrollLeft,o=Math.max(i-a,0);e.scrollTo({left:o,behavior:"smooth"}),0===o&&this.data.set("leftEnd",!0)}},handleNext:function(){var t=this.data.get("workspaceData.wenku.pptId"),e=wy(yy(t,this.data.get("pptsInfo")[t].renderType)),n=this.ref("pptEditorPreview"),a=(null==n?void 0:n.clientWidth)||200;if(e){var i=e.scrollLeft,o=e.scrollWidth-e.clientWidth,r=Math.min(i+a,o);e.scrollTo({left:r,behavior:"smooth"}),r>=o&&this.data.set("rightEnd",!0)}},handleScroll:function(){var t=this.data.get("workspaceData.wenku.pptId"),e=this.data.get("pptsInfo")[t];if(e){var n=wy(yy(t,null==e?void 0:e.renderType));if(n){var a=n.scrollLeft,i=n.scrollWidth,o=n.clientWidth;this.data.set("rightEnd",Math.abs(i-o-a)<4),this.data.set("leftEnd",0===a)}}},loadAnimationInstance:function(){var e=this;new Promise((function(e,n){t(["lottie-web"],(function(t){e(d(t))}),n)})).then((function(t){var n=t.default,a={container:e.ref("pptLoading"),renderer:"svg",loop:!0,autoplay:!0,path:"https://psstatic.cdn.bcebos.com/basics/chat/ppt-big-loading_1741768414000.json"};e.data.set("loadingInstance",n.loadAnimation(a))}))},removeScrollListener:function(t){var e=this.data.get("pptsInfo")[t],n=wy(yy(t,null==e?void 0:e.renderType));n&&n.removeEventListener("scroll",this.listenerHandleScroll)},disposed:function(){var t=this;Object.keys(this.data.get("pptsInfo")).forEach((function(e){t.removeScrollListener(e);var n=t.data.get("pptsInfo")[e],a=by(e,null==n?void 0:n.renderType);t.data.get("pptEditors")[a]&&(t.data.get("pptEditors")[a].off("EDITOR_SLIDE_RENDERED"),t.data.get("pptEditors")[a].off("EDITOR_CHECK_BDJSON_FINISH"))}));var e=this.data.get("loadingInstance");e&&e.destroy()}})),KI={};KI=Object.assign(KI,{previewArea:"preview-area_1c4ch_1","preview-area":"preview-area_1c4ch_1",previewHeader:"preview-header_1c4ch_6","preview-header":"preview-header_1c4ch_6",headerText:"header-text_1c4ch_12","header-text":"header-text_1c4ch_12",pptPreviewPlaceholder:"ppt-preview-placeholder_1c4ch_18","ppt-preview-placeholder":"ppt-preview-placeholder_1c4ch_18",pptLoading:"ppt-loading_1c4ch_23","ppt-loading":"ppt-loading_1c4ch_23",pptLoadingSubImg:"ppt-loading-sub-img_1c4ch_31","ppt-loading-sub-img":"ppt-loading-sub-img_1c4ch_31",csLoading:"cs-loading_1c4ch_39","cs-loading":"cs-loading_1c4ch_39",pptPreviewRoot:"ppt-preview-root_1c4ch_50","ppt-preview-root":"ppt-preview-root_1c4ch_50",ppteditorPreviewContainer:"ppteditor-preview-container_1c4ch_54","ppteditor-preview-container":"ppteditor-preview-container_1c4ch_54",ppteditorPreview:"ppteditor-preview_1c4ch_54","ppteditor-preview":"ppteditor-preview_1c4ch_54",previewFooter:"preview-footer_1c4ch_134","preview-footer":"preview-footer_1c4ch_134",cosButtonContent:"cos-button-content_1c4ch_145","cos-button-content":"cos-button-content_1c4ch_145",btn:"btn_1c4ch_154",downloadBtn:"download-btn_1c4ch_170","download-btn":"download-btn_1c4ch_170",editBtn:"edit-btn_1c4ch_177","edit-btn":"edit-btn_1c4ch_177",editIcon:"edit-icon_1c4ch_182","edit-icon":"edit-icon_1c4ch_182",remainDownloadCount:"remain-download-count_1c4ch_189","remain-download-count":"remain-download-count_1c4ch_189",nxtMask:"nxt-mask_1c4ch_194","nxt-mask":"nxt-mask_1c4ch_194",preMask:"pre-mask_1c4ch_195","pre-mask":"pre-mask_1c4ch_195",visible:"visible_1c4ch_204",nxtBtn:"nxt-btn_1c4ch_210","nxt-btn":"nxt-btn_1c4ch_210",preBtn:"pre-btn_1c4ch_212","pre-btn":"pre-btn_1c4ch_212"}),VI.template='\n    <div class="{{$style[\'preview-area\']}}">\n        <div class="{{$style[\'preview-header\']}}">\n            <div class="{{$style[\'header-text\']}}">{{ headerText }}</div>\n        </div>\n        <div class="{{$style[\'ppt-preview-placeholder\']}}">\n            <div\n                s-show="!editorMounted"\n                class="{{$style[\'ppt-loading\']}}"\n            >\n                <div class="{{$style[\'ppt-loading-sub-img\']}}">\n                    <cos-loading\n                        text=""\n                        class="{{$style[\'cs-loading\']}}"\n                    />\n                </div>\n                <div\n                    s-ref="pptLoading"\n                    class="{{$style[\'ppt-loading-img\']}}"\n                >\n                </div>\n            </div>\n            <div\n                id="ppt-preview-root"\n                class="{{$style[\'ppt-preview-root\']}}"\n            >\n                <div class="{{$style[\'ppteditor-preview-container\']}} cs-ppt">\n                    <div\n                        s-ref="pptEditorPreview"\n                        id="ppteditor-preview"\n                        class="{{$style[\'ppteditor-preview\']}}"\n                    ></div>\n                    <div\n                        class="\n                        {{$style[\'pre-mask\']}}\n                        {{!leftEnd ? $style.visible : \'\'}}\n                    "\n                    >\n                        <div\n                            class="{{$style[\'pre-btn\']}}"\n                            on-click="handlePrev"\n                        >\n                            <nxt-btn />\n                        </div>\n                    </div>\n                    <div\n                        class="\n                        {{$style[\'nxt-mask\']}}\n                        {{!rightEnd ? $style.visible : \'\'}}\n                    "\n                    >\n                        <div\n                            class="{{$style[\'nxt-btn\']}}"\n                            on-click="handleNext"\n                        >\n                            <nxt-btn />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="{{$style[\'preview-footer\']}}">\n            <cos-button\n                appearance="text"\n                on-click="jumpToWenku"\n                disabled="{{!renderFinished}}"\n                class="loading-text\n                    {{$style.btn}}\n                    {{$style[\'edit-btn\']}}"\n            >\n                <img\n                    class="{{$style[\'edit-icon\']}}\n                        cos-space-mr-xxs"\n                    src="https://psstatic.cdn.bcebos.com/basics/chat/logo_1741863562000.svg"\n                    alt="wenku-logo"\n                />\n                <span>去文库编辑</span>\n            </cos-button>\n            <cos-button\n                disabled="{{!renderFinished}}"\n                on-click="downloadPptHandler"\n                class="loading-primary\n                    {{$style.btn}}\n                    {{$style[\'download-btn\']}}"\n            >\n                <cos-icon\n                    class="\n                    {{$style[\'download-icon\']}}\n                    cos-space-mr-xxs"\n                    style="font-size: 16px"\n                    name="download"\n                />\n                <span s-if="canDownload">\n                    <span>{{ hasPptDownload ? \'已下载\' : \'下载\' }}</span>\n                    <span\n                        s-if="vipStatus !== 1 && !hasPptDownload && remainDownloadCount !== -1"\n                        class="{{$style[\'remain-download-count\']}}"\n                    >\n                        (剩余{{ remainDownloadCount }}次)</span\n                    >\n                </span>\n                <span s-else>去文库开通会员下载</span>\n            </cos-button>\n        </div>\n    </div>\n';var XI="function"==typeof VI?VI.prototype.initData||YI:VI.initData||YI;function YI(){return{$style:KI}}function ZI(){return Object.assign({},XI.call(this),{$style:KI})}"function"==typeof VI?VI.prototype.initData=ZI:VI.initData=ZI;var tT=a.defineComponent({components:{},computed:{},created:function(){},initData:function(){return{themeInfo:"",index:"",selectIndex:"",vipStatus:0}},attached:function(){var t=this;this.handleLazyLoad(),this.watch("themeInfo",(function(){t.handleLazyLoad()}))},handleLazyLoad:function(){var t=this,e=new IntersectionObserver((function(t,e){t.forEach((function(t){if(t.isIntersecting){var n=t.target,a=n.getAttribute("data-src");n&&a&&(n.setAttribute("src",a),e.unobserve(n))}}))}),{rootMargin:"0px 200px"});this.nextTick((function(){var n=t.ref("themeImg");n&&e.observe(n);for(var a=0;a<3;a++){var i=t.ref("themeImg"+a);i&&e.observe(i)}})),this.observer=e},handleSelectTheme:function(){this.data.set("selectIndex",this.data.get("index"))},disposed:function(){this.observer&&(this.observer.disconnect(),this.observer=null)}}),eT={};eT=Object.assign(eT,{pptImgTheme:"ppt-img-theme_w7txe_1","ppt-img-theme":"ppt-img-theme_w7txe_1",pptImgThemeFree:"ppt-img-theme-free_w7txe_11","ppt-img-theme-free":"ppt-img-theme-free_w7txe_11",selected:"selected_w7txe_24",pptImgThemeLeft:"ppt-img-theme-left_w7txe_28","ppt-img-theme-left":"ppt-img-theme-left_w7txe_28",pptImgThemeLeftImg:"ppt-img-theme-left-img_w7txe_32","ppt-img-theme-left-img":"ppt-img-theme-left-img_w7txe_32",pptImgThemeRight:"ppt-img-theme-right_w7txe_40","ppt-img-theme-right":"ppt-img-theme-right_w7txe_40",pptImgThemeRightImg:"ppt-img-theme-right-img_w7txe_47","ppt-img-theme-right-img":"ppt-img-theme-right-img_w7txe_47"}),tT.template='\n    <div\n        class="{{$style[\'ppt-img-theme\']}} {{index === selectIndex ? $style[\'selected\'] : \'\'}}"\n        on-click="handleSelectTheme"\n        s-ref="themeContainer"\n    >\n        <div\n            class="{{$style[\'ppt-img-theme-free\']}}"\n            s-if="themeInfo.isVipTheme && vipStatus === 0"\n        >\n            限免\n        </div>\n        <div class="{{$style[\'ppt-img-theme-left\']}}">\n            <img\n                class="{{$style[\'ppt-img-theme-left-img\']}}"\n                s-ref="themeImg"\n                data-src="{{themeInfo.pcSelectUrl}}"\n                alt=""\n            />\n        </div>\n        <div class="{{$style[\'ppt-img-theme-right\']}}">\n            <img\n                class="{{$style[\'ppt-img-theme-right-img\']}}"\n                s-for="item, index in themeInfo.pcrotateImgUrl"\n                s-ref="{{\'themeImg\' + index}}"\n                data-src="{{item.url}}"\n                alt=""\n            />\n        </div>\n    </div>\n';var nT="function"==typeof tT?tT.prototype.initData||aT:tT.initData||aT;function aT(){return{$style:eT}}function iT(){return Object.assign({},nT.call(this),{$style:eT})}"function"==typeof tT?tT.prototype.initData=iT:tT.initData=iT;var oT=a.defineComponent({trimWhitespace:"all",components:{"ppt-img-theme":tT,"cos-icon":e.Icon,"cos-button":e.Button},computed:{isWenkuWhite:function(){return-1===this.data.get("remainGenerateCount")},isInitShow:function(){return-2===this.data.get("remainGenerateCount")}},created:function(){},initData:function(){return{templateList:[],themeId:"",selectIndex:0,showLeftButton:!1,showRightButton:!1,isScrolling:!1,vipStatus:0,remainGenerateCount:0,outlineLid:"",outlineQid:""}},attached:function(){var t=this;setTimeout((function(){t.updateButtonVisibility()}),500),this.updateButtonVisibilityOB=this.updateButtonVisibility.bind(this),window.addEventListener("resize",this.updateButtonVisibilityOB)},handlePptBtnClick:function(){var t;"1"===(null==(t=document.getElementById("outline-editor"+this.data.get("outlineQid")))?void 0:t.getAttribute("has-empty-title"))?ci().emit({outlineQid:this.data.get("outlineQid")}):this.handleGeneratePPT()},handleGeneratePPT:function(){var t={type:"click",value:"ppt_generate",page:"resultpage",ext:{enter_type:"home_tab",setype:"csaitab",area:"pptdesk",is_plugin:"0",re_rank:Je.getState("rank"),a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}};if(this.data.get("remainGenerateCount")<=0&&!this.data.get("isWenkuWhite"))this.data.get("vipStatus")?e.Toast.show({message:"本月PPT生成达会员上限，可切换百度账号继续体验。",duration:2e3}):(this.fire("jump-to-wenku-vip"),e.Toast.show({message:"生成需去文库开通会员"}),t.value="ppt_charge_time",Aa(t));else{var n=this.data.get("templateList")[this.data.get("selectIndex")];this.updatePptRanks(),Ar({query:"基于大纲和所选模板生成PPT",extParams:{sa:"pptdesk_generate",interactionType:5,searchInfo:{pptInfo:{outlineLid:this.data.get("outlineLid"),outlineQid:this.data.get("outlineQid"),themeId:this.data.get("themeId"),styleId:n.styleId,tplId:n.tplId}}}}),this.fire("update-remain-count"),t.value="ppt_generate",Aa(t),this.nextTick((function(){ri().emit({type:"ppt-active"})}))}},updatePptRanks:function(){var t=Je.getState("pptRanks")||[],e=Je.getState("curRankInfo.rank")+1,n=Je.getState("withoutStopSseRanks")||[];Je.dispatch("update",{pptRanks:[].concat(t,[e]),withoutStopSseRanks:[].concat(n,[e])})},getLogInfo:function(t){return JSON.stringify({type:"click",value:t,page:"resultpage",ubcExt:{enter_type:"home_tab",setype:"csaitab",area:"pptdesk"}})},updateButtonVisibility:function(){var t=this.ref("scrollContainer");if(t){var e=t.scrollLeft,n=t.scrollWidth,a=t.clientWidth;this.data.set("showLeftButton",Math.floor(e)>0),this.data.set("showRightButton",Math.ceil(e)<n-a)}},handleScrollAction:function(t,e){var n=this;void 0===e&&(e=500),this.data.get("isScrolling")||(this.data.set("isScrolling",!0),t(),setTimeout((function(){n.data.set("isScrolling",!1)}),e))},handleScroll:function(t){var e=this;this.handleScrollAction((function(){var n=e.ref("scrollContainer");if(n){var a=n.clientWidth;n.scrollBy({left:"left"===t?-a:a,behavior:"smooth"})}}))},disposed:function(){window.removeEventListener("resize",this.updateButtonVisibilityOB)}}),rT={};rT=Object.assign(rT,{chatPptContainer:"chat-ppt-container_1mumr_1","chat-ppt-container":"chat-ppt-container_1mumr_1",chatPptContainerHeader:"chat-ppt-container-header_1mumr_6","chat-ppt-container-header":"chat-ppt-container-header_1mumr_6",chatPptContainerHeaderTitle:"chat-ppt-container-header-title_1mumr_9","chat-ppt-container-header-title":"chat-ppt-container-header-title_1mumr_9",chatPptContainerHeaderText:"chat-ppt-container-header-text_1mumr_15","chat-ppt-container-header-text":"chat-ppt-container-header-text_1mumr_15",chatPptThemeListContainer:"chat-ppt-theme-list-container_1mumr_21","chat-ppt-theme-list-container":"chat-ppt-theme-list-container_1mumr_21",chatPptThemeListLeft:"chat-ppt-theme-list-left_1mumr_27","chat-ppt-theme-list-left":"chat-ppt-theme-list-left_1mumr_27",hidden:"hidden_1mumr_40",leftIconWrapper:"left-icon-wrapper_1mumr_44","left-icon-wrapper":"left-icon-wrapper_1mumr_44",csIconLeft:"cs-icon-left_1mumr_59","cs-icon-left":"cs-icon-left_1mumr_59",chatPptThemeListRight:"chat-ppt-theme-list-right_1mumr_70","chat-ppt-theme-list-right":"chat-ppt-theme-list-right_1mumr_70",rightIconWrapper:"right-icon-wrapper_1mumr_87","right-icon-wrapper":"right-icon-wrapper_1mumr_87",csIconRight:"cs-icon-right_1mumr_102","cs-icon-right":"cs-icon-right_1mumr_102",chatPptThemeList:"chat-ppt-theme-list_1mumr_21","chat-ppt-theme-list":"chat-ppt-theme-list_1mumr_21",chatPptThemeListWrapper:"chat-ppt-theme-list-wrapper_1mumr_126","chat-ppt-theme-list-wrapper":"chat-ppt-theme-list-wrapper_1mumr_126",chatPptThemePreview:"chat-ppt-theme-preview_1mumr_136","chat-ppt-theme-preview":"chat-ppt-theme-preview_1mumr_136",chatPptThemePreviewWrapper:"chat-ppt-theme-preview-wrapper_1mumr_139","chat-ppt-theme-preview-wrapper":"chat-ppt-theme-preview-wrapper_1mumr_139",chatPptThemePreviewWrapperImg:"chat-ppt-theme-preview-wrapper-img_1mumr_158","chat-ppt-theme-preview-wrapper-img":"chat-ppt-theme-preview-wrapper-img_1mumr_158",chatPptThemePreviewFooter:"chat-ppt-theme-preview-footer_1mumr_162","chat-ppt-theme-preview-footer":"chat-ppt-theme-preview-footer_1mumr_162",cosButtonContent:"cos-button-content_1mumr_172","cos-button-content":"cos-button-content_1mumr_172",btn:"btn_1mumr_180",generateBtn:"generate-btn_1mumr_195","generate-btn":"generate-btn_1mumr_195",pptLogo:"ppt-logo_1mumr_199","ppt-logo":"ppt-logo_1mumr_199",remainGenerateCount:"remain-generate-count_1mumr_207","remain-generate-count":"remain-generate-count_1mumr_207"}),oT.template='\n    <div class="{{$style[\'chat-ppt-container\']}}">\n        <div class="{{$style[\'chat-ppt-container-header\']}}">\n            <div class="{{$style[\'chat-ppt-container-header-title\']}}"> 选择模版 </div>\n            <div class="{{$style[\'chat-ppt-container-header-text\']}}">\n                选择一个喜欢的主题风格，点击开始生成PPT进入预览模式\n            </div>\n        </div>\n        <div class="{{$style[\'chat-ppt-theme-list-container\']}}">\n            <div class="{{$style[\'chat-ppt-theme-list-left\']}} {{!showLeftButton ? $style.hidden : \'\'}}">\n                <div\n                    class="{{$style[\'left-icon-wrapper\']}}"\n                    on-click="handleScroll(\'left\')"\n                    data-click-log="{{getLogInfo(\'ppt_change_left\')}}"\n                    need-click-log\n                >\n                    <cos-icon\n                        class="{{$style[\'cs-icon-left\']}}"\n                        name="left"\n                    />\n                </div>\n            </div>\n            <div class="{{$style[\'chat-ppt-theme-list-right\']}} {{!showRightButton ? $style.hidden : \'\'}}">\n                <div\n                    class="{{$style[\'right-icon-wrapper\']}}"\n                    on-click="handleScroll(\'right\')"\n                    data-click-log="{{getLogInfo(\'ppt_change_right\')}}"\n                    need-click-log\n                >\n                    <cos-icon\n                        class="{{$style[\'cs-icon-right\']}}"\n                        name="right"\n                    />\n                </div>\n            </div>\n            <div\n                class="{{$style[\'chat-ppt-theme-list\']}}"\n                s-ref="scrollContainer"\n                on-scroll="updateButtonVisibility"\n            >\n                <div class="{{$style[\'chat-ppt-theme-list-wrapper\']}}">\n                    <ppt-img-theme\n                        s-for="item, index in templateList"\n                        theme-info="{{item}}"\n                        index="{{index}}"\n                        select-index="{=selectIndex=}"\n                        vip-status="{{vipStatus}}"\n                    />\n                </div>\n            </div>\n        </div>\n        <div class="{{$style[\'chat-ppt-theme-preview\']}}">\n            <div class="{{$style[\'chat-ppt-theme-preview-wrapper\']}}">\n                <img\n                    class="{{$style[\'chat-ppt-theme-preview-wrapper-img\']}}"\n                    src="{{templateList[selectIndex].pcSelectUrl}}"\n                    alt=""\n                />\n            </div>\n        </div>\n        <div class="{{$style[\'chat-ppt-theme-preview-footer\']}}">\n            <cos-button\n                disabled="{{!isWenkuWhite && vipStatus && remainGenerateCount <= 0}}"\n                need-click-log\n                on-click="handlePptBtnClick"\n                class="{{$style.btn}} {{$style[\'generate-btn\']}}"\n            >\n                <img\n                    class="{{$style[\'ppt-logo\']}}"\n                    src="https://psstatic.cdn.bcebos.com/basics/chat/btn-ppt-logo_1742195947000.svg"\n                    alt=""\n                />\n                <span s-if="remainGenerateCount > 0 || isInitShow || isWenkuWhite">\n                    <span>开始生成PPT</span>\n                    <span\n                        s-if="remainGenerateCount > 0"\n                        class="{{$style[\'remain-generate-count\']}}"\n                    >\n                        (剩余{{ remainGenerateCount }}次)\n                    </span>\n                </span>\n                <span s-else>\n                    <span s-if="vipStatus">PPT生成次数已用完</span>\n                    <span s-else>生成需去文库开通会员</span>\n                </span>\n            </cos-button>\n        </div>\n    </div>\n';var sT="function"==typeof oT?oT.prototype.initData||cT:oT.initData||cT;function cT(){return{$style:rT}}function lT(){return Object.assign({},sT.call(this),{$style:rT})}function dT(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function uT(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){dT(o,a,i,r,s,"next",t)}function s(t){dT(o,a,i,r,s,"throw",t)}r(void 0)}))}}function pT(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}"function"==typeof oT?oT.prototype.initData=lT:oT.initData=lT;var hT=St.connect(Je,{showWorkspaceType:"showWorkspaceType"})(a.defineComponent({pollingTimer:null,components:{"ppt-panel":VI,"ppt-template":oT},initData:function(){return{vipStatus:1,remainDownloadCount:0,remainGenerateCount:-2,currentTab:"",outlineLid:"",outlineQid:"",templateList:[],themeId:"",pptsInfo:{},sdkLoaded:!1}},attached:function(){var t=this;this.microLoader=ky(),ri().on((function(e){var n=e.type,a=e.data,i=e.pptUniqId;"template"===n&&(t.data.set("currentTab","template-view"),t.data.set("outlineLid",a.outlineLid),t.data.set("outlineQid",a.outlineQid),t.data.set("templateList",a.templateList),t.data.set("themeId",a.themeId)),"ppt"===n&&(t.data.set("pptsInfo."+i,a),a.endTurn&&t.getRemainCountsHandler()),"ppt-active"===n&&t.data.set("currentTab","ppt-view"),"updateUserInfo"===n&&t.getRemainCountsHandler()})),this.watch("showWorkspaceType",(function(e){"wenku"===e?(t.getRemainCountsHandler(),t.microLoader.loadMicroApp(FI).then((function(){t.data.set("sdkLoaded",!0)}))):t.data.assign({currentTab:"",outlineLid:"",outlineQid:"",templateList:[],themeId:""})})),this.handleStopGenerate(),Mn().on((function(t){var e=t.rank;Je.getState("pptRanks").includes(e)&&Je.dispatch("update",{showWorkspaceType:""})})),di().on((function(e){var n=e.curBlock,a=e.rank,i=Je.getState("pptRanks").includes(a),o=t.data.get("templateList").length>0;"ppt-viewer"!==(null==n?void 0:n.component)&&i&&o&&t.data.set("currentTab","template-view")}))},handleStopGenerate:function(){var t=On().conversation.stopConversation;null==t||t.on((function(){var t=Je.getState("pptRanks"),e=Je.getState("curRankInfo.rank");t.includes(e)&&t[t.length-1]===e&&Je.dispatch("update",{showWorkspaceType:""})}))},getRemainCountsHandler:function(){return uT((function(){var t,e,n,a;return pT(this,(function(i){switch(i.label){case 0:return[4,ja(Je.getState("chatParams").sse_host+"/aichat/api/ppt/userinfo?tk="+$r(),{credentials:"include"},2e3).then((function(t){return 1003===t.status?Promise.reject():0===t.status&&t.data?Promise.resolve(t.data):Promise.reject()})).catch((function(t){}))];case 1:return(t=i.sent())?(e=t.vipStatus,n=t.pptGenerate,a=t.pptDownload,this.data.set("remainDownloadCount",a.left),this.data.set("remainGenerateCount",n.left),this.data.set("vipStatus",e),[2,t]):[2,Promise.reject()]}}))})).apply(this)},jumpToWenkuVip:function(){return uT((function(){var t,e;return pT(this,(function(n){return t=this,e=function(){"visible"===document.visibilityState&&(t.startPollingRemainCount(),window.removeEventListener("visibilitychange",e))},window.addEventListener("visibilitychange",e),"ppt-view"===this.data.get("currentTab")?window.open("https://wenku.baidu.com/ndbusiness/browse/wenkuvipcashier?third_fr=search_ppt&cashier_code=P*search_ppt-L*ppt_download"):window.open("https://wenku.baidu.com/ndbusiness/browse/wenkuvipcashier?third_fr=search_ppt&cashier_code=P*search_ppt-L*ppt_generation"),[2]}))})).apply(this)},startPollingRemainCount:function(){this.clearPollingTimer(),e.Toast.show({message:"正在支付中..."});var t=Date.now(),n=this,a=uT((function(){var i,o,r,s,c,l;return pT(this,(function(d){switch(d.label){case 0:return[4,n.getRemainCountsHandler()];case 1:return d.sent(),i=n.data.get("vipStatus"),o=n.data.get("remainDownloadCount"),r=n.data.get("remainGenerateCount"),s="ppt-view"===n.data.get("currentTab")&&o>0,c="template-view"===n.data.get("currentTab")&&r>0,l=Date.now()-t>=6e5,1===i||s||c||l?(l?e.Toast.error({message:"支付失败，请重新跳转支付"}):e.Toast.success({message:"支付成功"}),n.clearPollingTimer(),[2]):(n.pollingTimer=setTimeout(a,2e3),[2])}}))}));a()},clearPollingTimer:function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)},disposed:function(){this.clearPollingTimer()}})),fT={};fT=Object.assign(fT,{workspaceStageContainer:"workspace-stage-container_1enzs_1","workspace-stage-container":"workspace-stage-container_1enzs_1",workspaceStageContent:"workspace-stage-content_1enzs_8","workspace-stage-content":"workspace-stage-content_1enzs_8"}),hT.template='\n    <div class="{{$style[\'workspace-stage-container\']}}">\n        <div class="{{$style[\'workspace-stage-content\']}}">\n            <ppt-panel\n                s-if="currentTab === \'ppt-view\'"\n                vip-status="{{vipStatus}}"\n                current-tab="{{currentTab}}"\n                sdk-loaded="{{sdkLoaded}}"\n                ppts-info="{{pptsInfo}}"\n                remain-download-count="{{remainDownloadCount}}"\n                remain-generate-count="{{remainGenerateCount}}"\n                on-update-remain-count="getRemainCountsHandler"\n                on-jump-to-wenku-vip="jumpToWenkuVip"\n            />\n            <ppt-template\n                s-if="currentTab === \'template-view\'"\n                outline-lid="{{outlineLid}}"\n                outline-qid="{{outlineQid}}"\n                vip-status="{{vipStatus}}"\n                remain-generate-count="{{remainGenerateCount}}"\n                template-list="{{templateList}}"\n                theme-id="{{themeId}}"\n                on-jump-to-wenku-vip="jumpToWenkuVip"\n                on-update-remain-count="getRemainCountsHandler"\n            />\n        </div>\n    </div>\n';var gT="function"==typeof hT?hT.prototype.initData||mT:hT.initData||mT;function mT(){return{$style:fT}}function vT(){return Object.assign({},gT.call(this),{$style:fT})}"function"==typeof hT?hT.prototype.initData=vT:hT.initData=vT;var yT=St.connect(Je,{showWorkspaceType:"showWorkspaceType"})(a.defineComponent({trimWhitespace:"all",components:{"wenku-workspace":hT,"cos-icon":e.Icon},messages:{"open-workspace-stage":function(t){t&&Je.dispatch("update",{showWorkspaceType:t})},"close-workspace-stage":function(){this.closeWorkspace()}},attached:function(){var t=this;this.watch("showWorkspaceType",(function(e){""===e&&(t.sendLog(),Je.dispatch("update",{workspaceData:{wenku:{outlineLid:"",outlineQid:"",pptId:""}}})),"wenku"!==e&&Je.dispatch("update",{workspaceData:{wenku:{outlineLid:"",outlineQid:"",pptId:""}}})}))},sendLog:function(){Aa({type:"click",value:"ppt_desk_close",page:"resultpage",ext:{enter_type:"home_tab",setype:"csaitab",area:"pptdesk",re_rank:Je.getState("rank"),a_lid:Je.getState("apagelid"),ori_lid:Je.getState("oriLid"),lid:Je.getState("lid")}})},closeWorkspace:function(){Je.dispatch("update",{showWorkspaceType:""})}})),bT={};bT=Object.assign(bT,{workspaceStage:"workspace-stage_1993s_1","workspace-stage":"workspace-stage_1993s_1",closeIcon:"close-icon_1993s_8","close-icon":"close-icon_1993s_8"}),yT.template='\n    <div class="{{$style[\'workspace-stage\']}}">\n        <cos-icon\n            name="close"\n            class="{{$style[\'close-icon\']}}"\n            on-click="native:closeWorkspace"\n        />\n        <wenku-workspace s-show="showWorkspaceType === \'wenku\'" />\n    </div>\n';var wT="function"==typeof yT?yT.prototype.initData||_T:yT.initData||_T;function _T(){return{$style:bT}}function kT(){return Object.assign({},wT.call(this),{$style:bT})}function ST(){!function(t){_r.onPulldown(t)}(_n((function(){var t=gs(),e=Je.getState("isHistoryLoading"),n=Je.getState("pulldownDisabled");!t||e||n||(Je.dispatch("update",{isHistoryLoading:!0}),Wn().emit({state:$o.LOADING}),Rr(Qo("pc"===rt()||Jo()?{reqType:"5"}:{})))}),1e3,{leading:!0,trailing:!1}))}function xT(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function IT(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){xT(o,a,i,r,s,"next",t)}function s(t){xT(o,a,i,r,s,"throw",t)}r(void 0)}))}}function TT(){return TT=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},TT.apply(this,Array.from(arguments))}function CT(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function LT(){var t=On(),e=t.conversation.stopConversation,n=t.conversation.retryGenerate,a=t.conversation.regenerate,i=t.conversation.fillerEmptyHeight;null==e||e.on((function(){var t=Je.getState("rank");Je.getState("withoutStopSseRanks").includes(t)||_r.stopGenerate()})),null==n||n.on((function(t){!function(t,e,n,a,i){_r.retry(t,e,n,a,i)}(t.qid,t.aid,t.requestType,t.sseExtraData,{})})),null==a||a.on((function(t){!function(t,e,n){_r.regenerate(t,e,n)}(t.qid,t.requestType,t.sseExtraData)})),null==i||i.on((function(t){!function(t){_r.fillerEmptyHeight(t)}(t)}))}function PT(t){return DT.apply(this,Array.from(arguments))}function DT(){return DT=IT((function(t){var e,n,a,i,o,r,s,c,l,d,u,p,h,f,g;return CT(this,(function(m){return"search"!==t.name?[2]:((i=t.params).imageExtInfo&&(i.query="[图片]"),o=Je.getState("user"),r=Oe({eventParams:i,user:o}),s=r.agentInfo,c=Je.getState("chatParams").setype,es(s,i.agentSa),0===Je.getState("rank")&&(r.firstRankQuery=is(r.query,r.agentInfo)),Je.dispatch("update",TT({},r)),l=Je.getState("chatPageInitialized"),d={query:r.query,extParams:TT({setype:c,imageQueryInfo:r.imageQueryInfo},r.shareId?{share_id:r.shareId}:{},i.interactionType?{interactionType:i.interactionType}:{}),showQAPair:!!l},u=null==r||null==(n=r.imageQueryInfo)||null==(e=n.imageExtInfo.params)?void 0:e.rank,"CHANGE_QUESTION"===(null==r||null==(a=r.imageQueryInfo)?void 0:a.imageExtInfo.actionType)?($n().emit({rank:u,rectIndex:(null==r||null==(h=r.imageQueryInfo)||null==(p=h.imageExtInfo)?void 0:p.rectIndex)||0,rectList:(null==r||null==(g=r.imageQueryInfo)||null==(f=g.imageExtInfo)?void 0:f.rectList)||[]}),[2]):(Vs(r.query),+r.isShowHello||Ar(d,!1,"SSE"),[2]))}))})),DT.apply(this,Array.from(arguments))}function AT(){return(AT=IT((function(){var t,e,n,a,i,o,r,s,c;return CT(this,(function(l){return t=Je.getState("query"),e=Je.getState("sa"),n=Je.getState("shareId"),a=Je.getState("chatParams").setype,i=+Je.getState("isShowHello"),o=Je.getState("oriLid"),t||i?(r=Je.getState("chatPageInitialized"),s={query:t,extParams:TT({sa:e,setype:a},n?{share_id:n}:{}),showQAPair:!!r},(c=Je.getState("agentInfo"))&&c.agentSearchId&&(Je.dispatch("update",{agentRank:1,firstRankQuery:is(t,c)}),s.extParams.agt_rk=1),Vs({query:t,oriLid:o},!0),i||Ar(s,true),[2]):[2]}))}))).apply(this,Array.from(arguments))}"function"==typeof yT?yT.prototype.initData=kT:yT.initData=kT;var ET=!1;function OT(){window.chatSearchContainer||(window.chatSearchContainer={}),Object.assign(window.chatSearchContainer,{getEventInstance:On,launchSearch:function(t){var e=t.word,n=t.sa;n&&Je.dispatch("update",{sa:n}),Ar({query:e})},getCurrentPageLogInfo:function(t){var e,n,a=t.closest(""+Vt),i=(null==a||null==(n=a.sandbox)||null==(e=n.window)?void 0:e.comm)||{};return{rank:i.chatRank,lid:i.lid,ori_lid:Je.getState("oriLid")}}}),window.chatSearchContainer.hasOwnProperty("currentRank")||Object.defineProperty(window.chatSearchContainer,"currentRank",{get:function(){return Je.getState("rank")}}),window.chatSearchContainer.hasOwnProperty("sessionId")||Object.defineProperty(window.chatSearchContainer,"sessionId",{get:function(){return Je.getState("oriLid")}}),ET||(Ya().on(wn(PT,200,{leading:!0,trailing:!1})),LT(),ET=!0),function(){AT.apply(this,Array.from(arguments))}(),ST()}var RT=St.connect(Je,{showMindMap:"showMindMap",showWorkspaceType:"showWorkspaceType"})(a.defineComponent({components:{"chat-input-box":Jl,"back-to-generate":Ix,"right-bar":jI,"workspace-stage":yT},computed:{hasRightBar:function(){var t=this.data.get("showMindMap"),e=this.data.get("showWorkspaceType"),n=this.data.get("agentsList");return t||e||!!n.length}},created:function(){Fo("")},initData:function(){return{agentsList:[],isExtension:ft()}},attached:function(){!function(t){var e=t.containerDom,n=t.containerSanComponent,a=t.Question,i=t.ImageQuestion,o=t.FileQuestion,s=t.Answer,c=t.Header,l=t.AgentGreeting,d=t.Guide,u=t.Footer,p=t.AnswerTips,h=t.ssehost,f=t.sseWshost,g=t.scrollMode,m=t.upwardMargin,v=Je.getState("urlInfo")||{},y=ct()?v.conversationPath:$t.conversation;_r=new r.ChatStream({upwardMargin:m,questionBubbles:{text:a,image:i,file:o},answerBubble:s,tipComponents:{dangerTip:xi,historyTips:lr,guide:d,agentGreeting:l,answerTips:p},headerComponent:c,footerComponent:u,containerDom:e,containerSanComponent:n,scrollMode:g,requestService:{dangerCheck:{host:(h||"https://chat.baidu.com")+"/aichat/api/checkquerydanger",paramsHandler:Gr,failCallback:function(t){var e=t.QAInfo;vr(),Je.dispatch("update",{rank:e.id}),jn().emit({word:yt(e.promptContent),invokeKeyboard:0,type:"query"})}},searchGenerate:{host:"/s",ssehost:zr((f||"https://chat.baidu.com")+y),paramsHandler:Hr,degradeParamsHandler:Fr,callbacks:{onMessageHandler:function(t){var e;if("baseData"===(null==(e=t.data)?void 0:e.type)){if(Je.getState("imageQueryLid")[t.id])return;var n,a=Je.getState("imageQueryLid");Je.dispatch("update",{imageQueryLid:Ir((n={},n[t.id]=t.data.lid,n),a)})}}}},history:{host:(h||"https://chat.baidu.com")+"/csaitab/history/list",callback:Vo,preprocessHistoryData:sr},delete:{host:(h||"https://chat.baidu.com")+"/csaitab/history/delete",callback:Wr}}}),_r.init(),Qr&&Mn().off(Qr),Qr=function(t){if(Je.getState("rank")===t.rank&&"delete-rank-show-toast"===t.type){var e=Je.getState("qaPairIdDiff"),n=t.rank-e;_r.deleteQAPair(n,{},!0),vr()}},Mn().on(Qr)}({Question:Wk,ImageQuestion:yS,FileQuestion:PS,Answer:$k,Header:bx,Guide:qu,Footer:Lx,AgentGreeting:NS,containerDom:this.ref("chat-stream"),containerSanComponent:this,ssehost:Je.getState("chatParams").sse_host,sseWshost:Je.getState("chatParams").sse_ws_host,scrollMode:"container",upwardMargin:0}),this.rightBarDisplayHandler(),OT(),this.sendPageShowLog()},sendPageShowLog:function(){var t=Je.getState("pcEnterType")||"ai_tab_url",e=Je.getState("sa"),n=Je.getState("apagelid"),a=Je.getState("subEnterType"),i=Je.getState("agentInfo");Aa({type:"display",value:"",ext:{sa:e||"",a_lid:n||"",agent_id:(null==i?void 0:i.agentId)||"",agent_name:(null==i?void 0:i.agentName)||"",enter_type:t,sub_ori_lid:"",sub_re_rank:"0",sub_enter_type:a||"",setype:"csaitab"}})},handleCapsuleShow:null,rightBarDisplayHandler:function(){var t=this;this.data.get("isExtension")||(this.watch("hasRightBar",(function(e){t.ref("right-bar-wrapper").style.setProperty("--right-bar-width-duration",e?".24s":".16s")})),this.handleCapsuleShow=function(e){var n=e.data,a=null==n?void 0:n.items;a&&t.data.set("agentsList",a)},ua().on(this.handleCapsuleShow))},disposed:function(){this.handleCapsuleShow&&ua().off(this.handleCapsuleShow),this.handleCapsuleShow=null}})),NT={};NT=Object.assign(NT,{chatContainerMainArea:"chat-container-main-area_1y46a_1","chat-container-main-area":"chat-container-main-area_1y46a_1",chatContainerMainStream:"chat-container-main-stream_1y46a_11","chat-container-main-stream":"chat-container-main-stream_1y46a_11",chatBottomWrapper:"chat-bottom-wrapper_1y46a_27","chat-bottom-wrapper":"chat-bottom-wrapper_1y46a_27",chatBottom:"chat-bottom_1y46a_27","chat-bottom":"chat-bottom_1y46a_27",rightBarWrapper:"right-bar-wrapper_1y46a_38","right-bar-wrapper":"right-bar-wrapper_1y46a_38",show:"show_1y46a_42",showWorkspace:"show-workspace_1y46a_46","show-workspace":"show-workspace_1y46a_46",hide:"hide_1y46a_49",easeInShow:"ease-in-show_1y46a_56","ease-in-show":"ease-in-show_1y46a_56",fadeIn:"fadeIn_1y46a_1",chatContainerPc:"chat-container-pc_1y46a_69","chat-container-pc":"chat-container-pc_1y46a_69",chatContainerMainWrapper:"chat-container-main-wrapper_1y46a_77","chat-container-main-wrapper":"chat-container-main-wrapper_1y46a_77",chatContainerMain:"chat-container-main_1y46a_1","chat-container-main":"chat-container-main_1y46a_1"}),RT.template='\n    <div class="{{$style[\'chat-container-pc\']}}">\n        <div class="{{$style[\'chat-container-main-wrapper\']}}">\n            <div class="{{$style[\'chat-container-main\']}}">\n                \x3c!--- 对话区 --\x3e\n                <div\n                    class="{{$style[\'chat-container-main-area\']}}"\n                >\n                    \x3c!--- 对话流 --\x3e\n                    <div\n                        class="{{$style[\'chat-container-main-stream\']}}"\n                        s-ref="chat-stream"\n                    ></div>\n                </div>\n            </div>\n            \x3c!--- 底部输入框 --\x3e\n            <div\n                s-ref="chat-bottom-wrapper"\n                class="{{$style[\'chat-bottom-wrapper\']}} {{hasRightBar ? $style[\'has-right-bar\'] : \'\'}}"\n            >\n                <div class="{{$style[\'chat-bottom\']}}">\n                    <chat-input-box />\n                    <back-to-generate />\n                </div>\n            </div>\n        </div>\n        \x3c!-- 灵感区 --\x3e\n        <div\n            s-if="!isExtension"\n            s-ref="right-bar-wrapper"\n            class="{{$style[\'right-bar-wrapper\']}} {{hasRightBar ? $style[\'show\'] : $style[\'hide\']}} {{showWorkspaceType ? $style[\'show-workspace\'] : \'\'}}"\n        >\n            <div s-show="showWorkspaceType" class="{{$style[\'ease-in-show\']}}">\n                <workspace-stage />\n            </div>\n            <div s-show="!showWorkspaceType" class="{{$style[\'ease-in-show\']}}">\n                <right-bar agents-list="{{agentsList}}" />\n            </div>\n        </div>\n    </div>\n';var qT="function"==typeof RT?RT.prototype.initData||MT:RT.initData||MT;function MT(){return{$style:NT}}function jT(){return Object.assign({},qT.call(this),{$style:NT})}function BT(){return BT=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},BT.apply(this,Array.from(arguments))}function HT(t,e){return HT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},HT(t,e)}"function"==typeof RT?RT.prototype.initData=jT:RT.initData=jT;var $T=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).handleEscKey=function(t){"Escape"===t.key&&e.data.get("showDeleteDialog")&&e.handleDefaultCancel("esc")},e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&HT(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{sessionData:null,showDeleteDialog:!1}},n.handleClick=function(){var t,e,n;this.fire("click");var a=this.data.get("showData");Aa({type:"click",value:"dialog",page:"his_dialog",ext:BT({ori_lid:a.sessionId,lid:a.sessionId,re_rank:"1",query:a.text,agent_id:(null==(t=a.agentInfo)?void 0:t.agentId)||"",agent_name:(null==(e=a.agentInfo)?void 0:e.agentName)||""},(null==(n=a.fileList)?void 0:n.length)?{annex:a.fileList.map((function(t){return{annex_type:"file",annex_size:Nc(t.fileSize),annex_detail:t.fileUrl}}))}:{annex:[]})})},n.handleHistoryDeleteBtn=function(t){t.stopPropagation(),this.clickLogParams("delete_dialog"),document.addEventListener("keydown",this.handleEscKey),this.data.set("showDeleteDialog",!0)},n.handleDefaultCancel=function(t){this.data.set("showDeleteDialog",!1),document.removeEventListener("keydown",this.handleEscKey),this.clickLogParams("delete_dialog_pop",t||"")},n.handleDefaultOk=function(){var t=this.data.get("showData").sessionId;this.data.set("showDeleteDialog",!1),document.removeEventListener("keydown",this.handleEscKey),this.dispatch("delete-history",{sessionId:t}),this.clickLogParams("delete_dialog_pop","delete")},n.handleDefaultClose=function(){this.handleDefaultCancel("blank")},n.clickLogParams=function(t,e){Aa({type:"click",value:t,page:"his_dialog",ext:{button:e}})},e}(a.Component);function UT(){return UT=Object.assign||function(t){for(var e=1;e<Array.from(arguments).length;e++){var n=Array.from(arguments)[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},UT.apply(this,Array.from(arguments))}function FT(t,e){return FT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},FT(t,e)}$T.template='\n        <div s-if="showData.show" class="chat-history-list-item {{showDeleteDialog ? \'no-hover\' : \'\'}}">\n            <div class="history-item-content" data-show-ext="{{realShowExt}}" on-click="handleClick">\n                <div class="history-item-content-left">\n                    <span s-if="showData.agentText" class="history-item-agent">\n                        {{showData.agentText}}\n                    </span>\n                    <span\n                        s-if="showData.text"\n                        class="history-item-text\n                            {{showData.fileList && showData.fileList.length > 0 ? \'cos-space-mr-md\' : \'\'}}\n                        "\n                    >\n                        {{showData.text}}\n                    </span>\n                </div>\n                <div class="history-item-content-right" style="{{contentRightStyle}}">\n                    <span\n                        s-if="showData.fileList"\n                        s-for="fileInfo in showData.fileList"\n                        class="history-item-file"\n                    >\n                        <img src="{{fileInfo.iconUrl}}" class="history-item-file-img" />\n                        <span class="history-item-file-name">\n                            {{fileInfo.name}}\n                        </span>\n                    </span>\n                </div>\n            </div>\n            <span s-if="showData.updateTime" class="history-item-time">\n                {{showData.updateTime}}\n            </span>\n            \x3c!-- hover态展示删除按钮 --\x3e\n            <span class="history-item-delete" on-click="handleHistoryDeleteBtn" data-show-ext="{{deteleButtonShowExt}}">\n                <cos-icon name="bin" class="history-item-delete-btn"></cos-icon>\n            </span>\n            \x3c!-- 现组件上无法打曝光，所以再包了一层div --\x3e\n            <div\n                s-if="showDeleteDialog"\n                data-show-area\n                data-show-ext="{{deleteDialogShowExt}}"\n            >\n            \x3c!-- 删除会话弹窗 --\x3e\n                <cos-dialog\n                    open="{{showDeleteDialog}}"\n                    class="history-item-delete-dialog"\n                    appearance="info"\n                    title="确定删除对话？"\n                    okText="删除"\n                    outsideClosable="true"\n                    on-ok="handleDefaultOk"\n                    on-close="handleDefaultClose"\n                    on-cancel="handleDefaultCancel(\'cancle\')"\n                >删除后，对话记录不可恢复。</cos-dialog>\n            </div>\n        </div>\n    ',$T.computed={showData:function(){var t,e=this.data.get("sessionData");if(!e)return{};var n=e.sessionId,a=e.dayDiff,i=e.updateTime,o=e.query,r=e.agentInfo,s={agentText:"",text:"",fileList:[],updateTime:"",sessionId:n,show:!0};return r&&r.agentName&&(s.agentText="@"+r.agentName,s.agentInfo=r),null==o||o.forEach((function(t){var e;if("TEXT"===t.type)s.text=(null==(e=t.data.text)?void 0:e.query)||"";else if("FILE"===t.type){var n=t.data.file,a=Ec(n.fileType);s.fileList.push({type:"file",iconUrl:de[a],name:n.fileName,fileUrl:n.fileUrl,fileSize:n.fileSize})}else if("IMAGE"===t.type){var i=t.data.image;s.fileList.push({type:"image",iconUrl:"https://gips3.baidu.com/it/u=828382227,2824983548&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f48_48",name:i.imageName,fileUrl:i.imageUrl,fileSize:i.imageSize}),i.imageName||(s.show=!1)}})),i&&(s.updateTime=function(t,e){if(!t)return"";var n=Ti(Li(t));if(0===e){var a=Ci(n.minute);return Ci(n.hour)+":"+a}return n.year+"年"+n.monthe+"月"+n.day+"日"}(+i,a)),s.agentText||s.text||(null==(t=s.fileList)?void 0:t.length)||(s.show=!1),s},contentRightStyle:function(){var t,e=this.data.get("showData");return(null==(t=e.fileList)?void 0:t.length)?"min-width: "+19*e.fileList.length+"px":""},realShowExt:function(){var t,e,n,a=this.data.get("showData"),i={setype:"csaitab",value:"dialog",page:"his_dialog",ori_lid:a.sessionId,lid:a.sessionId,re_rank:"1",agentId:(null==(t=a.agentInfo)?void 0:t.agentId)||"",agentName:(null==(e=a.agentInfo)?void 0:e.agentName)||"",annex:[]};return null==(n=a.fileList)||n.forEach((function(t){i.annex.push({annex_type:"file"===t.type?"file":"pic",annex_size:Nc(t.fileSize),annex_detail:t.fileUrl})})),JSON.stringify(i)},deteleButtonShowExt:function(){return JSON.stringify({setype:"csaitab",value:"delete_dialog",page:"his_dialog"})},deleteDialogShowExt:function(){return JSON.stringify({setype:"csaitab",value:"delete_dialog_pop",page:"his_dialog"})}},$T.components={"cos-icon":e.Icon,"cos-dialog":e.Dialog};var GT="今天",WT="最近7天",zT="最近30天",QT="最近一年",JT="更久";var VT=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&FT(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{historyList:[]}},n.handleHistoryItemClick=function(t){this.dispatch("history-item-click",null),qa({isShowHello:"1",extParams:JSON.stringify(UT({ori_lid:t.sessionId,subEnterType:"his_middle"},t.enterType?{enter_type:t.enterType}:{}))})},e}(a.Component);function KT(t,e){return KT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},KT(t,e)}VT.template='\n        <div class="chat-history-list" data-show-area>\n            <fragment s-for="item in showHistoryList">\n                <div class="chat-history-time-item">\n                    <div class="chat-history-time-title">\n                        {{item.timeTitle}}\n                    </div>\n                    <fragment s-for="historyItem in item.list">\n                        <history-list-item\n                            session-data="{{historyItem}}"\n                            on-click="handleHistoryItemClick(historyItem)"\n                        />\n                    </fragment>\n                </div>\n            </fragment>\n        </div>\n    ',VT.components={"history-list-item":$T},VT.computed={showHistoryList:function(){return function(t){var e=new Map;return null==t||t.forEach((function(t){var n,a,i,o,r,s,c,l,d,u=t.sessionId,p=t.updateTime,h=t.msgList,f=Ii(+p),g="";g=0===f?GT:f<=7?WT:f<=30?zT:f<=365?QT:JT,e.has(g)||e.set(g,{timeTitle:g,list:[]});var m=(null==h||null==(n=h[0])?void 0:n.query)||[],v=(null==h||null==(a=h[0])?void 0:a.enterType)||"",y=null==h||null==(d=h[0])||null==(l=d.chatResponse)||null==(c=l[0])||null==(s=c.data)||null==(r=s.message)||null==(o=r.content)||null==(i=o.agentInfo)?void 0:i.agentMeta,b=y&&y.length&&y[0];e.get(g).list.push({sessionId:u,dayDiff:f,updateTime:p,query:Vi(m),agentInfo:b,enterType:v})})),Array.from(e.values())}(this.data.get("historyList"))}};var XT=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KT(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{loadingStatus:"loading",threshold:100}},n.attached=function(){var t=this.data.get("threshold");this.observer=new IntersectionObserver(this.handleIntoView.bind(this),{root:null,rootMargin:t+"px",threshold:0}),this.observer.observe(this.el)},n.handleIntoView=function(t){"loading"===this.data.get("loadingStatus")&&0!==t.length&&t[0].isIntersecting&&(this.fire("load"),Aa({type:"show",value:"more",page:"his_dialog"}))},n.handleClick=function(){"load-fail"===this.data.get("loadingStatus")&&this.fire("load")},n.disposed=function(){this.observer&&(this.observer.disconnect(),this.observer=null)},e}(a.Component);function YT(t,e){return YT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},YT(t,e)}XT.template='\n        <div s-ref="infinite-scroll" class="chat-history-infinite-scroll" on-click="handleClick">\n            <slot name="loading" s-if="loadingStatus === \'loading\'">\n                <span class="chat-infinite-scroll-text-default">正在加载...</span>\n            </slot>\n            <slot name="loadFail" s-elif="loadingStatus === \'loadFail\'">\n                <span class="chat-infinite-scroll-text-default">- 加载失败 请点击重试 -</span>\n            </slot>\n            <slot name="loadEnd" s-else>\n                <span class="chat-infinite-scroll-text-default">- 到底了 没有更多内容了 -</span>\n            </slot>\n        </div>\n    ',XT.computed={};var ZT=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YT(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{status:"loading",size:"30"}},n.attached=function(){var t={container:this.el,renderer:"svg",loop:!0,autoplay:!0,path:"https://psstatic.cdn.bcebos.com/basics/aichat/aitab_history_loading_1739519589000.json"};this.loadingInstance=i.loadAnimation(t)},e}(a.Component);function tC(t,e){return tC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},tC(t,e)}ZT.template='\n        <div style="width: {{size}}px; height: {{size}}px;"></div>\n    ';var eC=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tC(t,e)}(e,t);var n=e.prototype;return n.initData=function(){return{status:"empty",emptyText:"当前没有历史",emptyIcon:"https://gips1.baidu.com/it/u=3603041107,2441073942&fm=3028&app=3028&f=PNG&fmt=auto&q=100&size=f315_271"}},n.handleBtnClick=function(){Aa({type:"click",value:"back_ai",page:"his_dialog",ext:{setype:"csaitab"}}),qa({isShowHello:"1",extParams:JSON.stringify({enter_type:"his_empty"})})},e}(a.Component);function nC(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function aC(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function iC(t){return oC.apply(this,Array.from(arguments))}function oC(){var t;return t=function(t){var e,n,a;return aC(this,(function(i){switch(i.label){case 0:e=Je.getState("chatParams.sse_host")||Ht,n=""+e+$t.delete,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,ja(n,{method:"POST",body:JSON.stringify(t)},3e3)];case 2:return[2,{status:(a=i.sent()).status,message:a.message}];case 3:return[2,{status:-1,message:"Failed to delete history",error:i.sent()}];case 4:return[2]}}))},oC=function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){nC(o,a,i,r,s,"next",t)}function s(t){nC(o,a,i,r,s,"throw",t)}r(void 0)}))},oC.apply(this,Array.from(arguments))}function rC(t,e,n,a,i,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,i)}function sC(t){return function(){var e=this,n=Array.from(arguments);return new Promise((function(a,i){var o=t.apply(e,n);function r(t){rC(o,a,i,r,s,"next",t)}function s(t){rC(o,a,i,r,s,"throw",t)}r(void 0)}))}}function cC(t,e){return cC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},cC(t,e)}function lC(t,e){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}eC.template='\n        <div class="chat-history-empty">\n            <div class="chat-history-empty-content">\n                <cos-empty\n                    s-if="status === \'empty\'"\n                    icon="{{emptyIcon}}"\n                    title="{{emptyText}}"\n                    size="md"\n                >\n                    <cos-button\n                        attr-data-show-area\n                        attr-data-show-ext="{{btnShowExt}}"\n                        on-click="native:handleBtnClick"\n                        class="chat-history-empty-no-data-button"\n                    >\n                        回到<span class="chat-history-empty-no-data-button-icon"></span>\n                    </cos-button>\n                </cos-empty>\n\n                <loading-lottie size="80" s-if="status === \'loading\'"></loading-lottie>\n            </div>\n        </div>\n    ',eC.components={"cos-button":e.Button,"cos-empty":e.Empty,"loading-lottie":ZT},eC.computed={btnShowExt:function(){return JSON.stringify({setype:"csaitab",value:"back_ai",page:"his_dialog"})}};var dC,uC,pC=Math.min(Math.floor(window.innerHeight/46),30),hC=function(t){function n(){var e;return(e=t.apply(this,Array.from(arguments))||this).startTime=0,e.endTime=0,e.fetchCount=2,e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cC(t,e)}(n,t);var a=n.prototype;return a.initData=function(){return{historyList:[],infiniteScrollStatus:"loading",fetchStatus:"end",emptyStatus:"loading",pn:0}},a.attached=function(){this.sendPageShowLog(),this.fetchHistoryList()},a.sendPageShowLog=function(){this.startTime=+Date.now(),Aa({type:"display",page:"his_dialog"})},a.handleHistoryItemClick=function(){this.endTime=+Date.now(),Aa({ubcId:"18663",type:"",value:"page_duration",page:"his_dialog",ext:{starttime:String(this.startTime),endtime:String(this.endTime),duration:String(this.endTime-this.startTime)}})},a.fetchHistoryList=function(){var t=this;return sC((function(){var n,a,i,o,r,s,c,l,d;return lC(this,(function(u){switch(u.label){case 0:t.data.set("fetchStatus","loading"),n=Je.getState("chatParams.sse_host")||Ht,a=""+n+$t.history,i=t.data.get("pn"),o={},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,Ba(a,{rn:pC,pn:i,req_type:4,from:"chat_search",token:$r()},{},5e3)];case 2:return o=u.sent(),[3,4];case 3:return r=u.sent(),console.error(r),[3,4];case 4:if(s=o.status,c=o.data,0===s){if(!(null==(l=c.historyData)?void 0:l.length)&&0===i)return t.data.set("emptyStatus","empty"),[2];(null==l?void 0:l.length)||t.data.set("infiniteScrollStatus","loadEnd"),d=t.data.get("historyList"),t.data.splice("historyList",[].concat([d.length,0],l.reverse())),t.data.set("fetchStatus","end"),t.data.set("pn",+i+1)}else 0===i&&t.data.set("emptyStatus","empty"),t.data.set("infiniteScrollStatus","loadEnd"),e.Toast.error({message:"网络异常，请稍后再试"});return t.data.set("fetchStatus","end"),[2]}}))}))()},a.deleteHistoryItem=function(t){var n=this;return sC((function(){var a,i;return lC(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,iC({req_type:1,ori_lid_list:[{ori_lid:t}]})];case 1:return 0===(a=o.sent()).status?n.updateHistoryListAfterDelete(t):(console.error("Error deleting history:",a),e.Toast.error({message:"删除失败， 请稍后再试"})),[3,3];case 2:return i=o.sent(),console.error("Error deleting history:",i),[3,3];case 3:return[2]}}))}))()},a.updateHistoryListAfterDelete=function(t){var e=this.data.get("historyList");Je.getState("oriLid")===t&&(Na=null);var n=e.filter((function(e){return e.sessionId!==t}));this.data.set("historyList",n),0===n.length&&this.data.set("emptyStatus","empty")},a.handleLoad=function(){this.data.set("infiniteScrollStatus","loading"),"loading"!==this.data.get("fetchStatus")&&this.fetchHistoryList()},n}(a.Component);hC.template='\n        <div class="chat-search-history-page">\n            <div\n                s-if="historyList && historyList.length > 0"\n                class="chat-search-history-page-content"\n            >\n                <history-list\n                    history-list="{{historyList}}"\n                />\n                <infinite-scroll\n                    loading-status="{{infiniteScrollStatus}}"\n                    on-load="handleLoad"\n                >\n                    <div slot="loading" class="chat-history-page-list-loading">\n                        <loading-lottie size="28"></loading-lottie>\n                    </div>\n                    <div slot="loadEnd" class="chat-history-page-list-no-more">\n                        <div class="chat-history-page-list-no-more-left"></div>\n                        <div class="chat-history-page-list-no-more-text">\n                            没有更多历史了\n                        </div>\n                        <div class="chat-history-page-list-no-more-right"></div>\n                    </div>\n                </infinite-scroll>\n            </div>\n            <empty-page\n                s-else\n                status="{{emptyStatus}}"\n            />\n        </div>\n    ',hC.messages={"history-item-click":function(){this.handleHistoryItemClick()},"delete-history":function(t){var e=t.value.sessionId;this.deleteHistoryItem(e)}},hC.components={"history-list":VT,"infinite-scroll":XT,"empty-page":eC,"loading-lottie":ZT},function(t){t.OPEN_NEW_AGENT_CONVERSATION="openNewAgentConversation",t.JUMP_TO_TARGET_URL="jumpToTargetUrl"}(dC||(dC={})),function(t){t.LOADED="loaded"}(uC||(uC={}));var fC=function(){function t(t){var e=t.iframeId,n=t.fatherCb;this.iframeId=e,this.fatherCb=n,this.watchIframeStatus()}var e=t.prototype;return e.initMessagePipe=function(){this.channel=new MessageChannel,this.fatherPipe=this.channel.port1,this.childPipe=this.channel.port2,this.fatherPipe.onmessage=this.fatherCb},e.watchIframeStatus=function(){var t=this;window.addEventListener("message",(function(e){var n=(null==e?void 0:e.data)||{},a=n.iframeStatus;if(n.messageName,"loaded"===a)t.sendchildPipe()}))},e.sendchildPipe=function(){try{var t,e=document.getElementById(this.iframeId);this.initMessagePipe(),null==e||null==(t=e.contentWindow)||t.postMessage("父亲页面消息: 将childPipe传递给子页面","*",[this.childPipe])}catch(t){}},t.sendIframeLoadStatus=function(t,e){parent.window.postMessage({messageName:t,iframeStatus:e},"*")},t}();function gC(t,e){return gC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},gC(t,e)}var mC=function(t){function e(){return t.apply(this,Array.from(arguments))}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gC(t,e)}(e,t);var n=e.prototype;return n.created=function(){var t,e=new URLSearchParams(window.location.search),n=e.get("appSquare")||"",a=e.get("tabName")||"";try{t=JSON.parse(decodeURIComponent(n))}catch(e){t={}}this.data.set("appSquare",t),this.data.set("tabName",a)},n.initData=function(){return{appSquare:{pcSquareUrl:""},tabName:"",iframeId:"chat-square-iframe"}},n.attached=function(){this.handleIframeMessage()},n.handleIframeMessage=function(){var t=this,e=this.data.get("iframeId");this.messagePipe=new fC({iframeId:e,fatherCb:function(e){var n=e.data,a=n.name,i=n.data;if(a)switch(a){case dC.OPEN_NEW_AGENT_CONVERSATION:t.openNewAgentPage(i);break;case dC.JUMP_TO_TARGET_URL:t.jumpToTargetUrl(i)}}})},n.jumpToTargetUrl=function(t){var e=t.targetUrl;window.open(e,"_blank")},n.openNewAgentPage=function(t){ca().emit(t)},e}(a.Component);function vC(t,e){return vC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vC(t,e)}mC.template='\n        <div class="chat-square-page-container">\n            <iframe\n                s-if="iframeUrl"\n                id="{{iframeId}}"\n                src="{{iframeUrl}}"\n                class="chat-square-iframe"\n            >\n            </iframe>\n        </div>\n    ',mC.computed={iframeUrl:function(){var t=this.data.get("appSquare"),e=this.data.get("tabName"),n=t.pcSquareUrl;if(e){var a=new URL(n),i=new URLSearchParams(a.search);i.set("tabName",e),a.search=i.toString(),n=a.toString()}return n}};var yC=function(t){function e(){var e;return(e=t.apply(this,Array.from(arguments))||this).bgColorCache="",e}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vC(t,e)}(e,t);var n=e.prototype;return n.created=function(){var t=new URLSearchParams(window.location.search).get("agentInfo")||"",e={};try{e=JSON.parse(decodeURIComponent(t))}catch(t){e={}}this.data.set("agentInfo",e)},n.initData=function(){return{agentInfo:{agentId:"",agentName:"",logo:"",description:"",pcUrl:"",realUrl:""}}},n.attached=function(){this.setBgColor()},n.setBgColor=function(){this.bgColorCache=document.body.style.backgroundColor,document.body.style.backgroundColor="var(--cos-color-bg-dent) !important"},n.detached=function(){document.body.style.backgroundColor=this.bgColorCache},e}(a.Component);yC.template='\n        <div class="chat-agent-page-container">\n            <iframe\n                s-if="iframeUrl"\n                src="{{iframeUrl}}"\n                class="chat-agent-iframe"\n            />\n        </div>\n    ',yC.computed={iframeUrl:function(){var t=this.data.get("agentInfo");return t.realUrl||t.pcUrl}};var bC=[{rule:fe.CHAT.path,target:zt,handler:function(t){!function(t){var e=t.Component,n=t.event;if(Na){var a;null==(a=Na.el)||a.classList.remove("chat-page-hide")}else{var i=document.querySelector(zt);i&&(n.referrer&&Je.dispatch("resetChatPageStore",null),(Na=new e).attach(i))}}({event:t,Component:RT})}},{rule:fe.HISTORY.path,Component:hC,target:zt},{rule:fe.AGENT.path,Component:yC,target:zt},{rule:fe.SQUARE.path,Component:mC,target:zt}],wC=St.connect(Je,{topRank:"topRank",showMindMap:"showMindMap"})(a.defineComponent({components:{"chat-top-bar":uc,"chat-aside":lc},initData:function(){return{userInfo:Je.getState("user"),curAgentIndex:"main",isFindAgentIframe:!1,isShowIframe:!0,iframeId:"agent-iframe"}},attached:function(){this.initRouter()},initRouter:function(){bn.router.add(bC),bn.router.setMode("html5"),bn.router.start()},handleLogin:function(){ys()}})),_C={};_C=Object.assign(_C,{chatContainerBody:"chat-container-body_6aoef_1","chat-container-body":"chat-container-body_6aoef_1",chatContainerWrapper:"chat-container-wrapper_6aoef_4","chat-container-wrapper":"chat-container-wrapper_6aoef_4",chatContainer:"chat-container_6aoef_1","chat-container":"chat-container_6aoef_1",findAgentIframeLayout:"find-agent-iframe-layout_6aoef_16","find-agent-iframe-layout":"find-agent-iframe-layout_6aoef_16",chatContainerAside:"chat-container-aside_6aoef_29","chat-container-aside":"chat-container-aside_6aoef_29",chatContainerMain:"chat-container-main_6aoef_58","chat-container-main":"chat-container-main_6aoef_58",chatContainerAgent:"chat-container-agent_6aoef_68","chat-container-agent":"chat-container-agent_6aoef_68",findAgentIframe:"find-agent-iframe_6aoef_16","find-agent-iframe":"find-agent-iframe_6aoef_16",chatBackground:"chat-background_6aoef_92","chat-background":"chat-background_6aoef_92"}),wC.template="\n    <div class=\"\n        {{$style['chat-container']}}\n        {{currentAgent && !isFindAgentIframe ? $style['chat-background'] : ''}}\n    \">\n        \x3c!--- 顶部 --\x3e\n        <chat-top-bar\n            on-login=\"handleLogin\"\n        />\n\n        \x3c!--- 主体 --\x3e\n        <div class=\"{{$style['chat-container-body']}}\">\n            \x3c!--- 左侧导航菜单，固定 --\x3e\n            <chat-aside />\n            \x3c!--- 主内容 --\x3e\n            <div id=\"chat-container-main\" class=\"{{$style['chat-container-wrapper']}}\">\n            </div>\n        </div>\n    </div>\n";var kC="function"==typeof wC?wC.prototype.initData||SC:wC.initData||SC;function SC(){return{$style:_C}}function xC(){return Object.assign({},kC.call(this),{$style:_C})}"function"==typeof wC?wC.prototype.initData=xC:wC.initData=xC;var IC=0;document.addEventListener("mousedown",(function(){IC=(new Date).getTime()})),document.addEventListener("mouseup",(function(t){var e=(new Date).getTime()-IC,n=t.clientX,a=t.clientY;Je.dispatch("update",{pcClickInfo:{clickTimeDiff:e,clientX:n,clientY:a}})})),window.sc.getESLInstance().addEslConfig({paths:{"js/cosmic.pc.CiKfZjh1":"//ms.bdstatic.com/se/chat-search/static/js/cosmic.pc.CiKfZjh1","js/cosmic-agent-ui.pc.D3zcnH4y":"//ms.bdstatic.com/se/chat-search/static/js/cosmic-agent-ui.pc.D3zcnH4y","js/search-components.pc.DXXW15mB":"//ms.bdstatic.com/se/chat-search/static/js/search-components.pc.DXXW15mB","js/bootstrap.pc.xdqafqeS":"//ms.bdstatic.com/se/chat-search/static/js/bootstrap.pc.xdqafqeS","js/echarts.pc.KGe0vDLl":"//ms.bdstatic.com/se/chat-search/static/js/echarts.pc.KGe0vDLl","js/baidubce-sdk.bundle.min.pc.Dl2RPL9u":"//ms.bdstatic.com/se/chat-search/static/js/baidubce-sdk.bundle.min.pc.Dl2RPL9u","js/artplayer.pc.Cx1tPsvT":"//ms.bdstatic.com/se/chat-search/static/js/artplayer.pc.Cx1tPsvT","js/jsencrypt.min.pc.C4lM-0We":"//ms.bdstatic.com/se/chat-search/static/js/jsencrypt.min.pc.C4lM-0We","js/index.pc.Cl9AChXm":"//ms.bdstatic.com/se/chat-search/static/js/index.pc.Cl9AChXm","js/qeditor.pc.BpWzuvbh":"//ms.bdstatic.com/se/chat-search/static/js/qeditor.pc.BpWzuvbh","js/client.esm.pc.CbkX8WQ8":"//ms.bdstatic.com/se/chat-search/static/js/client.esm.pc.CbkX8WQ8","js/crypto.pc.DUESVqs9":"//ms.bdstatic.com/se/chat-search/static/js/crypto.pc.DUESVqs9"}}),Je.dispatch("update",{bootstrapStart:(new Date).getTime()});var TC,CC=document.getElementById("app");(new wC).attach(document.getElementById("app")),TC=+Date.now(),Hn().on((function(){var t=+Date.now();Ea(TC,t),TC=+Date.now()})),document.addEventListener("visibilitychange",(function(){if("hidden"===document.visibilityState){var t=+Date.now();Ea(TC,t),TC=0}else"visible"===document.visibilityState&&(TC=Date.now())})),window.addEventListener("beforeunload",(function(){var t=+Date.now();TC&&Ea(TC,t)})),nd||(nd=!0,document.body.addEventListener("click",cd));var LC,PC,DC;CC.setAttribute("data-click-log",JSON.stringify({tcreq4log:1,t:"zbios",vit:"osres",l:"1",fm:"beha",clk_type:1,clk_info:{pd:"csaitab",tab_se:"1"},extra:{ctse_id:"",setype:"csaitab",scene:""}})),LC="aitab-chat-search",PC=ln("body"),DC=Array.isArray(LC)?LC:[LC],PC.forEach((function(t){var e;(e=t.classList).add.apply(e,[].concat(DC))})),uo(),new cn})),require(["js/bootstrap.pc.xdqafqeS"]);
